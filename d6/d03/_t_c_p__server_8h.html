<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>libtoxcore: toxcore/TCP_server.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../tox.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libtoxcore
   </div>
   <div id="projectbrief">The future of instant messaging</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_0b4cb6aa1b49ded7d7b217b80a3955c0.html">toxcore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">TCP_server.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../dd/d3e/crypto__core_8h_source.html">crypto_core.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/db9/onion_8h_source.html">onion.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/d23/list_8h_source.html">list.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for TCP_server.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d33/_t_c_p__server_8h__incl.png" border="0" usemap="#toxcore_2_t_c_p__server_8h" alt=""/></div>
<map name="toxcore_2_t_c_p__server_8h" id="toxcore_2_t_c_p__server_8h">
<area shape="rect" id="node2" href="../../dd/d3e/crypto__core_8h.html" title="crypto_core.h" alt="" coords="555,229,657,256"/><area shape="rect" id="node19" href="../../d3/db9/onion_8h.html" title="onion.h" alt="" coords="662,80,726,107"/><area shape="rect" id="node22" href="../../da/d23/list_8h.html" title="list.h" alt="" coords="1138,304,1189,331"/><area shape="rect" id="node3" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="655,304,733,331"/><area shape="rect" id="node20" href="../../df/dad/_d_h_t_8h.html" title="DHT.h" alt="" coords="663,155,725,181"/><area shape="rect" id="node21" href="../../dd/dec/ping__array_8h.html" title="ping_array.h" alt="" coords="731,229,825,256"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d2c/_t_c_p__server_8h__dep__incl.png" border="0" usemap="#toxcore_2_t_c_p__server_8hdep" alt=""/></div>
<map name="toxcore_2_t_c_p__server_8hdep" id="toxcore_2_t_c_p__server_8hdep">
<area shape="rect" id="node2" href="../../d0/df3/_t_c_p__client_8h.html" title="toxcore/TCP_client.h" alt="" coords="643,87,789,114"/><area shape="rect" id="node26" href="../../db/d5e/_d_h_t__bootstrap_8c.html" title="other/DHT_bootstrap.c" alt="" coords="452,543,607,569"/><area shape="rect" id="node34" href="../../d2/d8d/_t_c_p__test_8c.html" title="auto_tests/TCP_test.c" alt="" coords="553,244,708,271"/><area shape="rect" id="node37" href="../../d1/d36/tox-bootstrapd_8c.html" title="other/bootstrap_daemon\l/tox&#45;bootstrapd.c" alt="" coords="813,80,976,121"/><area shape="rect" id="node38" href="../../d4/d40/_t_c_p__server_8c.html" title="toxcore/TCP_server.c" alt="" coords="1001,87,1151,114"/><area shape="rect" id="node3" href="../../da/d39/_t_c_p__connection_8h.html" title="toxcore/TCP_connection.h" alt="" coords="694,169,871,196"/><area shape="rect" id="node36" href="../../da/da1/_t_c_p__client_8c.html" title="toxcore/TCP_client.c" alt="" coords="895,169,1041,196"/><area shape="rect" id="node4" href="../../de/d42/net__crypto_8h.html" title="toxcore/net_crypto.h" alt="" coords="935,244,1076,271"/><area shape="rect" id="node35" href="../../d5/d26/_t_c_p__connection_8c.html" title="toxcore/TCP_connection.c" alt="" coords="733,244,910,271"/><area shape="rect" id="node5" href="../../d5/d29/crypto__test_8c.html" title="auto_tests/crypto_test.c" alt="" coords="805,319,968,345"/><area shape="rect" id="node6" href="../../d0/d08/friend__connection_8h.html" title="toxcore/friend_connection.h" alt="" coords="835,393,1018,420"/><area shape="rect" id="node30" href="../../d9/d26/onion__client_8h.html" title="toxcore/onion_client.h" alt="" coords="1043,319,1192,345"/><area shape="rect" id="node33" href="../../d8/dc6/net__crypto_8c.html" title="toxcore/net_crypto.c" alt="" coords="640,319,781,345"/><area shape="rect" id="node7" href="../../d5/d24/friend__requests_8h.html" title="toxcore/friend_requests.h" alt="" coords="827,468,997,495"/><area shape="rect" id="node9" href="../../d4/d30/_messenger_8h.html" title="toxcore/Messenger.h" alt="" coords="659,543,803,569"/><area shape="rect" id="node29" href="../../d2/db1/friend__connection_8c.html" title="toxcore/friend_connection.c" alt="" coords="1021,468,1203,495"/><area shape="rect" id="node8" href="../../d2/dee/friends__test_8c.html" title="auto_tests/friends\l_test.c" alt="" coords="1258,617,1385,659"/><area shape="rect" id="node27" href="../../d3/dfd/_d_h_t__test_8c.html" title="testing/DHT_test.c" alt="" coords="1072,543,1205,569"/><area shape="rect" id="node28" href="../../d6/da4/friend__requests_8c.html" title="toxcore/friend_requests.c" alt="" coords="827,543,997,569"/><area shape="rect" id="node10" href="../../d8/dda/messenger__test_8c.html" title="auto_tests/messenger\l_test.c" alt="" coords="890,617,1041,659"/><area shape="rect" id="node11" href="../../db/de9/_messenger__test_8c.html" title="testing/Messenger_test.c" alt="" coords="1065,625,1234,651"/><area shape="rect" id="node12" href="../../df/dc1/rtp_8h.html" title="toxav/rtp.h" alt="" coords="111,625,195,651"/><area shape="rect" id="node15" href="../../d9/d06/msi_8h.html" title="toxav/msi.h" alt="" coords="133,781,224,808"/><area shape="rect" id="node19" href="../../dd/de4/toxcore_2group_8h.html" title="toxcore/group.h" alt="" coords="396,625,508,651"/><area shape="rect" id="node23" href="../../d3/d69/tox_8c.html" title="toxcore/tox.c" alt="" coords="592,707,691,733"/><area shape="rect" id="node24" href="../../d8/d8d/_messenger_8c.html" title="toxcore/Messenger.c" alt="" coords="583,625,727,651"/><area shape="rect" id="node25" href="../../da/d84/toxdns_8c.html" title="toxdns/toxdns.c" alt="" coords="751,625,865,651"/><area shape="rect" id="node13" href="../../d1/d16/codec_8h.html" title="toxav/codec.h" alt="" coords="43,707,147,733"/><area shape="rect" id="node14" href="../../d5/def/codec_8c.html" title="toxav/codec.c" alt="" coords="5,856,109,883"/><area shape="rect" id="node18" href="../../d6/d46/rtp_8c.html" title="toxav/rtp.c" alt="" coords="171,707,255,733"/><area shape="rect" id="node17" href="../../d8/d0e/toxav_8c.html" title="toxav/toxav.c" alt="" coords="248,856,349,883"/><area shape="rect" id="node16" href="../../d2/d9b/msi_8c.html" title="toxav/msi.c" alt="" coords="133,856,224,883"/><area shape="rect" id="node20" href="../../d8/da5/toxav_2group_8h.html" title="toxav/group.h" alt="" coords="467,707,568,733"/><area shape="rect" id="node22" href="../../df/de9/toxcore_2group_8c.html" title="toxcore/group.c" alt="" coords="331,707,443,733"/><area shape="rect" id="node21" href="../../db/d46/toxav_2group_8c.html" title="toxav/group.c" alt="" coords="467,781,568,808"/><area shape="rect" id="node31" href="../../d7/dd9/onion__test_8c.html" title="auto_tests/onion_test.c" alt="" coords="1217,393,1375,420"/><area shape="rect" id="node32" href="../../db/d79/onion__client_8c.html" title="toxcore/onion_client.c" alt="" coords="1043,393,1192,420"/></map>
</div>
</div>
<p><a href="../../d6/d03/_t_c_p__server_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d8f/struct_t_c_p___priority___list.html">TCP_Priority_List</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dbf/struct_t_c_p___secure___connection.html">TCP_Secure_Connection</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2c62883bf7895f3582975a14ec316bef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a2c62883bf7895f3582975a14ec316bef">MAX_INCOMMING_CONNECTIONS</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a2c62883bf7895f3582975a14ec316bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2850071db896a7e93afd4acc1bfd69b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#ae2850071db896a7e93afd4acc1bfd69b">TCP_MAX_BACKLOG</a>&#160;&#160;&#160;<a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a2c62883bf7895f3582975a14ec316bef">MAX_INCOMMING_CONNECTIONS</a></td></tr>
<tr class="separator:ae2850071db896a7e93afd4acc1bfd69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879456c3b8e2853f7044d764e9c180d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a879456c3b8e2853f7044d764e9c180d4">MAX_PACKET_SIZE</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a879456c3b8e2853f7044d764e9c180d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b820bd1123c0fbdfd8391cce314b35b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a9b820bd1123c0fbdfd8391cce314b35b">TCP_HANDSHAKE_PLAIN_SIZE</a>&#160;&#160;&#160;(crypto_box_PUBLICKEYBYTES + crypto_box_NONCEBYTES)</td></tr>
<tr class="separator:a9b820bd1123c0fbdfd8391cce314b35b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a61b02e465cd8c05fbae1def1066f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a88a61b02e465cd8c05fbae1def1066f2">TCP_SERVER_HANDSHAKE_SIZE</a>&#160;&#160;&#160;(crypto_box_NONCEBYTES + <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a9b820bd1123c0fbdfd8391cce314b35b">TCP_HANDSHAKE_PLAIN_SIZE</a> + crypto_box_MACBYTES)</td></tr>
<tr class="separator:a88a61b02e465cd8c05fbae1def1066f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f4778a5c176dbd24018f61cc7524f7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#aa5f4778a5c176dbd24018f61cc7524f7">TCP_CLIENT_HANDSHAKE_SIZE</a>&#160;&#160;&#160;(crypto_box_PUBLICKEYBYTES + <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a88a61b02e465cd8c05fbae1def1066f2">TCP_SERVER_HANDSHAKE_SIZE</a>)</td></tr>
<tr class="separator:aa5f4778a5c176dbd24018f61cc7524f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f050748925b02db21564fa5f6c78e4e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a9f050748925b02db21564fa5f6c78e4e">TCP_MAX_OOB_DATA_LENGTH</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:a9f050748925b02db21564fa5f6c78e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d07eb7b13b1998b771080dfaef6b7b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a41d07eb7b13b1998b771080dfaef6b7b">NUM_RESERVED_PORTS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a41d07eb7b13b1998b771080dfaef6b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad3362495a10d80b0edac21c8f896ae1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#aad3362495a10d80b0edac21c8f896ae1">NUM_CLIENT_CONNECTIONS</a>&#160;&#160;&#160;(256 - <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a41d07eb7b13b1998b771080dfaef6b7b">NUM_RESERVED_PORTS</a>)</td></tr>
<tr class="separator:aad3362495a10d80b0edac21c8f896ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a808af5b9484311a39abb96dac1ecd426"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a808af5b9484311a39abb96dac1ecd426">TCP_PACKET_ROUTING_REQUEST</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a808af5b9484311a39abb96dac1ecd426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad288b46b857552d69e64135b3a329d83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#ad288b46b857552d69e64135b3a329d83">TCP_PACKET_ROUTING_RESPONSE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad288b46b857552d69e64135b3a329d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae03ebbe7438d78a242e6970f35eb6dfa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#ae03ebbe7438d78a242e6970f35eb6dfa">TCP_PACKET_CONNECTION_NOTIFICATION</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ae03ebbe7438d78a242e6970f35eb6dfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b6df680eaecb9563dfcc8c5fcfba3d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a65b6df680eaecb9563dfcc8c5fcfba3d">TCP_PACKET_DISCONNECT_NOTIFICATION</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a65b6df680eaecb9563dfcc8c5fcfba3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1328be3bbb33d8e47490408376c3553"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#aa1328be3bbb33d8e47490408376c3553">TCP_PACKET_PING</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:aa1328be3bbb33d8e47490408376c3553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783819134f7296fb82cfc3149f6fbb62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a783819134f7296fb82cfc3149f6fbb62">TCP_PACKET_PONG</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a783819134f7296fb82cfc3149f6fbb62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5961d2c3587485c79194c5479a8b0973"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a5961d2c3587485c79194c5479a8b0973">TCP_PACKET_OOB_SEND</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a5961d2c3587485c79194c5479a8b0973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d824009f914ddf664d60adf6695189c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a6d824009f914ddf664d60adf6695189c">TCP_PACKET_OOB_RECV</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a6d824009f914ddf664d60adf6695189c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879315f1b7234dad07a45d63a6d0aed5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a879315f1b7234dad07a45d63a6d0aed5">TCP_PACKET_ONION_REQUEST</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a879315f1b7234dad07a45d63a6d0aed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe72759c701ff843abf6a80dafee7e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#acbe72759c701ff843abf6a80dafee7e8">TCP_PACKET_ONION_RESPONSE</a>&#160;&#160;&#160;9</td></tr>
<tr class="separator:acbe72759c701ff843abf6a80dafee7e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ba8b32c7131d7bddb07be65aec9d4db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a4ba8b32c7131d7bddb07be65aec9d4db">ARRAY_ENTRY_SIZE</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a4ba8b32c7131d7bddb07be65aec9d4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779366bdff0863c4e36c9313b25fcb29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a779366bdff0863c4e36c9313b25fcb29">TCP_PING_FREQUENCY</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:a779366bdff0863c4e36c9313b25fcb29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09b714899296b82866bab0a4d294c917"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a09b714899296b82866bab0a4d294c917">TCP_PING_TIMEOUT</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a09b714899296b82866bab0a4d294c917"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5750799a61dd1a6dc6930e5aa25ce653"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../df/d8f/struct_t_c_p___priority___list.html">TCP_Priority_List</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a5750799a61dd1a6dc6930e5aa25ce653">TCP_Priority_List</a></td></tr>
<tr class="separator:a5750799a61dd1a6dc6930e5aa25ce653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22e20d6aa67ad907ef4ae8334e5091b"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak" />
<a class="el" href="../../d2/dbf/struct_t_c_p___secure___connection.html">TCP_Secure_Connection</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#aa22e20d6aa67ad907ef4ae8334e5091b">TCP_Secure_Connection</a></td></tr>
<tr class="separator:aa22e20d6aa67ad907ef4ae8334e5091b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a5d76b81b0ad4c19007a781d4edb8181f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa20692881561141ef7621446ae15f78bc">TCP_STATUS_NO_STATUS</a>, 
<a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fab5e948cd81931f0c7e6a827e90c24616">TCP_STATUS_CONNECTED</a>, 
<a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa17e64dcb5cb3bb08704b328ff40c8138">TCP_STATUS_UNCONFIRMED</a>, 
<a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa42e6e74e5c62734eb1386045e159a601">TCP_STATUS_CONFIRMED</a>
 }</td></tr>
<tr class="separator:a5d76b81b0ad4c19007a781d4edb8181f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a148e632f4c51645cbc1b414bc3584b60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a148e632f4c51645cbc1b414bc3584b60">new_TCP_server</a> (uint8_t ipv6_enabled, uint16_t num_sockets, const uint16_t *<a class="el" href="../../d2/d8d/_t_c_p__test_8c.html#a04e5444bf6a826487066ba973577f674">ports</a>, const uint8_t *secret_key, <a class="el" href="../../d3/d01/struct_onion.html">Onion</a> *onion)</td></tr>
<tr class="separator:a148e632f4c51645cbc1b414bc3584b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e8a0302a359dd4f712eb1e9c346fe5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5">do_TCP_server</a> (<a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a> *TCP_server)</td></tr>
<tr class="separator:a40e8a0302a359dd4f712eb1e9c346fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6df6382ad309456dcf5b7b350313714"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#af6df6382ad309456dcf5b7b350313714">kill_TCP_server</a> (<a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a> *TCP_server)</td></tr>
<tr class="separator:af6df6382ad309456dcf5b7b350313714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae80fe7119d00d2a7788c0839a90e0782"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#ae80fe7119d00d2a7788c0839a90e0782">TCP_socket_data_recv_buffer</a> (<a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a> <a class="el" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>)</td></tr>
<tr class="separator:ae80fe7119d00d2a7788c0839a90e0782"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a984a0b6fc27b03e09170579ec9494093"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a984a0b6fc27b03e09170579ec9494093">read_TCP_length</a> (<a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a> <a class="el" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>)</td></tr>
<tr class="separator:a984a0b6fc27b03e09170579ec9494093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88eda37b476d8dcfdba94899e740dd9e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a88eda37b476d8dcfdba94899e740dd9e">read_TCP_packet</a> (<a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a> <a class="el" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, uint8_t *data, uint16_t length)</td></tr>
<tr class="separator:a88eda37b476d8dcfdba94899e740dd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2acbecbd76fe539293b5d92d0e0b6c5e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a2acbecbd76fe539293b5d92d0e0b6c5e">read_packet_TCP_secure_connection</a> (<a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a> <a class="el" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, uint16_t *next_packet_length, const uint8_t *shared_key, uint8_t *recv_nonce, uint8_t *data, uint16_t max_len)</td></tr>
<tr class="separator:a2acbecbd76fe539293b5d92d0e0b6c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a4ba8b32c7131d7bddb07be65aec9d4db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARRAY_ENTRY_SIZE&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00063">63</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2c62883bf7895f3582975a14ec316bef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_INCOMMING_CONNECTIONS&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00038">38</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00884">accept_connection()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01041">do_incoming()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01110">do_TCP_incomming()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01119">do_TCP_unconfirmed()</a>.</p>

</div>
</div>
<a class="anchor" id="a879456c3b8e2853f7044d764e9c180d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_PACKET_SIZE&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00042">42</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01089">do_confirmed_recv()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00827">do_confirmed_TCP()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01068">do_unconfirmed()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00074">proxy_http_generate_connection_request()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00204">read_TCP_length()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00365">write_packet_TCP_secure_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="aad3362495a10d80b0edac21c8f896ae1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_CLIENT_CONNECTIONS&#160;&#160;&#160;(256 - <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a41d07eb7b13b1998b771080dfaef6b7b">NUM_RESERVED_PORTS</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00050">50</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00740">handle_TCP_packet()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00579">handle_TCP_routing_req()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00460">kill_accepted()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00684">rm_connection_index()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00455">send_data()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00580">send_disconnect_request()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00496">set_tcp_connection_number()</a>.</p>

</div>
</div>
<a class="anchor" id="a41d07eb7b13b1998b771080dfaef6b7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_RESERVED_PORTS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00049">49</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00579">handle_TCP_routing_req()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00560">send_connect_notification()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00455">send_data()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00570">send_disconnect_notification()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00580">send_disconnect_request()</a>.</p>

</div>
</div>
<a class="anchor" id="aa5f4778a5c176dbd24018f61cc7524f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_CLIENT_HANDSHAKE_SIZE&#160;&#160;&#160;(crypto_box_PUBLICKEYBYTES + <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a88a61b02e465cd8c05fbae1def1066f2">TCP_SERVER_HANDSHAKE_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00046">46</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00483">handle_TCP_handshake()</a>, <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00133">new_TCP_con()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00530">read_connection_handshake()</a>, and <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00030">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b820bd1123c0fbdfd8391cce314b35b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_HANDSHAKE_PLAIN_SIZE&#160;&#160;&#160;(crypto_box_PUBLICKEYBYTES + crypto_box_NONCEBYTES)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00044">44</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00483">handle_TCP_handshake()</a>, <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00133">new_TCP_con()</a>, and <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00030">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="ae2850071db896a7e93afd4acc1bfd69b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_MAX_BACKLOG&#160;&#160;&#160;<a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a2c62883bf7895f3582975a14ec316bef">MAX_INCOMMING_CONNECTIONS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00040">40</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00914">new_listening_TCP_socket()</a>.</p>

</div>
</div>
<a class="anchor" id="a9f050748925b02db21564fa5f6c78e4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_MAX_OOB_DATA_LENGTH&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00047">47</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00657">handle_TCP_oob_send()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00476">send_oob_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="ae03ebbe7438d78a242e6970f35eb6dfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_CONNECTION_NOTIFICATION&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00054">54</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00560">send_connect_notification()</a>.</p>

</div>
</div>
<a class="anchor" id="a65b6df680eaecb9563dfcc8c5fcfba3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_DISCONNECT_NOTIFICATION&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00055">55</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00526">send_disconnect_notification()</a>.</p>

</div>
</div>
<a class="anchor" id="a879315f1b7234dad07a45d63a6d0aed5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_ONION_REQUEST&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00060">60</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00740">handle_TCP_packet()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00594">send_onion_request()</a>.</p>

</div>
</div>
<a class="anchor" id="acbe72759c701ff843abf6a80dafee7e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_ONION_RESPONSE&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00061">61</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00714">handle_onion_recv_1()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d824009f914ddf664d60adf6695189c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_OOB_RECV&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00059">59</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00657">handle_TCP_oob_send()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a5961d2c3587485c79194c5479a8b0973"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_OOB_SEND&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00058">58</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00740">handle_TCP_packet()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00476">send_oob_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="aa1328be3bbb33d8e47490408376c3553"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_PING&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00056">56</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01128">do_TCP_confirmed()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00538">send_ping_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a783819134f7296fb82cfc3149f6fbb62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_PONG&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00057">57</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00559">send_ping_response()</a>.</p>

</div>
</div>
<a class="anchor" id="a808af5b9484311a39abb96dac1ecd426"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_ROUTING_REQUEST&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00052">52</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00740">handle_TCP_packet()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00426">send_routing_request()</a>.</p>

</div>
</div>
<a class="anchor" id="ad288b46b857552d69e64135b3a329d83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PACKET_ROUTING_RESPONSE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00053">53</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00695">handle_TCP_packet()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00546">send_routing_response()</a>.</p>

</div>
</div>
<a class="anchor" id="a779366bdff0863c4e36c9313b25fcb29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PING_FREQUENCY&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00066">66</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00827">do_confirmed_TCP()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01128">do_TCP_confirmed()</a>.</p>

</div>
</div>
<a class="anchor" id="a09b714899296b82866bab0a4d294c917"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_PING_TIMEOUT&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00067">67</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00827">do_confirmed_TCP()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01128">do_TCP_confirmed()</a>.</p>

</div>
</div>
<a class="anchor" id="a88a61b02e465cd8c05fbae1def1066f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TCP_SERVER_HANDSHAKE_SIZE&#160;&#160;&#160;(crypto_box_NONCEBYTES + <a class="el" href="../../d6/d03/_t_c_p__server_8h.html#a9b820bd1123c0fbdfd8391cce314b35b">TCP_HANDSHAKE_PLAIN_SIZE</a> + crypto_box_MACBYTES)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00045">45</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00870">do_TCP_connection()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00243">handle_handshake()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00483">handle_TCP_handshake()</a>, <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00133">new_TCP_con()</a>, and <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00030">START_TEST()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a5750799a61dd1a6dc6930e5aa25ce653"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../df/d8f/struct_t_c_p___priority___list.html">TCP_Priority_List</a> <a class="el" href="../../df/d8f/struct_t_c_p___priority___list.html">TCP_Priority_List</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00083">83</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa22e20d6aa67ad907ef4ae8334e5091b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d2/dbf/struct_t_c_p___secure___connection.html">TCP_Secure_Connection</a>  <a class="el" href="../../d2/dbf/struct_t_c_p___secure___connection.html">TCP_Secure_Connection</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a5d76b81b0ad4c19007a781d4edb8181f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a5d76b81b0ad4c19007a781d4edb8181fa20692881561141ef7621446ae15f78bc"></a>TCP_STATUS_NO_STATUS&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a5d76b81b0ad4c19007a781d4edb8181fab5e948cd81931f0c7e6a827e90c24616"></a>TCP_STATUS_CONNECTED&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a5d76b81b0ad4c19007a781d4edb8181fa17e64dcb5cb3bb08704b328ff40c8138"></a>TCP_STATUS_UNCONFIRMED&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a5d76b81b0ad4c19007a781d4edb8181fa42e6e74e5c62734eb1386045e159a601"></a>TCP_STATUS_CONFIRMED&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00076">76</a> of file <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html">TCP_server.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;     {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa20692881561141ef7621446ae15f78bc">TCP_STATUS_NO_STATUS</a>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fab5e948cd81931f0c7e6a827e90c24616">TCP_STATUS_CONNECTED</a>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa17e64dcb5cb3bb08704b328ff40c8138">TCP_STATUS_UNCONFIRMED</a>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa42e6e74e5c62734eb1386045e159a601">TCP_STATUS_CONFIRMED</a>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;};</div>
<div class="ttc" id="_t_c_p__server_8h_html_a5d76b81b0ad4c19007a781d4edb8181fa20692881561141ef7621446ae15f78bc"><div class="ttname"><a href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa20692881561141ef7621446ae15f78bc">TCP_STATUS_NO_STATUS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00077">TCP_server.h:77</a></div></div>
<div class="ttc" id="_t_c_p__server_8h_html_a5d76b81b0ad4c19007a781d4edb8181fa42e6e74e5c62734eb1386045e159a601"><div class="ttname"><a href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa42e6e74e5c62734eb1386045e159a601">TCP_STATUS_CONFIRMED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00080">TCP_server.h:80</a></div></div>
<div class="ttc" id="_t_c_p__server_8h_html_a5d76b81b0ad4c19007a781d4edb8181fab5e948cd81931f0c7e6a827e90c24616"><div class="ttname"><a href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fab5e948cd81931f0c7e6a827e90c24616">TCP_STATUS_CONNECTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00078">TCP_server.h:78</a></div></div>
<div class="ttc" id="_t_c_p__server_8h_html_a5d76b81b0ad4c19007a781d4edb8181fa17e64dcb5cb3bb08704b328ff40c8138"><div class="ttname"><a href="../../d6/d03/_t_c_p__server_8h.html#a5d76b81b0ad4c19007a781d4edb8181fa17e64dcb5cb3bb08704b328ff40c8138">TCP_STATUS_UNCONFIRMED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00079">TCP_server.h:79</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a40e8a0302a359dd4f712eb1e9c346fe5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void do_TCP_server </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a> *&#160;</td>
          <td class="paramname"><em>TCP_server</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01305">1305</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>References <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01026">do_TCP_accept_new()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01128">do_TCP_confirmed()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01110">do_TCP_incomming()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01119">do_TCP_unconfirmed()</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02280">do_messenger()</a>, <a class="el" href="../../d1/d36/tox-bootstrapd_8c_source.html#l00519">main()</a>, <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00133">new_TCP_con()</a>, and <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00030">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;{</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="preprocessor">#ifdef TCP_SERVER_USE_EPOLL</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    do_TCP_epoll(TCP_server);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#a8bcfa0b79de4e0fad8720af7d1ed1d70">do_TCP_accept_new</a>(TCP_server);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#affc332b8c3280bd44fa933413d678796">do_TCP_incomming</a>(TCP_server);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a">do_TCP_unconfirmed</a>(TCP_server);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0">do_TCP_confirmed</a>(TCP_server);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div>
<div class="ttc" id="_t_c_p__server_8c_html_aed90b296bcb98bcb905565ae68548c9a"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a">do_TCP_unconfirmed</a></div><div class="ttdeci">static void do_TCP_unconfirmed(TCP_Server *TCP_server)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l01119">TCP_server.c:1119</a></div></div>
<div class="ttc" id="_t_c_p__server_8c_html_a8bcfa0b79de4e0fad8720af7d1ed1d70"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#a8bcfa0b79de4e0fad8720af7d1ed1d70">do_TCP_accept_new</a></div><div class="ttdeci">static void do_TCP_accept_new(TCP_Server *TCP_server)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l01026">TCP_server.c:1026</a></div></div>
<div class="ttc" id="_t_c_p__server_8c_html_affc332b8c3280bd44fa933413d678796"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#affc332b8c3280bd44fa933413d678796">do_TCP_incomming</a></div><div class="ttdeci">static void do_TCP_incomming(TCP_Server *TCP_server)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l01110">TCP_server.c:1110</a></div></div>
<div class="ttc" id="_t_c_p__server_8c_html_a001f38d27860442b6fe9fe7dd030a7a0"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0">do_TCP_confirmed</a></div><div class="ttdeci">static void do_TCP_confirmed(TCP_Server *TCP_server)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l01128">TCP_server.c:1128</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_cgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_cgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_cgraph" id="d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_cgraph">
<area shape="rect" id="node2" href="../../d4/d40/_t_c_p__server_8c.html#a8bcfa0b79de4e0fad8720af7d1ed1d70" title="do_TCP_accept_new" alt="" coords="167,157,314,184"/><area shape="rect" id="node9" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="589,899,724,925"/><area shape="rect" id="node41" href="../../d4/d40/_t_c_p__server_8c.html#affc332b8c3280bd44fa933413d678796" title="do_TCP_incomming" alt="" coords="171,309,311,336"/><area shape="rect" id="node45" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="167,259,315,285"/><area shape="rect" id="node49" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="179,411,303,437"/><area shape="rect" id="node3" href="../../d4/d40/_t_c_p__server_8c.html#ad3971e4c18ffe30a530ef41da1008bf7" title="accept_connection" alt="" coords="591,107,722,133"/><area shape="rect" id="node4" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="1266,251,1339,277"/><area shape="rect" id="node5" href="../../d4/d40/_t_c_p__server_8c.html#a51bace7dc1f6b7e7049430de070f3864" title="kill_TCP_connection" alt="" coords="792,259,935,285"/><area shape="rect" id="node6" href="../../d6/d6e/network_8c.html#a6a50bb1345f2d5192fe1ec23ac7a1da9" title="set_socket_nonblock" alt="" coords="791,56,936,83"/><area shape="rect" id="node7" href="../../d6/d6e/network_8c.html#a379153c027c17d7c71797cb0e3ea41a3" title="set_socket_nosigpipe" alt="" coords="789,107,937,133"/><area shape="rect" id="node8" href="../../d6/d6e/network_8c.html#a84c3240a3325cbdaaa8a206c96980cd1" title="sock_valid" alt="" coords="821,5,905,32"/><area shape="rect" id="node10" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="797,576,929,603"/><area shape="rect" id="node14" href="../../d4/d40/_t_c_p__server_8c.html#a1b2fd7984b9d3eb39bf588fc9bc5e21f" title="write_packet_TCP_secure\l_connection" alt="" coords="1672,470,1848,511"/><area shape="rect" id="node18" href="../../d4/d40/_t_c_p__server_8c.html#a80fa82b117432f080f39f481ab5d9fef" title="send_pending_data" alt="" coords="1911,801,2046,828"/><area shape="rect" id="node30" href="../../d4/d40/_t_c_p__server_8c.html#a2f45b38fbf8f1646a682172973fd7a25" title="kill_accepted" alt="" coords="1029,696,1128,723"/><area shape="rect" id="node38" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="822,924,905,951"/><area shape="rect" id="node39" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1039,925,1118,952"/><area shape="rect" id="node40" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="817,975,910,1001"/><area shape="rect" id="node11" href="../../d4/d40/_t_c_p__server_8c.html#a904af6fcbd24cb3f75c4a04470be46de" title="handle_TCP_packet" alt="" coords="1009,523,1149,549"/><area shape="rect" id="node34" href="../../d4/d40/_t_c_p__server_8c.html#a2acbecbd76fe539293b5d92d0e0b6c5e" title="read_packet_TCP_secure\l_connection" alt="" coords="992,142,1165,183"/><area shape="rect" id="node12" href="../../d4/d40/_t_c_p__server_8c.html#a7631710481101de4b345f7e318fdb88a" title="handle_TCP_oob_send" alt="" coords="1224,411,1381,437"/><area shape="rect" id="node20" href="../../d4/d40/_t_c_p__server_8c.html#af925f101a4e90d1fa2381536ef23a794" title="handle_TCP_routing_req" alt="" coords="1220,465,1385,492"/><area shape="rect" id="node23" href="../../d4/d18/onion_8c.html#a112ff3dd6d8a1e104516eb4b465fc2fa" title="onion_send_1" alt="" coords="1251,521,1354,548"/><area shape="rect" id="node28" href="../../d4/d40/_t_c_p__server_8c.html#a537d1f47612f3dbb19a92e557b062c20" title="rm_connection_index" alt="" coords="1230,723,1375,749"/><area shape="rect" id="node13" href="../../d4/d40/_t_c_p__server_8c.html#a11f81fcb9060389c52d55b079e1b8f3b" title="get_TCP_connection\l_index" alt="" coords="1457,201,1601,242"/><area shape="rect" id="node15" href="../../d4/d40/_t_c_p__server_8c.html#ac9f38bf2eaf3cd2603c380091ae6ebad" title="add_priority" alt="" coords="1934,477,2023,504"/><area shape="rect" id="node16" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1896,419,2061,445"/><area shape="rect" id="node17" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="1918,208,2039,235"/><area shape="rect" id="node19" href="../../d4/d40/_t_c_p__server_8c.html#a127449a3fca8398acf0ba361be8c5c83" title="send_pending_data_nonpriority" alt="" coords="2109,801,2311,828"/><area shape="rect" id="node21" href="../../d4/d40/_t_c_p__server_8c.html#aebc23608e1cc6d5fc35210e9c28e8960" title="send_connect_notification" alt="" coords="1442,469,1615,496"/><area shape="rect" id="node22" href="../../d4/d40/_t_c_p__server_8c.html#a378a47bb3e63730aa104d8da7d10f384" title="send_routing_response" alt="" coords="1451,368,1607,395"/><area shape="rect" id="node24" href="../../d4/d18/onion_8c.html#ae9d8dde9317c06fe493658b8145de853" title="ipport_pack" alt="" coords="1484,571,1573,597"/><area shape="rect" id="node25" href="../../d4/d18/onion_8c.html#a5134cc15375a918b584e3c408e038331" title="ipport_unpack" alt="" coords="1477,621,1580,648"/><area shape="rect" id="node26" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="1485,267,1573,293"/><area shape="rect" id="node27" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="1484,520,1573,547"/><area shape="rect" id="node29" href="../../d4/d40/_t_c_p__server_8c.html#aad6cd0a2a98d4da60235be8000f2c66f" title="send_disconnect_notification" alt="" coords="1433,723,1624,749"/><area shape="rect" id="node31" href="../../d4/d40/_t_c_p__server_8c.html#a8fbde82c141c5368acc8ea8e8ad58fd2" title="del_accepted" alt="" coords="1253,773,1352,800"/><area shape="rect" id="node32" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f" title="bs_list_remove" alt="" coords="1473,773,1584,800"/><area shape="rect" id="node33" href="../../d4/d40/_t_c_p__server_8c.html#abdfaa164f396557d6499a8e5e3145b49" title="realloc_connection" alt="" coords="1463,824,1594,851"/><area shape="rect" id="node35" href="../../dc/d85/crypto__core_8c.html#a824b257fcff74b9d17c5247223fbed29" title="decrypt_data_symmetric" alt="" coords="1446,99,1611,125"/><area shape="rect" id="node36" href="../../d4/d40/_t_c_p__server_8c.html#a984a0b6fc27b03e09170579ec9494093" title="read_TCP_length" alt="" coords="1241,149,1364,176"/><area shape="rect" id="node37" href="../../d4/d40/_t_c_p__server_8c.html#a88eda37b476d8dcfdba94899e740dd9e" title="read_TCP_packet" alt="" coords="1239,200,1366,227"/><area shape="rect" id="node42" href="../../d4/d40/_t_c_p__server_8c.html#a02fab0695a22b7f75c83439b2b6937ca" title="do_incoming" alt="" coords="609,309,704,336"/><area shape="rect" id="node43" href="../../d4/d40/_t_c_p__server_8c.html#ab6e95a3eda0dace913cf12bf3e6088ff" title="read_connection_handshake" alt="" coords="985,309,1172,336"/><area shape="rect" id="node44" href="../../d4/d40/_t_c_p__server_8c.html#ad83c5da554cb68b07d7bef24c99c8ad8" title="handle_TCP_handshake" alt="" coords="1221,301,1385,328"/><area shape="rect" id="node46" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="386,259,501,285"/><area shape="rect" id="node47" href="../../d4/d40/_t_c_p__server_8c.html#a00813f259948ef060f6ab7ec40da2f2c" title="confirm_TCP_connection" alt="" coords="572,523,741,549"/><area shape="rect" id="node48" href="../../d4/d40/_t_c_p__server_8c.html#a1ae92403cba7d9cf7248d594f15b0d62" title="add_accepted" alt="" coords="812,696,915,723"/><area shape="rect" id="node50" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="363,411,524,437"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_icgraph" id="d6/d03/_t_c_p__server_8h_a40e8a0302a359dd4f712eb1e9c346fe5_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="167,56,274,83"/><area shape="rect" id="node10" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="195,107,246,133"/><area shape="rect" id="node11" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="167,157,275,184"/><area shape="rect" id="node13" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="167,208,274,235"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="351,31,401,57"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="335,81,417,108"/><area shape="rect" id="node5" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="477,5,584,32"/><area shape="rect" id="node6" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="505,56,557,83"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="505,107,556,133"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="494,157,567,184"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="632,157,683,184"/><area shape="rect" id="node12" href="../../d2/d8d/_t_c_p__test_8c.html#a0ee98d716eb7311dd4b6d217289734ff" title="START_TEST" alt="" coords="323,157,429,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af6df6382ad309456dcf5b7b350313714"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kill_TCP_server </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a> *&#160;</td>
          <td class="paramname"><em>TCP_server</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01321">1321</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>References <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00135">TCP_Server::accepted_connection_array</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00141">TCP_Server::accepted_key_list</a>, <a class="el" href="../../d7/d40/list_8c_source.html#l00158">bs_list_free()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00136">kill_sock()</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00126">TCP_Server::num_listening_socks</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00119">TCP_Server::onion</a>, <a class="el" href="../../d4/d18/onion_8c_source.html#l00576">set_callback_handle_recv_1()</a>, and <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00125">TCP_Server::socks_listening</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01848">kill_messenger()</a>, and <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00030">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;{</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a5efc50bc21a4b488b17bb593b2758718">num_listening_socks</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e">kill_sock</a>(TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a>[i]);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keywordflow">if</span> (TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a66fb4bf67c711a5ed3e7bbecec7fde30">onion</a>) {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <a class="code" href="../../d4/d18/onion_8c.html#ae1b8e562e22bd28deca3f98dace1a421">set_callback_handle_recv_1</a>(TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a66fb4bf67c711a5ed3e7bbecec7fde30">onion</a>, NULL, NULL);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <a class="code" href="../../d7/d40/list_8c.html#a20f4503183113923cd946fc04bf8f2b4">bs_list_free</a>(&amp;TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#ae01209a4897757539a5ff199cdcfb64c">accepted_key_list</a>);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="preprocessor">#ifdef TCP_SERVER_USE_EPOLL</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    close(TCP_server-&gt;efd);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    free(TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a>);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    free(TCP_server-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#aaec24f8b80a7853d1b7da87e903c44ee">accepted_connection_array</a>);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    free(TCP_server);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;}</div>
<div class="ttc" id="struct_t_c_p___server_html_aaec24f8b80a7853d1b7da87e903c44ee"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#aaec24f8b80a7853d1b7da87e903c44ee">TCP_Server::accepted_connection_array</a></div><div class="ttdeci">TCP_Secure_Connection * accepted_connection_array</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00135">TCP_server.h:135</a></div></div>
<div class="ttc" id="list_8c_html_a20f4503183113923cd946fc04bf8f2b4"><div class="ttname"><a href="../../d7/d40/list_8c.html#a20f4503183113923cd946fc04bf8f2b4">bs_list_free</a></div><div class="ttdeci">void bs_list_free(BS_LIST *list)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00158">list.c:158</a></div></div>
<div class="ttc" id="network_8c_html_a512d8ea12392ba9ddfadd83bb7c92b2e"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e">kill_sock</a></div><div class="ttdeci">void kill_sock(sock_t sock)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00136">network.c:136</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a120d7e1abddb3a838bc0d0442f4ad8e6"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">TCP_Server::socks_listening</a></div><div class="ttdeci">sock_t * socks_listening</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00125">TCP_server.h:125</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a5efc50bc21a4b488b17bb593b2758718"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a5efc50bc21a4b488b17bb593b2758718">TCP_Server::num_listening_socks</a></div><div class="ttdeci">unsigned int num_listening_socks</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00126">TCP_server.h:126</a></div></div>
<div class="ttc" id="onion_8c_html_ae1b8e562e22bd28deca3f98dace1a421"><div class="ttname"><a href="../../d4/d18/onion_8c.html#ae1b8e562e22bd28deca3f98dace1a421">set_callback_handle_recv_1</a></div><div class="ttdeci">void set_callback_handle_recv_1(Onion *onion, int(*function)(void *, IP_Port, const uint8_t *, uint16_t), void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d18/onion_8c_source.html#l00576">onion.c:576</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_ae01209a4897757539a5ff199cdcfb64c"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#ae01209a4897757539a5ff199cdcfb64c">TCP_Server::accepted_key_list</a></div><div class="ttdeci">BS_LIST accepted_key_list</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00141">TCP_server.h:141</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a66fb4bf67c711a5ed3e7bbecec7fde30"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a66fb4bf67c711a5ed3e7bbecec7fde30">TCP_Server::onion</a></div><div class="ttdeci">Onion * onion</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00119">TCP_server.h:119</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_cgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_cgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_cgraph" id="d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_cgraph">
<area shape="rect" id="node2" href="../../d7/d40/list_8c.html#a20f4503183113923cd946fc04bf8f2b4" title="bs_list_free" alt="" coords="193,5,283,32"/><area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="201,56,275,83"/><area shape="rect" id="node4" href="../../d4/d18/onion_8c.html#ae1b8e562e22bd28deca3f98dace1a421" title="set_callback_handle\l_recv_1" alt="" coords="168,107,308,149"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_icgraph" id="d6/d03/_t_c_p__server_8h_af6df6382ad309456dcf5b7b350313714_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#a771c65c3057d870b0653c2fdf0a12fb7" title="kill_messenger" alt="" coords="168,56,277,83"/><area shape="rect" id="node12" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="169,107,276,133"/><area shape="rect" id="node3" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="335,5,386,32"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#a52259e134bfb9396d9fef4fffe94e878" title="tox_kill" alt="" coords="329,56,392,83"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="325,107,396,133"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="444,31,551,57"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="465,81,529,108"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="458,132,537,159"/><area shape="rect" id="node11" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="472,183,523,209"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="599,81,649,108"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="599,132,649,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a148e632f4c51645cbc1b414bc3584b60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a>* new_TCP_server </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ipv6_enabled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>num_sockets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t *&#160;</td>
          <td class="paramname"><em>ports</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>secret_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d01/struct_onion.html">Onion</a> *&#160;</td>
          <td class="paramname"><em>onion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00942">942</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>References <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00141">TCP_Server::accepted_key_list</a>, <a class="el" href="../../d7/d40/list_8c_source.html#l00138">bs_list_init()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00714">handle_onion_recv_1()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00444">networking_at_startup()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00914">new_listening_TCP_socket()</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00126">TCP_Server::num_listening_socks</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00119">TCP_Server::onion</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00128">TCP_Server::public_key</a>, <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00129">TCP_Server::secret_key</a>, <a class="el" href="../../d4/d18/onion_8c_source.html#l00576">set_callback_handle_recv_1()</a>, <a class="el" href="../../db/d11/irc__syncbot_8c_source.html#l00035">sock</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00119">sock_valid()</a>, and <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00125">TCP_Server::socks_listening</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d36/tox-bootstrapd_8c_source.html#l00519">main()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01751">new_messenger()</a>, and <a class="el" href="../../d2/d8d/_t_c_p__test_8c_source.html#l00030">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;{</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">if</span> (num_sockets == 0 || <a class="code" href="../../d2/d8d/_t_c_p__test_8c.html#a04e5444bf6a826487066ba973577f674">ports</a> == NULL)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#ad953dedd6d25d03cf441960dd1e1fed1">networking_at_startup</a>() != 0) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a> *temp = calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a>));</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span> (temp == NULL)</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a> = calloc(num_sockets, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a>));</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a> == NULL) {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        free(temp);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="preprocessor">#ifdef TCP_SERVER_USE_EPOLL</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    temp-&gt;efd = epoll_create(8);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (temp-&gt;efd == -1) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        free(temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        free(temp);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    uint8_t family;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span> (ipv6_enabled) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        family = AF_INET6;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        family = AF_INET;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#ifdef TCP_SERVER_USE_EPOLL</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keyword">struct </span>epoll_event ev;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; num_sockets; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <a class="code" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a> <a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a> = <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#aa6d558b4e988007697894aff27271927">new_listening_TCP_socket</a>(family, <a class="code" href="../../d2/d8d/_t_c_p__test_8c.html#a04e5444bf6a826487066ba973577f674">ports</a>[i]);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#a84c3240a3325cbdaaa8a206c96980cd1">sock_valid</a>(sock)) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="preprocessor">#ifdef TCP_SERVER_USE_EPOLL</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            ev.events = EPOLLIN | EPOLLET;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            ev.data.u64 = sock | ((uint64_t)TCP_SOCKET_LISTENING &lt;&lt; 32);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="keywordflow">if</span> (epoll_ctl(temp-&gt;efd, EPOLL_CTL_ADD, sock, &amp;ev) == -1) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a>[temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a5efc50bc21a4b488b17bb593b2758718">num_listening_socks</a>] = <a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            ++temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a5efc50bc21a4b488b17bb593b2758718">num_listening_socks</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">if</span> (temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a5efc50bc21a4b488b17bb593b2758718">num_listening_socks</a> == 0) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        free(temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">socks_listening</a>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        free(temp);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">if</span> (onion) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a66fb4bf67c711a5ed3e7bbecec7fde30">onion</a> = onion;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="../../d4/d18/onion_8c.html#ae1b8e562e22bd28deca3f98dace1a421">set_callback_handle_recv_1</a>(onion, &amp;<a class="code" href="../../d4/d40/_t_c_p__server_8c.html#aaee6d8849ed25c44203b345808d79bed">handle_onion_recv_1</a>, temp);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    memcpy(temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a41928223d6ad8bd41837f371deef62ae">secret_key</a>, secret_key, crypto_box_SECRETKEYBYTES);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    crypto_scalarmult_curve25519_base(temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#a41928223d6ad8bd41837f371deef62ae">secret_key</a>);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="../../d7/d40/list_8c.html#a7b07772cffb6af34e279f424dca08895">bs_list_init</a>(&amp;temp-&gt;<a class="code" href="../../d1/dd1/struct_t_c_p___server.html#ae01209a4897757539a5ff199cdcfb64c">accepted_key_list</a>, crypto_box_PUBLICKEYBYTES, 8);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">return</span> temp;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div>
<div class="ttc" id="irc__syncbot_8c_html_a5903d0b282fc5eae503de618f896b5e1"><div class="ttname"><a href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a></div><div class="ttdeci">int sock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/irc__syncbot_8c_source.html#l00035">irc_syncbot.c:35</a></div></div>
<div class="ttc" id="list_8c_html_a7b07772cffb6af34e279f424dca08895"><div class="ttname"><a href="../../d7/d40/list_8c.html#a7b07772cffb6af34e279f424dca08895">bs_list_init</a></div><div class="ttdeci">int bs_list_init(BS_LIST *list, uint32_t element_size, uint32_t initial_capacity)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00138">list.c:138</a></div></div>
<div class="ttc" id="_t_c_p__server_8c_html_aa6d558b4e988007697894aff27271927"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#aa6d558b4e988007697894aff27271927">new_listening_TCP_socket</a></div><div class="ttdeci">static sock_t new_listening_TCP_socket(int family, uint16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l00914">TCP_server.c:914</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a120d7e1abddb3a838bc0d0442f4ad8e6"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a120d7e1abddb3a838bc0d0442f4ad8e6">TCP_Server::socks_listening</a></div><div class="ttdeci">sock_t * socks_listening</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00125">TCP_server.h:125</a></div></div>
<div class="ttc" id="_t_c_p__server_8c_html_aaee6d8849ed25c44203b345808d79bed"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#aaee6d8849ed25c44203b345808d79bed">handle_onion_recv_1</a></div><div class="ttdeci">static int handle_onion_recv_1(void *object, IP_Port dest, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l00714">TCP_server.c:714</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#aaa806bb1136fb3d4b5d8d8970b596ff7">TCP_Server::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00128">TCP_server.h:128</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a41928223d6ad8bd41837f371deef62ae"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a41928223d6ad8bd41837f371deef62ae">TCP_Server::secret_key</a></div><div class="ttdeci">uint8_t secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00129">TCP_server.h:129</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a5efc50bc21a4b488b17bb593b2758718"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a5efc50bc21a4b488b17bb593b2758718">TCP_Server::num_listening_socks</a></div><div class="ttdeci">unsigned int num_listening_socks</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00126">TCP_server.h:126</a></div></div>
<div class="ttc" id="_t_c_p__test_8c_html_a04e5444bf6a826487066ba973577f674"><div class="ttname"><a href="../../d2/d8d/_t_c_p__test_8c.html#a04e5444bf6a826487066ba973577f674">ports</a></div><div class="ttdeci">uint16_t ports[NUM_PORTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d8d/_t_c_p__test_8c_source.html#l00028">TCP_test.c:28</a></div></div>
<div class="ttc" id="network_8h_html_ae5faf8a8d23da59c3e3025a62039d8c1"><div class="ttname"><a href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a></div><div class="ttdeci">int sock_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00071">network.h:71</a></div></div>
<div class="ttc" id="network_8c_html_a84c3240a3325cbdaaa8a206c96980cd1"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a84c3240a3325cbdaaa8a206c96980cd1">sock_valid</a></div><div class="ttdeci">int sock_valid(sock_t sock)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00119">network.c:119</a></div></div>
<div class="ttc" id="network_8c_html_ad953dedd6d25d03cf441960dd1e1fed1"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ad953dedd6d25d03cf441960dd1e1fed1">networking_at_startup</a></div><div class="ttdeci">int networking_at_startup(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00444">network.c:444</a></div></div>
<div class="ttc" id="onion_8c_html_ae1b8e562e22bd28deca3f98dace1a421"><div class="ttname"><a href="../../d4/d18/onion_8c.html#ae1b8e562e22bd28deca3f98dace1a421">set_callback_handle_recv_1</a></div><div class="ttdeci">void set_callback_handle_recv_1(Onion *onion, int(*function)(void *, IP_Port, const uint8_t *, uint16_t), void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d18/onion_8c_source.html#l00576">onion.c:576</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_ae01209a4897757539a5ff199cdcfb64c"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#ae01209a4897757539a5ff199cdcfb64c">TCP_Server::accepted_key_list</a></div><div class="ttdeci">BS_LIST accepted_key_list</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00141">TCP_server.h:141</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html">TCP_Server</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00118">TCP_server.h:118</a></div></div>
<div class="ttc" id="struct_t_c_p___server_html_a66fb4bf67c711a5ed3e7bbecec7fde30"><div class="ttname"><a href="../../d1/dd1/struct_t_c_p___server.html#a66fb4bf67c711a5ed3e7bbecec7fde30">TCP_Server::onion</a></div><div class="ttdeci">Onion * onion</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00119">TCP_server.h:119</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_cgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_cgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_cgraph" id="d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_cgraph">
<area shape="rect" id="node2" href="../../d7/d40/list_8c.html#a7b07772cffb6af34e279f424dca08895" title="bs_list_init" alt="" coords="225,31,309,57"/><area shape="rect" id="node4" href="../../d4/d40/_t_c_p__server_8c.html#aaee6d8849ed25c44203b345808d79bed" title="handle_onion_recv_1" alt="" coords="195,85,339,112"/><area shape="rect" id="node11" href="../../d6/d6e/network_8c.html#ad953dedd6d25d03cf441960dd1e1fed1" title="networking_at_startup" alt="" coords="191,165,342,192"/><area shape="rect" id="node13" href="../../d4/d40/_t_c_p__server_8c.html#aa6d558b4e988007697894aff27271927" title="new_listening_TCP_socket" alt="" coords="176,267,357,293"/><area shape="rect" id="node19" href="../../d6/d6e/network_8c.html#a84c3240a3325cbdaaa8a206c96980cd1" title="sock_valid" alt="" coords="451,444,535,471"/><area shape="rect" id="node20" href="../../d4/d18/onion_8c.html#ae1b8e562e22bd28deca3f98dace1a421" title="set_callback_handle\l_recv_1" alt="" coords="197,369,337,410"/><area shape="rect" id="node3" href="../../d7/d40/list_8c.html#a7c246868ee5a3542509cdf90379c5bb2" title="resize" alt="" coords="465,23,522,49"/><area shape="rect" id="node5" href="../../d4/d40/_t_c_p__server_8c.html#a1b2fd7984b9d3eb39bf588fc9bc5e21f" title="write_packet_TCP_secure\l_connection" alt="" coords="405,74,581,115"/><area shape="rect" id="node6" href="../../d4/d40/_t_c_p__server_8c.html#ac9f38bf2eaf3cd2603c380091ae6ebad" title="add_priority" alt="" coords="667,5,757,32"/><area shape="rect" id="node7" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="629,56,795,83"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="651,107,773,133"/><area shape="rect" id="node9" href="../../d4/d40/_t_c_p__server_8c.html#a80fa82b117432f080f39f481ab5d9fef" title="send_pending_data" alt="" coords="645,157,779,184"/><area shape="rect" id="node10" href="../../d4/d40/_t_c_p__server_8c.html#a127449a3fca8398acf0ba361be8c5c83" title="send_pending_data_nonpriority" alt="" coords="843,157,1044,184"/><area shape="rect" id="node12" href="../../d6/d6e/network_8c.html#a9f5cd2a713e4a17d4c6d36650336cab0" title="current_time_actual" alt="" coords="425,140,561,167"/><area shape="rect" id="node14" href="../../d4/d40/_t_c_p__server_8c.html#a944f17c26a170be923cc64f9921e001b" title="bind_to_port" alt="" coords="447,191,540,217"/><area shape="rect" id="node15" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="457,241,530,268"/><area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#ad2f109728a6345e6862686ea4baf5b27" title="set_socket_dualstack" alt="" coords="419,292,568,319"/><area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#a6a50bb1345f2d5192fe1ec23ac7a1da9" title="set_socket_nonblock" alt="" coords="421,343,566,369"/><area shape="rect" id="node18" href="../../d6/d6e/network_8c.html#ac278c3d25e3807f0b2be9d91c9db328f" title="set_socket_reuseaddr" alt="" coords="418,393,569,420"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_icgraph" id="d6/d03/_t_c_p__server_8h_a148e632f4c51645cbc1b414bc3584b60_icgraph">
<area shape="rect" id="node2" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="209,5,260,32"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="176,56,293,83"/><area shape="rect" id="node12" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="181,107,288,133"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="351,31,402,57"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="341,81,412,108"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="460,5,567,32"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="481,56,545,83"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="474,107,553,133"/><area shape="rect" id="node11" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="488,157,539,184"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="615,56,665,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="615,107,665,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2acbecbd76fe539293b5d92d0e0b6c5e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_packet_TCP_secure_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a>&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>next_packet_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>shared_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>recv_nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>max_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00256">256</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>References <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00104">decrypt_data_symmetric()</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00141">increment_nonce()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00204">read_TCP_length()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00234">read_TCP_packet()</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01089">do_confirmed_recv()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00827">do_confirmed_TCP()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l01068">do_unconfirmed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (*next_packet_length == 0) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        uint16_t len = <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#a984a0b6fc27b03e09170579ec9494093">read_TCP_length</a>(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span> (len == (uint16_t)~0)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (len == 0)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        *next_packet_length = len;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (max_len + crypto_box_MACBYTES &lt; *next_packet_length)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    uint8_t data_encrypted[*next_packet_length];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">int</span> len_packet = <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#a88eda37b476d8dcfdba94899e740dd9e">read_TCP_packet</a>(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, data_encrypted, *next_packet_length);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (len_packet != *next_packet_length)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    *next_packet_length = 0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span> len = <a class="code" href="../../dc/d85/crypto__core_8c.html#a824b257fcff74b9d17c5247223fbed29">decrypt_data_symmetric</a>(shared_key, recv_nonce, data_encrypted, len_packet, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (len + crypto_box_MACBYTES != len_packet)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980">increment_nonce</a>(recv_nonce);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="ttc" id="_t_c_p__server_8c_html_a88eda37b476d8dcfdba94899e740dd9e"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#a88eda37b476d8dcfdba94899e740dd9e">read_TCP_packet</a></div><div class="ttdeci">int read_TCP_packet(sock_t sock, uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l00234">TCP_server.c:234</a></div></div>
<div class="ttc" id="_t_c_p__server_8c_html_a984a0b6fc27b03e09170579ec9494093"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#a984a0b6fc27b03e09170579ec9494093">read_TCP_length</a></div><div class="ttdeci">uint16_t read_TCP_length(sock_t sock)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l00204">TCP_server.c:204</a></div></div>
<div class="ttc" id="irc__syncbot_8c_html_a5903d0b282fc5eae503de618f896b5e1"><div class="ttname"><a href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a></div><div class="ttdeci">int sock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/irc__syncbot_8c_source.html#l00035">irc_syncbot.c:35</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="crypto__core_8c_html_ab953f1e92b8a9a193f69f02323b9c980"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980">increment_nonce</a></div><div class="ttdeci">void increment_nonce(uint8_t *nonce)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00141">crypto_core.c:141</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a824b257fcff74b9d17c5247223fbed29"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a824b257fcff74b9d17c5247223fbed29">decrypt_data_symmetric</a></div><div class="ttdeci">int decrypt_data_symmetric(const uint8_t *secret_key, const uint8_t *nonce, const uint8_t *encrypted, uint32_t length, uint8_t *plain)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00104">crypto_core.c:104</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_cgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_cgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_cgraph" id="d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_cgraph">
<area shape="rect" id="node2" href="../../dc/d85/crypto__core_8c.html#a824b257fcff74b9d17c5247223fbed29" title="decrypt_data_symmetric" alt="" coords="227,5,392,32"/><area shape="rect" id="node3" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="249,56,370,83"/><area shape="rect" id="node4" href="../../d4/d40/_t_c_p__server_8c.html#a984a0b6fc27b03e09170579ec9494093" title="read_TCP_length" alt="" coords="248,107,371,133"/><area shape="rect" id="node6" href="../../d4/d40/_t_c_p__server_8c.html#a88eda37b476d8dcfdba94899e740dd9e" title="read_TCP_packet" alt="" coords="246,157,373,184"/><area shape="rect" id="node5" href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782" title="TCP_socket_data_recv\l_buffer" alt="" coords="440,125,599,166"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_icgraph" id="d6/d03/_t_c_p__server_8h_a2acbecbd76fe539293b5d92d0e0b6c5e_icgraph">
<area shape="rect" id="node2" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="228,107,360,133"/><area shape="rect" id="node17" href="../../da/da1/_t_c_p__client_8c.html#a8fef95bc96c35d09a2705f79d7e08a5a" title="do_confirmed_TCP" alt="" coords="227,208,361,235"/><area shape="rect" id="node25" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="237,157,351,184"/><area shape="rect" id="node3" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="416,107,551,133"/><area shape="rect" id="node4" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5" title="do_TCP_server" alt="" coords="605,107,719,133"/><area shape="rect" id="node5" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1260,56,1367,83"/><area shape="rect" id="node13" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="811,56,861,83"/><area shape="rect" id="node14" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="782,107,890,133"/><area shape="rect" id="node16" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="783,157,889,184"/><area shape="rect" id="node6" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1431,31,1481,57"/><area shape="rect" id="node7" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1415,81,1497,108"/><area shape="rect" id="node8" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1545,5,1652,32"/><area shape="rect" id="node9" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1573,56,1625,83"/><area shape="rect" id="node10" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1573,107,1624,133"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1562,157,1635,184"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1700,157,1751,184"/><area shape="rect" id="node15" href="../../d2/d8d/_t_c_p__test_8c.html#a0ee98d716eb7311dd4b6d217289734ff" title="START_TEST" alt="" coords="953,107,1060,133"/><area shape="rect" id="node18" href="../../d0/df3/_t_c_p__client_8h.html#a3333858c51935f9f546cf923b07ed845" title="do_TCP_connection" alt="" coords="413,208,553,235"/><area shape="rect" id="node19" href="../../d5/d26/_t_c_p__connection_8c.html#a6377f0f3d60ba706c5b014a9439696b7" title="do_tcp_conns" alt="" coords="611,208,713,235"/><area shape="rect" id="node24" href="../../d2/d8d/_t_c_p__test_8c.html#a54051584eff6e81044025b36d88c9a2b" title="START_TEST" alt="" coords="609,259,715,285"/><area shape="rect" id="node20" href="../../da/d39/_t_c_p__connection_8h.html#a30c1a9c57a8d07cc2327c0505d6619a4" title="do_tcp_connections" alt="" coords="767,208,905,235"/><area shape="rect" id="node21" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3" title="do_tcp" alt="" coords="976,157,1037,184"/><area shape="rect" id="node23" href="../../d2/d8d/_t_c_p__test_8c.html#a1b7f98a901f4b8685223ec1dac1c1ce3" title="START_TEST" alt="" coords="953,208,1060,235"/><area shape="rect" id="node22" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436" title="do_net_crypto" alt="" coords="1108,107,1212,133"/><area shape="rect" id="node26" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="409,157,557,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a984a0b6fc27b03e09170579ec9494093"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t read_TCP_length </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a>&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00204">204</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>References <a class="el" href="../../d6/d03/_t_c_p__server_8h_source.html#l00042">MAX_PACKET_SIZE</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00184">TCP_socket_data_recv_buffer()</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00256">read_packet_TCP_secure_connection()</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count = <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782">TCP_socket_data_recv_buffer</a>(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">if</span> (count &gt;= <span class="keyword">sizeof</span>(uint16_t)) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        uint16_t length;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">int</span> len = recv(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, (uint8_t *)&amp;length, <span class="keyword">sizeof</span>(uint16_t), MSG_NOSIGNAL);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">if</span> (len != <span class="keyword">sizeof</span>(uint16_t)) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;FAIL recv packet\n&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        length = ntohs(length);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (length &gt; <a class="code" href="../../d6/d03/_t_c_p__server_8h.html#a879456c3b8e2853f7044d764e9c180d4">MAX_PACKET_SIZE</a>) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">return</span> ~0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> length;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="ttc" id="_t_c_p__server_8c_html_ae80fe7119d00d2a7788c0839a90e0782"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782">TCP_socket_data_recv_buffer</a></div><div class="ttdeci">unsigned int TCP_socket_data_recv_buffer(sock_t sock)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l00184">TCP_server.c:184</a></div></div>
<div class="ttc" id="irc__syncbot_8c_html_a5903d0b282fc5eae503de618f896b5e1"><div class="ttname"><a href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a></div><div class="ttdeci">int sock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/irc__syncbot_8c_source.html#l00035">irc_syncbot.c:35</a></div></div>
<div class="ttc" id="_t_c_p__server_8h_html_a879456c3b8e2853f7044d764e9c180d4"><div class="ttname"><a href="../../d6/d03/_t_c_p__server_8h.html#a879456c3b8e2853f7044d764e9c180d4">MAX_PACKET_SIZE</a></div><div class="ttdeci">#define MAX_PACKET_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/_t_c_p__server_8h_source.html#l00042">TCP_server.h:42</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_cgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_cgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_cgraph" id="d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_cgraph">
<area shape="rect" id="node2" href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782" title="TCP_socket_data_recv\l_buffer" alt="" coords="176,5,335,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_icgraph" id="d6/d03/_t_c_p__server_8h_a984a0b6fc27b03e09170579ec9494093_icgraph">
<area shape="rect" id="node2" href="../../d6/d03/_t_c_p__server_8h.html#a2acbecbd76fe539293b5d92d0e0b6c5e" title="read_packet_TCP_secure\l_connection" alt="" coords="176,150,349,191"/><area shape="rect" id="node3" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="399,107,531,133"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#a8fef95bc96c35d09a2705f79d7e08a5a" title="do_confirmed_TCP" alt="" coords="397,208,532,235"/><area shape="rect" id="node26" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="407,157,522,184"/><area shape="rect" id="node4" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="587,107,721,133"/><area shape="rect" id="node5" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5" title="do_TCP_server" alt="" coords="776,107,889,133"/><area shape="rect" id="node6" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1431,56,1537,83"/><area shape="rect" id="node14" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="981,56,1032,83"/><area shape="rect" id="node15" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="953,107,1061,133"/><area shape="rect" id="node17" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="953,157,1060,184"/><area shape="rect" id="node7" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1601,31,1652,57"/><area shape="rect" id="node8" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1585,81,1668,108"/><area shape="rect" id="node9" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1716,5,1823,32"/><area shape="rect" id="node10" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1743,56,1795,83"/><area shape="rect" id="node11" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1744,107,1795,133"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1733,157,1806,184"/><area shape="rect" id="node13" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1871,157,1921,184"/><area shape="rect" id="node16" href="../../d2/d8d/_t_c_p__test_8c.html#a0ee98d716eb7311dd4b6d217289734ff" title="START_TEST" alt="" coords="1124,107,1231,133"/><area shape="rect" id="node19" href="../../d0/df3/_t_c_p__client_8h.html#a3333858c51935f9f546cf923b07ed845" title="do_TCP_connection" alt="" coords="584,208,724,235"/><area shape="rect" id="node20" href="../../d5/d26/_t_c_p__connection_8c.html#a6377f0f3d60ba706c5b014a9439696b7" title="do_tcp_conns" alt="" coords="781,208,884,235"/><area shape="rect" id="node25" href="../../d2/d8d/_t_c_p__test_8c.html#a54051584eff6e81044025b36d88c9a2b" title="START_TEST" alt="" coords="779,259,886,285"/><area shape="rect" id="node21" href="../../da/d39/_t_c_p__connection_8h.html#a30c1a9c57a8d07cc2327c0505d6619a4" title="do_tcp_connections" alt="" coords="937,208,1076,235"/><area shape="rect" id="node22" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3" title="do_tcp" alt="" coords="1147,157,1208,184"/><area shape="rect" id="node24" href="../../d2/d8d/_t_c_p__test_8c.html#a1b7f98a901f4b8685223ec1dac1c1ce3" title="START_TEST" alt="" coords="1124,208,1231,235"/><area shape="rect" id="node23" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436" title="do_net_crypto" alt="" coords="1279,107,1383,133"/><area shape="rect" id="node27" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="580,157,728,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a88eda37b476d8dcfdba94899e740dd9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_TCP_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a>&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00234">234</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>References <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00184">TCP_socket_data_recv_buffer()</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00870">do_TCP_connection()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00104">proxy_http_read_connection_response()</a>, <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00190">proxy_socks5_read_connection_response()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00530">read_connection_handshake()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00256">read_packet_TCP_secure_connection()</a>, and <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00146">socks5_read_handshake_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count = <a class="code" href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782">TCP_socket_data_recv_buffer</a>(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (count &gt;= length) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordtype">int</span> len = recv(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>, length, MSG_NOSIGNAL);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span> (len != length) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;FAIL recv packet\n&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div>
<div class="ttc" id="_t_c_p__server_8c_html_ae80fe7119d00d2a7788c0839a90e0782"><div class="ttname"><a href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782">TCP_socket_data_recv_buffer</a></div><div class="ttdeci">unsigned int TCP_socket_data_recv_buffer(sock_t sock)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d40/_t_c_p__server_8c_source.html#l00184">TCP_server.c:184</a></div></div>
<div class="ttc" id="irc__syncbot_8c_html_a5903d0b282fc5eae503de618f896b5e1"><div class="ttname"><a href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a></div><div class="ttdeci">int sock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/irc__syncbot_8c_source.html#l00035">irc_syncbot.c:35</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_cgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_cgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_cgraph" id="d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_cgraph">
<area shape="rect" id="node2" href="../../d4/d40/_t_c_p__server_8c.html#ae80fe7119d00d2a7788c0839a90e0782" title="TCP_socket_data_recv\l_buffer" alt="" coords="180,5,339,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_icgraph" id="d6/d03/_t_c_p__server_8h_a88eda37b476d8dcfdba94899e740dd9e_icgraph">
<area shape="rect" id="node2" href="../../d0/df3/_t_c_p__client_8h.html#a3333858c51935f9f546cf923b07ed845" title="do_TCP_connection" alt="" coords="671,130,811,157"/><area shape="rect" id="node17" href="../../da/da1/_t_c_p__client_8c.html#a39080f686c09274aa55d7b352fcadd56" title="proxy_http_read_connection\l_response" alt="" coords="433,180,619,221"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#a258117084993caf09bd2d1c04425d7f0" title="proxy_socks5_read_connection\l_response" alt="" coords="180,5,385,47"/><area shape="rect" id="node19" href="../../d4/d40/_t_c_p__server_8c.html#ab6e95a3eda0dace913cf12bf3e6088ff" title="read_connection_handshake" alt="" coords="189,363,376,390"/><area shape="rect" id="node27" href="../../d6/d03/_t_c_p__server_8h.html#a2acbecbd76fe539293b5d92d0e0b6c5e" title="read_packet_TCP_secure\l_connection" alt="" coords="196,264,369,305"/><area shape="rect" id="node33" href="../../da/da1/_t_c_p__client_8c.html#ada9457c0effffd236ca9c4a004ee8942" title="socks5_read_handshake\l_response" alt="" coords="199,71,366,112"/><area shape="rect" id="node3" href="../../d5/d26/_t_c_p__connection_8c.html#a6377f0f3d60ba706c5b014a9439696b7" title="do_tcp_conns" alt="" coords="868,189,971,215"/><area shape="rect" id="node16" href="../../d2/d8d/_t_c_p__test_8c.html#a54051584eff6e81044025b36d88c9a2b" title="START_TEST" alt="" coords="866,130,973,157"/><area shape="rect" id="node4" href="../../da/d39/_t_c_p__connection_8h.html#a30c1a9c57a8d07cc2327c0505d6619a4" title="do_tcp_connections" alt="" coords="1024,193,1163,219"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3" title="do_tcp" alt="" coords="1233,193,1295,219"/><area shape="rect" id="node15" href="../../d2/d8d/_t_c_p__test_8c.html#a1b7f98a901f4b8685223ec1dac1c1ce3" title="START_TEST" alt="" coords="1211,243,1317,270"/><area shape="rect" id="node6" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436" title="do_net_crypto" alt="" coords="1365,219,1469,246"/><area shape="rect" id="node7" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1517,258,1624,285"/><area shape="rect" id="node8" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1688,233,1739,259"/><area shape="rect" id="node9" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1672,283,1755,310"/><area shape="rect" id="node10" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1803,207,1909,234"/><area shape="rect" id="node11" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1830,258,1882,285"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1831,309,1881,335"/><area shape="rect" id="node13" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1819,359,1893,386"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1957,359,2008,386"/><area shape="rect" id="node20" href="../../d4/d40/_t_c_p__server_8c.html#a02fab0695a22b7f75c83439b2b6937ca" title="do_incoming" alt="" coords="479,398,573,425"/><area shape="rect" id="node21" href="../../d4/d40/_t_c_p__server_8c.html#affc332b8c3280bd44fa933413d678796" title="do_TCP_incomming" alt="" coords="671,398,811,425"/><area shape="rect" id="node22" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5" title="do_TCP_server" alt="" coords="863,346,976,373"/><area shape="rect" id="node23" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1068,346,1119,373"/><area shape="rect" id="node24" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="1039,397,1147,423"/><area shape="rect" id="node26" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1040,245,1147,271"/><area shape="rect" id="node25" href="../../d2/d8d/_t_c_p__test_8c.html#a0ee98d716eb7311dd4b6d217289734ff" title="START_TEST" alt="" coords="1211,397,1317,423"/><area shape="rect" id="node28" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="460,347,592,374"/><area shape="rect" id="node30" href="../../da/da1/_t_c_p__client_8c.html#a8fef95bc96c35d09a2705f79d7e08a5a" title="do_confirmed_TCP" alt="" coords="459,246,593,273"/><area shape="rect" id="node31" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="469,297,583,323"/><area shape="rect" id="node29" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="673,347,808,374"/><area shape="rect" id="node32" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="667,297,815,323"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae80fe7119d00d2a7788c0839a90e0782"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int TCP_socket_data_recv_buffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d94/network_8h.html#ae5faf8a8d23da59c3e3025a62039d8c1">sock_t</a>&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00184">184</a> of file <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html">TCP_server.c</a>.</p>

<p>Referenced by <a class="el" href="../../da/da1/_t_c_p__client_8c_source.html#l00104">proxy_http_read_connection_response()</a>, <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00204">read_TCP_length()</a>, and <a class="el" href="../../d4/d40/_t_c_p__server_8c_source.html#l00234">read_TCP_packet()</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#if defined(_WIN32) || defined(__WIN32__) || defined (WIN32)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    ioctlsocket(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, FIONREAD, &amp;count);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    ioctl(<a class="code" href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a>, FIONREAD, &amp;count);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> count;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="ttc" id="irc__syncbot_8c_html_a5903d0b282fc5eae503de618f896b5e1"><div class="ttname"><a href="../../db/d11/irc__syncbot_8c.html#a5903d0b282fc5eae503de618f896b5e1">sock</a></div><div class="ttdeci">int sock</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/irc__syncbot_8c_source.html#l00035">irc_syncbot.c:35</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d03/_t_c_p__server_8h_ae80fe7119d00d2a7788c0839a90e0782_icgraph.png" border="0" usemap="#d6/d03/_t_c_p__server_8h_ae80fe7119d00d2a7788c0839a90e0782_icgraph" alt=""/></div>
<map name="d6/d03/_t_c_p__server_8h_ae80fe7119d00d2a7788c0839a90e0782_icgraph" id="d6/d03/_t_c_p__server_8h_ae80fe7119d00d2a7788c0839a90e0782_icgraph">
<area shape="rect" id="node2" href="../../da/da1/_t_c_p__client_8c.html#a39080f686c09274aa55d7b352fcadd56" title="proxy_http_read_connection\l_response" alt="" coords="387,369,573,410"/><area shape="rect" id="node18" href="../../d6/d03/_t_c_p__server_8h.html#a984a0b6fc27b03e09170579ec9494093" title="read_TCP_length" alt="" coords="214,120,337,147"/><area shape="rect" id="node30" href="../../d6/d03/_t_c_p__server_8h.html#a88eda37b476d8dcfdba94899e740dd9e" title="read_TCP_packet" alt="" coords="212,229,339,256"/><area shape="rect" id="node3" href="../../d0/df3/_t_c_p__client_8h.html#a3333858c51935f9f546cf923b07ed845" title="do_TCP_connection" alt="" coords="879,233,1019,260"/><area shape="rect" id="node4" href="../../d5/d26/_t_c_p__connection_8c.html#a6377f0f3d60ba706c5b014a9439696b7" title="do_tcp_conns" alt="" coords="1076,233,1179,260"/><area shape="rect" id="node17" href="../../d2/d8d/_t_c_p__test_8c.html#a54051584eff6e81044025b36d88c9a2b" title="START_TEST" alt="" coords="1074,183,1181,209"/><area shape="rect" id="node5" href="../../da/d39/_t_c_p__connection_8h.html#a30c1a9c57a8d07cc2327c0505d6619a4" title="do_tcp_connections" alt="" coords="1232,221,1371,248"/><area shape="rect" id="node6" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3" title="do_tcp" alt="" coords="1441,168,1503,195"/><area shape="rect" id="node16" href="../../d2/d8d/_t_c_p__test_8c.html#a1b7f98a901f4b8685223ec1dac1c1ce3" title="START_TEST" alt="" coords="1419,221,1525,248"/><area shape="rect" id="node7" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436" title="do_net_crypto" alt="" coords="1573,113,1677,140"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1725,61,1832,88"/><area shape="rect" id="node9" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1896,36,1947,63"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1880,87,1963,113"/><area shape="rect" id="node11" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2011,11,2117,37"/><area shape="rect" id="node12" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2038,61,2090,88"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2039,112,2089,139"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2027,163,2101,189"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2165,163,2216,189"/><area shape="rect" id="node19" href="../../d6/d03/_t_c_p__server_8h.html#a2acbecbd76fe539293b5d92d0e0b6c5e" title="read_packet_TCP_secure\l_connection" alt="" coords="393,83,567,125"/><area shape="rect" id="node20" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="658,56,790,83"/><area shape="rect" id="node27" href="../../da/da1/_t_c_p__client_8c.html#a8fef95bc96c35d09a2705f79d7e08a5a" title="do_confirmed_TCP" alt="" coords="657,157,791,184"/><area shape="rect" id="node28" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="667,5,781,32"/><area shape="rect" id="node21" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="881,56,1016,83"/><area shape="rect" id="node22" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5" title="do_TCP_server" alt="" coords="1071,60,1184,87"/><area shape="rect" id="node23" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1276,60,1327,87"/><area shape="rect" id="node24" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="1247,111,1355,137"/><area shape="rect" id="node26" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1248,161,1355,188"/><area shape="rect" id="node25" href="../../d2/d8d/_t_c_p__test_8c.html#a0ee98d716eb7311dd4b6d217289734ff" title="START_TEST" alt="" coords="1419,111,1525,137"/><area shape="rect" id="node29" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="875,5,1023,32"/><area shape="rect" id="node31" href="../../da/da1/_t_c_p__client_8c.html#a258117084993caf09bd2d1c04425d7f0" title="proxy_socks5_read_connection\l_response" alt="" coords="621,310,827,351"/><area shape="rect" id="node32" href="../../d4/d40/_t_c_p__server_8c.html#ab6e95a3eda0dace913cf12bf3e6088ff" title="read_connection_handshake" alt="" coords="387,149,573,176"/><area shape="rect" id="node35" href="../../da/da1/_t_c_p__client_8c.html#ada9457c0effffd236ca9c4a004ee8942" title="socks5_read_handshake\l_response" alt="" coords="397,251,563,293"/><area shape="rect" id="node33" href="../../d4/d40/_t_c_p__server_8c.html#a02fab0695a22b7f75c83439b2b6937ca" title="do_incoming" alt="" coords="677,107,771,133"/><area shape="rect" id="node34" href="../../d4/d40/_t_c_p__server_8c.html#affc332b8c3280bd44fa933413d678796" title="do_TCP_incomming" alt="" coords="879,107,1019,133"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 2 2015 23:41:30 for libtoxcore by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
