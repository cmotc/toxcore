<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>libtoxcore: toxcore/net_crypto.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../tox.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libtoxcore
   </div>
   <div id="projectbrief">The future of instant messaging</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_0b4cb6aa1b49ded7d7b217b80a3955c0.html">toxcore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">net_crypto.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/db4/_l_a_n__discovery_8h_source.html">LAN_discovery.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/d39/_t_c_p__connection_8h_source.html">TCP_connection.h</a>&quot;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for net_crypto.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d9d/net__crypto_8h__incl.png" border="0" usemap="#toxcore_2net__crypto_8h" alt=""/></div>
<map name="toxcore_2net__crypto_8h" id="toxcore_2net__crypto_8h">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html" title="DHT.h" alt="" coords="713,379,774,405"/><area shape="rect" id="node21" href="../../dd/db4/_l_a_n__discovery_8h.html" title="LAN_discovery.h" alt="" coords="623,155,746,181"/><area shape="rect" id="node22" href="../../da/d39/_t_c_p__connection_8h.html" title="TCP_connection.h" alt="" coords="821,80,951,107"/><area shape="rect" id="node3" href="../../dd/d3e/crypto__core_8h.html" title="crypto_core.h" alt="" coords="807,453,909,480"/><area shape="rect" id="node4" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="655,528,733,555"/><area shape="rect" id="node20" href="../../dd/dec/ping__array_8h.html" title="ping_array.h" alt="" coords="690,453,783,480"/><area shape="rect" id="node23" href="../../d0/df3/_t_c_p__client_8h.html" title="TCP_client.h" alt="" coords="837,155,935,181"/><area shape="rect" id="node24" href="../../d6/d03/_t_c_p__server_8h.html" title="TCP_server.h" alt="" coords="905,229,1008,256"/><area shape="rect" id="node25" href="../../d3/db9/onion_8h.html" title="onion.h" alt="" coords="881,304,945,331"/><area shape="rect" id="node26" href="../../da/d23/list_8h.html" title="list.h" alt="" coords="1138,528,1189,555"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d75/net__crypto_8h__dep__incl.png" border="0" usemap="#toxcore_2net__crypto_8hdep" alt=""/></div>
<map name="toxcore_2net__crypto_8hdep" id="toxcore_2net__crypto_8hdep">
<area shape="rect" id="node2" href="../../d5/d29/crypto__test_8c.html" title="auto_tests/crypto_test.c" alt="" coords="813,80,976,107"/><area shape="rect" id="node3" href="../../d0/d08/friend__connection_8h.html" title="toxcore/friend_connection.h" alt="" coords="882,155,1065,181"/><area shape="rect" id="node27" href="../../d9/d26/onion__client_8h.html" title="toxcore/onion_client.h" alt="" coords="1051,80,1200,107"/><area shape="rect" id="node30" href="../../d8/dc6/net__crypto_8c.html" title="toxcore/net_crypto.c" alt="" coords="1224,80,1365,107"/><area shape="rect" id="node4" href="../../d5/d24/friend__requests_8h.html" title="toxcore/friend_requests.h" alt="" coords="889,229,1058,256"/><area shape="rect" id="node6" href="../../d4/d30/_messenger_8h.html" title="toxcore/Messenger.h" alt="" coords="659,304,803,331"/><area shape="rect" id="node26" href="../../d2/db1/friend__connection_8c.html" title="toxcore/friend_connection.c" alt="" coords="1082,229,1265,256"/><area shape="rect" id="node5" href="../../d2/dee/friends__test_8c.html" title="auto_tests/friends\l_test.c" alt="" coords="1258,379,1385,420"/><area shape="rect" id="node23" href="../../db/d5e/_d_h_t__bootstrap_8c.html" title="other/DHT_bootstrap.c" alt="" coords="1072,304,1227,331"/><area shape="rect" id="node24" href="../../d3/dfd/_d_h_t__test_8c.html" title="testing/DHT_test.c" alt="" coords="1251,304,1384,331"/><area shape="rect" id="node25" href="../../d6/da4/friend__requests_8c.html" title="toxcore/friend_requests.c" alt="" coords="827,304,997,331"/><area shape="rect" id="node7" href="../../d8/dda/messenger__test_8c.html" title="auto_tests/messenger\l_test.c" alt="" coords="890,379,1041,420"/><area shape="rect" id="node8" href="../../db/de9/_messenger__test_8c.html" title="testing/Messenger_test.c" alt="" coords="1065,386,1234,413"/><area shape="rect" id="node9" href="../../df/dc1/rtp_8h.html" title="toxav/rtp.h" alt="" coords="111,386,195,413"/><area shape="rect" id="node12" href="../../d9/d06/msi_8h.html" title="toxav/msi.h" alt="" coords="133,543,224,569"/><area shape="rect" id="node16" href="../../dd/de4/toxcore_2group_8h.html" title="toxcore/group.h" alt="" coords="396,386,508,413"/><area shape="rect" id="node20" href="../../d3/d69/tox_8c.html" title="toxcore/tox.c" alt="" coords="592,468,691,495"/><area shape="rect" id="node21" href="../../d8/d8d/_messenger_8c.html" title="toxcore/Messenger.c" alt="" coords="583,386,727,413"/><area shape="rect" id="node22" href="../../da/d84/toxdns_8c.html" title="toxdns/toxdns.c" alt="" coords="751,386,865,413"/><area shape="rect" id="node10" href="../../d1/d16/codec_8h.html" title="toxav/codec.h" alt="" coords="43,468,147,495"/><area shape="rect" id="node11" href="../../d5/def/codec_8c.html" title="toxav/codec.c" alt="" coords="5,617,109,644"/><area shape="rect" id="node15" href="../../d6/d46/rtp_8c.html" title="toxav/rtp.c" alt="" coords="171,468,255,495"/><area shape="rect" id="node14" href="../../d8/d0e/toxav_8c.html" title="toxav/toxav.c" alt="" coords="248,617,349,644"/><area shape="rect" id="node13" href="../../d2/d9b/msi_8c.html" title="toxav/msi.c" alt="" coords="133,617,224,644"/><area shape="rect" id="node17" href="../../d8/da5/toxav_2group_8h.html" title="toxav/group.h" alt="" coords="467,468,568,495"/><area shape="rect" id="node19" href="../../df/de9/toxcore_2group_8c.html" title="toxcore/group.c" alt="" coords="331,468,443,495"/><area shape="rect" id="node18" href="../../db/d46/toxav_2group_8c.html" title="toxav/group.c" alt="" coords="467,543,568,569"/><area shape="rect" id="node28" href="../../d7/dd9/onion__test_8c.html" title="auto_tests/onion_test.c" alt="" coords="1263,155,1422,181"/><area shape="rect" id="node29" href="../../db/d79/onion__client_8c.html" title="toxcore/onion_client.c" alt="" coords="1089,155,1239,181"/></map>
</div>
</div>
<p><a href="../../de/d42/net__crypto_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d14/struct_packet___data.html">Packet_Data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d40/struct_packets___array.html">Packets_Array</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dc9/struct_new___connection.html">New_Connection</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab974dcadabde124fab5287024341f7a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ab974dcadabde124fab5287024341f7a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3982349ee55b611d39ef3014e739e403"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a3982349ee55b611d39ef3014e739e403">CRYPTO_CONN_COOKIE_REQUESTING</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a3982349ee55b611d39ef3014e739e403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83145faeb8957481e615549e05e03d78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a83145faeb8957481e615549e05e03d78">CRYPTO_CONN_HANDSHAKE_SENT</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a83145faeb8957481e615549e05e03d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac188171760299bf65ba620fe348b9b40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ac188171760299bf65ba620fe348b9b40">CRYPTO_CONN_NOT_CONFIRMED</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ac188171760299bf65ba620fe348b9b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae15ad1cc9a29a669e0df83d610c188b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ae15ad1cc9a29a669e0df83d610c188b0">CRYPTO_CONN_ESTABLISHED</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ae15ad1cc9a29a669e0df83d610c188b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac73cf1eb0a938f0962ddc607945636f4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ac73cf1eb0a938f0962ddc607945636f4">CRYPTO_PACKET_BUFFER_SIZE</a>&#160;&#160;&#160;16384 /* Must be a power of 2 */</td></tr>
<tr class="separator:ac73cf1eb0a938f0962ddc607945636f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab329443d2f5643d95e6034542fcb82f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ab329443d2f5643d95e6034542fcb82f3">CRYPTO_PACKET_MIN_RATE</a>&#160;&#160;&#160;8.0</td></tr>
<tr class="separator:ab329443d2f5643d95e6034542fcb82f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d2e7f3b3f18b516bb0a512c91b2914"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ab0d2e7f3b3f18b516bb0a512c91b2914">CRYPTO_MIN_QUEUE_LENGTH</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:ab0d2e7f3b3f18b516bb0a512c91b2914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4358ff1fe0068c79f791ac88674aea04"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a4358ff1fe0068c79f791ac88674aea04">MAX_CRYPTO_PACKET_SIZE</a>&#160;&#160;&#160;1400</td></tr>
<tr class="separator:a4358ff1fe0068c79f791ac88674aea04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f9efcfe577f9eadd24094a8abd6bb7e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a5f9efcfe577f9eadd24094a8abd6bb7e">CRYPTO_DATA_PACKET_MIN_SIZE</a>&#160;&#160;&#160;(1 + sizeof(uint16_t) + (sizeof(uint32_t) + sizeof(uint32_t)) + crypto_box_MACBYTES)</td></tr>
<tr class="separator:a5f9efcfe577f9eadd24094a8abd6bb7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b6e5122f9fdc5ef548ccf920f0c246e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a1b6e5122f9fdc5ef548ccf920f0c246e">MAX_CRYPTO_DATA_SIZE</a>&#160;&#160;&#160;(<a class="el" href="../../de/d42/net__crypto_8h.html#a4358ff1fe0068c79f791ac88674aea04">MAX_CRYPTO_PACKET_SIZE</a> - <a class="el" href="../../de/d42/net__crypto_8h.html#a5f9efcfe577f9eadd24094a8abd6bb7e">CRYPTO_DATA_PACKET_MIN_SIZE</a>)</td></tr>
<tr class="separator:a1b6e5122f9fdc5ef548ccf920f0c246e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22cf528ff4b695034a0f38e6ea1cc40e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a22cf528ff4b695034a0f38e6ea1cc40e">CRYPTO_SEND_PACKET_INTERVAL</a>&#160;&#160;&#160;1000</td></tr>
<tr class="separator:a22cf528ff4b695034a0f38e6ea1cc40e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea7d88fb77084002add50dddb519cc9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#adea7d88fb77084002add50dddb519cc9">MAX_NUM_SENDPACKET_TRIES</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:adea7d88fb77084002add50dddb519cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c533e2029f9b1bdb8a368a7308253c0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a0c533e2029f9b1bdb8a368a7308253c0">UDP_DIRECT_TIMEOUT</a>&#160;&#160;&#160;((<a class="el" href="../../de/d42/net__crypto_8h.html#adea7d88fb77084002add50dddb519cc9">MAX_NUM_SENDPACKET_TRIES</a> * <a class="el" href="../../de/d42/net__crypto_8h.html#a22cf528ff4b695034a0f38e6ea1cc40e">CRYPTO_SEND_PACKET_INTERVAL</a>) / 1000)</td></tr>
<tr class="separator:a0c533e2029f9b1bdb8a368a7308253c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacaea3de09437a784d2b510a47ae15d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#aacaea3de09437a784d2b510a47ae15d6">PACKET_ID_PADDING</a>&#160;&#160;&#160;0 /* Denotes padding */</td></tr>
<tr class="separator:aacaea3de09437a784d2b510a47ae15d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1de9decbe4790923c53235d3b04a00a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#af1de9decbe4790923c53235d3b04a00a">PACKET_ID_REQUEST</a>&#160;&#160;&#160;1 /* Used to request unreceived packets */</td></tr>
<tr class="separator:af1de9decbe4790923c53235d3b04a00a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3fca17f739e473ffb4f16ec9b2f4cde"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ac3fca17f739e473ffb4f16ec9b2f4cde">PACKET_ID_KILL</a>&#160;&#160;&#160;2 /* Used to kill connection */</td></tr>
<tr class="separator:ac3fca17f739e473ffb4f16ec9b2f4cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98aaeb516244f1581d65e3dbb008979e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a98aaeb516244f1581d65e3dbb008979e">CRYPTO_RESERVED_PACKETS</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a98aaeb516244f1581d65e3dbb008979e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e0985f4d6f18b8835ec23373252ef1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a8e0985f4d6f18b8835ec23373252ef1e">MAX_TCP_CONNECTIONS</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a8e0985f4d6f18b8835ec23373252ef1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6815b993824b223ab5fb6e1cf0e32fd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a6815b993824b223ab5fb6e1cf0e32fd7">MAX_TCP_RELAYS_PEER</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a6815b993824b223ab5fb6e1cf0e32fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02481d2cc931289c2d5ee21d2a633316"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a02481d2cc931289c2d5ee21d2a633316">PACKET_ID_LOSSY_RANGE_START</a>&#160;&#160;&#160;192</td></tr>
<tr class="separator:a02481d2cc931289c2d5ee21d2a633316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97668dde651012b4dffe599cd0df333b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a97668dde651012b4dffe599cd0df333b">PACKET_ID_LOSSY_RANGE_SIZE</a>&#160;&#160;&#160;63</td></tr>
<tr class="separator:a97668dde651012b4dffe599cd0df333b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e42bab1226f7962c22372f29012a0d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a3e42bab1226f7962c22372f29012a0d6">CRYPTO_MAX_PADDING</a>&#160;&#160;&#160;8 /* All packets will be padded a number of bytes based on this number. */</td></tr>
<tr class="separator:a3e42bab1226f7962c22372f29012a0d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f273efcbb427d7ab96d56de4de63137"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a0f273efcbb427d7ab96d56de4de63137">CONGESTION_QUEUE_ARRAY_SIZE</a>&#160;&#160;&#160;24</td></tr>
<tr class="separator:a0f273efcbb427d7ab96d56de4de63137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa737ddb8e565b8959c9d30398907026e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#aa737ddb8e565b8959c9d30398907026e">DEFAULT_PING_CONNECTION</a>&#160;&#160;&#160;200</td></tr>
<tr class="separator:aa737ddb8e565b8959c9d30398907026e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adaa8cd47d0ede85ca13626e91d2e995d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#adaa8cd47d0ede85ca13626e91d2e995d">new_connection_handler</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int(*new_connection_callback)(void *object, <a class="el" href="../../d7/dc9/struct_new___connection.html">New_Connection</a> *n_c), void *object)</td></tr>
<tr class="separator:adaa8cd47d0ede85ca13626e91d2e995d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11f6e96035c3717a21b809d5373f96f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ab11f6e96035c3717a21b809d5373f96f">accept_crypto_connection</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, <a class="el" href="../../d7/dc9/struct_new___connection.html">New_Connection</a> *n_c)</td></tr>
<tr class="separator:ab11f6e96035c3717a21b809d5373f96f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09413aa94644bc88bf73b88f48ef814"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ae09413aa94644bc88bf73b88f48ef814">new_crypto_connection</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, const uint8_t *real_public_key, const uint8_t *dht_public_key)</td></tr>
<tr class="separator:ae09413aa94644bc88bf73b88f48ef814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ced4e168a95db5708bf4b3095cb4df6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a8ced4e168a95db5708bf4b3095cb4df6">set_direct_ip_port</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, _Bool connected)</td></tr>
<tr class="separator:a8ced4e168a95db5708bf4b3095cb4df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af159dc9120b9cd0675a865eabec03a73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#af159dc9120b9cd0675a865eabec03a73">connection_status_handler</a> (const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, int(*connection_status_callback)(void *object, int id, uint8_t status), void *object, int id)</td></tr>
<tr class="separator:af159dc9120b9cd0675a865eabec03a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc8cda0f8580be3a59a4f315c042fb0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#afdc8cda0f8580be3a59a4f315c042fb0">connection_data_handler</a> (const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, int(*connection_data_callback)(void *object, int id, uint8_t *data, uint16_t length), void *object, int id)</td></tr>
<tr class="separator:afdc8cda0f8580be3a59a4f315c042fb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a587a287b13cce4271a272c71c2b788"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a8a587a287b13cce4271a272c71c2b788">connection_lossy_data_handler</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, int(*connection_lossy_data_callback)(void *object, int id, const uint8_t *data, uint16_t length), void *object, int id)</td></tr>
<tr class="separator:a8a587a287b13cce4271a272c71c2b788"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ed6dc36b6e6996387b7542fc2580fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a92ed6dc36b6e6996387b7542fc2580fa">nc_dht_pk_callback</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, void(*function)(void *data, int32_t number, const uint8_t *dht_public_key), void *object, uint32_t number)</td></tr>
<tr class="separator:a92ed6dc36b6e6996387b7542fc2580fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4680603c9714e8742ad580b74ff1d891"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a4680603c9714e8742ad580b74ff1d891">crypto_num_free_sendqueue_slots</a> (const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id)</td></tr>
<tr class="separator:a4680603c9714e8742ad580b74ff1d891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a5448ebee4fd4f8fd32cc7e3ac69c0"><td class="memItemLeft" align="right" valign="top">_Bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ac2a5448ebee4fd4f8fd32cc7e3ac69c0">max_speed_reached</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id)</td></tr>
<tr class="separator:ac2a5448ebee4fd4f8fd32cc7e3ac69c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17ccce6d503f75b7d98be214ebd7621"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ab17ccce6d503f75b7d98be214ebd7621">write_cryptpacket</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, const uint8_t *data, uint16_t length, uint8_t congestion_control)</td></tr>
<tr class="separator:ab17ccce6d503f75b7d98be214ebd7621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ced352d973b7f835224854ef97f4407"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a8ced352d973b7f835224854ef97f4407">cryptpacket_received</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, uint32_t packet_number)</td></tr>
<tr class="separator:a8ced352d973b7f835224854ef97f4407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fcdf763c4a1b4b71e0de620b12f074c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a7fcdf763c4a1b4b71e0de620b12f074c">send_lossy_cryptpacket</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, const uint8_t *data, uint16_t length)</td></tr>
<tr class="separator:a7fcdf763c4a1b4b71e0de620b12f074c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9f3aef7b0d4c461294e24a21e64e71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a4b9f3aef7b0d4c461294e24a21e64e71">add_tcp_relay_peer</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, const uint8_t *public_key)</td></tr>
<tr class="separator:a4b9f3aef7b0d4c461294e24a21e64e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a632021583d7dd2484614071a7080f311"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a632021583d7dd2484614071a7080f311">add_tcp_relay</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, const uint8_t *public_key)</td></tr>
<tr class="separator:a632021583d7dd2484614071a7080f311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1a4103f75eb81ae93a0f1701b259db0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ad1a4103f75eb81ae93a0f1701b259db0">get_random_tcp_con_number</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c)</td></tr>
<tr class="separator:ad1a4103f75eb81ae93a0f1701b259db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1d29e0d6cd3c6d9dd8b613f2cc3afb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a4c1d29e0d6cd3c6d9dd8b613f2cc3afb">send_tcp_onion_request</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, unsigned int TCP_conn_number, const uint8_t *data, uint16_t length)</td></tr>
<tr class="separator:a4c1d29e0d6cd3c6d9dd8b613f2cc3afb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac398e442ae77ace2af0156b9ce7f604c"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ac398e442ae77ace2af0156b9ce7f604c">copy_connected_tcp_relays</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, <a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *tcp_relays, uint16_t <a class="el" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>)</td></tr>
<tr class="separator:ac398e442ae77ace2af0156b9ce7f604c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c3a0008512675dad8eb00ff1822763"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a16c3a0008512675dad8eb00ff1822763">crypto_kill</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id)</td></tr>
<tr class="separator:a16c3a0008512675dad8eb00ff1822763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5c59e6df7f38fe0bdf9e0f6c459869"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#afb5c59e6df7f38fe0bdf9e0f6c459869">crypto_connection_status</a> (const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, int crypt_connection_id, _Bool *direct_connected, unsigned int *online_tcp_relays)</td></tr>
<tr class="separator:afb5c59e6df7f38fe0bdf9e0f6c459869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcede595fdf06772b76f60792c82ed2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#abcede595fdf06772b76f60792c82ed2b">new_keys</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c)</td></tr>
<tr class="separator:abcede595fdf06772b76f60792c82ed2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2f39ed236b85952fa913fdac1785671"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ae2f39ed236b85952fa913fdac1785671">save_keys</a> (const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, uint8_t *keys)</td></tr>
<tr class="separator:ae2f39ed236b85952fa913fdac1785671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8131842eafef1819a6e6da5404e3234"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#ac8131842eafef1819a6e6da5404e3234">load_secret_key</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c, const uint8_t *sk)</td></tr>
<tr class="separator:ac8131842eafef1819a6e6da5404e3234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e46c6f42e93e2aa968f8f63de90a53c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a5e46c6f42e93e2aa968f8f63de90a53c">new_net_crypto</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, <a class="el" href="../../df/d64/struct_t_c_p___proxy___info.html">TCP_Proxy_Info</a> *proxy_info)</td></tr>
<tr class="separator:a5e46c6f42e93e2aa968f8f63de90a53c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0fcda7ce07347179ae4f327489c7643"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#af0fcda7ce07347179ae4f327489c7643">crypto_run_interval</a> (const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c)</td></tr>
<tr class="separator:af0fcda7ce07347179ae4f327489c7643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fa028eb320bf09ecd619c5053580436"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436">do_net_crypto</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c)</td></tr>
<tr class="separator:a6fa028eb320bf09ecd619c5053580436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb3546495adde3f08c0474f31c5d3a37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d42/net__crypto_8h.html#abb3546495adde3f08c0474f31c5d3a37">kill_net_crypto</a> (<a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *c)</td></tr>
<tr class="separator:abb3546495adde3f08c0474f31c5d3a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a0f273efcbb427d7ab96d56de4de63137"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONGESTION_QUEUE_ARRAY_SIZE&#160;&#160;&#160;24</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00083">83</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>.</p>

</div>
</div>
<a class="anchor" id="a3982349ee55b611d39ef3014e739e403"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_CONN_COOKIE_REQUESTING&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00033">33</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01515">handle_new_connection_handshake()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01266">handle_packet_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01623">new_crypto_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="ae15ad1cc9a29a669e0df83d610c188b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_CONN_ESTABLISHED&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00036">36</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02323">crypto_kill()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01851">do_tcp()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01266">handle_packet_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02219">write_cryptpacket()</a>.</p>

</div>
</div>
<a class="anchor" id="a83145faeb8957481e615549e05e03d78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_CONN_HANDSHAKE_SENT&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00034">34</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01515">handle_new_connection_handshake()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01266">handle_packet_connection()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>.</p>

</div>
</div>
<a class="anchor" id="ab974dcadabde124fab5287024341f7a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_CONN_NO_CONNECTION&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00032">32</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01570">accept_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01375">create_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00035">crypt_connection_id_not_valid()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02364">crypto_connection_status()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01449">getcryptconnection_id()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01623">new_crypto_connection()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01416">wipe_crypto_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="ac188171760299bf65ba620fe348b9b40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_CONN_NOT_CONFIRMED&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00035">35</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01570">accept_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01515">handle_new_connection_handshake()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01266">handle_packet_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>.</p>

</div>
</div>
<a class="anchor" id="a5f9efcfe577f9eadd24094a8abd6bb7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_DATA_PACKET_MIN_SIZE&#160;&#160;&#160;(1 + sizeof(uint16_t) + (sizeof(uint32_t) + sizeof(uint32_t)) + crypto_box_MACBYTES)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00050">50</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e42bab1226f7962c22372f29012a0d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_MAX_PADDING&#160;&#160;&#160;8 /* All packets will be padded a number of bytes based on this number. */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00079">79</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00773">send_data_packet_helper()</a>.</p>

</div>
</div>
<a class="anchor" id="ab0d2e7f3b3f18b516bb0a512c91b2914"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_MIN_QUEUE_LENGTH&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00045">45</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01570">accept_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01623">new_crypto_connection()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>.</p>

</div>
</div>
<a class="anchor" id="ac73cf1eb0a938f0962ddc607945636f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_PACKET_BUFFER_SIZE&#160;&#160;&#160;16384 /* Must be a power of 2 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00039">39</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00505">add_data_end_of_buffer()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00454">add_data_to_buffer()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00572">clear_buffer()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00550">clear_buffer_until()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02196">crypto_num_free_sendqueue_slots()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00612">generate_request_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00484">get_data_pointer()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00661">handle_request_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00527">read_data_beg_buffer()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00594">set_buffer_end()</a>.</p>

</div>
</div>
<a class="anchor" id="ab329443d2f5643d95e6034542fcb82f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_PACKET_MIN_RATE&#160;&#160;&#160;8.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00042">42</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01570">accept_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01623">new_crypto_connection()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>.</p>

</div>
</div>
<a class="anchor" id="a98aaeb516244f1581d65e3dbb008979e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_RESERVED_PACKETS&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00070">70</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02219">write_cryptpacket()</a>.</p>

</div>
</div>
<a class="anchor" id="a22cf528ff4b695034a0f38e6ea1cc40e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPTO_SEND_PACKET_INTERVAL&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00056">56</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02414">new_net_crypto()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>.</p>

</div>
</div>
<a class="anchor" id="aa737ddb8e565b8959c9d30398907026e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_PING_CONNECTION&#160;&#160;&#160;200</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00086">86</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01570">accept_crypto_connection()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01623">new_crypto_connection()</a>.</p>

</div>
</div>
<a class="anchor" id="a1b6e5122f9fdc5ef548ccf920f0c246e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CRYPTO_DATA_SIZE&#160;&#160;&#160;(<a class="el" href="../../de/d42/net__crypto_8h.html#a4358ff1fe0068c79f791ac88674aea04">MAX_CRYPTO_PACKET_SIZE</a> - <a class="el" href="../../de/d42/net__crypto_8h.html#a5f9efcfe577f9eadd24094a8abd6bb7e">CRYPTO_DATA_PACKET_MIN_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00053">53</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00454">m_send_message_generic()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01714">send_custom_lossless_packet()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01663">send_custom_lossy_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00773">send_data_packet_helper()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01106">send_file_control_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00831">send_lossless_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02284">send_lossy_cryptpacket()</a>, <a class="el" href="../../df/de9/toxcore_2group_8c_source.html#l00875">send_lossy_group_peer()</a>, <a class="el" href="../../df/de9/toxcore_2group_8c_source.html#l00855">send_packet_group_peer()</a>, <a class="el" href="../../df/de9/toxcore_2group_8c_source.html#l01451">send_peers()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00934">send_request_packet()</a>, and <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00893">write_cryptpacket_id()</a>.</p>

</div>
</div>
<a class="anchor" id="a4358ff1fe0068c79f791ac88674aea04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CRYPTO_PACKET_SIZE&#160;&#160;&#160;1400</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00048">48</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00897">handle_data_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01266">handle_packet_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01003">new_temp_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00741">send_data_packet()</a>, <a class="el" href="../../d5/d29/crypto__test_8c_source.html#l00208">START_TEST()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01719">tcp_data_callback()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01746">tcp_oob_callback()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01995">udp_handle_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="adea7d88fb77084002add50dddb519cc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_NUM_SENDPACKET_TRIES&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00060">60</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>.</p>

</div>
</div>
<a class="anchor" id="a8e0985f4d6f18b8835ec23373252ef1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_TCP_CONNECTIONS&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00072">72</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6815b993824b223ab5fb6e1cf0e32fd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_TCP_RELAYS_PEER&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00073">73</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac3fca17f739e473ffb4f16ec9b2f4cde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACKET_ID_KILL&#160;&#160;&#160;2 /* Used to kill connection */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00067">67</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01107">send_kill_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a97668dde651012b4dffe599cd0df333b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACKET_ID_LOSSY_RANGE_SIZE&#160;&#160;&#160;63</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00077">77</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01663">send_custom_lossy_packet()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02284">send_lossy_cryptpacket()</a>.</p>

</div>
</div>
<a class="anchor" id="a02481d2cc931289c2d5ee21d2a633316"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACKET_ID_LOSSY_RANGE_START&#160;&#160;&#160;192</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00076">76</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01615">handle_custom_lossy_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01644">m_callback_rtp_packet()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01663">send_custom_lossy_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02284">send_lossy_cryptpacket()</a>, <a class="el" href="../../d3/d69/tox_8c_source.html#l01172">tox_friend_send_lossy_packet()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02219">write_cryptpacket()</a>.</p>

</div>
</div>
<a class="anchor" id="aacaea3de09437a784d2b510a47ae15d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACKET_ID_PADDING&#160;&#160;&#160;0 /* Denotes padding */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00065">65</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00773">send_data_packet_helper()</a>.</p>

</div>
</div>
<a class="anchor" id="af1de9decbe4790923c53235d3b04a00a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACKET_ID_REQUEST&#160;&#160;&#160;1 /* Used to request unreceived packets */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00066">66</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00612">generate_request_packet()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01138">handle_data_packet_helper()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00661">handle_request_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c533e2029f9b1bdb8a368a7308253c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UDP_DIRECT_TIMEOUT&#160;&#160;&#160;((<a class="el" href="../../de/d42/net__crypto_8h.html#adea7d88fb77084002add50dddb519cc9">MAX_NUM_SENDPACKET_TRIES</a> * <a class="el" href="../../de/d42/net__crypto_8h.html#a22cf528ff4b695034a0f38e6ea1cc40e">CRYPTO_SEND_PACKET_INTERVAL</a>) / 1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00063">63</a> of file <a class="el" href="../../de/d42/net__crypto_8h_source.html">net_crypto.h</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02364">crypto_connection_status()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01680">set_direct_ip_port()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab11f6e96035c3717a21b809d5373f96f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int accept_crypto_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dc9/struct_new___connection.html">New_Connection</a> *&#160;</td>
          <td class="paramname"><em>n_c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01570">1570</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00156">Crypto_Connection::connection_number_tcp</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00173">New_Connection::cookie</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00053">COOKIE_LENGTH</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00174">New_Connection::cookie_length</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01375">create_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01081">create_send_handshake()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00032">CRYPTO_CONN_NO_CONNECTION</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00035">CRYPTO_CONN_NOT_CONFIRMED</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01469">crypto_connection_add_source()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00181">Net_Crypto::crypto_connections</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00045">CRYPTO_MIN_QUEUE_LENGTH</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00042">CRYPTO_PACKET_MIN_RATE</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00086">DEFAULT_PING_CONNECTION</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00114">Crypto_Connection::dht_public_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00170">New_Connection::dht_public_key</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00079">encrypt_precompute()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01449">getcryptconnection_id()</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00455">kill_tcp_connection_to()</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00433">new_tcp_connection_to()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00145">Crypto_Connection::packet_send_rate</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00146">Crypto_Connection::packets_left</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00106">Crypto_Connection::peersessionpublic_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00172">New_Connection::peersessionpublic_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00101">Crypto_Connection::public_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00169">New_Connection::public_key</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00176">random_nonce()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00102">Crypto_Connection::recv_nonce</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00171">New_Connection::recv_nonce</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00153">Crypto_Connection::rtt_time</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00103">Crypto_Connection::sent_nonce</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00104">Crypto_Connection::sessionpublic_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00105">Crypto_Connection::sessionsecret_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00107">Crypto_Connection::shared_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00168">New_Connection::source</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00108">Crypto_Connection::status</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00453">handle_new_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;{</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257">getcryptconnection_id</a>(c, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>) != -1)</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordtype">int</span> crypt_connection_id = <a class="code" href="../../d8/dc6/net__crypto_8c.html#aed34560fc11f32d1b280d00152655b9b">create_crypto_connection</a>(c);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span> (crypt_connection_id == -1)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = &amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a13fdc865b8a114466ba136f5390ec1b2">crypto_connections</a>[crypt_connection_id];</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">if</span> (n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#a801672aeddedd60f76a667a2275a95ce">cookie_length</a> != <a class="code" href="../../d8/dc6/net__crypto_8c.html#a905c0a7642c878ca482e2d7aff7d670c">COOKIE_LENGTH</a>)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordtype">int</span> connection_number_tcp = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a22c797c7e0ef3ad66e171f05b1cb52bd">new_tcp_connection_to</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">dht_public_key</a>, crypt_connection_id);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">if</span> (connection_number_tcp == -1)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a> = connection_number_tcp;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    memcpy(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    memcpy(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aae0467706f97aa3ef23e5dc9c3c199d7">recv_nonce</a>, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#aae0467706f97aa3ef23e5dc9c3c199d7">recv_nonce</a>, crypto_box_NONCEBYTES);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    memcpy(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ac040d4ba2a22ee327952009e7396bb2f">peersessionpublic_key</a>, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#ac040d4ba2a22ee327952009e7396bb2f">peersessionpublic_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7">random_nonce</a>(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a9df0e00e8f493ed6cd1ff45e7da33c0d">sent_nonce</a>);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    crypto_box_keypair(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a6e74fbae398c7966800ee80f7b93dbfa">sessionpublic_key</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a5f38fc9ff1b20b61ffbb56d9e7f5c892">sessionsecret_key</a>);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d">encrypt_precompute</a>(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ac040d4ba2a22ee327952009e7396bb2f">peersessionpublic_key</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a5f38fc9ff1b20b61ffbb56d9e7f5c892">sessionsecret_key</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a81ead9fac55a0cedc30a96253a2c5119">shared_key</a>);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ac188171760299bf65ba620fe348b9b40">CRYPTO_CONN_NOT_CONFIRMED</a>;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/dc6/net__crypto_8c.html#ad2ca4aad15dc0607252aa21cd525b5ba">create_send_handshake</a>(c, crypt_connection_id, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#a78fb2cbe7af4d12847f2f044c35e7823">cookie</a>, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">dht_public_key</a>) != 0) {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d">kill_tcp_connection_to</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a>);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    memcpy(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">dht_public_key</a>, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">dht_public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a8358768a02871910ed059b1b2646438e">packet_send_rate</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ab329443d2f5643d95e6034542fcb82f3">CRYPTO_PACKET_MIN_RATE</a>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">packets_left</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ab0d2e7f3b3f18b516bb0a512c91b2914">CRYPTO_MIN_QUEUE_LENGTH</a>;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ae88ec876060fbc648a4c75ac596137f9">rtt_time</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#aa737ddb8e565b8959c9d30398907026e">DEFAULT_PING_CONNECTION</a>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="../../d8/dc6/net__crypto_8c.html#a9e779393ece10111b0ac7fe2bbc3beeb">crypto_connection_add_source</a>(c, crypt_connection_id, n_c-&gt;<a class="code" href="../../d7/dc9/struct_new___connection.html#afffde330c649378add9a507c9c151586">source</a>);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">return</span> crypt_connection_id;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_ab2ecaa07625ad0ed5e07d3a1f0dcc939"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">Crypto_Connection::dht_public_key</a></div><div class="ttdeci">uint8_t dht_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00114">net_crypto.h:114</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab329443d2f5643d95e6034542fcb82f3"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab329443d2f5643d95e6034542fcb82f3">CRYPTO_PACKET_MIN_RATE</a></div><div class="ttdeci">#define CRYPTO_PACKET_MIN_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00042">net_crypto.h:42</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a2a46344fe22f21eea9d777b12918e257"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257">getcryptconnection_id</a></div><div class="ttdeci">static int getcryptconnection_id(const Net_Crypto *c, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01449">net_crypto.c:1449</a></div></div>
<div class="ttc" id="struct_new___connection_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">New_Connection::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00169">net_crypto.h:169</a></div></div>
<div class="ttc" id="net__crypto_8h_html_aa737ddb8e565b8959c9d30398907026e"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#aa737ddb8e565b8959c9d30398907026e">DEFAULT_PING_CONNECTION</a></div><div class="ttdeci">#define DEFAULT_PING_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00086">net_crypto.h:86</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ac040d4ba2a22ee327952009e7396bb2f"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ac040d4ba2a22ee327952009e7396bb2f">Crypto_Connection::peersessionpublic_key</a></div><div class="ttdeci">uint8_t peersessionpublic_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00106">net_crypto.h:106</a></div></div>
<div class="ttc" id="struct_new___connection_html_a801672aeddedd60f76a667a2275a95ce"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#a801672aeddedd60f76a667a2275a95ce">New_Connection::cookie_length</a></div><div class="ttdeci">uint8_t cookie_length</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00174">net_crypto.h:174</a></div></div>
<div class="ttc" id="struct_new___connection_html_ab2ecaa07625ad0ed5e07d3a1f0dcc939"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">New_Connection::dht_public_key</a></div><div class="ttdeci">uint8_t dht_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00170">net_crypto.h:170</a></div></div>
<div class="ttc" id="net__crypto_8c_html_aed34560fc11f32d1b280d00152655b9b"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#aed34560fc11f32d1b280d00152655b9b">create_crypto_connection</a></div><div class="ttdeci">static int create_crypto_connection(Net_Crypto *c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01375">net_crypto.c:1375</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a0d8eaef49981c5dc3ada078866b42f6d"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d">encrypt_precompute</a></div><div class="ttdeci">void encrypt_precompute(const uint8_t *public_key, const uint8_t *secret_key, uint8_t *enc_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00079">crypto_core.c:79</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a15ef255ab026d4881a16b99148b05dd7"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7">random_nonce</a></div><div class="ttdeci">void random_nonce(uint8_t *nonce)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00176">crypto_core.c:176</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab974dcadabde124fab5287024341f7a1"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a></div><div class="ttdeci">#define CRYPTO_CONN_NO_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00032">net_crypto.h:32</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab0d2e7f3b3f18b516bb0a512c91b2914"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab0d2e7f3b3f18b516bb0a512c91b2914">CRYPTO_MIN_QUEUE_LENGTH</a></div><div class="ttdeci">#define CRYPTO_MIN_QUEUE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00045">net_crypto.h:45</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a9df0e00e8f493ed6cd1ff45e7da33c0d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a9df0e00e8f493ed6cd1ff45e7da33c0d">Crypto_Connection::sent_nonce</a></div><div class="ttdeci">uint8_t sent_nonce[crypto_box_NONCEBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00103">net_crypto.h:103</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a5f38fc9ff1b20b61ffbb56d9e7f5c892"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a5f38fc9ff1b20b61ffbb56d9e7f5c892">Crypto_Connection::sessionsecret_key</a></div><div class="ttdeci">uint8_t sessionsecret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00105">net_crypto.h:105</a></div></div>
<div class="ttc" id="struct_new___connection_html_ac040d4ba2a22ee327952009e7396bb2f"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#ac040d4ba2a22ee327952009e7396bb2f">New_Connection::peersessionpublic_key</a></div><div class="ttdeci">uint8_t peersessionpublic_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00172">net_crypto.h:172</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a6e74fbae398c7966800ee80f7b93dbfa"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a6e74fbae398c7966800ee80f7b93dbfa">Crypto_Connection::sessionpublic_key</a></div><div class="ttdeci">uint8_t sessionpublic_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00104">net_crypto.h:104</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a81ead9fac55a0cedc30a96253a2c5119"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a81ead9fac55a0cedc30a96253a2c5119">Crypto_Connection::shared_key</a></div><div class="ttdeci">uint8_t shared_key[crypto_box_BEFORENMBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00107">net_crypto.h:107</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a8358768a02871910ed059b1b2646438e"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a8358768a02871910ed059b1b2646438e">Crypto_Connection::packet_send_rate</a></div><div class="ttdeci">double packet_send_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00145">net_crypto.h:145</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a22c797c7e0ef3ad66e171f05b1cb52bd"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a22c797c7e0ef3ad66e171f05b1cb52bd">new_tcp_connection_to</a></div><div class="ttdeci">int new_tcp_connection_to(TCP_Connections *tcp_c, const uint8_t *public_key, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00433">TCP_connection.c:433</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a51666aaba0fc5680040fe5bd6778bc50"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">Crypto_Connection::connection_number_tcp</a></div><div class="ttdeci">unsigned int connection_number_tcp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00156">net_crypto.h:156</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_adfabcbe80305cc6b4e1c0dfef5c48653"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">Crypto_Connection::packets_left</a></div><div class="ttdeci">uint32_t packets_left</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00146">net_crypto.h:146</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a905c0a7642c878ca482e2d7aff7d670c"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a905c0a7642c878ca482e2d7aff7d670c">COOKIE_LENGTH</a></div><div class="ttdeci">#define COOKIE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00053">net_crypto.c:53</a></div></div>
<div class="ttc" id="net__crypto_8c_html_ad2ca4aad15dc0607252aa21cd525b5ba"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#ad2ca4aad15dc0607252aa21cd525b5ba">create_send_handshake</a></div><div class="ttdeci">static int create_send_handshake(Net_Crypto *c, int crypt_connection_id, const uint8_t *cookie, const uint8_t *dht_public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01081">net_crypto.c:1081</a></div></div>
<div class="ttc" id="struct_new___connection_html_aae0467706f97aa3ef23e5dc9c3c199d7"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#aae0467706f97aa3ef23e5dc9c3c199d7">New_Connection::recv_nonce</a></div><div class="ttdeci">uint8_t recv_nonce[crypto_box_NONCEBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00171">net_crypto.h:171</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_aae0467706f97aa3ef23e5dc9c3c199d7"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aae0467706f97aa3ef23e5dc9c3c199d7">Crypto_Connection::recv_nonce</a></div><div class="ttdeci">uint8_t recv_nonce[crypto_box_NONCEBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00102">net_crypto.h:102</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ade818037fd6c985038ff29656089758d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">Crypto_Connection::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00108">net_crypto.h:108</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a9e779393ece10111b0ac7fe2bbc3beeb"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a9e779393ece10111b0ac7fe2bbc3beeb">crypto_connection_add_source</a></div><div class="ttdeci">static int crypto_connection_add_source(Net_Crypto *c, int crypt_connection_id, IP_Port source)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01469">net_crypto.c:1469</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ae88ec876060fbc648a4c75ac596137f9"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ae88ec876060fbc648a4c75ac596137f9">Crypto_Connection::rtt_time</a></div><div class="ttdeci">uint64_t rtt_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00153">net_crypto.h:153</a></div></div>
<div class="ttc" id="struct_new___connection_html_afffde330c649378add9a507c9c151586"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#afffde330c649378add9a507c9c151586">New_Connection::source</a></div><div class="ttdeci">IP_Port source</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00168">net_crypto.h:168</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a13fdc865b8a114466ba136f5390ec1b2"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a13fdc865b8a114466ba136f5390ec1b2">Net_Crypto::crypto_connections</a></div><div class="ttdeci">Crypto_Connection * crypto_connections</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00181">net_crypto.h:181</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a2369688a49bef46cb2029b3bb680e11d"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d">kill_tcp_connection_to</a></div><div class="ttdeci">int kill_tcp_connection_to(TCP_Connections *tcp_c, int connections_number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00455">TCP_connection.c:455</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ac188171760299bf65ba620fe348b9b40"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ac188171760299bf65ba620fe348b9b40">CRYPTO_CONN_NOT_CONFIRMED</a></div><div class="ttdeci">#define CRYPTO_CONN_NOT_CONFIRMED</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00035">net_crypto.h:35</a></div></div>
<div class="ttc" id="struct_new___connection_html_a78fb2cbe7af4d12847f2f044c35e7823"><div class="ttname"><a href="../../d7/dc9/struct_new___connection.html#a78fb2cbe7af4d12847f2f044c35e7823">New_Connection::cookie</a></div><div class="ttdeci">uint8_t * cookie</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00173">net_crypto.h:173</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Crypto_Connection::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00101">net_crypto.h:101</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_cgraph" id="de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#aed34560fc11f32d1b280d00152655b9b" title="create_crypto_connection" alt="" coords="228,200,399,227"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#ad2ca4aad15dc0607252aa21cd525b5ba" title="create_send_handshake" alt="" coords="232,302,395,328"/><area shape="rect" id="node9" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="1135,438,1242,464"/><area shape="rect" id="node12" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="890,555,1030,582"/><area shape="rect" id="node31" href="../../d8/dc6/net__crypto_8c.html#a9e779393ece10111b0ac7fe2bbc3beeb" title="crypto_connection_add\l_source" alt="" coords="668,750,824,792"/><area shape="rect" id="node43" href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257" title="getcryptconnection_id" alt="" coords="239,758,388,784"/><area shape="rect" id="node44" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d" title="kill_tcp_connection_to" alt="" coords="885,1078,1035,1104"/><area shape="rect" id="node48" href="../../d5/d26/_t_c_p__connection_8c.html#a22c797c7e0ef3ad66e171f05b1cb52bd" title="new_tcp_connection_to" alt="" coords="234,851,393,878"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#ab0b745274346dc3464e35fcd756db0d2" title="realloc_cryptoconnection" alt="" coords="449,150,615,176"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#a152a683d32712d0d91bfe1f4497c9485" title="create_crypto_handshake" alt="" coords="447,428,617,455"/><area shape="rect" id="node13" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1112,247,1265,274"/><area shape="rect" id="node15" href="../../d8/dc6/net__crypto_8c.html#aa762d8aa84aa2c0a9cd48fa3d93856b1" title="new_temp_packet" alt="" coords="682,48,810,75"/><area shape="rect" id="node16" href="../../d8/dc6/net__crypto_8c.html#ae0a00f5fe1955d7d15af11eacc20997b" title="send_temp_packet" alt="" coords="466,251,598,278"/><area shape="rect" id="node6" href="../../d8/dc6/net__crypto_8c.html#ad630e2753f088cf9ccd45babe8719532" title="create_cookie" alt="" coords="695,403,797,430"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="916,454,1004,480"/><area shape="rect" id="node11" href="../../dc/d85/crypto__core_8c.html#a014149333522d211490304255e139ec3" title="encrypt_data" alt="" coords="697,504,795,531"/><area shape="rect" id="node7" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1795,306,1960,332"/><area shape="rect" id="node10" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1149,539,1228,566"/><area shape="rect" id="node14" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1358,240,1497,281"/><area shape="rect" id="node17" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="665,251,827,278"/><area shape="rect" id="node18" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="689,150,803,176"/><area shape="rect" id="node19" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="875,352,1045,379"/><area shape="rect" id="node23" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="1093,188,1284,215"/><area shape="rect" id="node30" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="915,48,1005,75"/><area shape="rect" id="node20" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1104,364,1273,405"/><area shape="rect" id="node21" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1372,926,1483,952"/><area shape="rect" id="node22" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="1587,969,1730,1010"/><area shape="rect" id="node24" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1360,678,1495,704"/><area shape="rect" id="node26" href="../../da/da1/_t_c_p__client_8c.html#aea842652030d00bd8302e3c0201f95b9" title="send_data" alt="" coords="1386,138,1469,164"/><area shape="rect" id="node29" href="../../da/da1/_t_c_p__client_8c.html#a7818a314434c2bb01c3ea406744f076b" title="send_oob_packet" alt="" coords="1365,188,1489,215"/><area shape="rect" id="node25" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1575,670,1742,712"/><area shape="rect" id="node27" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1571,240,1747,281"/><area shape="rect" id="node28" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1810,247,1945,274"/><area shape="rect" id="node32" href="../../d5/d26/_t_c_p__connection_8c.html#af7a3111a46b9cb6947452393a2cbea31" title="add_tcp_number_relay\l_connection" alt="" coords="883,809,1037,850"/><area shape="rect" id="node37" href="../../d7/d40/list_8c.html#ace05755dd126bff18700a17d6f8edd28" title="bs_list_add" alt="" coords="916,875,1004,902"/><area shape="rect" id="node40" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f" title="bs_list_remove" alt="" coords="905,926,1015,952"/><area shape="rect" id="node41" href="../../d6/d6e/network_8c.html#a6913335cf0b2a76303f5f61d18ea2277" title="ipport_equal" alt="" coords="914,758,1006,784"/><area shape="rect" id="node33" href="../../d5/d26/_t_c_p__connection_8c.html#a00d2fc46939eaff0106abe890760bee0" title="add_tcp_connection\l_to_conn" alt="" coords="1119,758,1258,800"/><area shape="rect" id="node35" href="../../d5/d26/_t_c_p__connection_8c.html#a739c051ae50acb8bb1d84ff30ea96432" title="send_tcp_relay_routing\l_request" alt="" coords="1111,641,1267,682"/><area shape="rect" id="node34" href="../../d5/d26/_t_c_p__connection_8c.html#a452c51915aabeb4300da3591a7d14096" title="tcp_connection_in_conn" alt="" coords="1346,766,1509,792"/><area shape="rect" id="node36" href="../../da/da1/_t_c_p__client_8c.html#a0dc7de6475c22a0a31722bbf7ebb8dc5" title="send_routing_request" alt="" coords="1354,396,1501,423"/><area shape="rect" id="node38" href="../../d7/d40/list_8c.html#ae2aaa4149a770ed6e47a58af78fc6600" title="find" alt="" coords="1167,875,1210,902"/><area shape="rect" id="node39" href="../../d7/d40/list_8c.html#a7c246868ee5a3542509cdf90379c5bb2" title="resize" alt="" coords="1160,926,1217,952"/><area shape="rect" id="node42" href="../../d6/d6e/network_8c.html#af982256c6d8486349bdc13a920884ef6" title="ip_equal" alt="" coords="1153,590,1224,616"/><area shape="rect" id="node45" href="../../da/da1/_t_c_p__client_8c.html#af83d9fac2256a46428ad95bf337c05b7" title="send_disconnect_request" alt="" coords="1103,1128,1274,1155"/><area shape="rect" id="node47" href="../../d5/d26/_t_c_p__connection_8c.html#a10a5b3ddc6f1bfa7785301f33c369695" title="wipe_connection" alt="" coords="1368,1140,1487,1167"/><area shape="rect" id="node46" href="../../da/da1/_t_c_p__client_8c.html#abe305661e19883349d213c74c44ff93f" title="send_disconnect_notification" alt="" coords="1332,1052,1523,1079"/><area shape="rect" id="node49" href="../../d5/d26/_t_c_p__connection_8c.html#adc455181d7c862328a677fb5394885c6" title="find_tcp_connection_to" alt="" coords="454,986,610,1012"/><area shape="rect" id="node50" href="../../d5/d26/_t_c_p__connection_8c.html#a62b7fc88f48b373ae0b957244fe9db8e" title="create_connection" alt="" coords="468,851,596,878"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_icgraph" id="de/d42/net__crypto_8h_ab11f6e96035c3717a21b809d5373f96f_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="228,56,396,83"/><area shape="rect" id="node3" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="444,56,607,83"/><area shape="rect" id="node4" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="655,56,772,83"/><area shape="rect" id="node5" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="830,31,881,57"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="820,81,891,108"/><area shape="rect" id="node7" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="939,5,1045,32"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="960,56,1024,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="953,107,1031,133"/><area shape="rect" id="node12" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="967,157,1017,184"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1093,56,1144,83"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1093,107,1144,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a632021583d7dd2484614071a7080f311"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_tcp_relay </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>&#160;</td>
          <td class="paramname"><em>ip_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01794">1794</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01046">add_tcp_relay_global()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02280">do_messenger()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00248">tcp_relay_node_callback()</a>, and <a class="el" href="../../d3/d69/tox_8c_source.html#l00317">tox_add_tcp_relay()</a>.</p>
<div class="fragment"><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;{</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a5ee1dbaa28ff59e0f452eda3c97418e3">add_tcp_relay_global</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, ip_port, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a5ee1dbaa28ff59e0f452eda3c97418e3"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a5ee1dbaa28ff59e0f452eda3c97418e3">add_tcp_relay_global</a></div><div class="ttdeci">int add_tcp_relay_global(TCP_Connections *tcp_c, IP_Port ip_port, const uint8_t *relay_pk)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01046">TCP_connection.c:1046</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_cgraph" id="de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_cgraph">
<area shape="rect" id="node2" href="../../d5/d26/_t_c_p__connection_8c.html#a5ee1dbaa28ff59e0f452eda3c97418e3" title="add_tcp_relay_global" alt="" coords="156,119,300,146"/><area shape="rect" id="node3" href="../../d5/d26/_t_c_p__connection_8c.html#a6146372f26967550f1260e7f72589fa4" title="find_tcp_connection\l_relay" alt="" coords="358,69,497,111"/><area shape="rect" id="node6" href="../../d5/d26/_t_c_p__connection_8c.html#af221264f649b29407becf0e4ca352cbd" title="add_tcp_relay_instance" alt="" coords="348,161,507,187"/><area shape="rect" id="node4" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="564,26,699,53"/><area shape="rect" id="node5" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="756,5,923,47"/><area shape="rect" id="node7" href="../../d5/d26/_t_c_p__connection_8c.html#a2cd69ef2e2153135f588193ef36acf3e" title="create_tcp_connection" alt="" coords="555,161,708,187"/><area shape="rect" id="node8" href="../../da/da1/_t_c_p__client_8c.html#aedb0d5c54ac7754bb342517247ac632d" title="new_TCP_connection" alt="" coords="556,313,707,339"/><area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#ad953dedd6d25d03cf441960dd1e1fed1" title="networking_at_startup" alt="" coords="764,71,915,98"/><area shape="rect" id="node11" href="../../d6/d6e/network_8c.html#a84c3240a3325cbdaaa8a206c96980cd1" title="sock_valid" alt="" coords="797,122,881,149"/><area shape="rect" id="node12" href="../../d6/d6e/network_8c.html#a379153c027c17d7c71797cb0e3ea41a3" title="set_socket_nosigpipe" alt="" coords="765,173,913,199"/><area shape="rect" id="node13" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="803,223,876,250"/><area shape="rect" id="node14" href="../../d6/d6e/network_8c.html#a6a50bb1345f2d5192fe1ec23ac7a1da9" title="set_socket_nonblock" alt="" coords="767,274,912,301"/><area shape="rect" id="node15" href="../../da/da1/_t_c_p__client_8c.html#a60b303142f843cad13249065ddeefb17" title="connect_sock_to" alt="" coords="779,325,900,351"/><area shape="rect" id="node16" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="769,375,909,402"/><area shape="rect" id="node17" href="../../da/da1/_t_c_p__client_8c.html#a3000ce77c7c25ee8a08da815cbd0c7cb" title="proxy_http_generate\l_connection_request" alt="" coords="768,427,911,468"/><area shape="rect" id="node19" href="../../da/da1/_t_c_p__client_8c.html#a76c75a8969ec140e5799744179ba8048" title="proxy_socks5_generate\l_handshake" alt="" coords="759,492,919,533"/><area shape="rect" id="node20" href="../../da/da1/_t_c_p__client_8c.html#aec632a758fda6b73153ec16180750366" title="generate_handshake" alt="" coords="768,558,911,585"/><area shape="rect" id="node24" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="800,609,879,635"/><area shape="rect" id="node10" href="../../d6/d6e/network_8c.html#a9f5cd2a713e4a17d4c6d36650336cab0" title="current_time_actual" alt="" coords="985,71,1121,98"/><area shape="rect" id="node18" href="../../d6/d6e/network_8c.html#ae25cce1bbb77b6a8b441bb940a75783f" title="ip_parse_addr" alt="" coords="1002,434,1105,461"/><area shape="rect" id="node21" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="1184,533,1291,559"/><area shape="rect" id="node22" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="1009,558,1097,585"/><area shape="rect" id="node23" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="971,609,1136,635"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_icgraph" id="de/d42/net__crypto_8h_a632021583d7dd2484614071a7080f311_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1592,60,1699,87"/><area shape="rect" id="node10" href="../../d2/db1/friend__connection_8c.html#a9360ec098f2b1082b480b4e36b0a5f07" title="tcp_relay_node_callback" alt="" coords="156,123,321,149"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#ae858a499d7f8e2e5cbf5533afbd20537" title="tox_add_tcp_relay" alt="" coords="175,199,303,225"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1835,259,1886,285"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1819,56,1902,83"/><area shape="rect" id="node5" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1991,5,2097,32"/><area shape="rect" id="node6" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2018,56,2070,83"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2145,240,2196,267"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2007,220,2081,247"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2145,316,2196,343"/><area shape="rect" id="node11" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="573,136,728,163"/><area shape="rect" id="node36" href="../../d9/d26/onion__client_8h.html#a7bb680d62616d0dfbb6f7d2ff097107c" title="recv_tcp_relay_handler" alt="" coords="369,161,525,188"/><area shape="rect" id="node12" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="776,123,911,149"/><area shape="rect" id="node14" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="789,212,898,239"/><area shape="rect" id="node13" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1592,9,1699,36"/><area shape="rect" id="node15" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="991,364,1084,391"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="959,212,1116,239"/><area shape="rect" id="node16" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1179,313,1295,340"/><area shape="rect" id="node25" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1164,364,1311,391"/><area shape="rect" id="node27" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="1807,360,1914,387"/><area shape="rect" id="node17" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1359,399,1512,441"/><area shape="rect" id="node18" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1587,403,1704,429"/><area shape="rect" id="node19" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="1807,309,1914,336"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1825,411,1896,437"/><area shape="rect" id="node21" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1991,284,2097,311"/><area shape="rect" id="node22" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2012,335,2076,361"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2005,436,2083,463"/><area shape="rect" id="node24" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2019,385,2069,412"/><area shape="rect" id="node26" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1410,280,1461,307"/><area shape="rect" id="node29" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1175,263,1299,289"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1212,161,1263,188"/><area shape="rect" id="node31" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1387,212,1484,239"/><area shape="rect" id="node32" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1560,147,1731,173"/><area shape="rect" id="node33" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="1785,208,1936,235"/><area shape="rect" id="node34" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="1779,107,1943,133"/><area shape="rect" id="node35" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="1991,157,2097,184"/><area shape="rect" id="node38" href="../../d9/d35/tox__test_8c.html#a7d4f70e1580986cb8b3ba57d085ccc13" title="START_TEST" alt="" coords="394,212,501,239"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b9f3aef7b0d4c461294e24a21e64e71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_tcp_relay_peer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>&#160;</td>
          <td class="paramname"><em>ip_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01776">1776</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01099">add_tcp_relay_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00156">Crypto_Connection::connection_number_tcp</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00189">connect_to_saved_tcp_relays()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00154">friend_add_tcp_relay()</a>.</p>
<div class="fragment"><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;{</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a26901882c0b134822660515493683132">add_tcp_relay_connection</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a>, ip_port, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a26901882c0b134822660515493683132"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a26901882c0b134822660515493683132">add_tcp_relay_connection</a></div><div class="ttdeci">int add_tcp_relay_connection(TCP_Connections *tcp_c, int connections_number, IP_Port ip_port, const uint8_t *relay_pk)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01099">TCP_connection.c:1099</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a51666aaba0fc5680040fe5bd6778bc50"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">Crypto_Connection::connection_number_tcp</a></div><div class="ttdeci">unsigned int connection_number_tcp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00156">net_crypto.h:156</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_cgraph" id="de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_cgraph">
<area shape="rect" id="node2" href="../../d5/d26/_t_c_p__connection_8c.html#a26901882c0b134822660515493683132" title="add_tcp_relay_connection" alt="" coords="188,257,361,283"/><area shape="rect" id="node38" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="198,370,351,397"/><area shape="rect" id="node3" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="639,13,749,39"/><area shape="rect" id="node5" href="../../d5/d26/_t_c_p__connection_8c.html#a6146372f26967550f1260e7f72589fa4" title="find_tcp_connection\l_relay" alt="" coords="419,60,558,101"/><area shape="rect" id="node6" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="834,166,969,193"/><area shape="rect" id="node8" href="../../d5/d26/_t_c_p__connection_8c.html#af7a3111a46b9cb6947452393a2cbea31" title="add_tcp_number_relay\l_connection" alt="" coords="412,220,565,261"/><area shape="rect" id="node9" href="../../d5/d26/_t_c_p__connection_8c.html#a00d2fc46939eaff0106abe890760bee0" title="add_tcp_connection\l_to_conn" alt="" coords="625,285,763,327"/><area shape="rect" id="node20" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="413,337,564,379"/><area shape="rect" id="node21" href="../../d5/d26/_t_c_p__connection_8c.html#af221264f649b29407becf0e4ca352cbd" title="add_tcp_relay_instance" alt="" coords="409,403,568,430"/><area shape="rect" id="node4" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="830,5,973,47"/><area shape="rect" id="node7" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1035,159,1202,200"/><area shape="rect" id="node11" href="../../d5/d26/_t_c_p__connection_8c.html#a739c051ae50acb8bb1d84ff30ea96432" title="send_tcp_relay_routing\l_request" alt="" coords="616,220,772,261"/><area shape="rect" id="node19" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="862,337,941,363"/><area shape="rect" id="node10" href="../../d5/d26/_t_c_p__connection_8c.html#a452c51915aabeb4300da3591a7d14096" title="tcp_connection_in_conn" alt="" coords="820,286,983,313"/><area shape="rect" id="node12" href="../../da/da1/_t_c_p__client_8c.html#a0dc7de6475c22a0a31722bbf7ebb8dc5" title="send_routing_request" alt="" coords="828,229,975,255"/><area shape="rect" id="node13" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1031,272,1207,313"/><area shape="rect" id="node14" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1270,229,1405,255"/><area shape="rect" id="node16" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1255,799,1420,826"/><area shape="rect" id="node17" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="1277,279,1398,306"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="1293,330,1382,357"/><area shape="rect" id="node15" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="1468,229,1669,255"/><area shape="rect" id="node22" href="../../d5/d26/_t_c_p__connection_8c.html#a2cd69ef2e2153135f588193ef36acf3e" title="create_tcp_connection" alt="" coords="617,403,771,430"/><area shape="rect" id="node23" href="../../da/da1/_t_c_p__client_8c.html#aedb0d5c54ac7754bb342517247ac632d" title="new_TCP_connection" alt="" coords="619,565,769,591"/><area shape="rect" id="node24" href="../../d6/d6e/network_8c.html#ad953dedd6d25d03cf441960dd1e1fed1" title="networking_at_startup" alt="" coords="826,387,977,414"/><area shape="rect" id="node26" href="../../d6/d6e/network_8c.html#a84c3240a3325cbdaaa8a206c96980cd1" title="sock_valid" alt="" coords="859,438,943,465"/><area shape="rect" id="node27" href="../../d6/d6e/network_8c.html#a379153c027c17d7c71797cb0e3ea41a3" title="set_socket_nosigpipe" alt="" coords="827,489,975,515"/><area shape="rect" id="node28" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="865,539,938,566"/><area shape="rect" id="node29" href="../../d6/d6e/network_8c.html#a6a50bb1345f2d5192fe1ec23ac7a1da9" title="set_socket_nonblock" alt="" coords="829,590,974,617"/><area shape="rect" id="node30" href="../../da/da1/_t_c_p__client_8c.html#a60b303142f843cad13249065ddeefb17" title="connect_sock_to" alt="" coords="841,641,962,667"/><area shape="rect" id="node31" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="831,691,971,718"/><area shape="rect" id="node32" href="../../da/da1/_t_c_p__client_8c.html#a3000ce77c7c25ee8a08da815cbd0c7cb" title="proxy_http_generate\l_connection_request" alt="" coords="830,743,973,784"/><area shape="rect" id="node34" href="../../da/da1/_t_c_p__client_8c.html#a76c75a8969ec140e5799744179ba8048" title="proxy_socks5_generate\l_handshake" alt="" coords="821,808,981,849"/><area shape="rect" id="node35" href="../../da/da1/_t_c_p__client_8c.html#aec632a758fda6b73153ec16180750366" title="generate_handshake" alt="" coords="830,874,973,901"/><area shape="rect" id="node25" href="../../d6/d6e/network_8c.html#a9f5cd2a713e4a17d4c6d36650336cab0" title="current_time_actual" alt="" coords="1051,387,1187,414"/><area shape="rect" id="node33" href="../../d6/d6e/network_8c.html#ae25cce1bbb77b6a8b441bb940a75783f" title="ip_parse_addr" alt="" coords="1067,750,1170,777"/><area shape="rect" id="node36" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="1284,875,1391,902"/><area shape="rect" id="node37" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="1075,913,1163,939"/><area shape="rect" id="node39" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="419,455,558,496"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_icgraph" id="de/d42/net__crypto_8h_a4b9f3aef7b0d4c461294e24a21e64e71_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#a612a688a590b1836efec92949e3cbdff" title="connect_to_saved_tcp\l_relays" alt="" coords="188,491,341,533"/><area shape="rect" id="node12" href="../../d0/d08/friend__connection_8h.html#ac89688f7660c1cb5fb664ecc09bab460" title="friend_add_tcp_relay" alt="" coords="193,419,336,445"/><area shape="rect" id="node3" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="1188,469,1340,496"/><area shape="rect" id="node4" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="2027,469,2133,496"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2270,315,2321,341"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="2254,468,2337,495"/><area shape="rect" id="node7" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2425,416,2532,443"/><area shape="rect" id="node8" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2453,467,2505,493"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2580,365,2631,392"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2442,365,2515,392"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2580,264,2631,291"/><area shape="rect" id="node13" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="389,368,501,395"/><area shape="rect" id="node46" href="../../d2/db1/friend__connection_8c.html#a5f8ad19d23bf2ff57659934d2c2eb904" title="handle_packet" alt="" coords="787,419,894,445"/><area shape="rect" id="node47" href="../../d2/db1/friend__connection_8c.html#a6e0e582317de001468faab8240bd2b5c" title="send_relays" alt="" coords="399,469,491,496"/><area shape="rect" id="node48" href="../../d2/db1/friend__connection_8c.html#a9360ec098f2b1082b480b4e36b0a5f07" title="tcp_relay_node_callback" alt="" coords="549,216,715,243"/><area shape="rect" id="node14" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="577,317,687,344"/><area shape="rect" id="node15" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="783,317,899,344"/><area shape="rect" id="node17" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="967,267,1135,293"/><area shape="rect" id="node16" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="973,368,1128,395"/><area shape="rect" id="node26" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="973,216,1128,243"/><area shape="rect" id="node45" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="989,317,1112,344"/><area shape="rect" id="node18" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1183,115,1345,141"/><area shape="rect" id="node19" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1413,64,1531,91"/><area shape="rect" id="node20" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1647,64,1697,91"/><area shape="rect" id="node21" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2260,163,2331,189"/><area shape="rect" id="node22" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2425,213,2532,240"/><area shape="rect" id="node23" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2447,264,2511,291"/><area shape="rect" id="node24" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2439,163,2518,189"/><area shape="rect" id="node25" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2453,315,2504,341"/><area shape="rect" id="node27" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1197,317,1331,344"/><area shape="rect" id="node29" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1209,216,1319,243"/><area shape="rect" id="node28" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1817,520,1923,547"/><area shape="rect" id="node30" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1425,317,1519,344"/><area shape="rect" id="node38" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1393,191,1551,217"/><area shape="rect" id="node31" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1614,267,1730,293"/><area shape="rect" id="node35" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1599,317,1745,344"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="2242,365,2349,392"/><area shape="rect" id="node32" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1793,251,1947,293"/><area shape="rect" id="node33" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="2021,261,2139,288"/><area shape="rect" id="node34" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="2242,264,2349,291"/><area shape="rect" id="node36" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1845,317,1895,344"/><area shape="rect" id="node39" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1610,216,1734,243"/><area shape="rect" id="node40" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1821,183,1919,209"/><area shape="rect" id="node41" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1995,5,2165,32"/><area shape="rect" id="node42" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="2220,93,2371,120"/><area shape="rect" id="node43" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="2213,5,2377,32"/><area shape="rect" id="node44" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2425,5,2532,32"/><area shape="rect" id="node49" href="../../d9/d26/onion__client_8h.html#a7bb680d62616d0dfbb6f7d2ff097107c" title="recv_tcp_relay_handler" alt="" coords="763,216,919,243"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afdc8cda0f8580be3a59a4f315c042fb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_data_handler </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *object, int id, uint8_t *data, uint16_t length)&#160;</td>
          <td class="paramname"><em>connection_data_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01914">1914</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00131">Crypto_Connection::connection_data_callback</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00133">Crypto_Connection::connection_data_callback_id</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00132">Crypto_Connection::connection_data_callback_object</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00493">friend_new_connection()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00453">handle_new_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;{</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adc6ee264e4a5758049c6299beb81ce6d">connection_data_callback</a> = connection_data_callback;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a3c44dfac7528ae10a6d09bf812f36486">connection_data_callback_object</a> = object;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a7d50567cce6cb1b8ef983e64060d414e">connection_data_callback_id</a> = <a class="code" href="../../db/d8c/struct_file___transfers.html#aa32dbb3439461c6ccc1a52ff15bcb22e">id</a>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_a3c44dfac7528ae10a6d09bf812f36486"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a3c44dfac7528ae10a6d09bf812f36486">Crypto_Connection::connection_data_callback_object</a></div><div class="ttdeci">void * connection_data_callback_object</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00132">net_crypto.h:132</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_adc6ee264e4a5758049c6299beb81ce6d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#adc6ee264e4a5758049c6299beb81ce6d">Crypto_Connection::connection_data_callback</a></div><div class="ttdeci">int(* connection_data_callback)(void *object, int id, uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00131">net_crypto.h:131</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a7d50567cce6cb1b8ef983e64060d414e"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a7d50567cce6cb1b8ef983e64060d414e">Crypto_Connection::connection_data_callback_id</a></div><div class="ttdeci">int connection_data_callback_id</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00133">net_crypto.h:133</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="struct_file___transfers_html_aa32dbb3439461c6ccc1a52ff15bcb22e"><div class="ttname"><a href="../../db/d8c/struct_file___transfers.html#aa32dbb3439461c6ccc1a52ff15bcb22e">File_Transfers::id</a></div><div class="ttdeci">uint8_t id[FILE_ID_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d30/_messenger_8h_source.html#l00138">Messenger.h:138</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_cgraph" id="de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="220,13,373,39"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="421,5,560,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_icgraph" id="de/d42/net__crypto_8h_afdc8cda0f8580be3a59a4f315c042fb0_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="220,148,375,175"/><area shape="rect" id="node6" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="945,243,1113,269"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="443,211,555,237"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="781,153,897,180"/><area shape="rect" id="node42" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="423,15,575,41"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="623,211,733,237"/><area shape="rect" id="node17" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="952,172,1107,199"/><area shape="rect" id="node41" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="968,121,1091,148"/><area shape="rect" id="node7" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1161,343,1324,369"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1392,461,1509,488"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1625,461,1676,488"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2239,360,2309,387"/><area shape="rect" id="node11" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2404,360,2511,387"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2425,208,2489,235"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2418,309,2497,336"/><area shape="rect" id="node16" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2432,259,2483,285"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2559,157,2609,184"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2559,233,2609,260"/><area shape="rect" id="node18" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1175,121,1310,148"/><area shape="rect" id="node24" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1188,191,1297,217"/><area shape="rect" id="node19" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1397,87,1504,113"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="2233,56,2315,83"/><area shape="rect" id="node21" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2404,5,2511,32"/><area shape="rect" id="node22" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2431,56,2483,83"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2421,157,2494,184"/><area shape="rect" id="node25" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1404,191,1497,217"/><area shape="rect" id="node34" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1372,335,1529,361"/><area shape="rect" id="node26" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1593,259,1709,285"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2249,208,2299,235"/><area shape="rect" id="node31" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1577,208,1724,235"/><area shape="rect" id="node33" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="2221,157,2327,184"/><area shape="rect" id="node27" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1772,310,1925,351"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="2000,301,2117,328"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="2221,259,2327,285"/><area shape="rect" id="node32" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1823,208,1874,235"/><area shape="rect" id="node35" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1589,309,1713,336"/><area shape="rect" id="node36" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1800,259,1897,285"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1973,427,2144,453"/><area shape="rect" id="node38" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="2199,411,2349,437"/><area shape="rect" id="node39" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="2192,461,2356,488"/><area shape="rect" id="node40" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2404,461,2511,488"/><area shape="rect" id="node43" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="2005,56,2112,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8a587a287b13cce4271a272c71c2b788"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_lossy_data_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *object, int id, const uint8_t *data, uint16_t length)&#160;</td>
          <td class="paramname"><em>connection_lossy_data_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01936">1936</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00135">Crypto_Connection::connection_lossy_data_callback</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00137">Crypto_Connection::connection_lossy_data_callback_id</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00136">Crypto_Connection::connection_lossy_data_callback_object</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00493">friend_new_connection()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00453">handle_new_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;{</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab5af8aad05ddc085e69ead928cc26313">connection_lossy_data_callback</a> = connection_lossy_data_callback;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a70a99b7d0c9dd2f913ca9ea42bafc942">connection_lossy_data_callback_object</a> = object;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#acdd49847729119bc5d6cc7269cde876a">connection_lossy_data_callback_id</a> = <a class="code" href="../../db/d8c/struct_file___transfers.html#aa32dbb3439461c6ccc1a52ff15bcb22e">id</a>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_acdd49847729119bc5d6cc7269cde876a"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#acdd49847729119bc5d6cc7269cde876a">Crypto_Connection::connection_lossy_data_callback_id</a></div><div class="ttdeci">int connection_lossy_data_callback_id</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00137">net_crypto.h:137</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a70a99b7d0c9dd2f913ca9ea42bafc942"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a70a99b7d0c9dd2f913ca9ea42bafc942">Crypto_Connection::connection_lossy_data_callback_object</a></div><div class="ttdeci">void * connection_lossy_data_callback_object</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00136">net_crypto.h:136</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ab5af8aad05ddc085e69ead928cc26313"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ab5af8aad05ddc085e69ead928cc26313">Crypto_Connection::connection_lossy_data_callback</a></div><div class="ttdeci">int(* connection_lossy_data_callback)(void *object, int id, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00135">net_crypto.h:135</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="struct_file___transfers_html_aa32dbb3439461c6ccc1a52ff15bcb22e"><div class="ttname"><a href="../../db/d8c/struct_file___transfers.html#aa32dbb3439461c6ccc1a52ff15bcb22e">File_Transfers::id</a></div><div class="ttdeci">uint8_t id[FILE_ID_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d30/_messenger_8h_source.html#l00138">Messenger.h:138</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_cgraph" id="de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="208,13,361,39"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="409,5,548,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_icgraph" id="de/d42/net__crypto_8h_a8a587a287b13cce4271a272c71c2b788_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="208,148,363,175"/><area shape="rect" id="node6" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="933,243,1101,269"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="431,211,543,237"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="769,153,885,180"/><area shape="rect" id="node42" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="411,15,563,41"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="611,211,721,237"/><area shape="rect" id="node17" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="940,172,1095,199"/><area shape="rect" id="node41" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="956,121,1079,148"/><area shape="rect" id="node7" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1149,343,1312,369"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1380,461,1497,488"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1613,461,1664,488"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2227,360,2297,387"/><area shape="rect" id="node11" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2392,360,2499,387"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2413,208,2477,235"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2406,309,2485,336"/><area shape="rect" id="node16" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2420,259,2471,285"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2547,157,2597,184"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2547,233,2597,260"/><area shape="rect" id="node18" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1163,121,1298,148"/><area shape="rect" id="node24" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1176,191,1285,217"/><area shape="rect" id="node19" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1385,87,1492,113"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="2221,56,2303,83"/><area shape="rect" id="node21" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2392,5,2499,32"/><area shape="rect" id="node22" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2419,56,2471,83"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2409,157,2482,184"/><area shape="rect" id="node25" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1392,191,1485,217"/><area shape="rect" id="node34" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1360,335,1517,361"/><area shape="rect" id="node26" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1581,259,1697,285"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2237,208,2287,235"/><area shape="rect" id="node31" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1565,208,1712,235"/><area shape="rect" id="node33" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="2209,157,2315,184"/><area shape="rect" id="node27" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1760,310,1913,351"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1988,301,2105,328"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="2209,259,2315,285"/><area shape="rect" id="node32" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1811,208,1862,235"/><area shape="rect" id="node35" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1577,309,1701,336"/><area shape="rect" id="node36" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1788,259,1885,285"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1961,427,2132,453"/><area shape="rect" id="node38" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="2187,411,2337,437"/><area shape="rect" id="node39" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="2180,461,2344,488"/><area shape="rect" id="node40" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2392,461,2499,488"/><area shape="rect" id="node43" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1993,56,2100,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af159dc9120b9cd0675a865eabec03a73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connection_status_handler </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *object, int id, uint8_t status)&#160;</td>
          <td class="paramname"><em>connection_status_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01892">1892</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00127">Crypto_Connection::connection_status_callback</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00129">Crypto_Connection::connection_status_callback_id</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00128">Crypto_Connection::connection_status_callback_object</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00493">friend_new_connection()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00453">handle_new_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;{</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ad3c663c15ca97b75951ea711b522c049">connection_status_callback</a> = connection_status_callback;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#afe03d43c62ac2aa575a39e4308353244">connection_status_callback_object</a> = object;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a3cd6f7015115dc493f86be91526eb9f8">connection_status_callback_id</a> = <a class="code" href="../../db/d8c/struct_file___transfers.html#aa32dbb3439461c6ccc1a52ff15bcb22e">id</a>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_a3cd6f7015115dc493f86be91526eb9f8"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a3cd6f7015115dc493f86be91526eb9f8">Crypto_Connection::connection_status_callback_id</a></div><div class="ttdeci">int connection_status_callback_id</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00129">net_crypto.h:129</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_afe03d43c62ac2aa575a39e4308353244"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#afe03d43c62ac2aa575a39e4308353244">Crypto_Connection::connection_status_callback_object</a></div><div class="ttdeci">void * connection_status_callback_object</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00128">net_crypto.h:128</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ad3c663c15ca97b75951ea711b522c049"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ad3c663c15ca97b75951ea711b522c049">Crypto_Connection::connection_status_callback</a></div><div class="ttdeci">int(* connection_status_callback)(void *object, int id, uint8_t status)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00127">net_crypto.h:127</a></div></div>
<div class="ttc" id="struct_file___transfers_html_aa32dbb3439461c6ccc1a52ff15bcb22e"><div class="ttname"><a href="../../db/d8c/struct_file___transfers.html#aa32dbb3439461c6ccc1a52ff15bcb22e">File_Transfers::id</a></div><div class="ttdeci">uint8_t id[FILE_ID_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d30/_messenger_8h_source.html#l00138">Messenger.h:138</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_cgraph" id="de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="231,13,384,39"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="432,5,571,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_icgraph" id="de/d42/net__crypto_8h_af159dc9120b9cd0675a865eabec03a73_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="231,148,385,175"/><area shape="rect" id="node6" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="956,243,1124,269"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="453,211,565,237"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="792,153,908,180"/><area shape="rect" id="node42" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="433,15,585,41"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="633,211,744,237"/><area shape="rect" id="node17" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="963,172,1117,199"/><area shape="rect" id="node41" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="979,121,1101,148"/><area shape="rect" id="node7" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1172,343,1335,369"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1403,461,1520,488"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1636,461,1687,488"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2249,360,2320,387"/><area shape="rect" id="node11" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2415,360,2521,387"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2436,208,2500,235"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2429,309,2507,336"/><area shape="rect" id="node16" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2443,259,2493,285"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2569,157,2620,184"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2569,233,2620,260"/><area shape="rect" id="node18" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1186,121,1321,148"/><area shape="rect" id="node24" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1199,191,1308,217"/><area shape="rect" id="node19" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1408,87,1515,113"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="2243,56,2326,83"/><area shape="rect" id="node21" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2415,5,2521,32"/><area shape="rect" id="node22" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2442,56,2494,83"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2431,157,2505,184"/><area shape="rect" id="node25" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1415,191,1508,217"/><area shape="rect" id="node34" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1383,335,1540,361"/><area shape="rect" id="node26" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1603,259,1719,285"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2259,208,2310,235"/><area shape="rect" id="node31" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1588,208,1735,235"/><area shape="rect" id="node33" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="2231,157,2338,184"/><area shape="rect" id="node27" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1783,310,1936,351"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="2011,301,2128,328"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="2231,259,2338,285"/><area shape="rect" id="node32" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1834,208,1885,235"/><area shape="rect" id="node35" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1599,309,1723,336"/><area shape="rect" id="node36" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1811,259,1908,285"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1984,427,2155,453"/><area shape="rect" id="node38" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="2209,411,2360,437"/><area shape="rect" id="node39" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="2203,461,2367,488"/><area shape="rect" id="node40" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2415,461,2521,488"/><area shape="rect" id="node43" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="2016,56,2123,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac398e442ae77ace2af0156b9ce7f604c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int copy_connected_tcp_relays </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *&#160;</td>
          <td class="paramname"><em>tcp_relays</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01839">1839</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01149">tcp_copy_connected_relays()</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02565">messenger_save()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l01219">populate_path_nodes_tcp()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00921">send_dhtpk_announce()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00210">send_relays()</a>.</p>
<div class="fragment"><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;{</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a> == 0)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ret = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#ac2e62c717ccebd2379e32ca9b330812c">tcp_copy_connected_relays</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, tcp_relays, <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;}</div>
<div class="ttc" id="_t_c_p__connection_8c_html_ac2e62c717ccebd2379e32ca9b330812c"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#ac2e62c717ccebd2379e32ca9b330812c">tcp_copy_connected_relays</a></div><div class="ttdeci">unsigned int tcp_copy_connected_relays(TCP_Connections *tcp_c, Node_format *tcp_relays, uint16_t max_num)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01149">TCP_connection.c:1149</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="tox__test_8c_html_abea371f9030e15a5d2a4c181576833d8"><div class="ttname"><a href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a></div><div class="ttdeci">uint8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/tox__test_8c_source.html#l00246">tox_test.c:246</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_cgraph" id="de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_cgraph">
<area shape="rect" id="node2" href="../../d5/d26/_t_c_p__connection_8c.html#ac2e62c717ccebd2379e32ca9b330812c" title="tcp_copy_connected\l_relays" alt="" coords="196,5,339,47"/><area shape="rect" id="node3" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="387,13,521,39"/><area shape="rect" id="node4" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="569,5,736,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_icgraph" id="de/d42/net__crypto_8h_ac398e442ae77ace2af0156b9ce7f604c_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#af0dfac679b1b57a0036f6511e12fe777" title="messenger_save" alt="" coords="630,64,751,91"/><area shape="rect" id="node11" href="../../db/d79/onion__client_8c.html#aa10b37a1195f854626985f6707487b2c" title="populate_path_nodes_tcp" alt="" coords="396,221,567,248"/><area shape="rect" id="node20" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="196,171,348,197"/><area shape="rect" id="node22" href="../../d2/db1/friend__connection_8c.html#a6e0e582317de001468faab8240bd2b5c" title="send_relays" alt="" coords="226,120,318,147"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1016,107,1067,133"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="824,5,931,32"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#a63116d9c9454da73a56463d9093e53e4" title="tox_get_savedata" alt="" coords="815,56,940,83"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="988,56,1095,83"/><area shape="rect" id="node7" href="../../d2/d65/n_tox_8c.html#a631b615f9972e1b5609e5773d809f9b4" title="save_data" alt="" coords="1000,5,1083,32"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1159,56,1233,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a86825faeca35dae8e6c4ab666d4543d6" title="save_data_file" alt="" coords="1143,5,1249,32"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1297,31,1348,57"/><area shape="rect" id="node12" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="635,196,747,223"/><area shape="rect" id="node13" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="837,208,918,235"/><area shape="rect" id="node15" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="824,157,931,184"/><area shape="rect" id="node14" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="988,208,1095,235"/><area shape="rect" id="node16" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1000,157,1083,184"/><area shape="rect" id="node17" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1143,157,1249,184"/><area shape="rect" id="node18" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1170,208,1222,235"/><area shape="rect" id="node19" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1171,107,1221,133"/><area shape="rect" id="node21" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="444,171,519,197"/><area shape="rect" id="node23" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="615,127,767,153"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afb5c59e6df7f38fe0bdf9e0f6c459869"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int crypto_connection_status </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Bool *&#160;</td>
          <td class="paramname"><em>direct_connected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>online_tcp_relays</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02364">2364</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00156">Crypto_Connection::connection_number_tcp</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00032">CRYPTO_CONN_NO_CONNECTION</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00122">Crypto_Connection::direct_lastrecv_time</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00108">Crypto_Connection::status</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01133">tcp_connection_to_online_tcp_relays()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00063">UDP_DIRECT_TIMEOUT</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00049">unix_time()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01851">do_tcp()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00412">m_get_friend_connectionstatus()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00392">send_packet_to()</a>.</p>
<div class="fragment"><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;{</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="keywordflow">if</span> (direct_connected) {</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        *direct_connected = 0;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../de/d42/net__crypto_8h.html#a0c533e2029f9b1bdb8a368a7308253c0">UDP_DIRECT_TIMEOUT</a> + conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ac6eb8a274b0dedea83359f2d9269cbc2">direct_lastrecv_time</a>) &gt; <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>())</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            *direct_connected = 1;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    }</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keywordflow">if</span> (online_tcp_relays) {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        *online_tcp_relays = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61">tcp_connection_to_online_tcp_relays</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a>);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    }</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <span class="keywordflow">return</span> conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a>;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;}</div>
<div class="ttc" id="util_8c_html_ac958d9f8847cb8039444bfa3d304233a"><div class="ttname"><a href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a></div><div class="ttdeci">uint64_t unix_time()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00049">util.c:49</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ac6eb8a274b0dedea83359f2d9269cbc2"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ac6eb8a274b0dedea83359f2d9269cbc2">Crypto_Connection::direct_lastrecv_time</a></div><div class="ttdeci">uint64_t direct_lastrecv_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00122">net_crypto.h:122</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_ae843b0b4c8041f08bf9c18f68cae8a61"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61">tcp_connection_to_online_tcp_relays</a></div><div class="ttdeci">unsigned int tcp_connection_to_online_tcp_relays(TCP_Connections *tcp_c, int connections_number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01133">TCP_connection.c:1133</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab974dcadabde124fab5287024341f7a1"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a></div><div class="ttdeci">#define CRYPTO_CONN_NO_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00032">net_crypto.h:32</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a51666aaba0fc5680040fe5bd6778bc50"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">Crypto_Connection::connection_number_tcp</a></div><div class="ttdeci">unsigned int connection_number_tcp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00156">net_crypto.h:156</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ade818037fd6c985038ff29656089758d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">Crypto_Connection::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00108">net_crypto.h:108</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a0c533e2029f9b1bdb8a368a7308253c0"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a0c533e2029f9b1bdb8a368a7308253c0">UDP_DIRECT_TIMEOUT</a></div><div class="ttdeci">#define UDP_DIRECT_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00063">net_crypto.h:63</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_cgraph" id="de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="232,13,385,39"/><area shape="rect" id="node4" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="224,64,393,105"/><area shape="rect" id="node8" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="269,130,348,157"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="447,5,586,47"/><area shape="rect" id="node5" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="461,71,572,98"/><area shape="rect" id="node7" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="441,123,592,164"/><area shape="rect" id="node6" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="640,64,783,105"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_icgraph" id="de/d42/net__crypto_8h_afb5c59e6df7f38fe0bdf9e0f6c459869_icgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3" title="do_tcp" alt="" coords="251,773,312,800"/><area shape="rect" id="node12" href="../../d4/d30/_messenger_8h.html#a4b1f7ee3f635e7a80c8f3cbe98588e4d" title="m_get_friend_connectionstatus" alt="" coords="387,284,589,311"/><area shape="rect" id="node26" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="224,639,339,665"/><area shape="rect" id="node3" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436" title="do_net_crypto" alt="" coords="1360,639,1464,665"/><area shape="rect" id="node4" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1691,255,1797,281"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1907,255,1958,281"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1891,157,1974,184"/><area shape="rect" id="node7" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2068,56,2175,83"/><area shape="rect" id="node8" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2095,107,2147,133"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2096,157,2147,184"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2085,208,2158,235"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2223,208,2273,235"/><area shape="rect" id="node13" href="../../d8/d8d/_messenger_8c.html#a6177eb11440d9263eae1465810989cfd" title="check_friend_tcp_udp" alt="" coords="648,233,797,260"/><area shape="rect" id="node21" href="../../d8/dda/messenger__test_8c.html#a921391ba2a74ae4536cfcd2c789c78f9" title="messenger_suite" alt="" coords="662,335,783,361"/><area shape="rect" id="node23" href="../../d8/dda/messenger__test_8c.html#abd0bd2f7090927784ed67ea15fcf19ab" title="START_TEST" alt="" coords="669,284,776,311"/><area shape="rect" id="node24" href="../../da/d8f/tox_8h.html#a21c61f8efb52a75bac6cb7858071d00a" title="tox_friend_get_connection\l_status" alt="" coords="1845,23,2020,65"/><area shape="rect" id="node14" href="../../d8/d8d/_messenger_8c.html#a961f02c4cb668e9932894d0f8969dbb1" title="check_friend_connectionstatus" alt="" coords="856,200,1059,227"/><area shape="rect" id="node17" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="1547,255,1629,281"/><area shape="rect" id="node15" href="../../d8/d8d/_messenger_8c.html#a2e422bac86f120965227703f1930c8e6" title="set_friend_status" alt="" coords="1137,167,1260,193"/><area shape="rect" id="node16" href="../../d8/d8d/_messenger_8c.html#a00b3a64396035b3b700ba9d19140a201" title="check_friend_request\l_timed_out" alt="" coords="1339,218,1485,259"/><area shape="rect" id="node18" href="../../d8/d8d/_messenger_8c.html#a8fce9b8564a3a552ff2b77a9f81914ad" title="handle_packet" alt="" coords="1359,116,1465,143"/><area shape="rect" id="node20" href="../../d8/d8d/_messenger_8c.html#a2be56d7329b8b89d95918eba9b692c71" title="handle_status" alt="" coords="1361,65,1463,92"/><area shape="rect" id="node19" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1533,91,1643,117"/><area shape="rect" id="node22" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="932,335,983,361"/><area shape="rect" id="node25" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2096,5,2147,32"/><area shape="rect" id="node27" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="424,588,552,615"/><area shape="rect" id="node42" href="../../d8/dc6/net__crypto_8c.html#ae0a00f5fe1955d7d15af11eacc20997b" title="send_temp_packet" alt="" coords="422,689,554,716"/><area shape="rect" id="node28" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="637,537,808,564"/><area shape="rect" id="node29" href="../../d8/dc6/net__crypto_8c.html#abb8a6ea2bdfb75eb366cc0a026649e2c" title="reset_max_speed_reached" alt="" coords="868,385,1047,412"/><area shape="rect" id="node32" href="../../d8/dc6/net__crypto_8c.html#a06c8bdc27b9865d1b7d775b654f44d1a" title="send_lossless_packet" alt="" coords="1123,385,1274,412"/><area shape="rect" id="node34" href="../../d8/dc6/net__crypto_8c.html#aef6ea83ebc4f62428b09ee74441f6f4b" title="send_kill_packet" alt="" coords="898,537,1017,564"/><area shape="rect" id="node36" href="../../de/d42/net__crypto_8h.html#a7fcdf763c4a1b4b71e0de620b12f074c" title="send_lossy_cryptpacket" alt="" coords="876,487,1039,513"/><area shape="rect" id="node39" href="../../d8/dc6/net__crypto_8c.html#a31370353b1f1c90c8fb06ae736be1a0d" title="send_request_packet" alt="" coords="884,639,1031,665"/><area shape="rect" id="node41" href="../../d8/dc6/net__crypto_8c.html#ac64daefe87866ea116735f3540be3092" title="send_requested_packets" alt="" coords="874,588,1041,615"/><area shape="rect" id="node30" href="../../de/d42/net__crypto_8h.html#ac2a5448ebee4fd4f8fd32cc7e3ac69c0" title="max_speed_reached" alt="" coords="1127,335,1270,361"/><area shape="rect" id="node31" href="../../d8/d8d/_messenger_8c.html#a74c09bcf488256da7b3ed899f541fc8c" title="do_reqchunk_filecb" alt="" coords="1345,335,1479,361"/><area shape="rect" id="node33" href="../../de/d42/net__crypto_8h.html#ab17ccce6d503f75b7d98be214ebd7621" title="write_cryptpacket" alt="" coords="1349,385,1475,412"/><area shape="rect" id="node35" href="../../de/d42/net__crypto_8h.html#a16c3a0008512675dad8eb00ff1822763" title="crypto_kill" alt="" coords="1158,537,1239,564"/><area shape="rect" id="node37" href="../../df/de9/toxcore_2group_8c.html#ae3bb029450c53089066ace620abfe971" title="send_lossy_group_peer" alt="" coords="1119,487,1278,513"/><area shape="rect" id="node38" href="../../d4/d30/_messenger_8h.html#a2ebb5527b47fb87384093c4aa3c384c0" title="send_custom_lossy_packet" alt="" coords="1107,436,1291,463"/><area shape="rect" id="node40" href="../../d8/dc6/net__crypto_8c.html#ad0fc252748fecbb499c4b01706476a77" title="send_crypto_packets" alt="" coords="1125,639,1272,665"/><area shape="rect" id="node43" href="../../d8/dc6/net__crypto_8c.html#ad2ca4aad15dc0607252aa21cd525b5ba" title="create_send_handshake" alt="" coords="641,769,804,796"/><area shape="rect" id="node44" href="../../de/d42/net__crypto_8h.html#ab11f6e96035c3717a21b809d5373f96f" title="accept_crypto_connection" alt="" coords="870,740,1045,767"/><area shape="rect" id="node46" href="../../d8/dc6/net__crypto_8c.html#ae8139c35468806f25d5aed185edcc5a1" title="handle_new_connection\l_handshake" alt="" coords="877,791,1038,833"/><area shape="rect" id="node49" href="../../d8/dc6/net__crypto_8c.html#a04717fefa34f146623e7c95d5eef8caa" title="handle_packet_connection" alt="" coords="869,857,1045,884"/><area shape="rect" id="node45" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="1115,705,1283,732"/><area shape="rect" id="node47" href="../../d8/dc6/net__crypto_8c.html#a86a3ff661a8b9b10fd7c0daee3901091" title="tcp_oob_callback" alt="" coords="1137,756,1260,783"/><area shape="rect" id="node48" href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12" title="udp_handle_packet" alt="" coords="1131,807,1266,833"/><area shape="rect" id="node50" href="../../d8/dc6/net__crypto_8c.html#ab2eaad4448a5deca58a00316b522e380" title="tcp_data_callback" alt="" coords="1135,857,1262,884"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a16c3a0008512675dad8eb00ff1822763"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto_kill </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02323">2323</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d7/d40/list_8c_source.html#l00217">bs_list_remove()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00572">clear_buffer()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01034">clear_temp_packet()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00156">Crypto_Connection::connection_number_tcp</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00185">Net_Crypto::connection_use_counter</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00184">Net_Crypto::connections_mutex</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00036">CRYPTO_CONN_ESTABLISHED</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00121">Crypto_Connection::ip_port</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00202">Net_Crypto::ip_port_list</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00455">kill_tcp_connection_to()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00125">Crypto_Connection::recv_array</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00124">Crypto_Connection::send_array</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01107">send_kill_packet()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00108">Crypto_Connection::status</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01416">wipe_crypto_connection()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01119">connection_kill()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00351">dht_pk_callback()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00791">do_friend_connections()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00690">kill_friend_connection()</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02505">kill_net_crypto()</a>.</p>
<div class="fragment"><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;{</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keywordflow">while</span> (1) { <span class="comment">/* TODO: is this really the best way to do this? */</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ab5be057850e1cee67902276a69900326">connection_use_counter</a>) {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordtype">int</span> ret = -1;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <span class="keywordflow">if</span> (conn) {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a> == <a class="code" href="../../de/d42/net__crypto_8h.html#ae15ad1cc9a29a669e0df83d610c188b0">CRYPTO_CONN_ESTABLISHED</a>)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <a class="code" href="../../d8/dc6/net__crypto_8c.html#aef6ea83ebc4f62428b09ee74441f6f4b">send_kill_packet</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d">kill_tcp_connection_to</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a>);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <a class="code" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f">bs_list_remove</a>(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">ip_port_list</a>, (uint8_t *)&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, crypt_connection_id);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        <a class="code" href="../../d8/dc6/net__crypto_8c.html#a6e6c3107cf48ec1c5087d3780a03ad0c">clear_temp_packet</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <a class="code" href="../../d8/dc6/net__crypto_8c.html#ae690bbce7d008eda1142ceaf0673e672">clear_buffer</a>(&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">send_array</a>);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <a class="code" href="../../d8/dc6/net__crypto_8c.html#ae690bbce7d008eda1142ceaf0673e672">clear_buffer</a>(&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a1a62bc0c4bb9e349735c65f9948020d5">recv_array</a>);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        ret = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a7be52b4dc75558fc64e9e017ea67f1d0">wipe_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;}</div>
<div class="ttc" id="list_8c_html_a365995457101cc16f8c6b25ead07fb6f"><div class="ttname"><a href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f">bs_list_remove</a></div><div class="ttdeci">int bs_list_remove(BS_LIST *list, const uint8_t *data, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00217">list.c:217</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Crypto_Connection::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00121">net_crypto.h:121</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_aa9112ee7e76eb3e870491f7c5c272197"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">Crypto_Connection::send_array</a></div><div class="ttdeci">Packets_Array send_array</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00124">net_crypto.h:124</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a6e6c3107cf48ec1c5087d3780a03ad0c"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a6e6c3107cf48ec1c5087d3780a03ad0c">clear_temp_packet</a></div><div class="ttdeci">static int clear_temp_packet(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01034">net_crypto.c:1034</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a51666aaba0fc5680040fe5bd6778bc50"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">Crypto_Connection::connection_number_tcp</a></div><div class="ttdeci">unsigned int connection_number_tcp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00156">net_crypto.h:156</a></div></div>
<div class="ttc" id="net__crypto_8c_html_aef6ea83ebc4f62428b09ee74441f6f4b"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#aef6ea83ebc4f62428b09ee74441f6f4b">send_kill_packet</a></div><div class="ttdeci">static int send_kill_packet(Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01107">net_crypto.c:1107</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ae15ad1cc9a29a669e0df83d610c188b0"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ae15ad1cc9a29a669e0df83d610c188b0">CRYPTO_CONN_ESTABLISHED</a></div><div class="ttdeci">#define CRYPTO_CONN_ESTABLISHED</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00036">net_crypto.h:36</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a213135bf3b5b80b1cfe99b27dc42815e"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">Net_Crypto::connections_mutex</a></div><div class="ttdeci">pthread_mutex_t connections_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00184">net_crypto.h:184</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ade818037fd6c985038ff29656089758d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">Crypto_Connection::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00108">net_crypto.h:108</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae8cfe94df9c9030bbc525010603450ac"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">Net_Crypto::ip_port_list</a></div><div class="ttdeci">BS_LIST ip_port_list</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00202">net_crypto.h:202</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a7be52b4dc75558fc64e9e017ea67f1d0"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a7be52b4dc75558fc64e9e017ea67f1d0">wipe_crypto_connection</a></div><div class="ttdeci">static int wipe_crypto_connection(Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01416">net_crypto.c:1416</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ab5be057850e1cee67902276a69900326"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ab5be057850e1cee67902276a69900326">Net_Crypto::connection_use_counter</a></div><div class="ttdeci">unsigned int connection_use_counter</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00185">net_crypto.h:185</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a2369688a49bef46cb2029b3bb680e11d"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d">kill_tcp_connection_to</a></div><div class="ttdeci">int kill_tcp_connection_to(TCP_Connections *tcp_c, int connections_number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00455">TCP_connection.c:455</a></div></div>
<div class="ttc" id="net__crypto_8c_html_ae690bbce7d008eda1142ceaf0673e672"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#ae690bbce7d008eda1142ceaf0673e672">clear_buffer</a></div><div class="ttdeci">static int clear_buffer(Packets_Array *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00572">net_crypto.c:572</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a1a62bc0c4bb9e349735c65f9948020d5"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a1a62bc0c4bb9e349735c65f9948020d5">Crypto_Connection::recv_array</a></div><div class="ttdeci">Packets_Array recv_array</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00125">net_crypto.h:125</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_cgraph" id="de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_cgraph">
<area shape="rect" id="node2" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f" title="bs_list_remove" alt="" coords="161,31,271,57"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#ae690bbce7d008eda1142ceaf0673e672" title="clear_buffer" alt="" coords="171,81,261,108"/><area shape="rect" id="node6" href="../../d8/dc6/net__crypto_8c.html#a6e6c3107cf48ec1c5087d3780a03ad0c" title="clear_temp_packet" alt="" coords="564,727,696,753"/><area shape="rect" id="node7" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1154,625,1307,652"/><area shape="rect" id="node9" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d" title="kill_tcp_connection_to" alt="" coords="927,132,1077,159"/><area shape="rect" id="node23" href="../../d8/dc6/net__crypto_8c.html#aef6ea83ebc4f62428b09ee74441f6f4b" title="send_kill_packet" alt="" coords="157,588,275,615"/><area shape="rect" id="node37" href="../../d8/dc6/net__crypto_8c.html#a7be52b4dc75558fc64e9e017ea67f1d0" title="wipe_crypto_connection" alt="" coords="135,777,297,804"/><area shape="rect" id="node3" href="../../d7/d40/list_8c.html#ae2aaa4149a770ed6e47a58af78fc6600" title="find" alt="" coords="409,5,452,32"/><area shape="rect" id="node4" href="../../d7/d40/list_8c.html#a7c246868ee5a3542509cdf90379c5bb2" title="resize" alt="" coords="402,56,459,83"/><area shape="rect" id="node8" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1390,719,1529,761"/><area shape="rect" id="node10" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1404,217,1515,244"/><area shape="rect" id="node12" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1163,159,1298,185"/><area shape="rect" id="node14" href="../../da/da1/_t_c_p__client_8c.html#af83d9fac2256a46428ad95bf337c05b7" title="send_disconnect_request" alt="" coords="1145,104,1316,131"/><area shape="rect" id="node22" href="../../d5/d26/_t_c_p__connection_8c.html#a10a5b3ddc6f1bfa7785301f33c369695" title="wipe_connection" alt="" coords="1400,49,1519,76"/><area shape="rect" id="node11" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="1619,130,1762,171"/><area shape="rect" id="node13" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1376,151,1543,193"/><area shape="rect" id="node15" href="../../da/da1/_t_c_p__client_8c.html#abe305661e19883349d213c74c44ff93f" title="send_disconnect_notification" alt="" coords="1364,100,1555,127"/><area shape="rect" id="node16" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1603,311,1779,353"/><area shape="rect" id="node17" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1842,344,1977,371"/><area shape="rect" id="node19" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1827,465,1992,492"/><area shape="rect" id="node20" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="1849,121,1970,148"/><area shape="rect" id="node21" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="1865,293,1954,320"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="2040,344,2241,371"/><area shape="rect" id="node24" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="345,549,516,576"/><area shape="rect" id="node25" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="566,524,694,551"/><area shape="rect" id="node26" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="744,423,859,449"/><area shape="rect" id="node27" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="917,372,1087,399"/><area shape="rect" id="node31" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="907,313,1097,340"/><area shape="rect" id="node36" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="957,423,1047,449"/><area shape="rect" id="node28" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1146,365,1315,406"/><area shape="rect" id="node30" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1191,481,1270,508"/><area shape="rect" id="node29" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="1384,421,1535,462"/><area shape="rect" id="node32" href="../../da/da1/_t_c_p__client_8c.html#aea842652030d00bd8302e3c0201f95b9" title="send_data" alt="" coords="1189,313,1272,340"/><area shape="rect" id="node35" href="../../da/da1/_t_c_p__client_8c.html#a7818a314434c2bb01c3ea406744f076b" title="send_oob_packet" alt="" coords="1169,431,1293,457"/><area shape="rect" id="node33" href="../../da/da1/_t_c_p__client_8c.html#a8e1ca90aa8db34a58b3b38cfcb1bb9de" title="send_ping_response" alt="" coords="1389,319,1530,345"/><area shape="rect" id="node34" href="../../da/da1/_t_c_p__client_8c.html#a5aad81831c1333b763c9fd5eaf41603f" title="send_ping_request" alt="" coords="1394,369,1525,396"/><area shape="rect" id="node38" href="../../d8/dc6/net__crypto_8c.html#ab0b745274346dc3464e35fcd756db0d2" title="realloc_cryptoconnection" alt="" coords="347,777,514,804"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_icgraph" id="de/d42/net__crypto_8h_a16c3a0008512675dad8eb00ff1822763_icgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#ac679d5f08189ac10b3eca22c3f032dbc" title="connection_kill" alt="" coords="139,354,247,381"/><area shape="rect" id="node18" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="135,144,251,170"/><area shape="rect" id="node24" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="513,245,665,272"/><area shape="rect" id="node30" href="../../d0/d08/friend__connection_8h.html#a5f311791c0ec4ecd8fdf5359cf7fb95a" title="kill_friend_connection" alt="" coords="303,590,449,617"/><area shape="rect" id="node48" href="../../de/d42/net__crypto_8h.html#abb3546495adde3f08c0474f31c5d3a37" title="kill_net_crypto" alt="" coords="1152,464,1259,490"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a38debbf6310a8190eeafd33e42423f1a" title="handle_data_packet\l_helper" alt="" coords="307,347,445,388"/><area shape="rect" id="node11" href="../../d8/dc6/net__crypto_8c.html#ae8139c35468806f25d5aed185edcc5a1" title="handle_new_connection\l_handshake" alt="" coords="509,398,670,439"/><area shape="rect" id="node13" href="../../d8/dc6/net__crypto_8c.html#acb48e059ed89d52de983ac4c59fcde06" title="kill_timedout" alt="" coords="329,296,423,322"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#a04717fefa34f146623e7c95d5eef8caa" title="handle_packet_connection" alt="" coords="501,346,677,373"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#ab2eaad4448a5deca58a00316b522e380" title="tcp_data_callback" alt="" coords="729,312,856,338"/><area shape="rect" id="node10" href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12" title="udp_handle_packet" alt="" coords="725,362,860,389"/><area shape="rect" id="node6" href="../../de/d42/net__crypto_8h.html#a5e46c6f42e93e2aa968f8f63de90a53c" title="new_net_crypto" alt="" coords="935,388,1049,414"/><area shape="rect" id="node7" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1340,464,1457,490"/><area shape="rect" id="node8" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1539,514,1589,541"/><area shape="rect" id="node9" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1529,464,1599,490"/><area shape="rect" id="node12" href="../../d8/dc6/net__crypto_8c.html#a86a3ff661a8b9b10fd7c0daee3901091" title="tcp_oob_callback" alt="" coords="731,413,854,440"/><area shape="rect" id="node14" href="../../de/d42/net__crypto_8h.html#a6fa028eb320bf09ecd619c5053580436" title="do_net_crypto" alt="" coords="537,296,641,322"/><area shape="rect" id="node15" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="739,245,846,272"/><area shape="rect" id="node16" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="967,245,1017,272"/><area shape="rect" id="node17" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="951,169,1033,196"/><area shape="rect" id="node19" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="299,194,453,221"/><area shape="rect" id="node22" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="908,106,1076,133"/><area shape="rect" id="node25" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="299,93,453,120"/><area shape="rect" id="node29" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="315,144,437,170"/><area shape="rect" id="node20" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="533,194,645,221"/><area shape="rect" id="node21" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="737,106,848,133"/><area shape="rect" id="node23" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1124,234,1287,261"/><area shape="rect" id="node26" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="522,144,657,170"/><area shape="rect" id="node28" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="535,93,644,120"/><area shape="rect" id="node27" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="739,157,846,184"/><area shape="rect" id="node31" href="../../dd/de4/toxcore_2group_8h.html#a526817b20616bdf13250e1020d2a1808" title="del_groupchat" alt="" coords="1154,616,1257,642"/><area shape="rect" id="node37" href="../../df/de9/toxcore_2group_8c.html#a5f0da219f2f87c142bd8c95f6d43e32c" title="handle_direct_packet" alt="" coords="517,793,662,820"/><area shape="rect" id="node39" href="../../df/de9/toxcore_2group_8c.html#aadd3b840d1ca411fc2345ec2c9f6bfe7" title="handle_packet_online" alt="" coords="516,742,663,769"/><area shape="rect" id="node40" href="../../d0/d08/friend__connection_8h.html#a2ef8cdbd93f21f11ff0333a9527c2c02" title="kill_friend_connections" alt="" coords="1128,514,1283,541"/><area shape="rect" id="node42" href="../../d4/d30/_messenger_8h.html#a7a7b52e12232948dfe96d8e7dea50610" title="m_delfriend" alt="" coords="545,692,634,718"/><area shape="rect" id="node46" href="../../df/de9/toxcore_2group_8c.html#a812cc4cdcdb4821a6624c886e71e2a6c" title="remove_close_conn" alt="" coords="520,514,659,541"/><area shape="rect" id="node32" href="../../d8/da5/toxav_2group_8h.html#a0cf061415a40de14b1dca48921a6f687" title="add_av_groupchat" alt="" coords="1335,616,1463,642"/><area shape="rect" id="node33" href="../../d8/da5/toxav_2group_8h.html#a3bb53f02b23ac60cb1e76d3717a4e2e5" title="join_av_groupchat" alt="" coords="1335,666,1462,693"/><area shape="rect" id="node34" href="../../dd/de4/toxcore_2group_8h.html#af203efe57203e3b774d8e4f5e29cca81" title="kill_groupchats" alt="" coords="1344,717,1453,744"/><area shape="rect" id="node36" href="../../d3/d8f/tox__old__code_8h.html#a2a5c2f4bc3730d20bc784e512bc116b5" title="tox_del_groupchat" alt="" coords="1335,565,1463,592"/><area shape="rect" id="node35" href="../../da/d8f/tox_8h.html#a52259e134bfb9396d9fef4fffe94e878" title="tox_kill" alt="" coords="1533,641,1595,668"/><area shape="rect" id="node38" href="../../df/de9/toxcore_2group_8c.html#a0b63c2cb5a61d6418705d22a30a8d4ef" title="handle_packet" alt="" coords="739,818,846,845"/><area shape="rect" id="node41" href="../../d4/d30/_messenger_8h.html#a771c65c3057d870b0653c2fdf0a12fb7" title="kill_messenger" alt="" coords="1344,514,1453,541"/><area shape="rect" id="node43" href="../../d8/dda/messenger__test_8c.html#a921391ba2a74ae4536cfcd2c789c78f9" title="messenger_suite" alt="" coords="931,768,1053,794"/><area shape="rect" id="node44" href="../../d8/dda/messenger__test_8c.html#a0d7e5cba3f1de72c42741b80489f5df0" title="START_TEST" alt="" coords="739,666,846,693"/><area shape="rect" id="node45" href="../../da/d8f/tox_8h.html#ae7909e1bb1cf6d8073d38aac41c2fb9c" title="tox_friend_delete" alt="" coords="732,717,853,744"/><area shape="rect" id="node47" href="../../df/de9/toxcore_2group_8c.html#a54efac41dbd172d4443518f006d89b05" title="delpeer" alt="" coords="761,514,825,541"/><area shape="rect" id="node49" href="../../d7/dd9/onion__test_8c.html#a11b4d3c94243b8abdd439dea94ee679e" title="kill_onions" alt="" coords="1357,413,1440,440"/><area shape="rect" id="node50" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1511,413,1617,440"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4680603c9714e8742ad580b74ff1d891"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t crypto_num_free_sendqueue_slots </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02196">2196</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00039">CRYPTO_PACKET_BUFFER_SIZE</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00444">num_packets_array()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00146">Crypto_Connection::packets_left</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00124">Crypto_Connection::send_array</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01404">do_reqchunk_filecb()</a>, and <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01318">file_data()</a>.</p>
<div class="fragment"><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;{</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    uint32_t max_packets = <a class="code" href="../../de/d42/net__crypto_8h.html#ac73cf1eb0a938f0962ddc607945636f4">CRYPTO_PACKET_BUFFER_SIZE</a> - <a class="code" href="../../d8/dc6/net__crypto_8c.html#abbe1101e6464100c19aea7cde5c1d3a0">num_packets_array</a>(&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">send_array</a>);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">packets_left</a> &lt; max_packets) {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="keywordflow">return</span> conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">packets_left</a>;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="keywordflow">return</span> max_packets;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_aa9112ee7e76eb3e870491f7c5c272197"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">Crypto_Connection::send_array</a></div><div class="ttdeci">Packets_Array send_array</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00124">net_crypto.h:124</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ac73cf1eb0a938f0962ddc607945636f4"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ac73cf1eb0a938f0962ddc607945636f4">CRYPTO_PACKET_BUFFER_SIZE</a></div><div class="ttdeci">#define CRYPTO_PACKET_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00039">net_crypto.h:39</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_adfabcbe80305cc6b4e1c0dfef5c48653"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">Crypto_Connection::packets_left</a></div><div class="ttdeci">uint32_t packets_left</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00146">net_crypto.h:146</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="net__crypto_8c_html_abbe1101e6464100c19aea7cde5c1d3a0"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#abbe1101e6464100c19aea7cde5c1d3a0">num_packets_array</a></div><div class="ttdeci">static uint32_t num_packets_array(const Packets_Array *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00444">net_crypto.c:444</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_cgraph" id="de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="243,13,396,39"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#abbe1101e6464100c19aea7cde5c1d3a0" title="num_packets_array" alt="" coords="251,63,387,90"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="444,5,583,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_icgraph" id="de/d42/net__crypto_8h_a4680603c9714e8742ad580b74ff1d891_icgraph">
<area shape="rect" id="node2" href="../../d8/d8d/_messenger_8c.html#a74c09bcf488256da7b3ed899f541fc8c" title="do_reqchunk_filecb" alt="" coords="361,56,496,83"/><area shape="rect" id="node12" href="../../d4/d30/_messenger_8h.html#a2d94ca52e2129848ab7b137edb049eb4" title="file_data" alt="" coords="243,107,313,133"/><area shape="rect" id="node3" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="573,56,656,83"/><area shape="rect" id="node4" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1367,56,1473,83"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1610,309,1661,336"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1594,56,1677,83"/><area shape="rect" id="node7" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1765,107,1872,133"/><area shape="rect" id="node8" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1793,5,1845,32"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1920,323,1971,349"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1782,259,1855,285"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1920,373,1971,400"/><area shape="rect" id="node13" href="../../d8/d8d/_messenger_8c.html#a8fce9b8564a3a552ff2b77a9f81914ad" title="handle_packet" alt="" coords="375,208,482,235"/><area shape="rect" id="node36" href="../../da/d8f/tox_8h.html#a7653dd0bbf8bda8e18d211277f3e7577" title="tox_file_send_chunk" alt="" coords="544,107,685,133"/><area shape="rect" id="node14" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="560,259,669,285"/><area shape="rect" id="node15" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="765,411,859,437"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="733,259,891,285"/><area shape="rect" id="node16" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="954,411,1070,437"/><area shape="rect" id="node25" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="939,360,1085,387"/><area shape="rect" id="node27" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="1582,411,1689,437"/><area shape="rect" id="node17" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1133,395,1287,437"/><area shape="rect" id="node18" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1361,461,1479,488"/><area shape="rect" id="node19" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="1582,360,1689,387"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1600,461,1671,488"/><area shape="rect" id="node21" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1765,335,1872,361"/><area shape="rect" id="node22" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1787,436,1851,463"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1779,487,1858,513"/><area shape="rect" id="node24" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1793,385,1844,412"/><area shape="rect" id="node26" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1185,327,1235,353"/><area shape="rect" id="node29" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="950,309,1074,336"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="987,157,1037,184"/><area shape="rect" id="node31" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1161,259,1259,285"/><area shape="rect" id="node32" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1335,208,1505,235"/><area shape="rect" id="node33" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="1560,259,1711,285"/><area shape="rect" id="node34" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="1553,157,1717,184"/><area shape="rect" id="node35" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="1765,157,1872,184"/><area shape="rect" id="node37" href="../../d9/d35/tox__test_8c.html#a7209b965126c3b606c3f0030a088ed27" title="tox_file_chunk_request" alt="" coords="734,107,890,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af0fcda7ce07347179ae4f327489c7643"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t crypto_run_interval </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02491">2491</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00200">Net_Crypto::current_sleep_time</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02268">messenger_run_interval()</a>.</p>
<div class="fragment"><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;{</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordflow">return</span> c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a86823a02e323235811eada4755e3f81e">current_sleep_time</a>;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_a86823a02e323235811eada4755e3f81e"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a86823a02e323235811eada4755e3f81e">Net_Crypto::current_sleep_time</a></div><div class="ttdeci">uint32_t current_sleep_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00200">net_crypto.h:200</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_af0fcda7ce07347179ae4f327489c7643_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_af0fcda7ce07347179ae4f327489c7643_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_af0fcda7ce07347179ae4f327489c7643_icgraph" id="de/d42/net__crypto_8h_af0fcda7ce07347179ae4f327489c7643_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#ae99fff78f4ac1f79f1faa817d31c7dfe" title="messenger_run_interval" alt="" coords="185,31,345,57"/><area shape="rect" id="node3" href="../../da/d8f/tox_8h.html#ad32da51807cfe5023d63d2e9de5759c1" title="tox_iteration_interval" alt="" coords="393,31,536,57"/><area shape="rect" id="node4" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="584,5,691,32"/><area shape="rect" id="node5" href="../../d2/d65/n_tox_8c.html#a184d2213a76dbfc1600d83a997f49fa5" title="timeout_getch" alt="" coords="585,56,689,83"/><area shape="rect" id="node6" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="739,56,789,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8ced352d973b7f835224854ef97f4407"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int cryptpacket_received </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>packet_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02262">2262</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00097">Packets_Array::buffer_end</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00096">Packets_Array::buffer_start</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../d9/d35/tox__test_8c_source.html#l00246">num</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00124">Crypto_Connection::send_array</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00338">friend_received_packet()</a>.</p>
<div class="fragment"><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;{</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    uint32_t <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a> = conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">send_array</a>.<a class="code" href="../../d2/d40/struct_packets___array.html#a66d710e0093872b26ee80118c1a85d99">buffer_end</a> - conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">send_array</a>.<a class="code" href="../../d2/d40/struct_packets___array.html#a85973b335814248c05f63543876b348e">buffer_start</a>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    uint32_t num1 = packet_number - conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">send_array</a>.<a class="code" href="../../d2/d40/struct_packets___array.html#a85973b335814248c05f63543876b348e">buffer_start</a>;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">if</span> (num &lt; num1) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    }</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_aa9112ee7e76eb3e870491f7c5c272197"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">Crypto_Connection::send_array</a></div><div class="ttdeci">Packets_Array send_array</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00124">net_crypto.h:124</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="tox__test_8c_html_abea371f9030e15a5d2a4c181576833d8"><div class="ttname"><a href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a></div><div class="ttdeci">uint8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/tox__test_8c_source.html#l00246">tox_test.c:246</a></div></div>
<div class="ttc" id="struct_packets___array_html_a66d710e0093872b26ee80118c1a85d99"><div class="ttname"><a href="../../d2/d40/struct_packets___array.html#a66d710e0093872b26ee80118c1a85d99">Packets_Array::buffer_end</a></div><div class="ttdeci">uint32_t buffer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00097">net_crypto.h:97</a></div></div>
<div class="ttc" id="struct_packets___array_html_a85973b335814248c05f63543876b348e"><div class="ttname"><a href="../../d2/d40/struct_packets___array.html#a85973b335814248c05f63543876b348e">Packets_Array::buffer_start</a></div><div class="ttdeci">uint32_t buffer_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00096">net_crypto.h:96</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_cgraph" id="de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="200,13,353,39"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="401,5,540,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_icgraph" id="de/d42/net__crypto_8h_a8ced352d973b7f835224854ef97f4407_icgraph">
<area shape="rect" id="node2" href="../../d8/d8d/_messenger_8c.html#a27839390fa4224c2474ad304ee6a199c" title="friend_received_packet" alt="" coords="200,56,356,83"/><area shape="rect" id="node3" href="../../d8/d8d/_messenger_8c.html#ac9dcb9b0a9c69f521369a559a1835c57" title="do_receipts" alt="" coords="427,31,516,57"/><area shape="rect" id="node13" href="../../d8/d8d/_messenger_8c.html#a74c09bcf488256da7b3ed899f541fc8c" title="do_reqchunk_filecb" alt="" coords="404,81,539,108"/><area shape="rect" id="node4" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="587,56,669,83"/><area shape="rect" id="node5" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="717,56,824,83"/><area shape="rect" id="node6" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="888,31,939,57"/><area shape="rect" id="node7" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="872,81,955,108"/><area shape="rect" id="node8" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1003,5,1109,32"/><area shape="rect" id="node9" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1030,56,1082,83"/><area shape="rect" id="node10" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1031,107,1081,133"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1019,157,1093,184"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1157,157,1208,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6fa028eb320bf09ecd619c5053580436"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void do_net_crypto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02497">2497</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01851">do_tcp()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02460">kill_timedout()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02042">send_crypto_packets()</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02280">do_messenger()</a>.</p>
<div class="fragment"><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;{</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <a class="code" href="../../d8/dc6/net__crypto_8c.html#acb48e059ed89d52de983ac4c59fcde06">kill_timedout</a>(c);</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <a class="code" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3">do_tcp</a>(c);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <a class="code" href="../../d8/dc6/net__crypto_8c.html#ad0fc252748fecbb499c4b01706476a77">send_crypto_packets</a>(c);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;}</div>
<div class="ttc" id="net__crypto_8c_html_ad0fc252748fecbb499c4b01706476a77"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#ad0fc252748fecbb499c4b01706476a77">send_crypto_packets</a></div><div class="ttdeci">static void send_crypto_packets(Net_Crypto *c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l02042">net_crypto.c:2042</a></div></div>
<div class="ttc" id="net__crypto_8c_html_adf499e22f45244e3660f9da6de77d2a3"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3">do_tcp</a></div><div class="ttdeci">static void do_tcp(Net_Crypto *c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01851">net_crypto.c:1851</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
<div class="ttc" id="net__crypto_8c_html_acb48e059ed89d52de983ac4c59fcde06"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#acb48e059ed89d52de983ac4c59fcde06">kill_timedout</a></div><div class="ttdeci">static void kill_timedout(Net_Crypto *c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l02460">net_crypto.c:2460</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_cgraph" id="de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#adf499e22f45244e3660f9da6de77d2a3" title="do_tcp" alt="" coords="920,892,981,918"/><area shape="rect" id="node16" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="1753,993,1877,1020"/><area shape="rect" id="node30" href="../../d8/dc6/net__crypto_8c.html#acb48e059ed89d52de983ac4c59fcde06" title="kill_timedout" alt="" coords="157,1804,252,1830"/><area shape="rect" id="node44" href="../../d8/dc6/net__crypto_8c.html#ad0fc252748fecbb499c4b01706476a77" title="send_crypto_packets" alt="" coords="456,1246,603,1273"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="1488,892,1659,918"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1739,1525,1892,1552"/><area shape="rect" id="node11" href="../../d5/d26/_t_c_p__connection_8c.html#a30c1a9c57a8d07cc2327c0505d6619a4" title="do_tcp_connections" alt="" coords="1096,442,1235,469"/><area shape="rect" id="node29" href="../../d5/d26/_t_c_p__connection_8c.html#a0c7079221df3e2f827e6ec1aaac597e6" title="set_tcp_connection\l_to_status" alt="" coords="1748,708,1883,750"/><area shape="rect" id="node6" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1731,927,1900,968"/><area shape="rect" id="node10" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1776,353,1855,380"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1970,1758,2109,1799"/><area shape="rect" id="node7" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1984,745,2095,772"/><area shape="rect" id="node9" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="1964,927,2115,968"/><area shape="rect" id="node8" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="2180,738,2323,779"/><area shape="rect" id="node12" href="../../d5/d26/_t_c_p__connection_8c.html#a6377f0f3d60ba706c5b014a9439696b7" title="do_tcp_conns" alt="" coords="1309,442,1412,469"/><area shape="rect" id="node28" href="../../d5/d26/_t_c_p__connection_8c.html#a49dd47efa4f43cd5ba37a4836c6e55ff" title="kill_nonused_tcp" alt="" coords="1301,366,1420,393"/><area shape="rect" id="node13" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1972,581,2107,608"/><area shape="rect" id="node15" href="../../da/da1/_t_c_p__client_8c.html#a3333858c51935f9f546cf923b07ed845" title="do_TCP_connection" alt="" coords="1503,294,1643,321"/><area shape="rect" id="node22" href="../../d5/d26/_t_c_p__connection_8c.html#a81963b2aeca3eb88b3fea76869b19fad" title="reconnect_tcp_relay\l_connection" alt="" coords="1504,607,1643,648"/><area shape="rect" id="node23" href="../../d5/d26/_t_c_p__connection_8c.html#aa2768924d23efbf6770245379d89da4c" title="kill_tcp_relay_connection" alt="" coords="1731,556,1899,582"/><area shape="rect" id="node24" href="../../d5/d26/_t_c_p__connection_8c.html#a52486c51f2c9e789893e71611dc2a188" title="tcp_relay_on_online" alt="" coords="1505,404,1642,430"/><area shape="rect" id="node25" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="1532,353,1615,380"/><area shape="rect" id="node26" href="../../d5/d26/_t_c_p__connection_8c.html#ac91d3707f1b16a4a9e0f6d4d70cdee14" title="sleep_tcp_relay_connection" alt="" coords="1724,657,1907,684"/><area shape="rect" id="node27" href="../../d5/d26/_t_c_p__connection_8c.html#a359cec296ed123fc92b9b149266b30a4" title="unsleep_tcp_relay_connection" alt="" coords="1475,454,1672,481"/><area shape="rect" id="node14" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="2168,574,2335,615"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1748,118,1883,145"/><area shape="rect" id="node19" href="../../da/da1/_t_c_p__client_8c.html#a39080f686c09274aa55d7b352fcadd56" title="proxy_http_read_connection\l_response" alt="" coords="1723,170,1908,211"/><area shape="rect" id="node20" href="../../da/da1/_t_c_p__client_8c.html#aec632a758fda6b73153ec16180750366" title="generate_handshake" alt="" coords="1744,236,1887,262"/><area shape="rect" id="node21" href="../../da/da1/_t_c_p__client_8c.html#ada9457c0effffd236ca9c4a004ee8942" title="socks5_read_handshake\l_response" alt="" coords="1732,287,1899,328"/><area shape="rect" id="node17" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="1959,1069,2120,1096"/><area shape="rect" id="node31" href="../../d8/dc6/net__crypto_8c.html#ac679d5f08189ac10b3eca22c3f032dbc" title="connection_kill" alt="" coords="300,1804,408,1830"/><area shape="rect" id="node32" href="../../d8/dc6/net__crypto_8c.html#a16c3a0008512675dad8eb00ff1822763" title="crypto_kill" alt="" coords="489,1728,570,1754"/><area shape="rect" id="node33" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f" title="bs_list_remove" alt="" coords="679,1804,789,1830"/><area shape="rect" id="node34" href="../../d8/dc6/net__crypto_8c.html#ae690bbce7d008eda1142ceaf0673e672" title="clear_buffer" alt="" coords="689,1702,779,1729"/><area shape="rect" id="node35" href="../../d8/dc6/net__crypto_8c.html#a6e6c3107cf48ec1c5087d3780a03ad0c" title="clear_temp_packet" alt="" coords="1295,1728,1427,1754"/><area shape="rect" id="node36" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d" title="kill_tcp_connection_to" alt="" coords="1740,825,1891,852"/><area shape="rect" id="node37" href="../../d8/dc6/net__crypto_8c.html#aef6ea83ebc4f62428b09ee74441f6f4b" title="send_kill_packet" alt="" coords="675,1601,793,1628"/><area shape="rect" id="node43" href="../../d8/dc6/net__crypto_8c.html#a7be52b4dc75558fc64e9e017ea67f1d0" title="wipe_crypto_connection" alt="" coords="1084,1905,1247,1932"/><area shape="rect" id="node38" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="865,1449,1036,1476"/><area shape="rect" id="node39" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="1101,1449,1229,1476"/><area shape="rect" id="node40" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="1303,1272,1418,1298"/><area shape="rect" id="node41" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="1720,876,1911,902"/><area shape="rect" id="node42" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="1529,1246,1618,1273"/><area shape="rect" id="node45" href="../../d8/dc6/net__crypto_8c.html#abbe1101e6464100c19aea7cde5c1d3a0" title="num_packets_array" alt="" coords="883,1145,1019,1172"/><area shape="rect" id="node46" href="../../d8/dc6/net__crypto_8c.html#a31370353b1f1c90c8fb06ae736be1a0d" title="send_request_packet" alt="" coords="661,1424,807,1450"/><area shape="rect" id="node48" href="../../d8/dc6/net__crypto_8c.html#ac64daefe87866ea116735f3540be3092" title="send_requested_packets" alt="" coords="651,1246,817,1273"/><area shape="rect" id="node50" href="../../d8/dc6/net__crypto_8c.html#ae0a00f5fe1955d7d15af11eacc20997b" title="send_temp_packet" alt="" coords="1099,1285,1231,1312"/><area shape="rect" id="node47" href="../../d8/dc6/net__crypto_8c.html#ae4bed66c607b0d067e9b83dbf718d1f7" title="generate_request_packet" alt="" coords="867,1398,1035,1425"/><area shape="rect" id="node49" href="../../d8/dc6/net__crypto_8c.html#a1e36bfc22078fc52c29d90e8ab79295d" title="get_data_pointer" alt="" coords="891,1246,1010,1273"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_icgraph" id="de/d42/net__crypto_8h_a6fa028eb320bf09ecd619c5053580436_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="157,56,264,83"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="328,31,379,57"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="312,81,395,108"/><area shape="rect" id="node5" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="443,5,549,32"/><area shape="rect" id="node6" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="470,56,522,83"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="471,107,521,133"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="459,157,533,184"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="597,157,648,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad1a4103f75eb81ae93a0f1701b259db0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_random_tcp_con_number </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01810">1810</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00285">get_random_tcp_onion_conn_number()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../db/d79/onion__client_8c_source.html#l00126">random_nodes_path_onion()</a>.</p>
<div class="fragment"><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;{</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a84992bb55c148bb9f7a1b442d255865f">get_random_tcp_onion_conn_number</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a84992bb55c148bb9f7a1b442d255865f"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a84992bb55c148bb9f7a1b442d255865f">get_random_tcp_onion_conn_number</a></div><div class="ttdeci">int get_random_tcp_onion_conn_number(TCP_Connections *tcp_c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00285">TCP_connection.c:285</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_cgraph" id="de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_cgraph">
<area shape="rect" id="node2" href="../../d5/d26/_t_c_p__connection_8c.html#a84992bb55c148bb9f7a1b442d255865f" title="get_random_tcp_onion\l_conn_number" alt="" coords="196,5,349,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_icgraph" id="de/d42/net__crypto_8h_ad1a4103f75eb81ae93a0f1701b259db0_icgraph">
<area shape="rect" id="node2" href="../../db/d79/onion__client_8c.html#a62aaed2b6aee07c4c0fb8ffd97a03172" title="random_nodes_path_onion" alt="" coords="196,161,373,188"/><area shape="rect" id="node3" href="../../db/d79/onion__client_8c.html#a0ec6065dac34021e69682691f70b667c" title="random_path" alt="" coords="421,161,519,188"/><area shape="rect" id="node4" href="../../db/d79/onion__client_8c.html#a4253f1739f978c9aac584c97b7a55f48" title="client_send_announce\l_request" alt="" coords="567,114,717,155"/><area shape="rect" id="node30" href="../../d9/d26/onion__client_8h.html#aa1be42b5ea93bd068f47271831157927" title="send_onion_data" alt="" coords="582,201,702,228"/><area shape="rect" id="node5" href="../../db/d79/onion__client_8c.html#a934df896ad375a9dbd82f563fb27144f" title="client_ping_nodes" alt="" coords="778,49,905,76"/><area shape="rect" id="node20" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="1019,151,1094,177"/><area shape="rect" id="node29" href="../../db/d79/onion__client_8c.html#ae37f00e2304222b24cef2cce370e58d3" title="do_announce" alt="" coords="792,100,891,127"/><area shape="rect" id="node6" href="../../db/d79/onion__client_8c.html#acef82e3853e62dce8cd45450ff028f97" title="handle_announce_response" alt="" coords="965,49,1148,76"/><area shape="rect" id="node7" href="../../db/d79/onion__client_8c.html#a3519dd95525df398b46b0e4a928f54f0" title="handle_tcp_onion" alt="" coords="1196,24,1319,51"/><area shape="rect" id="node8" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="1367,63,1489,89"/><area shape="rect" id="node9" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1551,56,1641,83"/><area shape="rect" id="node11" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1537,157,1655,184"/><area shape="rect" id="node10" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1703,56,1809,83"/><area shape="rect" id="node12" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1731,157,1781,184"/><area shape="rect" id="node13" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1721,107,1791,133"/><area shape="rect" id="node14" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1857,56,1964,83"/><area shape="rect" id="node15" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1879,5,1943,32"/><area shape="rect" id="node17" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1871,157,1950,184"/><area shape="rect" id="node19" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1885,107,1936,133"/><area shape="rect" id="node16" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2012,56,2063,83"/><area shape="rect" id="node18" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2012,208,2063,235"/><area shape="rect" id="node21" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="1201,141,1313,168"/><area shape="rect" id="node22" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="1387,123,1469,149"/><area shape="rect" id="node23" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1375,252,1481,279"/><area shape="rect" id="node24" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1571,303,1621,329"/><area shape="rect" id="node25" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1715,259,1797,285"/><area shape="rect" id="node26" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1857,360,1964,387"/><area shape="rect" id="node27" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1885,309,1937,336"/><area shape="rect" id="node28" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1874,259,1947,285"/><area shape="rect" id="node31" href="../../d0/d08/friend__connection_8h.html#a2af492c22c086276ed147d0826839d25" title="send_friend_request\l_packet" alt="" coords="987,245,1126,286"/><area shape="rect" id="node33" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="765,201,917,228"/><area shape="rect" id="node32" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="1216,252,1299,279"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abb3546495adde3f08c0474f31c5d3a37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kill_net_crypto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02505">2505</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d7/d40/list_8c_source.html#l00158">bs_list_free()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00184">Net_Crypto::connections_mutex</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00187">Net_Crypto::crypto_connections_length</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02323">crypto_kill()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00178">Net_Crypto::dht</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00202">Net_Crypto::ip_port_list</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01352">kill_tcp_connections()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT::net</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00101">NET_PACKET_COOKIE_REQUEST</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00102">NET_PACKET_COOKIE_RESPONSE</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00104">NET_PACKET_CRYPTO_DATA</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00103">NET_PACKET_CRYPTO_HS</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00409">networking_registerhandler()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01848">kill_messenger()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00294">kill_onions()</a>, and <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01751">new_messenger()</a>.</p>
<div class="fragment"><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;{</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a9c91c3c65885a2bd39d0f864b9a5ddb9">crypto_connections_length</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        <a class="code" href="../../d8/dc6/net__crypto_8c.html#a16c3a0008512675dad8eb00ff1822763">crypto_kill</a>(c, i);</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    }</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    pthread_mutex_destroy(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    pthread_mutex_destroy(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a6938788005ebe33a896755ac2b9f501a">kill_tcp_connections</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <a class="code" href="../../d7/d40/list_8c.html#a20f4503183113923cd946fc04bf8f2b4">bs_list_free</a>(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">ip_port_list</a>);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">dht</a>-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a3ad6d83af0ed67a84b327df50d66229c">NET_PACKET_COOKIE_REQUEST</a>, NULL, NULL);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">dht</a>-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a1162e12ce54e50cb3744e2cf69553565">NET_PACKET_COOKIE_RESPONSE</a>, NULL, NULL);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">dht</a>-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#ae4ba32f7f36e935bd3a56b5e90299857">NET_PACKET_CRYPTO_HS</a>, NULL, NULL);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">dht</a>-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#abd68cd32dfdf6a1e0407967df0c10a9e">NET_PACKET_CRYPTO_DATA</a>, NULL, NULL);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    memset(c, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a>));</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    free(c);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_a9c91c3c65885a2bd39d0f864b9a5ddb9"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a9c91c3c65885a2bd39d0f864b9a5ddb9">Net_Crypto::crypto_connections_length</a></div><div class="ttdeci">uint32_t crypto_connections_length</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00187">net_crypto.h:187</a></div></div>
<div class="ttc" id="network_8h_html_abd68cd32dfdf6a1e0407967df0c10a9e"><div class="ttname"><a href="../../d9/d94/network_8h.html#abd68cd32dfdf6a1e0407967df0c10a9e">NET_PACKET_CRYPTO_DATA</a></div><div class="ttdeci">#define NET_PACKET_CRYPTO_DATA</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00104">network.h:104</a></div></div>
<div class="ttc" id="list_8c_html_a20f4503183113923cd946fc04bf8f2b4"><div class="ttname"><a href="../../d7/d40/list_8c.html#a20f4503183113923cd946fc04bf8f2b4">bs_list_free</a></div><div class="ttdeci">void bs_list_free(BS_LIST *list)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00158">list.c:158</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a8b3d6ce8745acc52695e252bdb1531b6"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">Net_Crypto::dht</a></div><div class="ttdeci">DHT * dht</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00178">net_crypto.h:178</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a6938788005ebe33a896755ac2b9f501a"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a6938788005ebe33a896755ac2b9f501a">kill_tcp_connections</a></div><div class="ttdeci">void kill_tcp_connections(TCP_Connections *tcp_c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01352">TCP_connection.c:1352</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa14ea2f67950f57fe4235d7375a2216c"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">DHT::net</a></div><div class="ttdeci">Networking_Core * net</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT.h:201</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a213135bf3b5b80b1cfe99b27dc42815e"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">Net_Crypto::connections_mutex</a></div><div class="ttdeci">pthread_mutex_t connections_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00184">net_crypto.h:184</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="network_8h_html_a3ad6d83af0ed67a84b327df50d66229c"><div class="ttname"><a href="../../d9/d94/network_8h.html#a3ad6d83af0ed67a84b327df50d66229c">NET_PACKET_COOKIE_REQUEST</a></div><div class="ttdeci">#define NET_PACKET_COOKIE_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00101">network.h:101</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a16c3a0008512675dad8eb00ff1822763"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a16c3a0008512675dad8eb00ff1822763">crypto_kill</a></div><div class="ttdeci">int crypto_kill(Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l02323">net_crypto.c:2323</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae8cfe94df9c9030bbc525010603450ac"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">Net_Crypto::ip_port_list</a></div><div class="ttdeci">BS_LIST ip_port_list</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00202">net_crypto.h:202</a></div></div>
<div class="ttc" id="network_8c_html_a230a192ca9463ec4985d4f86de439733"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a></div><div class="ttdeci">void networking_registerhandler(Networking_Core *net, uint8_t byte, packet_handler_callback cb, void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00409">network.c:409</a></div></div>
<div class="ttc" id="struct_net___crypto_html"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html">Net_Crypto</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00177">net_crypto.h:177</a></div></div>
<div class="ttc" id="network_8h_html_ae4ba32f7f36e935bd3a56b5e90299857"><div class="ttname"><a href="../../d9/d94/network_8h.html#ae4ba32f7f36e935bd3a56b5e90299857">NET_PACKET_CRYPTO_HS</a></div><div class="ttdeci">#define NET_PACKET_CRYPTO_HS</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00103">network.h:103</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
<div class="ttc" id="network_8h_html_a1162e12ce54e50cb3744e2cf69553565"><div class="ttname"><a href="../../d9/d94/network_8h.html#a1162e12ce54e50cb3744e2cf69553565">NET_PACKET_COOKIE_RESPONSE</a></div><div class="ttdeci">#define NET_PACKET_COOKIE_RESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00102">network.h:102</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_cgraph" id="de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_cgraph">
<area shape="rect" id="node2" href="../../d7/d40/list_8c.html#a20f4503183113923cd946fc04bf8f2b4" title="bs_list_free" alt="" coords="204,351,293,377"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a16c3a0008512675dad8eb00ff1822763" title="crypto_kill" alt="" coords="208,401,289,428"/><area shape="rect" id="node41" href="../../d5/d26/_t_c_p__connection_8c.html#a6938788005ebe33a896755ac2b9f501a" title="kill_tcp_connections" alt="" coords="179,452,319,479"/><area shape="rect" id="node45" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733" title="networking_registerhandler" alt="" coords="160,503,337,529"/><area shape="rect" id="node4" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f" title="bs_list_remove" alt="" coords="411,312,522,339"/><area shape="rect" id="node7" href="../../d8/dc6/net__crypto_8c.html#ae690bbce7d008eda1142ceaf0673e672" title="clear_buffer" alt="" coords="421,160,512,187"/><area shape="rect" id="node8" href="../../d8/dc6/net__crypto_8c.html#a6e6c3107cf48ec1c5087d3780a03ad0c" title="clear_temp_packet" alt="" coords="815,547,947,573"/><area shape="rect" id="node9" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1405,515,1558,541"/><area shape="rect" id="node11" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d" title="kill_tcp_connection_to" alt="" coords="1177,144,1328,171"/><area shape="rect" id="node25" href="../../d8/dc6/net__crypto_8c.html#aef6ea83ebc4f62428b09ee74441f6f4b" title="send_kill_packet" alt="" coords="407,477,526,504"/><area shape="rect" id="node39" href="../../d8/dc6/net__crypto_8c.html#a7be52b4dc75558fc64e9e017ea67f1d0" title="wipe_crypto_connection" alt="" coords="385,667,548,693"/><area shape="rect" id="node5" href="../../d7/d40/list_8c.html#ae2aaa4149a770ed6e47a58af78fc6600" title="find" alt="" coords="660,312,703,339"/><area shape="rect" id="node6" href="../../d7/d40/list_8c.html#a7c246868ee5a3542509cdf90379c5bb2" title="resize" alt="" coords="653,261,710,288"/><area shape="rect" id="node10" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1641,539,1779,581"/><area shape="rect" id="node12" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1655,211,1765,237"/><area shape="rect" id="node14" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1414,144,1549,171"/><area shape="rect" id="node16" href="../../da/da1/_t_c_p__client_8c.html#af83d9fac2256a46428ad95bf337c05b7" title="send_disconnect_request" alt="" coords="1396,93,1567,120"/><area shape="rect" id="node24" href="../../d5/d26/_t_c_p__connection_8c.html#a10a5b3ddc6f1bfa7785301f33c369695" title="wipe_connection" alt="" coords="1651,43,1769,69"/><area shape="rect" id="node13" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="1870,123,2013,165"/><area shape="rect" id="node15" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1627,145,1793,186"/><area shape="rect" id="node17" href="../../da/da1/_t_c_p__client_8c.html#abe305661e19883349d213c74c44ff93f" title="send_disconnect_notification" alt="" coords="1615,93,1805,120"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1853,305,2029,346"/><area shape="rect" id="node19" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="2093,337,2227,364"/><area shape="rect" id="node21" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="2077,501,2243,528"/><area shape="rect" id="node22" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="2099,115,2221,141"/><area shape="rect" id="node23" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="2115,287,2205,313"/><area shape="rect" id="node20" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="2291,337,2492,364"/><area shape="rect" id="node26" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="596,477,767,504"/><area shape="rect" id="node27" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="817,477,945,504"/><area shape="rect" id="node28" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="995,413,1109,440"/><area shape="rect" id="node29" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="1167,312,1338,339"/><area shape="rect" id="node33" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="1157,261,1348,288"/><area shape="rect" id="node38" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="1208,413,1297,440"/><area shape="rect" id="node30" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1397,398,1566,439"/><area shape="rect" id="node32" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1442,464,1521,491"/><area shape="rect" id="node31" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="1635,465,1785,506"/><area shape="rect" id="node34" href="../../da/da1/_t_c_p__client_8c.html#aea842652030d00bd8302e3c0201f95b9" title="send_data" alt="" coords="1440,296,1523,323"/><area shape="rect" id="node37" href="../../da/da1/_t_c_p__client_8c.html#a7818a314434c2bb01c3ea406744f076b" title="send_oob_packet" alt="" coords="1419,347,1543,373"/><area shape="rect" id="node35" href="../../da/da1/_t_c_p__client_8c.html#a8e1ca90aa8db34a58b3b38cfcb1bb9de" title="send_ping_response" alt="" coords="1639,363,1781,389"/><area shape="rect" id="node36" href="../../da/da1/_t_c_p__client_8c.html#a5aad81831c1333b763c9fd5eaf41603f" title="send_ping_request" alt="" coords="1645,261,1775,288"/><area shape="rect" id="node40" href="../../d8/dc6/net__crypto_8c.html#ab0b745274346dc3464e35fcd756db0d2" title="realloc_cryptoconnection" alt="" coords="598,667,765,693"/><area shape="rect" id="node42" href="../../da/da1/_t_c_p__client_8c.html#a437ba55ccf24fb881acf298f3e225a63" title="kill_TCP_connection" alt="" coords="395,768,538,795"/><area shape="rect" id="node43" href="../../da/da1/_t_c_p__client_8c.html#aaf4385f749c6f9c21f4f4ac17b31a77b" title="wipe_priority_list" alt="" coords="622,768,741,795"/><area shape="rect" id="node44" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="645,819,718,845"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_icgraph" id="de/d42/net__crypto_8h_abb3546495adde3f08c0474f31c5d3a37_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#a771c65c3057d870b0653c2fdf0a12fb7" title="kill_messenger" alt="" coords="164,95,273,121"/><area shape="rect" id="node12" href="../../d7/dd9/onion__test_8c.html#a11b4d3c94243b8abdd439dea94ee679e" title="kill_onions" alt="" coords="177,157,260,184"/><area shape="rect" id="node14" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="160,44,277,71"/><area shape="rect" id="node3" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="353,31,404,57"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#a52259e134bfb9396d9fef4fffe94e878" title="tox_kill" alt="" coords="347,132,410,159"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="343,81,414,108"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="480,5,587,32"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="501,56,565,83"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="494,107,573,133"/><area shape="rect" id="node11" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="508,157,559,184"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="635,56,685,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="635,107,685,133"/><area shape="rect" id="node13" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="325,183,432,209"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac8131842eafef1819a6e6da5404e3234"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_secret_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02405">2405</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00190">Net_Crypto::self_public_key</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00191">Net_Crypto::self_secret_key</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02648">messenger_load_state_callback()</a>, and <a class="el" href="../../d3/d69/tox_8c_source.html#l00124">tox_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;{</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    memcpy(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>, sk, crypto_box_SECRETKEYBYTES);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    crypto_scalarmult_curve25519_base(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>, c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>);</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">Net_Crypto::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00191">net_crypto.h:191</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae726df8bdc26380e5a6c3187a00d6881"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae726df8bdc26380e5a6c3187a00d6881">Net_Crypto::self_public_key</a></div><div class="ttdeci">uint8_t self_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00190">net_crypto.h:190</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ac8131842eafef1819a6e6da5404e3234_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ac8131842eafef1819a6e6da5404e3234_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ac8131842eafef1819a6e6da5404e3234_icgraph" id="de/d42/net__crypto_8h_ac8131842eafef1819a6e6da5404e3234_icgraph">
<area shape="rect" id="node2" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="171,43,324,85"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="555,108,626,135"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="372,52,489,79"/><area shape="rect" id="node4" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="565,5,616,32"/><area shape="rect" id="node5" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="537,56,644,83"/><area shape="rect" id="node7" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="692,32,799,59"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="713,83,777,109"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="706,133,785,160"/><area shape="rect" id="node12" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="720,184,771,211"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="847,83,897,109"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="847,133,897,160"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac2a5448ebee4fd4f8fd32cc7e3ac69c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Bool max_speed_reached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02188">2188</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00791">reset_max_speed_reached()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01404">do_reqchunk_filecb()</a>.</p>
<div class="fragment"><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;{</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/dc6/net__crypto_8c.html#abb8a6ea2bdfb75eb366cc0a026649e2c">reset_max_speed_reached</a>(c, crypt_connection_id) != 0;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;}</div>
<div class="ttc" id="net__crypto_8c_html_abb8a6ea2bdfb75eb366cc0a026649e2c"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#abb8a6ea2bdfb75eb366cc0a026649e2c">reset_max_speed_reached</a></div><div class="ttdeci">static int reset_max_speed_reached(Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00791">net_crypto.c:791</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_cgraph" id="de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#abb8a6ea2bdfb75eb366cc0a026649e2c" title="reset_max_speed_reached" alt="" coords="196,81,375,108"/><area shape="rect" id="node3" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="427,5,589,32"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1227,107,1380,133"/><area shape="rect" id="node6" href="../../d8/dc6/net__crypto_8c.html#a1e36bfc22078fc52c29d90e8ab79295d" title="get_data_pointer" alt="" coords="449,157,567,184"/><area shape="rect" id="node7" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="423,107,593,133"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1450,87,1589,129"/><area shape="rect" id="node8" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="641,233,769,260"/><area shape="rect" id="node9" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1875,528,2040,555"/><area shape="rect" id="node10" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="1897,584,2018,611"/><area shape="rect" id="node11" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="817,233,932,260"/><area shape="rect" id="node12" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="990,259,1161,285"/><area shape="rect" id="node18" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="980,336,1171,363"/><area shape="rect" id="node29" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="1031,208,1120,235"/><area shape="rect" id="node13" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1219,169,1388,210"/><area shape="rect" id="node17" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1264,235,1343,261"/><area shape="rect" id="node14" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1464,219,1575,245"/><area shape="rect" id="node16" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="1444,153,1595,194"/><area shape="rect" id="node15" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="1667,211,1810,253"/><area shape="rect" id="node19" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1236,336,1371,363"/><area shape="rect" id="node21" href="../../da/da1/_t_c_p__client_8c.html#aea842652030d00bd8302e3c0201f95b9" title="send_data" alt="" coords="1262,387,1345,413"/><area shape="rect" id="node28" href="../../da/da1/_t_c_p__client_8c.html#a7818a314434c2bb01c3ea406744f076b" title="send_oob_packet" alt="" coords="1241,463,1365,489"/><area shape="rect" id="node20" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1436,270,1603,311"/><area shape="rect" id="node22" href="../../da/da1/_t_c_p__client_8c.html#a8e1ca90aa8db34a58b3b38cfcb1bb9de" title="send_ping_response" alt="" coords="1449,336,1590,363"/><area shape="rect" id="node23" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1651,435,1827,477"/><area shape="rect" id="node27" href="../../da/da1/_t_c_p__client_8c.html#a5aad81831c1333b763c9fd5eaf41603f" title="send_ping_request" alt="" coords="1454,387,1585,413"/><area shape="rect" id="node24" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1890,421,2025,448"/><area shape="rect" id="node26" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="1913,472,2002,499"/><area shape="rect" id="node25" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="2088,421,2289,448"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_icgraph" id="de/d42/net__crypto_8h_ac2a5448ebee4fd4f8fd32cc7e3ac69c0_icgraph">
<area shape="rect" id="node2" href="../../d8/d8d/_messenger_8c.html#a74c09bcf488256da7b3ed899f541fc8c" title="do_reqchunk_filecb" alt="" coords="196,56,331,83"/><area shape="rect" id="node3" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="379,56,461,83"/><area shape="rect" id="node4" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="509,56,616,83"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="680,31,731,57"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="664,81,747,108"/><area shape="rect" id="node7" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="795,5,901,32"/><area shape="rect" id="node8" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="822,56,874,83"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="823,107,873,133"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="811,157,885,184"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="949,157,1000,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92ed6dc36b6e6996387b7542fc2580fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nc_dht_pk_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *data, int32_t number, const uint8_t *dht_public_key)&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01961">1961</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00162">Crypto_Connection::dht_pk_callback</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00164">Crypto_Connection::dht_pk_callback_number</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00163">Crypto_Connection::dht_pk_callback_object</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00493">friend_new_connection()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00453">handle_new_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;{</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab0f780a41ece58bf84d8460e71cbdbb3">dht_pk_callback</a> = <span class="keyword">function</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab5d618d73b8d83fb07209433e7b448ee">dht_pk_callback_object</a> = object;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab0413da421baacf312141b8ae3ec7762">dht_pk_callback_number</a> = number;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;}</div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ab0413da421baacf312141b8ae3ec7762"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ab0413da421baacf312141b8ae3ec7762">Crypto_Connection::dht_pk_callback_number</a></div><div class="ttdeci">uint32_t dht_pk_callback_number</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00164">net_crypto.h:164</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ab0f780a41ece58bf84d8460e71cbdbb3"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ab0f780a41ece58bf84d8460e71cbdbb3">Crypto_Connection::dht_pk_callback</a></div><div class="ttdeci">void(* dht_pk_callback)(void *data, int32_t number, const uint8_t *dht_public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00162">net_crypto.h:162</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ab5d618d73b8d83fb07209433e7b448ee"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ab5d618d73b8d83fb07209433e7b448ee">Crypto_Connection::dht_pk_callback_object</a></div><div class="ttdeci">void * dht_pk_callback_object</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00163">net_crypto.h:163</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_cgraph" id="de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="191,13,344,39"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="392,5,531,47"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_icgraph" id="de/d42/net__crypto_8h_a92ed6dc36b6e6996387b7542fc2580fa_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="191,148,345,175"/><area shape="rect" id="node6" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="916,243,1084,269"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="413,211,525,237"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="752,153,868,180"/><area shape="rect" id="node42" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="393,15,545,41"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="593,211,704,237"/><area shape="rect" id="node17" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="923,172,1077,199"/><area shape="rect" id="node41" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="939,121,1061,148"/><area shape="rect" id="node7" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1132,343,1295,369"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1363,461,1480,488"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1596,461,1647,488"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2209,360,2280,387"/><area shape="rect" id="node11" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2375,360,2481,387"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2396,208,2460,235"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2389,309,2467,336"/><area shape="rect" id="node16" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2403,259,2453,285"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2529,157,2580,184"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2529,233,2580,260"/><area shape="rect" id="node18" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1146,121,1281,148"/><area shape="rect" id="node24" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1159,191,1268,217"/><area shape="rect" id="node19" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1368,87,1475,113"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="2203,56,2286,83"/><area shape="rect" id="node21" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2375,5,2481,32"/><area shape="rect" id="node22" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2402,56,2454,83"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2391,157,2465,184"/><area shape="rect" id="node25" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1375,191,1468,217"/><area shape="rect" id="node34" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1343,335,1500,361"/><area shape="rect" id="node26" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1563,259,1679,285"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2219,208,2270,235"/><area shape="rect" id="node31" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1548,208,1695,235"/><area shape="rect" id="node33" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="2191,157,2298,184"/><area shape="rect" id="node27" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1743,310,1896,351"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1971,301,2088,328"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="2191,259,2298,285"/><area shape="rect" id="node32" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1794,208,1845,235"/><area shape="rect" id="node35" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1559,309,1683,336"/><area shape="rect" id="node36" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1771,259,1868,285"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1944,427,2115,453"/><area shape="rect" id="node38" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="2169,411,2320,437"/><area shape="rect" id="node39" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="2163,461,2327,488"/><area shape="rect" id="node40" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2375,461,2481,488"/><area shape="rect" id="node43" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1976,56,2083,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adaa8cd47d0ede85ca13626e91d2e995d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void new_connection_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *object, <a class="el" href="../../d7/dc9/struct_new___connection.html">New_Connection</a> *n_c)&#160;</td>
          <td class="paramname"><em>new_connection_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01502">1502</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00196">Net_Crypto::new_connection_callback</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00197">Net_Crypto::new_connection_callback_object</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00761">new_friend_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;{</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a4e2c131b4a4b4ccb2acc140c29c628be">new_connection_callback</a> = new_connection_callback;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#af28bac95ede5cab8426b07e02dd1a1b0">new_connection_callback_object</a> = object;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_a4e2c131b4a4b4ccb2acc140c29c628be"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a4e2c131b4a4b4ccb2acc140c29c628be">Net_Crypto::new_connection_callback</a></div><div class="ttdeci">int(* new_connection_callback)(void *object, New_Connection *n_c)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00196">net_crypto.h:196</a></div></div>
<div class="ttc" id="struct_net___crypto_html_af28bac95ede5cab8426b07e02dd1a1b0"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#af28bac95ede5cab8426b07e02dd1a1b0">Net_Crypto::new_connection_callback_object</a></div><div class="ttdeci">void * new_connection_callback_object</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00197">net_crypto.h:197</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_adaa8cd47d0ede85ca13626e91d2e995d_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_adaa8cd47d0ede85ca13626e91d2e995d_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_adaa8cd47d0ede85ca13626e91d2e995d_icgraph" id="de/d42/net__crypto_8h_adaa8cd47d0ede85ca13626e91d2e995d_icgraph">
<area shape="rect" id="node2" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="219,56,381,83"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="429,56,547,83"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="605,31,655,57"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="595,81,665,108"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="713,5,820,32"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="735,56,799,83"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="727,107,806,133"/><area shape="rect" id="node11" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="741,157,792,184"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="868,56,919,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="868,107,919,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae09413aa94644bc88bf73b88f48ef814"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int new_crypto_connection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>real_public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>dht_public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01623">1623</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00156">Crypto_Connection::connection_number_tcp</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00056">COOKIE_REQUEST_LENGTH</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00113">Crypto_Connection::cookie_request_number</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00067">create_cookie_request()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01375">create_crypto_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00033">CRYPTO_CONN_COOKIE_REQUESTING</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00032">CRYPTO_CONN_NO_CONNECTION</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00181">Net_Crypto::crypto_connections</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00045">CRYPTO_MIN_QUEUE_LENGTH</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00042">CRYPTO_PACKET_MIN_RATE</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00086">DEFAULT_PING_CONNECTION</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00114">Crypto_Connection::dht_public_key</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01449">getcryptconnection_id()</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00455">kill_tcp_connection_to()</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00433">new_tcp_connection_to()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01003">new_temp_packet()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00145">Crypto_Connection::packet_send_rate</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00146">Crypto_Connection::packets_left</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00101">Crypto_Connection::public_key</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00053">random_64b()</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00176">random_nonce()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00153">Crypto_Connection::rtt_time</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00103">Crypto_Connection::sent_nonce</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00104">Crypto_Connection::sessionpublic_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00105">Crypto_Connection::sessionsecret_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00107">Crypto_Connection::shared_key</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00108">Crypto_Connection::status</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00493">friend_new_connection()</a>.</p>
<div class="fragment"><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;{</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordtype">int</span> crypt_connection_id = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257">getcryptconnection_id</a>(c, real_public_key);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">if</span> (crypt_connection_id != -1)</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="keywordflow">return</span> crypt_connection_id;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    crypt_connection_id = <a class="code" href="../../d8/dc6/net__crypto_8c.html#aed34560fc11f32d1b280d00152655b9b">create_crypto_connection</a>(c);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keywordflow">if</span> (crypt_connection_id == -1)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = &amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a13fdc865b8a114466ba136f5390ec1b2">crypto_connections</a>[crypt_connection_id];</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordtype">int</span> connection_number_tcp = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a22c797c7e0ef3ad66e171f05b1cb52bd">new_tcp_connection_to</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, dht_public_key, crypt_connection_id);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span> (connection_number_tcp == -1)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a> = connection_number_tcp;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    memcpy(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, real_public_key, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7">random_nonce</a>(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a9df0e00e8f493ed6cd1ff45e7da33c0d">sent_nonce</a>);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    crypto_box_keypair(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a6e74fbae398c7966800ee80f7b93dbfa">sessionpublic_key</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a5f38fc9ff1b20b61ffbb56d9e7f5c892">sessionsecret_key</a>);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#a3982349ee55b611d39ef3014e739e403">CRYPTO_CONN_COOKIE_REQUESTING</a>;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a8358768a02871910ed059b1b2646438e">packet_send_rate</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ab329443d2f5643d95e6034542fcb82f3">CRYPTO_PACKET_MIN_RATE</a>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">packets_left</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ab0d2e7f3b3f18b516bb0a512c91b2914">CRYPTO_MIN_QUEUE_LENGTH</a>;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ae88ec876060fbc648a4c75ac596137f9">rtt_time</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#aa737ddb8e565b8959c9d30398907026e">DEFAULT_PING_CONNECTION</a>;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    memcpy(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">dht_public_key</a>, dht_public_key, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#acb77d5443961bf245b63c17347b1b030">cookie_request_number</a> = <a class="code" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e">random_64b</a>();</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    uint8_t cookie_request[<a class="code" href="../../d8/dc6/net__crypto_8c.html#a25d19522f8fdd8da8932746bcf11e8aa">COOKIE_REQUEST_LENGTH</a>];</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/dc6/net__crypto_8c.html#a5b67a38d23f1bbe5ff0ba96ea57520a4">create_cookie_request</a>(c, cookie_request, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">dht_public_key</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#acb77d5443961bf245b63c17347b1b030">cookie_request_number</a>,</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                              conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a81ead9fac55a0cedc30a96253a2c5119">shared_key</a>) != <span class="keyword">sizeof</span>(cookie_request)</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            || <a class="code" href="../../d8/dc6/net__crypto_8c.html#aa762d8aa84aa2c0a9cd48fa3d93856b1">new_temp_packet</a>(c, crypt_connection_id, cookie_request, <span class="keyword">sizeof</span>(cookie_request)) != 0) {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d">kill_tcp_connection_to</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">connection_number_tcp</a>);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">return</span> crypt_connection_id;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_ab2ecaa07625ad0ed5e07d3a1f0dcc939"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ab2ecaa07625ad0ed5e07d3a1f0dcc939">Crypto_Connection::dht_public_key</a></div><div class="ttdeci">uint8_t dht_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00114">net_crypto.h:114</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab329443d2f5643d95e6034542fcb82f3"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab329443d2f5643d95e6034542fcb82f3">CRYPTO_PACKET_MIN_RATE</a></div><div class="ttdeci">#define CRYPTO_PACKET_MIN_RATE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00042">net_crypto.h:42</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a2a46344fe22f21eea9d777b12918e257"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257">getcryptconnection_id</a></div><div class="ttdeci">static int getcryptconnection_id(const Net_Crypto *c, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01449">net_crypto.c:1449</a></div></div>
<div class="ttc" id="net__crypto_8h_html_aa737ddb8e565b8959c9d30398907026e"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#aa737ddb8e565b8959c9d30398907026e">DEFAULT_PING_CONNECTION</a></div><div class="ttdeci">#define DEFAULT_PING_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00086">net_crypto.h:86</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a1ce51b34ab2247e750b9c2a25121eb9e"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e">random_64b</a></div><div class="ttdeci">uint64_t random_64b(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00053">crypto_core.c:53</a></div></div>
<div class="ttc" id="net__crypto_8c_html_aed34560fc11f32d1b280d00152655b9b"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#aed34560fc11f32d1b280d00152655b9b">create_crypto_connection</a></div><div class="ttdeci">static int create_crypto_connection(Net_Crypto *c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01375">net_crypto.c:1375</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a15ef255ab026d4881a16b99148b05dd7"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7">random_nonce</a></div><div class="ttdeci">void random_nonce(uint8_t *nonce)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00176">crypto_core.c:176</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab974dcadabde124fab5287024341f7a1"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab974dcadabde124fab5287024341f7a1">CRYPTO_CONN_NO_CONNECTION</a></div><div class="ttdeci">#define CRYPTO_CONN_NO_CONNECTION</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00032">net_crypto.h:32</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ab0d2e7f3b3f18b516bb0a512c91b2914"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ab0d2e7f3b3f18b516bb0a512c91b2914">CRYPTO_MIN_QUEUE_LENGTH</a></div><div class="ttdeci">#define CRYPTO_MIN_QUEUE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00045">net_crypto.h:45</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a9df0e00e8f493ed6cd1ff45e7da33c0d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a9df0e00e8f493ed6cd1ff45e7da33c0d">Crypto_Connection::sent_nonce</a></div><div class="ttdeci">uint8_t sent_nonce[crypto_box_NONCEBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00103">net_crypto.h:103</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a5f38fc9ff1b20b61ffbb56d9e7f5c892"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a5f38fc9ff1b20b61ffbb56d9e7f5c892">Crypto_Connection::sessionsecret_key</a></div><div class="ttdeci">uint8_t sessionsecret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00105">net_crypto.h:105</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a6e74fbae398c7966800ee80f7b93dbfa"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a6e74fbae398c7966800ee80f7b93dbfa">Crypto_Connection::sessionpublic_key</a></div><div class="ttdeci">uint8_t sessionpublic_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00104">net_crypto.h:104</a></div></div>
<div class="ttc" id="net__crypto_8c_html_aa762d8aa84aa2c0a9cd48fa3d93856b1"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#aa762d8aa84aa2c0a9cd48fa3d93856b1">new_temp_packet</a></div><div class="ttdeci">static int new_temp_packet(const Net_Crypto *c, int crypt_connection_id, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01003">net_crypto.c:1003</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a81ead9fac55a0cedc30a96253a2c5119"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a81ead9fac55a0cedc30a96253a2c5119">Crypto_Connection::shared_key</a></div><div class="ttdeci">uint8_t shared_key[crypto_box_BEFORENMBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00107">net_crypto.h:107</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a8358768a02871910ed059b1b2646438e"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a8358768a02871910ed059b1b2646438e">Crypto_Connection::packet_send_rate</a></div><div class="ttdeci">double packet_send_rate</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00145">net_crypto.h:145</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a22c797c7e0ef3ad66e171f05b1cb52bd"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a22c797c7e0ef3ad66e171f05b1cb52bd">new_tcp_connection_to</a></div><div class="ttdeci">int new_tcp_connection_to(TCP_Connections *tcp_c, const uint8_t *public_key, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00433">TCP_connection.c:433</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a51666aaba0fc5680040fe5bd6778bc50"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a51666aaba0fc5680040fe5bd6778bc50">Crypto_Connection::connection_number_tcp</a></div><div class="ttdeci">unsigned int connection_number_tcp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00156">net_crypto.h:156</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_adfabcbe80305cc6b4e1c0dfef5c48653"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">Crypto_Connection::packets_left</a></div><div class="ttdeci">uint32_t packets_left</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00146">net_crypto.h:146</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a3982349ee55b611d39ef3014e739e403"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a3982349ee55b611d39ef3014e739e403">CRYPTO_CONN_COOKIE_REQUESTING</a></div><div class="ttdeci">#define CRYPTO_CONN_COOKIE_REQUESTING</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00033">net_crypto.h:33</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a5b67a38d23f1bbe5ff0ba96ea57520a4"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a5b67a38d23f1bbe5ff0ba96ea57520a4">create_cookie_request</a></div><div class="ttdeci">static int create_cookie_request(const Net_Crypto *c, uint8_t *packet, uint8_t *dht_public_key, uint64_t number, uint8_t *shared_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00067">net_crypto.c:67</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ade818037fd6c985038ff29656089758d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">Crypto_Connection::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00108">net_crypto.h:108</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ae88ec876060fbc648a4c75ac596137f9"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ae88ec876060fbc648a4c75ac596137f9">Crypto_Connection::rtt_time</a></div><div class="ttdeci">uint64_t rtt_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00153">net_crypto.h:153</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a25d19522f8fdd8da8932746bcf11e8aa"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a25d19522f8fdd8da8932746bcf11e8aa">COOKIE_REQUEST_LENGTH</a></div><div class="ttdeci">#define COOKIE_REQUEST_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00056">net_crypto.c:56</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a13fdc865b8a114466ba136f5390ec1b2"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a13fdc865b8a114466ba136f5390ec1b2">Net_Crypto::crypto_connections</a></div><div class="ttdeci">Crypto_Connection * crypto_connections</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00181">net_crypto.h:181</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a2369688a49bef46cb2029b3bb680e11d"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d">kill_tcp_connection_to</a></div><div class="ttdeci">int kill_tcp_connection_to(TCP_Connections *tcp_c, int connections_number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00455">TCP_connection.c:455</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_acb77d5443961bf245b63c17347b1b030"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#acb77d5443961bf245b63c17347b1b030">Crypto_Connection::cookie_request_number</a></div><div class="ttdeci">uint64_t cookie_request_number</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00113">net_crypto.h:113</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Crypto_Connection::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00101">net_crypto.h:101</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_cgraph" id="de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a5b67a38d23f1bbe5ff0ba96ea57520a4" title="create_cookie_request" alt="" coords="221,183,374,209"/><area shape="rect" id="node10" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="702,233,809,260"/><area shape="rect" id="node11" href="../../d8/dc6/net__crypto_8c.html#aed34560fc11f32d1b280d00152655b9b" title="create_crypto_connection" alt="" coords="212,335,383,361"/><area shape="rect" id="node13" href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257" title="getcryptconnection_id" alt="" coords="223,399,372,425"/><area shape="rect" id="node14" href="../../d5/d26/_t_c_p__connection_8c.html#a2369688a49bef46cb2029b3bb680e11d" title="kill_tcp_connection_to" alt="" coords="222,449,373,476"/><area shape="rect" id="node27" href="../../d5/d26/_t_c_p__connection_8c.html#a22c797c7e0ef3ad66e171f05b1cb52bd" title="new_tcp_connection_to" alt="" coords="218,525,377,552"/><area shape="rect" id="node30" href="../../d8/dc6/net__crypto_8c.html#aa762d8aa84aa2c0a9cd48fa3d93856b1" title="new_temp_packet" alt="" coords="233,576,361,603"/><area shape="rect" id="node33" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="251,627,344,653"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="431,93,612,120"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1123,233,1288,260"/><area shape="rect" id="node9" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="477,208,565,235"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="698,68,813,95"/><area shape="rect" id="node5" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="917,5,1057,32"/><area shape="rect" id="node6" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="945,56,1028,83"/><area shape="rect" id="node7" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1166,107,1245,133"/><area shape="rect" id="node12" href="../../d8/dc6/net__crypto_8c.html#ab0b745274346dc3464e35fcd756db0d2" title="realloc_cryptoconnection" alt="" coords="438,309,605,336"/><area shape="rect" id="node15" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="700,512,811,539"/><area shape="rect" id="node17" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="454,360,589,387"/><area shape="rect" id="node19" href="../../da/da1/_t_c_p__client_8c.html#af83d9fac2256a46428ad95bf337c05b7" title="send_disconnect_request" alt="" coords="436,411,607,437"/><area shape="rect" id="node26" href="../../d5/d26/_t_c_p__connection_8c.html#a10a5b3ddc6f1bfa7785301f33c369695" title="wipe_connection" alt="" coords="696,461,815,488"/><area shape="rect" id="node16" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="915,470,1058,511"/><area shape="rect" id="node18" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="672,345,839,386"/><area shape="rect" id="node20" href="../../da/da1/_t_c_p__client_8c.html#abe305661e19883349d213c74c44ff93f" title="send_disconnect_notification" alt="" coords="660,411,851,437"/><area shape="rect" id="node21" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="899,387,1075,429"/><area shape="rect" id="node22" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1138,395,1273,421"/><area shape="rect" id="node24" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="1145,445,1266,472"/><area shape="rect" id="node25" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="1161,344,1250,371"/><area shape="rect" id="node23" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="1336,395,1537,421"/><area shape="rect" id="node28" href="../../d5/d26/_t_c_p__connection_8c.html#adc455181d7c862328a677fb5394885c6" title="find_tcp_connection_to" alt="" coords="443,563,599,589"/><area shape="rect" id="node29" href="../../d5/d26/_t_c_p__connection_8c.html#a62b7fc88f48b373ae0b957244fe9db8e" title="create_connection" alt="" coords="457,613,585,640"/><area shape="rect" id="node31" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="445,664,598,691"/><area shape="rect" id="node32" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="686,657,825,698"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_icgraph" id="de/d42/net__crypto_8h_ae09413aa94644bc88bf73b88f48ef814_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="212,364,367,391"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="435,302,547,328"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="773,360,889,387"/><area shape="rect" id="node42" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="415,454,567,480"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="615,302,725,328"/><area shape="rect" id="node6" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="937,302,1105,328"/><area shape="rect" id="node17" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="944,355,1099,382"/><area shape="rect" id="node41" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="960,406,1083,432"/><area shape="rect" id="node7" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1153,126,1316,152"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1384,24,1501,51"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1617,24,1668,51"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2231,126,2301,152"/><area shape="rect" id="node11" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2396,176,2503,203"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2417,227,2481,254"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2410,126,2489,152"/><area shape="rect" id="node16" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2424,278,2475,304"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2551,328,2601,355"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2551,176,2601,203"/><area shape="rect" id="node18" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1167,406,1302,432"/><area shape="rect" id="node24" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1180,303,1289,330"/><area shape="rect" id="node19" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1389,418,1496,444"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="2225,430,2307,456"/><area shape="rect" id="node21" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2396,430,2503,456"/><area shape="rect" id="node22" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2423,480,2475,507"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2413,328,2486,355"/><area shape="rect" id="node25" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1396,303,1489,330"/><area shape="rect" id="node34" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1364,151,1521,178"/><area shape="rect" id="node26" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1585,278,1701,304"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2241,278,2291,304"/><area shape="rect" id="node31" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1569,227,1716,254"/><area shape="rect" id="node33" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="2213,328,2319,355"/><area shape="rect" id="node27" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1764,262,1917,304"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1992,227,2109,254"/><area shape="rect" id="node30" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="2213,227,2319,254"/><area shape="rect" id="node32" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1815,211,1866,238"/><area shape="rect" id="node35" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1581,176,1705,203"/><area shape="rect" id="node36" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1792,160,1889,187"/><area shape="rect" id="node37" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1965,59,2136,86"/><area shape="rect" id="node38" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="2191,75,2341,102"/><area shape="rect" id="node39" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="2184,24,2348,51"/><area shape="rect" id="node40" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2396,24,2503,51"/><area shape="rect" id="node43" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1997,430,2104,456"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abcede595fdf06772b76f60792c82ed2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void new_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02386">2386</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00190">Net_Crypto::self_public_key</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00191">Net_Crypto::self_secret_key</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02414">new_net_crypto()</a>.</p>
<div class="fragment"><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;{</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    crypto_box_keypair(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>, c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">Net_Crypto::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00191">net_crypto.h:191</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae726df8bdc26380e5a6c3187a00d6881"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae726df8bdc26380e5a6c3187a00d6881">Net_Crypto::self_public_key</a></div><div class="ttdeci">uint8_t self_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00190">net_crypto.h:190</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_abcede595fdf06772b76f60792c82ed2b_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_abcede595fdf06772b76f60792c82ed2b_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_abcede595fdf06772b76f60792c82ed2b_icgraph" id="de/d42/net__crypto_8h_abcede595fdf06772b76f60792c82ed2b_icgraph">
<area shape="rect" id="node2" href="../../de/d42/net__crypto_8h.html#a5e46c6f42e93e2aa968f8f63de90a53c" title="new_net_crypto" alt="" coords="135,31,249,57"/><area shape="rect" id="node3" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="311,5,401,32"/><area shape="rect" id="node5" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="297,56,415,83"/><area shape="rect" id="node4" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="463,5,569,32"/><area shape="rect" id="node6" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="491,56,541,83"/><area shape="rect" id="node7" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="481,107,551,133"/><area shape="rect" id="node8" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="617,31,724,57"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="639,81,703,108"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="631,132,710,159"/><area shape="rect" id="node13" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="645,183,696,209"/><area shape="rect" id="node10" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="772,81,823,108"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="772,132,823,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5e46c6f42e93e2aa968f8f63de90a53c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a>* new_net_crypto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d64/struct_t_c_p___proxy___info.html">TCP_Proxy_Info</a> *&#160;</td>
          <td class="paramname"><em>proxy_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02414">2414</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d7/d40/list_8c_source.html#l00138">bs_list_init()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00184">Net_Crypto::connections_mutex</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00173">create_recursive_mutex()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00056">CRYPTO_SEND_PACKET_INTERVAL</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00200">Net_Crypto::current_sleep_time</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00178">Net_Crypto::dht</a>, <a class="el" href="../../d4/d30/_messenger_8h_source.html#l00215">Messenger::dht</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00202">Net_Crypto::ip_port_list</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01352">kill_tcp_connections()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT::net</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00101">NET_PACKET_COOKIE_REQUEST</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00102">NET_PACKET_COOKIE_RESPONSE</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00104">NET_PACKET_CRYPTO_DATA</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00103">NET_PACKET_CRYPTO_HS</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00409">networking_registerhandler()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02386">new_keys()</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00182">new_symmetric_key()</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l01251">new_tcp_connections()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00194">Net_Crypto::secret_symmetric_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT::self_secret_key</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00357">set_oob_packet_tcp_connection_callback()</a>, <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00348">set_packet_tcp_connection_callback()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01719">tcp_data_callback()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01746">tcp_oob_callback()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00194">udp_handle_cookie_request()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01995">udp_handle_packet()</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01751">new_messenger()</a>, and <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00269">new_onions()</a>.</p>
<div class="fragment"><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;{</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="keywordflow">if</span> (dht == NULL)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <a class="code" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *temp = calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a>));</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordflow">if</span> (temp == NULL)</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a> = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a3526d187a2a8f91d672f0bde2dff4633">new_tcp_connections</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>, proxy_info);</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">if</span> (temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a> == NULL) {</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        free(temp);</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#afdea860d77b12c79ee24c3ade58d4ac6">set_packet_tcp_connection_callback</a>(temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, &amp;<a class="code" href="../../d8/dc6/net__crypto_8c.html#ab2eaad4448a5deca58a00316b522e380">tcp_data_callback</a>, temp);</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a13df5ebd6110288f192070b8c1c28328">set_oob_packet_tcp_connection_callback</a>(temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, &amp;<a class="code" href="../../d8/dc6/net__crypto_8c.html#a86a3ff661a8b9b10fd7c0daee3901091">tcp_oob_callback</a>, temp);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/df1/util_8c.html#a2f0ae269c015342e2d29a251237ccce2">create_recursive_mutex</a>(&amp;temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>) != 0 ||</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            pthread_mutex_init(&amp;temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>, NULL) != 0) {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#a6938788005ebe33a896755ac2b9f501a">kill_tcp_connections</a>(temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        free(temp);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    }</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">dht</a> = dht;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <a class="code" href="../../d8/dc6/net__crypto_8c.html#abcede595fdf06772b76f60792c82ed2b">new_keys</a>(temp);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#a89b4a1a4a7d8bfabdf0e1b60f074e531">new_symmetric_key</a>(temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ab9f2ff47bc0b1e5110202a6e4be86390">secret_symmetric_key</a>);</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a86823a02e323235811eada4755e3f81e">current_sleep_time</a> = <a class="code" href="../../de/d42/net__crypto_8h.html#a22cf528ff4b695034a0f38e6ea1cc40e">CRYPTO_SEND_PACKET_INTERVAL</a>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a3ad6d83af0ed67a84b327df50d66229c">NET_PACKET_COOKIE_REQUEST</a>, &amp;<a class="code" href="../../d8/dc6/net__crypto_8c.html#a04fc41a4cb0d904536626006f3b7d7dd">udp_handle_cookie_request</a>, temp);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a1162e12ce54e50cb3744e2cf69553565">NET_PACKET_COOKIE_RESPONSE</a>, &amp;<a class="code" href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12">udp_handle_packet</a>, temp);</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#ae4ba32f7f36e935bd3a56b5e90299857">NET_PACKET_CRYPTO_HS</a>, &amp;<a class="code" href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12">udp_handle_packet</a>, temp);</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#abd68cd32dfdf6a1e0407967df0c10a9e">NET_PACKET_CRYPTO_DATA</a>, &amp;<a class="code" href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12">udp_handle_packet</a>, temp);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <a class="code" href="../../d7/d40/list_8c.html#a7b07772cffb6af34e279f424dca08895">bs_list_init</a>(&amp;temp-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">ip_port_list</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../db/d14/struct_i_p___port.html">IP_Port</a>), 8);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="keywordflow">return</span> temp;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;}</div>
<div class="ttc" id="net__crypto_8c_html_abcede595fdf06772b76f60792c82ed2b"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#abcede595fdf06772b76f60792c82ed2b">new_keys</a></div><div class="ttdeci">void new_keys(Net_Crypto *c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l02386">net_crypto.c:2386</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">DHT::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT.h:211</a></div></div>
<div class="ttc" id="network_8h_html_abd68cd32dfdf6a1e0407967df0c10a9e"><div class="ttname"><a href="../../d9/d94/network_8h.html#abd68cd32dfdf6a1e0407967df0c10a9e">NET_PACKET_CRYPTO_DATA</a></div><div class="ttdeci">#define NET_PACKET_CRYPTO_DATA</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00104">network.h:104</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a8b3d6ce8745acc52695e252bdb1531b6"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a8b3d6ce8745acc52695e252bdb1531b6">Net_Crypto::dht</a></div><div class="ttdeci">DHT * dht</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00178">net_crypto.h:178</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a22cf528ff4b695034a0f38e6ea1cc40e"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a22cf528ff4b695034a0f38e6ea1cc40e">CRYPTO_SEND_PACKET_INTERVAL</a></div><div class="ttdeci">#define CRYPTO_SEND_PACKET_INTERVAL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00056">net_crypto.h:56</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_afdea860d77b12c79ee24c3ade58d4ac6"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#afdea860d77b12c79ee24c3ade58d4ac6">set_packet_tcp_connection_callback</a></div><div class="ttdeci">void set_packet_tcp_connection_callback(TCP_Connections *tcp_c, int(*tcp_data_callback)(void *object, int id, const uint8_t *data, uint16_t length), void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00348">TCP_connection.c:348</a></div></div>
<div class="ttc" id="util_8c_html_a2f0ae269c015342e2d29a251237ccce2"><div class="ttname"><a href="../../de/df1/util_8c.html#a2f0ae269c015342e2d29a251237ccce2">create_recursive_mutex</a></div><div class="ttdeci">int create_recursive_mutex(pthread_mutex_t *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00173">util.c:173</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a6938788005ebe33a896755ac2b9f501a"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a6938788005ebe33a896755ac2b9f501a">kill_tcp_connections</a></div><div class="ttdeci">void kill_tcp_connections(TCP_Connections *tcp_c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01352">TCP_connection.c:1352</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a86823a02e323235811eada4755e3f81e"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a86823a02e323235811eada4755e3f81e">Net_Crypto::current_sleep_time</a></div><div class="ttdeci">uint32_t current_sleep_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00200">net_crypto.h:200</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa14ea2f67950f57fe4235d7375a2216c"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">DHT::net</a></div><div class="ttdeci">Networking_Core * net</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT.h:201</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a89b4a1a4a7d8bfabdf0e1b60f074e531"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a89b4a1a4a7d8bfabdf0e1b60f074e531">new_symmetric_key</a></div><div class="ttdeci">void new_symmetric_key(uint8_t *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00182">crypto_core.c:182</a></div></div>
<div class="ttc" id="list_8c_html_a7b07772cffb6af34e279f424dca08895"><div class="ttname"><a href="../../d7/d40/list_8c.html#a7b07772cffb6af34e279f424dca08895">bs_list_init</a></div><div class="ttdeci">int bs_list_init(BS_LIST *list, uint32_t element_size, uint32_t initial_capacity)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00138">list.c:138</a></div></div>
<div class="ttc" id="struct_i_p___port_html"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html">IP_Port</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00162">network.h:162</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ab9f2ff47bc0b1e5110202a6e4be86390"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ab9f2ff47bc0b1e5110202a6e4be86390">Net_Crypto::secret_symmetric_key</a></div><div class="ttdeci">uint8_t secret_symmetric_key[crypto_box_KEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00194">net_crypto.h:194</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a213135bf3b5b80b1cfe99b27dc42815e"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">Net_Crypto::connections_mutex</a></div><div class="ttdeci">pthread_mutex_t connections_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00184">net_crypto.h:184</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a86a3ff661a8b9b10fd7c0daee3901091"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a86a3ff661a8b9b10fd7c0daee3901091">tcp_oob_callback</a></div><div class="ttdeci">static int tcp_oob_callback(void *object, const uint8_t *public_key, unsigned int tcp_connections_number, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01746">net_crypto.c:1746</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a13df5ebd6110288f192070b8c1c28328"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a13df5ebd6110288f192070b8c1c28328">set_oob_packet_tcp_connection_callback</a></div><div class="ttdeci">void set_oob_packet_tcp_connection_callback(TCP_Connections *tcp_c, int(*tcp_oob_callback)(void *object, const uint8_t *public_key, unsigned int tcp_connections_number, const uint8_t *data, uint16_t length), void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00357">TCP_connection.c:357</a></div></div>
<div class="ttc" id="network_8h_html_a3ad6d83af0ed67a84b327df50d66229c"><div class="ttname"><a href="../../d9/d94/network_8h.html#a3ad6d83af0ed67a84b327df50d66229c">NET_PACKET_COOKIE_REQUEST</a></div><div class="ttdeci">#define NET_PACKET_COOKIE_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00101">network.h:101</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae8cfe94df9c9030bbc525010603450ac"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">Net_Crypto::ip_port_list</a></div><div class="ttdeci">BS_LIST ip_port_list</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00202">net_crypto.h:202</a></div></div>
<div class="ttc" id="network_8c_html_a230a192ca9463ec4985d4f86de439733"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a></div><div class="ttdeci">void networking_registerhandler(Networking_Core *net, uint8_t byte, packet_handler_callback cb, void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00409">network.c:409</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a812ca8a7291e22ce343669c9835c7c12"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12">udp_handle_packet</a></div><div class="ttdeci">static int udp_handle_packet(void *object, IP_Port source, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01995">net_crypto.c:1995</a></div></div>
<div class="ttc" id="struct_net___crypto_html"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html">Net_Crypto</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00177">net_crypto.h:177</a></div></div>
<div class="ttc" id="net__crypto_8c_html_ab2eaad4448a5deca58a00316b522e380"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#ab2eaad4448a5deca58a00316b522e380">tcp_data_callback</a></div><div class="ttdeci">static int tcp_data_callback(void *object, int id, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l01719">net_crypto.c:1719</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
<div class="ttc" id="network_8h_html_ae4ba32f7f36e935bd3a56b5e90299857"><div class="ttname"><a href="../../d9/d94/network_8h.html#ae4ba32f7f36e935bd3a56b5e90299857">NET_PACKET_CRYPTO_HS</a></div><div class="ttdeci">#define NET_PACKET_CRYPTO_HS</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00103">network.h:103</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a04fc41a4cb0d904536626006f3b7d7dd"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a04fc41a4cb0d904536626006f3b7d7dd">udp_handle_cookie_request</a></div><div class="ttdeci">static int udp_handle_cookie_request(void *object, IP_Port source, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00194">net_crypto.c:194</a></div></div>
<div class="ttc" id="network_8h_html_a1162e12ce54e50cb3744e2cf69553565"><div class="ttname"><a href="../../d9/d94/network_8h.html#a1162e12ce54e50cb3744e2cf69553565">NET_PACKET_COOKIE_RESPONSE</a></div><div class="ttdeci">#define NET_PACKET_COOKIE_RESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00102">network.h:102</a></div></div>
<div class="ttc" id="_t_c_p__connection_8c_html_a3526d187a2a8f91d672f0bde2dff4633"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#a3526d187a2a8f91d672f0bde2dff4633">new_tcp_connections</a></div><div class="ttdeci">TCP_Connections * new_tcp_connections(const uint8_t *secret_key, TCP_Proxy_Info *proxy_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l01251">TCP_connection.c:1251</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_cgraph" id="de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_cgraph">
<area shape="rect" id="node2" href="../../d7/d40/list_8c.html#a7b07772cffb6af34e279f424dca08895" title="bs_list_init" alt="" coords="215,5,299,32"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#a2f0ae269c015342e2d29a251237ccce2" title="create_recursive_mutex" alt="" coords="176,56,337,83"/><area shape="rect" id="node5" href="../../d5/d26/_t_c_p__connection_8c.html#a6938788005ebe33a896755ac2b9f501a" title="kill_tcp_connections" alt="" coords="187,107,327,133"/><area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733" title="networking_registerhandler" alt="" coords="168,157,345,184"/><area shape="rect" id="node10" href="../../d8/dc6/net__crypto_8c.html#abcede595fdf06772b76f60792c82ed2b" title="new_keys" alt="" coords="216,208,297,235"/><area shape="rect" id="node11" href="../../dc/d85/crypto__core_8c.html#a89b4a1a4a7d8bfabdf0e1b60f074e531" title="new_symmetric_key" alt="" coords="185,259,328,285"/><area shape="rect" id="node12" href="../../d5/d26/_t_c_p__connection_8c.html#a3526d187a2a8f91d672f0bde2dff4633" title="new_tcp_connections" alt="" coords="183,309,331,336"/><area shape="rect" id="node13" href="../../d5/d26/_t_c_p__connection_8c.html#a13df5ebd6110288f192070b8c1c28328" title="set_oob_packet_tcp\l_connection_callback" alt="" coords="183,361,330,402"/><area shape="rect" id="node20" href="../../d5/d26/_t_c_p__connection_8c.html#afdea860d77b12c79ee24c3ade58d4ac6" title="set_packet_tcp_connection\l_callback" alt="" coords="394,370,575,411"/><area shape="rect" id="node21" href="../../d8/dc6/net__crypto_8c.html#ab2eaad4448a5deca58a00316b522e380" title="tcp_data_callback" alt="" coords="193,528,320,555"/><area shape="rect" id="node40" href="../../d8/dc6/net__crypto_8c.html#a86a3ff661a8b9b10fd7c0daee3901091" title="tcp_oob_callback" alt="" coords="195,579,318,605"/><area shape="rect" id="node46" href="../../d8/dc6/net__crypto_8c.html#a04fc41a4cb0d904536626006f3b7d7dd" title="udp_handle_cookie_request" alt="" coords="393,465,576,492"/><area shape="rect" id="node48" href="../../d8/dc6/net__crypto_8c.html#a812ca8a7291e22ce343669c9835c7c12" title="udp_handle_packet" alt="" coords="189,1023,324,1049"/><area shape="rect" id="node50" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="423,1444,547,1471"/><area shape="rect" id="node3" href="../../d7/d40/list_8c.html#a7c246868ee5a3542509cdf90379c5bb2" title="resize" alt="" coords="456,5,513,32"/><area shape="rect" id="node6" href="../../da/da1/_t_c_p__client_8c.html#a437ba55ccf24fb881acf298f3e225a63" title="kill_TCP_connection" alt="" coords="413,107,556,133"/><area shape="rect" id="node7" href="../../da/da1/_t_c_p__client_8c.html#aaf4385f749c6f9c21f4f4ac17b31a77b" title="wipe_priority_list" alt="" coords="660,60,779,87"/><area shape="rect" id="node8" href="../../d6/d6e/network_8c.html#a512d8ea12392ba9ddfadd83bb7c92b2e" title="kill_sock" alt="" coords="683,111,756,137"/><area shape="rect" id="node14" href="../../d5/d26/_t_c_p__connection_8c.html#a0639171aa059dd205b410f7ed01faaed" title="tcp_oob_callback" alt="" coords="423,301,546,328"/><area shape="rect" id="node15" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="876,415,1011,441"/><area shape="rect" id="node16" href="../../d5/d26/_t_c_p__connection_8c.html#adc455181d7c862328a677fb5394885c6" title="find_tcp_connection_to" alt="" coords="641,263,797,289"/><area shape="rect" id="node17" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="888,313,999,340"/><area shape="rect" id="node18" href="../../d5/d26/_t_c_p__connection_8c.html#a452c51915aabeb4300da3591a7d14096" title="tcp_connection_in_conn" alt="" coords="638,212,801,239"/><area shape="rect" id="node19" href="../../d5/d26/_t_c_p__connection_8c.html#a3a74ceace0b841b9a50fa0fc8ed57613" title="tcp_data_callback" alt="" coords="656,364,783,391"/><area shape="rect" id="node22" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1078,1149,1231,1176"/><area shape="rect" id="node24" href="../../d8/dc6/net__crypto_8c.html#a04717fefa34f146623e7c95d5eef8caa" title="handle_packet_connection" alt="" coords="397,1099,573,1125"/><area shape="rect" id="node33" href="../../d8/dc6/net__crypto_8c.html#a9308f183e47e29869d5562d03a01f88a" title="tcp_handle_cookie_request" alt="" coords="395,517,575,544"/><area shape="rect" id="node23" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1285,1142,1424,1183"/><area shape="rect" id="node25" href="../../d8/dc6/net__crypto_8c.html#ad2ca4aad15dc0607252aa21cd525b5ba" title="create_send_handshake" alt="" coords="638,1175,801,1201"/><area shape="rect" id="node26" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="649,1073,789,1100"/><area shape="rect" id="node27" href="../../d8/dc6/net__crypto_8c.html#a28d8190542201eb7f1e41fe4764a7d53" title="handle_cookie_response" alt="" coords="637,1225,802,1252"/><area shape="rect" id="node28" href="../../d8/dc6/net__crypto_8c.html#a33f5ee072c7c7f92f2302e98f1697cea" title="handle_crypto_handshake" alt="" coords="633,1023,806,1049"/><area shape="rect" id="node29" href="../../dc/d85/crypto__core_8c.html#a45ba09cd560b3be51f6cb7a3859f31b3" title="public_key_cmp" alt="" coords="885,1023,1001,1049"/><area shape="rect" id="node30" href="../../d8/dc6/net__crypto_8c.html#a38debbf6310a8190eeafd33e42423f1a" title="handle_data_packet\l_helper" alt="" coords="650,1277,789,1318"/><area shape="rect" id="node31" href="../../d8/dc6/net__crypto_8c.html#ac679d5f08189ac10b3eca22c3f032dbc" title="connection_kill" alt="" coords="889,1124,997,1151"/><area shape="rect" id="node32" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="863,1288,1024,1315"/><area shape="rect" id="node34" href="../../d8/dc6/net__crypto_8c.html#ab88b2226740cacde1112ee7fd13048d3" title="create_cookie_response" alt="" coords="638,617,801,644"/><area shape="rect" id="node38" href="../../d8/dc6/net__crypto_8c.html#ae86cc5b9c02d6a9f61916e1ff1a1b768" title="handle_cookie_request" alt="" coords="642,465,797,492"/><area shape="rect" id="node39" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="624,516,815,543"/><area shape="rect" id="node35" href="../../d8/dc6/net__crypto_8c.html#ad630e2753f088cf9ccd45babe8719532" title="create_cookie" alt="" coords="892,617,995,644"/><area shape="rect" id="node36" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1072,592,1237,619"/><area shape="rect" id="node37" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1115,668,1194,695"/><area shape="rect" id="node41" href="../../d8/dc6/net__crypto_8c.html#ae8139c35468806f25d5aed185edcc5a1" title="handle_new_connection\l_handshake" alt="" coords="404,939,565,981"/><area shape="rect" id="node44" href="../../d8/dc6/net__crypto_8c.html#ae88369484d37b525d33c5c87c846606b" title="tcp_oob_handle_cookie\l_request" alt="" coords="405,570,564,611"/><area shape="rect" id="node42" href="../../d8/dc6/net__crypto_8c.html#a9e779393ece10111b0ac7fe2bbc3beeb" title="crypto_connection_add\l_source" alt="" coords="865,719,1021,761"/><area shape="rect" id="node43" href="../../d8/dc6/net__crypto_8c.html#a2a46344fe22f21eea9d777b12918e257" title="getcryptconnection_id" alt="" coords="645,820,794,847"/><area shape="rect" id="node45" href="../../d5/d26/_t_c_p__connection_8c.html#a5effabd83d700cccf9bcc51174f041f1" title="tcp_send_oob_packet" alt="" coords="645,567,794,593"/><area shape="rect" id="node47" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="675,415,764,441"/><area shape="rect" id="node49" href="../../d8/dc6/net__crypto_8c.html#ace680157da68eb91755350d0cb14cd8f" title="crypto_id_ip_port" alt="" coords="424,1149,545,1176"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_icgraph" id="de/d42/net__crypto_8h_a5e46c6f42e93e2aa968f8f63de90a53c_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="168,81,285,108"/><area shape="rect" id="node11" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="181,132,272,159"/><area shape="rect" id="node3" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="361,31,412,57"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="351,81,422,108"/><area shape="rect" id="node5" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="488,5,595,32"/><area shape="rect" id="node6" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="509,56,573,83"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="502,107,581,133"/><area shape="rect" id="node10" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="516,157,567,184"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="643,56,693,83"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="643,107,693,133"/><area shape="rect" id="node12" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="333,132,440,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae2f39ed236b85952fa913fdac1785671"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>keys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02396">2396</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00190">Net_Crypto::self_public_key</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00191">Net_Crypto::self_secret_key</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02565">messenger_save()</a>.</p>
<div class="fragment"><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;{</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    memcpy(keys, c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    memcpy(keys + crypto_box_PUBLICKEYBYTES, c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>, crypto_box_SECRETKEYBYTES);</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;}</div>
<div class="ttc" id="struct_net___crypto_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#aa05050f86513ff53fe9da81f73c72267">Net_Crypto::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00191">net_crypto.h:191</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae726df8bdc26380e5a6c3187a00d6881"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae726df8bdc26380e5a6c3187a00d6881">Net_Crypto::self_public_key</a></div><div class="ttdeci">uint8_t self_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00190">net_crypto.h:190</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ae2f39ed236b85952fa913fdac1785671_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ae2f39ed236b85952fa913fdac1785671_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ae2f39ed236b85952fa913fdac1785671_icgraph" id="de/d42/net__crypto_8h_ae2f39ed236b85952fa913fdac1785671_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#af0dfac679b1b57a0036f6511e12fe777" title="messenger_save" alt="" coords="139,56,260,83"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="345,5,396,32"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="317,56,424,83"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#a63116d9c9454da73a56463d9093e53e4" title="tox_get_savedata" alt="" coords="308,107,433,133"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="481,81,588,108"/><area shape="rect" id="node7" href="../../d2/d65/n_tox_8c.html#a631b615f9972e1b5609e5773d809f9b4" title="save_data" alt="" coords="493,132,576,159"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="653,107,726,133"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a86825faeca35dae8e6c4ab666d4543d6" title="save_data_file" alt="" coords="636,157,743,184"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="791,132,841,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7fcdf763c4a1b4b71e0de620b12f074c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_lossy_cryptpacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02284">2284</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00097">Packets_Array::buffer_end</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00096">Packets_Array::buffer_start</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00185">Net_Crypto::connection_use_counter</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00184">Net_Crypto::connections_mutex</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00053">MAX_CRYPTO_DATA_SIZE</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00160">Crypto_Connection::mutex</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00077">PACKET_ID_LOSSY_RANGE_SIZE</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00076">PACKET_ID_LOSSY_RANGE_START</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00125">Crypto_Connection::recv_array</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00124">Crypto_Connection::send_array</a>, and <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00773">send_data_packet_helper()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01663">send_custom_lossy_packet()</a>, and <a class="el" href="../../df/de9/toxcore_2group_8c_source.html#l00875">send_lossy_group_peer()</a>.</p>
<div class="fragment"><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;{</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">if</span> (length == 0 || length &gt; <a class="code" href="../../de/d42/net__crypto_8h.html#a1b6e5122f9fdc5ef548ccf920f0c246e">MAX_CRYPTO_DATA_SIZE</a>)</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[0] &lt; <a class="code" href="../../de/d42/net__crypto_8h.html#a02481d2cc931289c2d5ee21d2a633316">PACKET_ID_LOSSY_RANGE_START</a>)</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[0] &gt;= (<a class="code" href="../../de/d42/net__crypto_8h.html#a02481d2cc931289c2d5ee21d2a633316">PACKET_ID_LOSSY_RANGE_START</a> + <a class="code" href="../../de/d42/net__crypto_8h.html#a97668dde651012b4dffe599cd0df333b">PACKET_ID_LOSSY_RANGE_SIZE</a>))</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    ++c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ab5be057850e1cee67902276a69900326">connection_use_counter</a>;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keywordtype">int</span> ret = -1;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">if</span> (conn) {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        pthread_mutex_lock(&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        uint32_t buffer_start = conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a1a62bc0c4bb9e349735c65f9948020d5">recv_array</a>.<a class="code" href="../../d2/d40/struct_packets___array.html#a85973b335814248c05f63543876b348e">buffer_start</a>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        uint32_t buffer_end = conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">send_array</a>.<a class="code" href="../../d2/d40/struct_packets___array.html#a66d710e0093872b26ee80118c1a85d99">buffer_end</a>;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        pthread_mutex_unlock(&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        ret = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7">send_data_packet_helper</a>(c, crypt_connection_id, buffer_start, buffer_end, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>, length);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    --c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ab5be057850e1cee67902276a69900326">connection_use_counter</a>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">connections_mutex</a>);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;}</div>
<div class="ttc" id="net__crypto_8h_html_a1b6e5122f9fdc5ef548ccf920f0c246e"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a1b6e5122f9fdc5ef548ccf920f0c246e">MAX_CRYPTO_DATA_SIZE</a></div><div class="ttdeci">#define MAX_CRYPTO_DATA_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00053">net_crypto.h:53</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_aa9112ee7e76eb3e870491f7c5c272197"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#aa9112ee7e76eb3e870491f7c5c272197">Crypto_Connection::send_array</a></div><div class="ttdeci">Packets_Array send_array</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00124">net_crypto.h:124</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="struct_packets___array_html_a66d710e0093872b26ee80118c1a85d99"><div class="ttname"><a href="../../d2/d40/struct_packets___array.html#a66d710e0093872b26ee80118c1a85d99">Packets_Array::buffer_end</a></div><div class="ttdeci">uint32_t buffer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00097">net_crypto.h:97</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a97668dde651012b4dffe599cd0df333b"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a97668dde651012b4dffe599cd0df333b">PACKET_ID_LOSSY_RANGE_SIZE</a></div><div class="ttdeci">#define PACKET_ID_LOSSY_RANGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00077">net_crypto.h:77</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a02481d2cc931289c2d5ee21d2a633316"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a02481d2cc931289c2d5ee21d2a633316">PACKET_ID_LOSSY_RANGE_START</a></div><div class="ttdeci">#define PACKET_ID_LOSSY_RANGE_START</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00076">net_crypto.h:76</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a213135bf3b5b80b1cfe99b27dc42815e"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a213135bf3b5b80b1cfe99b27dc42815e">Net_Crypto::connections_mutex</a></div><div class="ttdeci">pthread_mutex_t connections_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00184">net_crypto.h:184</a></div></div>
<div class="ttc" id="struct_packets___array_html_a85973b335814248c05f63543876b348e"><div class="ttname"><a href="../../d2/d40/struct_packets___array.html#a85973b335814248c05f63543876b348e">Packets_Array::buffer_start</a></div><div class="ttdeci">uint32_t buffer_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00096">net_crypto.h:96</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a4acff8232e4aec9cd5c6dc200ac55ef3"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a4acff8232e4aec9cd5c6dc200ac55ef3">Crypto_Connection::mutex</a></div><div class="ttdeci">pthread_mutex_t mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00160">net_crypto.h:160</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ab5be057850e1cee67902276a69900326"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ab5be057850e1cee67902276a69900326">Net_Crypto::connection_use_counter</a></div><div class="ttdeci">unsigned int connection_use_counter</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00185">net_crypto.h:185</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a572e703b36ffafdc4cf9dafd31a279d7"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7">send_data_packet_helper</a></div><div class="ttdeci">static int send_data_packet_helper(Net_Crypto *c, int crypt_connection_id, uint32_t buffer_start, uint32_t num, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00773">net_crypto.c:773</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a1a62bc0c4bb9e349735c65f9948020d5"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a1a62bc0c4bb9e349735c65f9948020d5">Crypto_Connection::recv_array</a></div><div class="ttdeci">Packets_Array recv_array</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00125">net_crypto.h:125</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_cgraph" id="de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1020,43,1173,69"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="216,93,387,120"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1243,23,1382,65"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="435,169,563,196"/><area shape="rect" id="node6" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1668,464,1833,491"/><area shape="rect" id="node7" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="1690,520,1811,547"/><area shape="rect" id="node8" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="611,169,725,196"/><area shape="rect" id="node9" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="783,195,954,221"/><area shape="rect" id="node15" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="773,272,964,299"/><area shape="rect" id="node26" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="824,144,913,171"/><area shape="rect" id="node10" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1012,105,1181,146"/><area shape="rect" id="node14" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1057,171,1136,197"/><area shape="rect" id="node11" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1257,155,1368,181"/><area shape="rect" id="node13" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="1237,89,1388,130"/><area shape="rect" id="node12" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="1461,147,1603,189"/><area shape="rect" id="node16" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1029,272,1164,299"/><area shape="rect" id="node18" href="../../da/da1/_t_c_p__client_8c.html#aea842652030d00bd8302e3c0201f95b9" title="send_data" alt="" coords="1055,323,1138,349"/><area shape="rect" id="node25" href="../../da/da1/_t_c_p__client_8c.html#a7818a314434c2bb01c3ea406744f076b" title="send_oob_packet" alt="" coords="1035,399,1159,425"/><area shape="rect" id="node17" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1229,206,1396,247"/><area shape="rect" id="node19" href="../../da/da1/_t_c_p__client_8c.html#a8e1ca90aa8db34a58b3b38cfcb1bb9de" title="send_ping_response" alt="" coords="1242,272,1383,299"/><area shape="rect" id="node20" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1444,371,1620,413"/><area shape="rect" id="node24" href="../../da/da1/_t_c_p__client_8c.html#a5aad81831c1333b763c9fd5eaf41603f" title="send_ping_request" alt="" coords="1247,323,1378,349"/><area shape="rect" id="node21" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="1683,357,1818,384"/><area shape="rect" id="node23" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="1706,408,1795,435"/><area shape="rect" id="node22" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="1881,357,2083,384"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_icgraph" id="de/d42/net__crypto_8h_a7fcdf763c4a1b4b71e0de620b12f074c_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#a2ebb5527b47fb87384093c4aa3c384c0" title="send_custom_lossy_packet" alt="" coords="216,136,400,163"/><area shape="rect" id="node11" href="../../df/de9/toxcore_2group_8c.html#ae3bb029450c53089066ace620abfe971" title="send_lossy_group_peer" alt="" coords="229,255,387,281"/><area shape="rect" id="node3" href="../../df/dc1/rtp_8h.html#a061d9b8e8abbcfb87d365bf65297e3f3" title="rtp_send_msg" alt="" coords="472,77,576,104"/><area shape="rect" id="node9" href="../../da/d8f/tox_8h.html#a83a51aeda057c82ed1e844962a84fe46" title="tox_friend_send_lossy\l_packet" alt="" coords="448,129,600,170"/><area shape="rect" id="node4" href="../../d8/d0e/toxav_8c.html#aa03b009616ed838e27caded4f69483d1" title="toxav_send_rtp_payload" alt="" coords="653,77,816,104"/><area shape="rect" id="node5" href="../../d9/d82/toxav_8h.html#a0b848edf3ccbf9088d79ad77e308ac29" title="toxav_send_audio" alt="" coords="886,31,1013,57"/><area shape="rect" id="node8" href="../../d8/d0e/toxav_8c.html#a4aa0876a176b4e5e7abea2f72059a502" title="toxav_send_video" alt="" coords="886,81,1013,108"/><area shape="rect" id="node6" href="../../d6/dc0/toxav__many__test_8c.html#aba50a9b07c2b19443bb2aae141579dcc" title="in_thread_call" alt="" coords="1095,5,1197,32"/><area shape="rect" id="node7" href="../../d6/d19/toxav__basic__test_8c.html#aa1d0def2e9aa37d5cb681d81baa07667" title="START_TEST" alt="" coords="1093,56,1199,83"/><area shape="rect" id="node10" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1692,108,1799,135"/><area shape="rect" id="node12" href="../../df/de9/toxcore_2group_8c.html#a593b5363a3865f21759df2ecc0a8c45a" title="send_lossy_all_close" alt="" coords="451,359,597,385"/><area shape="rect" id="node13" href="../../df/de9/toxcore_2group_8c.html#ac0762dd7405b5b863aca34d0b52d8e98" title="handle_lossy" alt="" coords="685,359,784,385"/><area shape="rect" id="node37" href="../../dd/de4/toxcore_2group_8h.html#a7e20618640c4b45fe7f863c87ec2dfda" title="send_group_lossy_packet" alt="" coords="648,439,821,465"/><area shape="rect" id="node14" href="../../df/de9/toxcore_2group_8c.html#ab48e96a53cc90551754943ce3df01673" title="add_conn_to_groupchat" alt="" coords="869,359,1029,385"/><area shape="rect" id="node15" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1079,257,1213,284"/><area shape="rect" id="node22" href="../../df/de9/toxcore_2group_8c.html#a5827237272acfda26ad786049a80e42a" title="handle_friend_invite\l_packet" alt="" coords="1077,351,1215,393"/><area shape="rect" id="node29" href="../../dd/de4/toxcore_2group_8h.html#a6f097de58345cf9500d0413198c583fc" title="join_groupchat" alt="" coords="1093,417,1199,444"/><area shape="rect" id="node16" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1293,235,1399,261"/><area shape="rect" id="node17" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1519,209,1602,236"/><area shape="rect" id="node18" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1719,159,1771,185"/><area shape="rect" id="node19" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1847,260,1897,287"/><area shape="rect" id="node20" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1709,260,1782,287"/><area shape="rect" id="node21" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1847,412,1897,439"/><area shape="rect" id="node23" href="../../dd/de4/toxcore_2group_8h.html#a16ac0b94fed484d710f76d390b7a85d8" title="new_groupchats" alt="" coords="1287,360,1405,387"/><area shape="rect" id="node24" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1525,361,1596,388"/><area shape="rect" id="node25" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1692,361,1799,388"/><area shape="rect" id="node26" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1713,311,1777,337"/><area shape="rect" id="node27" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1706,412,1785,439"/><area shape="rect" id="node28" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1720,463,1771,489"/><area shape="rect" id="node30" href="../../d8/da5/toxav_2group_8h.html#a3bb53f02b23ac60cb1e76d3717a4e2e5" title="join_av_groupchat" alt="" coords="1283,464,1409,491"/><area shape="rect" id="node32" href="../../d3/d8f/tox__old__code_8h.html#a26cf750df10de88c8e5024db883fff97" title="tox_join_groupchat" alt="" coords="1281,413,1411,440"/><area shape="rect" id="node31" href="../../d9/d82/toxav_8h.html#a02fd1017fbe8e974c2c0a39ee08067d7" title="toxav_join_av_groupchat" alt="" coords="1477,531,1644,557"/><area shape="rect" id="node33" href="../../d9/d35/tox__test_8c.html#ad249c87d6056da5531b1e4265c03001a" title="print_group_invite\l_callback" alt="" coords="1499,465,1623,506"/><area shape="rect" id="node35" href="../../db/d11/irc__syncbot_8c.html#acfc0f8259fbefbcb0ca1256c6842e7d4" title="callback_group_invite" alt="" coords="1487,311,1634,337"/><area shape="rect" id="node36" href="../../d2/d65/n_tox_8c.html#a1b2b2f68f7d6d5ebeb8cd60c0368cc51" title="print_invite" alt="" coords="1518,413,1603,440"/><area shape="rect" id="node34" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="1692,564,1799,591"/><area shape="rect" id="node38" href="../../db/d46/toxav_2group_8c.html#a8b24466efb3298dc9fef80bf18485b82" title="send_audio_packet" alt="" coords="882,479,1017,505"/><area shape="rect" id="node39" href="../../d8/da5/toxav_2group_8h.html#abed2d235751a4282d79ff38abc3bf228" title="group_send_audio" alt="" coords="1083,493,1209,520"/><area shape="rect" id="node40" href="../../d9/d82/toxav_8h.html#ad78d09fb2b5ac7b1bd5c2395a7bdb5c6" title="toxav_group_send_audio" alt="" coords="1263,515,1429,541"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4c1d29e0d6cd3c6d9dd8b613f2cc3afb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int send_tcp_onion_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>TCP_conn_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01824">1824</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00179">Net_Crypto::tcp_c</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00182">Net_Crypto::tcp_mutex</a>, and <a class="el" href="../../d5/d26/_t_c_p__connection_8c_source.html#l00305">tcp_send_onion_request()</a>.</p>

<p>Referenced by <a class="el" href="../../db/d79/onion__client_8c_source.html#l00311">send_onion_packet_tcp_udp()</a>.</p>
<div class="fragment"><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;{</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    pthread_mutex_lock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="../../d5/d26/_t_c_p__connection_8c.html#afb1a507e5f1af925b01666f1b9b4960a">tcp_send_onion_request</a>(c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">tcp_c</a>, tcp_connections_number, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>, length);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    pthread_mutex_unlock(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">tcp_mutex</a>);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;}</div>
<div class="ttc" id="_t_c_p__connection_8c_html_afb1a507e5f1af925b01666f1b9b4960a"><div class="ttname"><a href="../../d5/d26/_t_c_p__connection_8c.html#afb1a507e5f1af925b01666f1b9b4960a">tcp_send_onion_request</a></div><div class="ttdeci">int tcp_send_onion_request(TCP_Connections *tcp_c, unsigned int tcp_connections_number, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d26/_t_c_p__connection_8c_source.html#l00305">TCP_connection.c:305</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a2e8f7f4dff2f2fc4ac2cc32b0c886974"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a2e8f7f4dff2f2fc4ac2cc32b0c886974">Net_Crypto::tcp_mutex</a></div><div class="ttdeci">pthread_mutex_t tcp_mutex</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00182">net_crypto.h:182</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="struct_net___crypto_html_a179982a02be89eaf6617ed81bd3c0961"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#a179982a02be89eaf6617ed81bd3c0961">Net_Crypto::tcp_c</a></div><div class="ttdeci">TCP_Connections * tcp_c</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00179">net_crypto.h:179</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_cgraph" id="de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_cgraph">
<area shape="rect" id="node2" href="../../d5/d26/_t_c_p__connection_8c.html#afb1a507e5f1af925b01666f1b9b4960a" title="tcp_send_onion_request" alt="" coords="216,81,379,108"/><area shape="rect" id="node3" href="../../da/da1/_t_c_p__client_8c.html#a236ad67f85cc718a03fda2da3ade0787" title="send_onion_request" alt="" coords="427,81,565,108"/><area shape="rect" id="node4" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="613,74,789,115"/><area shape="rect" id="node5" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="853,5,987,32"/><area shape="rect" id="node7" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="837,56,1003,83"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="859,107,981,133"/><area shape="rect" id="node9" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="875,157,965,184"/><area shape="rect" id="node6" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="1051,5,1252,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_icgraph" id="de/d42/net__crypto_8h_a4c1d29e0d6cd3c6d9dd8b613f2cc3afb_icgraph">
<area shape="rect" id="node2" href="../../db/d79/onion__client_8c.html#a4be9a76607f006a407f4f96dd49f25da" title="send_onion_packet_tcp_udp" alt="" coords="216,161,403,188"/><area shape="rect" id="node3" href="../../db/d79/onion__client_8c.html#a4253f1739f978c9aac584c97b7a55f48" title="client_send_announce\l_request" alt="" coords="451,114,601,155"/><area shape="rect" id="node29" href="../../d9/d26/onion__client_8h.html#aa1be42b5ea93bd068f47271831157927" title="send_onion_data" alt="" coords="466,201,586,228"/><area shape="rect" id="node4" href="../../db/d79/onion__client_8c.html#a934df896ad375a9dbd82f563fb27144f" title="client_ping_nodes" alt="" coords="662,49,789,76"/><area shape="rect" id="node19" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="903,151,978,177"/><area shape="rect" id="node28" href="../../db/d79/onion__client_8c.html#ae37f00e2304222b24cef2cce370e58d3" title="do_announce" alt="" coords="676,100,775,127"/><area shape="rect" id="node5" href="../../db/d79/onion__client_8c.html#acef82e3853e62dce8cd45450ff028f97" title="handle_announce_response" alt="" coords="849,49,1032,76"/><area shape="rect" id="node6" href="../../db/d79/onion__client_8c.html#a3519dd95525df398b46b0e4a928f54f0" title="handle_tcp_onion" alt="" coords="1080,24,1203,51"/><area shape="rect" id="node7" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="1251,63,1373,89"/><area shape="rect" id="node8" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1435,56,1525,83"/><area shape="rect" id="node10" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1421,157,1539,184"/><area shape="rect" id="node9" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1587,56,1693,83"/><area shape="rect" id="node11" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1615,157,1665,184"/><area shape="rect" id="node12" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1605,107,1675,133"/><area shape="rect" id="node13" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1741,56,1848,83"/><area shape="rect" id="node14" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1763,5,1827,32"/><area shape="rect" id="node16" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1755,157,1834,184"/><area shape="rect" id="node18" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1769,107,1820,133"/><area shape="rect" id="node15" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1896,56,1947,83"/><area shape="rect" id="node17" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1896,208,1947,235"/><area shape="rect" id="node20" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="1085,141,1197,168"/><area shape="rect" id="node21" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="1271,123,1353,149"/><area shape="rect" id="node22" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1259,252,1365,279"/><area shape="rect" id="node23" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1455,303,1505,329"/><area shape="rect" id="node24" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1599,259,1681,285"/><area shape="rect" id="node25" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1741,360,1848,387"/><area shape="rect" id="node26" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1769,309,1821,336"/><area shape="rect" id="node27" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1758,259,1831,285"/><area shape="rect" id="node30" href="../../d0/d08/friend__connection_8h.html#a2af492c22c086276ed147d0826839d25" title="send_friend_request\l_packet" alt="" coords="871,245,1010,286"/><area shape="rect" id="node32" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="649,201,801,228"/><area shape="rect" id="node31" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="1100,252,1183,279"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8ced4e168a95db5708bf4b3095cb4df6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_direct_ip_port </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>&#160;</td>
          <td class="paramname"><em>ip_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Bool&#160;</td>
          <td class="paramname"><em>connected</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l01680">1680</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../d7/d40/list_8c_source.html#l00177">bs_list_add()</a>, <a class="el" href="../../d7/d40/list_8c_source.html#l00217">bs_list_remove()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00122">Crypto_Connection::direct_lastrecv_time</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00154">IP::family</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00121">Crypto_Connection::ip_port</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00202">Net_Crypto::ip_port_list</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00749">ipport_equal()</a>, <a class="el" href="../../d1/de5/_l_a_n__discovery_8c_source.html#l00259">LAN_ip()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00063">UDP_DIRECT_TIMEOUT</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00049">unix_time()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00265">dht_ip_callback()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00791">do_friend_connections()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00453">handle_new_connections()</a>.</p>
<div class="fragment"><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;{</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span> (ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> != AF_INET &amp;&amp; ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> != AF_INET6)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d6e/network_8c.html#a6913335cf0b2a76303f5f61d18ea2277">ipport_equal</a>(&amp;ip_port, &amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>)) {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../de/d42/net__crypto_8h.html#a0c533e2029f9b1bdb8a368a7308253c0">UDP_DIRECT_TIMEOUT</a> + conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ac6eb8a274b0dedea83359f2d9269cbc2">direct_lastrecv_time</a>) &gt; <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>()) {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            <span class="comment">/* We already know a LAN ip, no need to switch. */</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152">LAN_ip</a>(conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>) == 0)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="comment">/* Prefer ipv6. */</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == AF_INET6 &amp;&amp; ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == AF_INET)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d7/d40/list_8c.html#ace05755dd126bff18700a17d6f8edd28">bs_list_add</a>(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">ip_port_list</a>, (uint8_t *)&amp;ip_port, crypt_connection_id)) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <a class="code" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f">bs_list_remove</a>(&amp;c-&gt;<a class="code" href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">ip_port_list</a>, (uint8_t *)&amp;conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, crypt_connection_id);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = ip_port;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            <span class="keywordflow">if</span> (connected) {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ac6eb8a274b0dedea83359f2d9269cbc2">direct_lastrecv_time</a> = <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>();</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ac6eb8a274b0dedea83359f2d9269cbc2">direct_lastrecv_time</a> = 0;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;}</div>
<div class="ttc" id="list_8c_html_ace05755dd126bff18700a17d6f8edd28"><div class="ttname"><a href="../../d7/d40/list_8c.html#ace05755dd126bff18700a17d6f8edd28">bs_list_add</a></div><div class="ttdeci">int bs_list_add(BS_LIST *list, const uint8_t *data, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00177">list.c:177</a></div></div>
<div class="ttc" id="list_8c_html_a365995457101cc16f8c6b25ead07fb6f"><div class="ttname"><a href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f">bs_list_remove</a></div><div class="ttdeci">int bs_list_remove(BS_LIST *list, const uint8_t *data, int id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/list_8c_source.html#l00217">list.c:217</a></div></div>
<div class="ttc" id="util_8c_html_ac958d9f8847cb8039444bfa3d304233a"><div class="ttname"><a href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a></div><div class="ttdeci">uint64_t unix_time()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00049">util.c:49</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Crypto_Connection::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00121">net_crypto.h:121</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ac6eb8a274b0dedea83359f2d9269cbc2"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ac6eb8a274b0dedea83359f2d9269cbc2">Crypto_Connection::direct_lastrecv_time</a></div><div class="ttdeci">uint64_t direct_lastrecv_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00122">net_crypto.h:122</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="network_8c_html_a6913335cf0b2a76303f5f61d18ea2277"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a6913335cf0b2a76303f5f61d18ea2277">ipport_equal</a></div><div class="ttdeci">int ipport_equal(const IP_Port *a, const IP_Port *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00749">network.c:749</a></div></div>
<div class="ttc" id="struct_i_p_html_adad4493a852deb413bb8c515368deaac"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">IP::family</a></div><div class="ttdeci">uint8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="struct_net___crypto_html_ae8cfe94df9c9030bbc525010603450ac"><div class="ttname"><a href="../../de/d49/struct_net___crypto.html#ae8cfe94df9c9030bbc525010603450ac">Net_Crypto::ip_port_list</a></div><div class="ttdeci">BS_LIST ip_port_list</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00202">net_crypto.h:202</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="_l_a_n__discovery_8c_html_a2d80a53390598eb8ededbc63f4e9c152"><div class="ttname"><a href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152">LAN_ip</a></div><div class="ttdeci">int LAN_ip(IP ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de5/_l_a_n__discovery_8c_source.html#l00259">LAN_discovery.c:259</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a0c533e2029f9b1bdb8a368a7308253c0"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a0c533e2029f9b1bdb8a368a7308253c0">UDP_DIRECT_TIMEOUT</a></div><div class="ttdeci">#define UDP_DIRECT_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00063">net_crypto.h:63</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_cgraph" id="de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_cgraph">
<area shape="rect" id="node2" href="../../d7/d40/list_8c.html#ace05755dd126bff18700a17d6f8edd28" title="bs_list_add" alt="" coords="211,9,299,36"/><area shape="rect" id="node5" href="../../d7/d40/list_8c.html#a365995457101cc16f8c6b25ead07fb6f" title="bs_list_remove" alt="" coords="200,60,311,87"/><area shape="rect" id="node6" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="179,115,332,141"/><area shape="rect" id="node8" href="../../d6/d6e/network_8c.html#a6913335cf0b2a76303f5f61d18ea2277" title="ipport_equal" alt="" coords="209,165,301,192"/><area shape="rect" id="node10" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="223,240,288,267"/><area shape="rect" id="node12" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="216,291,295,317"/><area shape="rect" id="node3" href="../../d7/d40/list_8c.html#ae2aaa4149a770ed6e47a58af78fc6600" title="find" alt="" coords="428,56,471,83"/><area shape="rect" id="node4" href="../../d7/d40/list_8c.html#a7c246868ee5a3542509cdf90379c5bb2" title="resize" alt="" coords="421,5,478,32"/><area shape="rect" id="node7" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="380,107,519,149"/><area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#af982256c6d8486349bdc13a920884ef6" title="ip_equal" alt="" coords="414,173,485,200"/><area shape="rect" id="node11" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="414,248,485,275"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_icgraph" id="de/d42/net__crypto_8h_a8ced4e168a95db5708bf4b3095cb4df6_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="179,396,291,423"/><area shape="rect" id="node6" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="883,472,1035,499"/><area shape="rect" id="node15" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="661,270,829,296"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="339,371,449,398"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="497,371,613,398"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="668,422,823,448"/><area shape="rect" id="node24" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="668,320,823,347"/><area shape="rect" id="node43" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="684,371,807,398"/><area shape="rect" id="node7" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1721,460,1828,487"/><area shape="rect" id="node8" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1965,258,2015,284"/><area shape="rect" id="node9" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1949,460,2031,487"/><area shape="rect" id="node10" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="2120,410,2227,436"/><area shape="rect" id="node11" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="2147,460,2199,487"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2275,322,2325,348"/><area shape="rect" id="node13" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="2137,359,2210,386"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2275,220,2325,247"/><area shape="rect" id="node16" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="877,219,1040,246"/><area shape="rect" id="node17" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1108,168,1225,195"/><area shape="rect" id="node18" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1341,168,1392,195"/><area shape="rect" id="node19" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1955,106,2025,132"/><area shape="rect" id="node20" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2120,232,2227,259"/><area shape="rect" id="node21" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2141,131,2205,158"/><area shape="rect" id="node22" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2134,80,2213,107"/><area shape="rect" id="node23" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2148,182,2199,208"/><area shape="rect" id="node25" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="891,371,1026,398"/><area shape="rect" id="node27" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="904,320,1013,347"/><area shape="rect" id="node26" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1511,523,1618,550"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1120,219,1213,246"/><area shape="rect" id="node36" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1088,320,1245,347"/><area shape="rect" id="node29" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1309,270,1425,296"/><area shape="rect" id="node33" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1293,219,1440,246"/><area shape="rect" id="node35" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="1937,156,2043,183"/><area shape="rect" id="node30" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1488,266,1641,308"/><area shape="rect" id="node31" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1716,118,1833,144"/><area shape="rect" id="node32" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="1937,207,2043,234"/><area shape="rect" id="node34" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1539,215,1590,242"/><area shape="rect" id="node37" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1305,320,1429,347"/><area shape="rect" id="node38" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1516,354,1613,380"/><area shape="rect" id="node39" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1689,396,1860,423"/><area shape="rect" id="node40" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="1915,308,2065,335"/><area shape="rect" id="node41" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="1908,359,2072,386"/><area shape="rect" id="node42" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="2120,308,2227,335"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab17ccce6d503f75b7d98be214ebd7621"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t write_cryptpacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d49/struct_net___crypto.html">Net_Crypto</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>crypt_connection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>congestion_control</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l02219">2219</a> of file <a class="el" href="../../d8/dc6/net__crypto_8c_source.html">net_crypto.c</a>.</p>

<p>References <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00036">CRYPTO_CONN_ESTABLISHED</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00070">CRYPTO_RESERVED_PACKETS</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00378">get_crypto_connection()</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00076">PACKET_ID_LOSSY_RANGE_START</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00146">Crypto_Connection::packets_left</a>, <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00151">Crypto_Connection::packets_sent</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00831">send_lossless_packet()</a>, and <a class="el" href="../../de/d42/net__crypto_8h_source.html#l00108">Crypto_Connection::status</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00454">m_send_message_generic()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01714">send_custom_lossless_packet()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01287">send_file_data_packet()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00731">send_friend_request_packet()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00157">send_offline_packet()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00147">send_online_packet()</a>, <a class="el" href="../../df/de9/toxcore_2group_8c_source.html#l00855">send_packet_group_peer()</a>, <a class="el" href="../../df/de9/toxcore_2group_8c_source.html#l01359">send_packet_online()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00523">send_ping()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00210">send_relays()</a>, and <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l00893">write_cryptpacket_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;{</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordflow">if</span> (length == 0)</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[0] &lt; <a class="code" href="../../de/d42/net__crypto_8h.html#a98aaeb516244f1581d65e3dbb008979e">CRYPTO_RESERVED_PACKETS</a>)</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[0] &gt;= <a class="code" href="../../de/d42/net__crypto_8h.html#a02481d2cc931289c2d5ee21d2a633316">PACKET_ID_LOSSY_RANGE_START</a>)</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <a class="code" href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a> *conn = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a>(c, crypt_connection_id);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">if</span> (conn == 0)</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">status</a> != <a class="code" href="../../de/d42/net__crypto_8h.html#ae15ad1cc9a29a669e0df83d610c188b0">CRYPTO_CONN_ESTABLISHED</a>)</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="keywordflow">if</span> (congestion_control &amp;&amp; conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">packets_left</a> == 0)</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    int64_t ret = <a class="code" href="../../d8/dc6/net__crypto_8c.html#a06c8bdc27b9865d1b7d775b654f44d1a">send_lossless_packet</a>(c, crypt_connection_id, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>, length, congestion_control);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keywordflow">if</span> (ret == -1)</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">if</span> (congestion_control) {</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        --conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">packets_left</a>;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        conn-&gt;<a class="code" href="../../d6/db7/struct_crypto___connection.html#ad51d37ac38989c1d089da8aa0d1bc1d7">packets_sent</a>++;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;}</div>
<div class="ttc" id="struct_crypto___connection_html_ad51d37ac38989c1d089da8aa0d1bc1d7"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ad51d37ac38989c1d089da8aa0d1bc1d7">Crypto_Connection::packets_sent</a></div><div class="ttdeci">uint32_t packets_sent</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00151">net_crypto.h:151</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a909daa4b6d420cbd028f2c956a8642db"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db">get_crypto_connection</a></div><div class="ttdeci">static Crypto_Connection * get_crypto_connection(const Net_Crypto *c, int crypt_connection_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00378">net_crypto.c:378</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a98aaeb516244f1581d65e3dbb008979e"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a98aaeb516244f1581d65e3dbb008979e">CRYPTO_RESERVED_PACKETS</a></div><div class="ttdeci">#define CRYPTO_RESERVED_PACKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00070">net_crypto.h:70</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_adfabcbe80305cc6b4e1c0dfef5c48653"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#adfabcbe80305cc6b4e1c0dfef5c48653">Crypto_Connection::packets_left</a></div><div class="ttdeci">uint32_t packets_left</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00146">net_crypto.h:146</a></div></div>
<div class="ttc" id="net__crypto_8h_html_ae15ad1cc9a29a669e0df83d610c188b0"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#ae15ad1cc9a29a669e0df83d610c188b0">CRYPTO_CONN_ESTABLISHED</a></div><div class="ttdeci">#define CRYPTO_CONN_ESTABLISHED</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00036">net_crypto.h:36</a></div></div>
<div class="ttc" id="net__crypto_8h_html_a02481d2cc931289c2d5ee21d2a633316"><div class="ttname"><a href="../../de/d42/net__crypto_8h.html#a02481d2cc931289c2d5ee21d2a633316">PACKET_ID_LOSSY_RANGE_START</a></div><div class="ttdeci">#define PACKET_ID_LOSSY_RANGE_START</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00076">net_crypto.h:76</a></div></div>
<div class="ttc" id="struct_crypto___connection_html_ade818037fd6c985038ff29656089758d"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html#ade818037fd6c985038ff29656089758d">Crypto_Connection::status</a></div><div class="ttdeci">uint8_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00108">net_crypto.h:108</a></div></div>
<div class="ttc" id="struct_crypto___connection_html"><div class="ttname"><a href="../../d6/db7/struct_crypto___connection.html">Crypto_Connection</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d42/net__crypto_8h_source.html#l00100">net_crypto.h:100</a></div></div>
<div class="ttc" id="net__crypto_8c_html_a06c8bdc27b9865d1b7d775b654f44d1a"><div class="ttname"><a href="../../d8/dc6/net__crypto_8c.html#a06c8bdc27b9865d1b7d775b654f44d1a">send_lossless_packet</a></div><div class="ttdeci">static int64_t send_lossless_packet(Net_Crypto *c, int crypt_connection_id, const uint8_t *data, uint16_t length, uint8_t congestion_control)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc6/net__crypto_8c_source.html#l00831">net_crypto.c:831</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_cgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_cgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_cgraph" id="de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_cgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a909daa4b6d420cbd028f2c956a8642db" title="get_crypto_connection" alt="" coords="1408,204,1561,231"/><area shape="rect" id="node4" href="../../d8/dc6/net__crypto_8c.html#a06c8bdc27b9865d1b7d775b654f44d1a" title="send_lossless_packet" alt="" coords="179,144,329,171"/><area shape="rect" id="node3" href="../../d8/dc6/net__crypto_8c.html#a8aae93bf17f0b4a4305b88334e820310" title="crypt_connection_id\l_not_valid" alt="" coords="1631,197,1770,238"/><area shape="rect" id="node5" href="../../d8/dc6/net__crypto_8c.html#af55d3f30f6b07366883f01a8fa09d866" title="add_data_end_of_buffer" alt="" coords="386,43,547,69"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="609,245,770,272"/><area shape="rect" id="node8" href="../../d8/dc6/net__crypto_8c.html#a1e36bfc22078fc52c29d90e8ab79295d" title="get_data_pointer" alt="" coords="630,144,749,171"/><area shape="rect" id="node9" href="../../d8/dc6/net__crypto_8c.html#abb8a6ea2bdfb75eb366cc0a026649e2c" title="reset_max_speed_reached" alt="" coords="377,195,556,221"/><area shape="rect" id="node10" href="../../d8/dc6/net__crypto_8c.html#a572e703b36ffafdc4cf9dafd31a279d7" title="send_data_packet_helper" alt="" coords="604,296,775,323"/><area shape="rect" id="node6" href="../../d8/dc6/net__crypto_8c.html#abbe1101e6464100c19aea7cde5c1d3a0" title="num_packets_array" alt="" coords="621,43,757,69"/><area shape="rect" id="node11" href="../../d8/dc6/net__crypto_8c.html#a507dd998c297ff5a666bd08121dd4143" title="send_data_packet" alt="" coords="823,372,951,399"/><area shape="rect" id="node12" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="2056,639,2221,665"/><area shape="rect" id="node13" href="../../dc/d85/crypto__core_8c.html#ab953f1e92b8a9a193f69f02323b9c980" title="increment_nonce" alt="" coords="2078,695,2199,721"/><area shape="rect" id="node14" href="../../d8/dc6/net__crypto_8c.html#a94d4c99b16cb7bd2dd61f9a7a8caf94a" title="send_packet_to" alt="" coords="999,372,1113,399"/><area shape="rect" id="node15" href="../../d8/dc6/net__crypto_8c.html#afb5c59e6df7f38fe0bdf9e0f6c459869" title="crypto_connection_status" alt="" coords="1171,397,1342,424"/><area shape="rect" id="node21" href="../../d5/d26/_t_c_p__connection_8c.html#a455e955e01d34ff3db0b22b8f6d49d98" title="send_packet_tcp_connection" alt="" coords="1161,448,1352,475"/><area shape="rect" id="node32" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="1212,296,1301,323"/><area shape="rect" id="node16" href="../../d5/d26/_t_c_p__connection_8c.html#ae843b0b4c8041f08bf9c18f68cae8a61" title="tcp_connection_to_online\l_tcp_relays" alt="" coords="1400,326,1569,367"/><area shape="rect" id="node20" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1445,275,1524,301"/><area shape="rect" id="node17" href="../../d5/d26/_t_c_p__connection_8c.html#a95c3e01ee87339f2dc2e87646f464b51" title="get_connection" alt="" coords="1645,329,1756,356"/><area shape="rect" id="node19" href="../../d5/d26/_t_c_p__connection_8c.html#a255916e82a74ad6c617216af786ec335" title="online_tcp_connection\l_from_conn" alt="" coords="1625,263,1776,305"/><area shape="rect" id="node18" href="../../d5/d26/_t_c_p__connection_8c.html#aafa7b2a7f56b8f6bb0c1e44b9aec7262" title="connections_number\l_not_valid" alt="" coords="1849,322,1991,363"/><area shape="rect" id="node22" href="../../d5/d26/_t_c_p__connection_8c.html#ab051b2158958b954824dbed361ec588a" title="get_tcp_connection" alt="" coords="1417,445,1552,472"/><area shape="rect" id="node24" href="../../da/da1/_t_c_p__client_8c.html#aea842652030d00bd8302e3c0201f95b9" title="send_data" alt="" coords="1443,497,1526,524"/><area shape="rect" id="node31" href="../../da/da1/_t_c_p__client_8c.html#a7818a314434c2bb01c3ea406744f076b" title="send_oob_packet" alt="" coords="1423,573,1547,600"/><area shape="rect" id="node23" href="../../d5/d26/_t_c_p__connection_8c.html#ae8f5b59977d8d4221ff8da3922d257a5" title="tcp_connections_number\l_not_valid" alt="" coords="1617,381,1784,422"/><area shape="rect" id="node25" href="../../da/da1/_t_c_p__client_8c.html#a8e1ca90aa8db34a58b3b38cfcb1bb9de" title="send_ping_response" alt="" coords="1630,548,1771,575"/><area shape="rect" id="node26" href="../../da/da1/_t_c_p__client_8c.html#ab959397449cc23b5811168e4395bdaea" title="write_packet_TCP_secure\l_connection" alt="" coords="1832,546,2008,587"/><area shape="rect" id="node30" href="../../da/da1/_t_c_p__client_8c.html#a5aad81831c1333b763c9fd5eaf41603f" title="send_ping_request" alt="" coords="1635,497,1766,524"/><area shape="rect" id="node27" href="../../da/da1/_t_c_p__client_8c.html#a878656cc36ac482c8063082d0d86850f" title="send_pending_data" alt="" coords="2071,532,2206,559"/><area shape="rect" id="node29" href="../../da/da1/_t_c_p__client_8c.html#a87e67ddfe8fdabe9f2d32080097c3970" title="add_priority" alt="" coords="2094,583,2183,609"/><area shape="rect" id="node28" href="../../da/da1/_t_c_p__client_8c.html#a531708d11982cfb4c8d31ac915c25386" title="send_pending_data_nonpriority" alt="" coords="2269,532,2471,559"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_icgraph.png" border="0" usemap="#de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_icgraph" alt=""/></div>
<map name="de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_icgraph" id="de/d42/net__crypto_8h_ab17ccce6d503f75b7d98be214ebd7621_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#a23c8b52187d4ab113cce5497a19ac997" title="m_send_message_generic" alt="" coords="393,883,571,909"/><area shape="rect" id="node10" href="../../d4/d30/_messenger_8h.html#a14ab15b529cd99d1f87ecf21c75456e1" title="send_custom_lossless\l_packet" alt="" coords="185,741,339,782"/><area shape="rect" id="node12" href="../../d8/d8d/_messenger_8c.html#a2daa1e5d6fa9bc3c7c92d3cd46b11fb7" title="send_file_data_packet" alt="" coords="186,317,338,344"/><area shape="rect" id="node22" href="../../d0/d08/friend__connection_8h.html#a2af492c22c086276ed147d0826839d25" title="send_friend_request\l_packet" alt="" coords="193,179,331,221"/><area shape="rect" id="node23" href="../../d8/d8d/_messenger_8c.html#ab4bf3c92ac721d93b6c8a014cd6ddfea" title="send_offline_packet" alt="" coords="193,947,331,973"/><area shape="rect" id="node28" href="../../d8/d8d/_messenger_8c.html#a3bf115e8b97c037d1d40faa946905b3b" title="send_online_packet" alt="" coords="413,664,551,691"/><area shape="rect" id="node30" href="../../df/de9/toxcore_2group_8c.html#a80236daa3393e2c93424b05ce6f63dcb" title="send_packet_group_peer" alt="" coords="179,1085,345,1112"/><area shape="rect" id="node36" href="../../df/de9/toxcore_2group_8c.html#af7c31fe40ea58b07c87e38ef94f13eac" title="send_packet_online" alt="" coords="193,1263,331,1289"/><area shape="rect" id="node39" href="../../d2/db1/friend__connection_8c.html#a8896f283aafad13adc5b68311cf24cd2" title="send_ping" alt="" coords="221,24,303,51"/><area shape="rect" id="node41" href="../../d2/db1/friend__connection_8c.html#a6e0e582317de001468faab8240bd2b5c" title="send_relays" alt="" coords="216,92,308,119"/><area shape="rect" id="node42" href="../../d8/d8d/_messenger_8c.html#af2b983c0aba45068c878e24e155f1ed2" title="write_cryptpacket_id" alt="" coords="411,411,553,437"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1204,872,1255,899"/><area shape="rect" id="node4" href="../../db/de9/_messenger__test_8c.html#a7a4fea32f3eb3f26cf343c951bbfae68" title="print_message" alt="" coords="1024,1009,1131,1036"/><area shape="rect" id="node5" href="../../d8/dda/messenger__test_8c.html#acb2665d4ea00c2da66251120149841f1" title="START_TEST" alt="" coords="653,832,759,859"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a89cd6aedba9fca87bd66a9713dc6b503" title="tox_friend_send_message" alt="" coords="619,883,793,909"/><area shape="rect" id="node7" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="843,803,949,829"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="859,984,933,1011"/><area shape="rect" id="node9" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="871,883,921,909"/><area shape="rect" id="node11" href="../../da/d8f/tox_8h.html#ac162368b375a58b5d7d4b29584449bdd" title="tox_friend_send_lossless\l_packet" alt="" coords="621,766,791,807"/><area shape="rect" id="node13" href="../../d4/d30/_messenger_8h.html#a2d94ca52e2129848ab7b137edb049eb4" title="file_data" alt="" coords="447,237,517,264"/><area shape="rect" id="node14" href="../../d8/d8d/_messenger_8c.html#a74c09bcf488256da7b3ed899f541fc8c" title="do_reqchunk_filecb" alt="" coords="639,157,773,184"/><area shape="rect" id="node17" href="../../d8/d8d/_messenger_8c.html#a8fce9b8564a3a552ff2b77a9f81914ad" title="handle_packet" alt="" coords="653,512,759,539"/><area shape="rect" id="node21" href="../../da/d8f/tox_8h.html#a7653dd0bbf8bda8e18d211277f3e7577" title="tox_file_send_chunk" alt="" coords="635,107,777,133"/><area shape="rect" id="node15" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="855,233,937,260"/><area shape="rect" id="node16" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1024,233,1131,260"/><area shape="rect" id="node18" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="841,689,951,716"/><area shape="rect" id="node19" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1031,811,1124,837"/><area shape="rect" id="node20" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="999,689,1156,716"/><area shape="rect" id="node24" href="../../d4/d30/_messenger_8h.html#a7a7b52e12232948dfe96d8e7dea50610" title="m_delfriend" alt="" coords="437,984,527,1011"/><area shape="rect" id="node25" href="../../d8/dda/messenger__test_8c.html#a921391ba2a74ae4536cfcd2c789c78f9" title="messenger_suite" alt="" coords="645,1136,767,1163"/><area shape="rect" id="node26" href="../../d8/dda/messenger__test_8c.html#a0d7e5cba3f1de72c42741b80489f5df0" title="START_TEST" alt="" coords="653,1085,759,1112"/><area shape="rect" id="node27" href="../../da/d8f/tox_8h.html#ae7909e1bb1cf6d8073d38aac41c2fb9c" title="tox_friend_delete" alt="" coords="645,984,767,1011"/><area shape="rect" id="node29" href="../../d8/d8d/_messenger_8c.html#a2be56d7329b8b89d95918eba9b692c71" title="handle_status" alt="" coords="655,715,757,741"/><area shape="rect" id="node31" href="../../df/de9/toxcore_2group_8c.html#a8b14c71c58c2bd20999d0fb1ddd6b0bc" title="send_message_all_close" alt="" coords="398,1136,566,1163"/><area shape="rect" id="node32" href="../../df/de9/toxcore_2group_8c.html#a0f7888238b6e47dd9f4e80ab1f33312c" title="send_peer_kill" alt="" coords="429,1187,535,1213"/><area shape="rect" id="node34" href="../../df/de9/toxcore_2group_8c.html#a1d102fdae79367ce06e55cda3cd9f441" title="send_peer_query" alt="" coords="421,1035,543,1061"/><area shape="rect" id="node35" href="../../df/de9/toxcore_2group_8c.html#a45538eb41a1837f5f6c76014cb18bf70" title="send_peers" alt="" coords="437,1085,527,1112"/><area shape="rect" id="node33" href="../../df/de9/toxcore_2group_8c.html#aadd3b840d1ca411fc2345ec2c9f6bfe7" title="handle_packet_online" alt="" coords="633,1187,779,1213"/><area shape="rect" id="node37" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="415,1288,549,1315"/><area shape="rect" id="node38" href="../../df/de9/toxcore_2group_8c.html#acd184cb8d897a453bde4b2a0ed5f37c1" title="set_conns_type_close" alt="" coords="406,1339,558,1365"/><area shape="rect" id="node40" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="406,5,558,32"/><area shape="rect" id="node43" href="../../d8/d8d/_messenger_8c.html#af0e440a0c993bf8a9adbf85b37753337" title="file_sendrequest" alt="" coords="647,411,765,437"/><area shape="rect" id="node44" href="../../d4/d30/_messenger_8h.html#a2374f56c7aeb5fa6d1a3f1a29bb5016b" title="m_msi_packet" alt="" coords="653,461,759,488"/><area shape="rect" id="node45" href="../../d8/d8d/_messenger_8c.html#a5328e9c55aff292c735e70c1953d49d4" title="m_sendname" alt="" coords="656,259,756,285"/><area shape="rect" id="node46" href="../../d8/d8d/_messenger_8c.html#a573ae5677a4dc9958bcec9bd3c9af6df" title="send_file_control_packet" alt="" coords="623,563,789,589"/><area shape="rect" id="node47" href="../../d4/d30/_messenger_8h.html#a64b0347daadcf7ef303ab013481b1eb2" title="send_group_invite_packet" alt="" coords="619,613,793,640"/><area shape="rect" id="node48" href="../../d8/d8d/_messenger_8c.html#a5ad1d3522f42e05278a777c9b5c70f66" title="send_statusmessage" alt="" coords="633,309,779,336"/><area shape="rect" id="node49" href="../../d8/d8d/_messenger_8c.html#a9cc7b7b8bc1c2acd9b63bbcc64d570df" title="send_user_istyping" alt="" coords="639,360,773,387"/><area shape="rect" id="node50" href="../../d8/d8d/_messenger_8c.html#aa43271679d82439481418e3251f5db4a" title="send_userstatus" alt="" coords="647,208,765,235"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 2 2015 23:41:27 for libtoxcore by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
