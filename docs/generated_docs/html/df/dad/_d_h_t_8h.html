<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>libtoxcore: toxcore/DHT.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../tox.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libtoxcore
   </div>
   <div id="projectbrief">The future of instant messaging</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_0b4cb6aa1b49ded7d7b217b80a3955c0.html">toxcore</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DHT.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../dd/d3e/crypto__core_8h_source.html">crypto_core.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d94/network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dec/ping__array_8h_source.html">ping_array.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for DHT.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/da0/_d_h_t_8h__incl.png" border="0" usemap="#toxcore_2_d_h_t_8h" alt=""/></div>
<map name="toxcore_2_d_h_t_8h" id="toxcore_2_d_h_t_8h">
<area shape="rect" id="node2" href="../../dd/d3e/crypto__core_8h.html" title="crypto_core.h" alt="" coords="701,80,803,107"/><area shape="rect" id="node3" href="../../d9/d94/network_8h.html" title="network.h" alt="" coords="591,155,670,181"/><area shape="rect" id="node19" href="../../dd/dec/ping__array_8h.html" title="ping_array.h" alt="" coords="584,80,677,107"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d66/_d_h_t_8h__dep__incl.png" border="0" usemap="#toxcore_2_d_h_t_8hdep" alt=""/></div>
<map name="toxcore_2_d_h_t_8hdep" id="toxcore_2_d_h_t_8hdep">
<area shape="rect" id="node2" href="../../db/d0f/assoc__test_8c.html" title="auto_tests/assoc_test.c" alt="" coords="5,80,168,107"/><area shape="rect" id="node3" href="../../de/d42/net__crypto_8h.html" title="toxcore/net_crypto.h" alt="" coords="811,386,952,413"/><area shape="rect" id="node5" href="../../d0/d08/friend__connection_8h.html" title="toxcore/friend_connection.h" alt="" coords="514,543,697,569"/><area shape="rect" id="node25" href="../../db/d5e/_d_h_t__bootstrap_8c.html" title="other/DHT_bootstrap.c" alt="" coords="1349,692,1504,719"/><area shape="rect" id="node26" href="../../d3/dfd/_d_h_t__test_8c.html" title="testing/DHT_test.c" alt="" coords="139,692,272,719"/><area shape="rect" id="node33" href="../../dd/db4/_l_a_n__discovery_8h.html" title="toxcore/LAN_discovery.h" alt="" coords="706,304,875,331"/><area shape="rect" id="node34" href="../../dc/dc1/_d_h_t_8c.html" title="toxcore/DHT.c" alt="" coords="433,386,541,413"/><area shape="rect" id="node37" href="../../d4/d9d/assoc_8c.html" title="toxcore/assoc.c" alt="" coords="293,386,408,413"/><area shape="rect" id="node40" href="../../d3/db9/onion_8h.html" title="toxcore/onion.h" alt="" coords="1473,80,1583,107"/><area shape="rect" id="node50" href="../../d9/d54/ping_8c.html" title="toxcore/ping.c" alt="" coords="2191,80,2295,107"/><area shape="rect" id="node4" href="../../d5/d29/crypto__test_8c.html" title="auto_tests/crypto_test.c" alt="" coords="808,468,971,495"/><area shape="rect" id="node29" href="../../d9/d26/onion__client_8h.html" title="toxcore/onion_client.h" alt="" coords="995,468,1144,495"/><area shape="rect" id="node32" href="../../d8/dc6/net__crypto_8c.html" title="toxcore/net_crypto.c" alt="" coords="643,468,784,495"/><area shape="rect" id="node6" href="../../d5/d24/friend__requests_8h.html" title="toxcore/friend_requests.h" alt="" coords="413,617,582,644"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html" title="toxcore/Messenger.h" alt="" coords="548,692,692,719"/><area shape="rect" id="node28" href="../../d2/db1/friend__connection_8c.html" title="toxcore/friend_connection.c" alt="" coords="658,617,841,644"/><area shape="rect" id="node7" href="../../d2/dee/friends__test_8c.html" title="auto_tests/friends\l_test.c" alt="" coords="207,767,334,808"/><area shape="rect" id="node27" href="../../d6/da4/friend__requests_8c.html" title="toxcore/friend_requests.c" alt="" coords="297,692,466,719"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html" title="auto_tests/messenger\l_test.c" alt="" coords="1011,767,1162,808"/><area shape="rect" id="node10" href="../../db/de9/_messenger__test_8c.html" title="testing/Messenger_test.c" alt="" coords="1186,774,1355,801"/><area shape="rect" id="node11" href="../../df/dc1/rtp_8h.html" title="toxav/rtp.h" alt="" coords="358,774,442,801"/><area shape="rect" id="node14" href="../../d9/d06/msi_8h.html" title="toxav/msi.h" alt="" coords="317,931,408,957"/><area shape="rect" id="node18" href="../../dd/de4/toxcore_2group_8h.html" title="toxcore/group.h" alt="" coords="517,774,629,801"/><area shape="rect" id="node22" href="../../d3/d69/tox_8c.html" title="toxcore/tox.c" alt="" coords="779,856,877,883"/><area shape="rect" id="node23" href="../../d8/d8d/_messenger_8c.html" title="toxcore/Messenger.c" alt="" coords="704,774,848,801"/><area shape="rect" id="node24" href="../../da/d84/toxdns_8c.html" title="toxdns/toxdns.c" alt="" coords="872,774,987,801"/><area shape="rect" id="node12" href="../../d1/d16/codec_8h.html" title="toxav/codec.h" alt="" coords="229,856,333,883"/><area shape="rect" id="node13" href="../../d5/def/codec_8c.html" title="toxav/codec.c" alt="" coords="189,1005,293,1032"/><area shape="rect" id="node17" href="../../d6/d46/rtp_8c.html" title="toxav/rtp.c" alt="" coords="358,856,442,883"/><area shape="rect" id="node16" href="../../d8/d0e/toxav_8c.html" title="toxav/toxav.c" alt="" coords="432,1005,533,1032"/><area shape="rect" id="node15" href="../../d2/d9b/msi_8c.html" title="toxav/msi.c" alt="" coords="317,1005,408,1032"/><area shape="rect" id="node19" href="../../d8/da5/toxav_2group_8h.html" title="toxav/group.h" alt="" coords="653,856,755,883"/><area shape="rect" id="node21" href="../../df/de9/toxcore_2group_8c.html" title="toxcore/group.c" alt="" coords="517,856,629,883"/><area shape="rect" id="node20" href="../../db/d46/toxav_2group_8c.html" title="toxav/group.c" alt="" coords="653,931,755,957"/><area shape="rect" id="node30" href="../../d7/dd9/onion__test_8c.html" title="auto_tests/onion_test.c" alt="" coords="1433,543,1591,569"/><area shape="rect" id="node31" href="../../db/d79/onion__client_8c.html" title="toxcore/onion_client.c" alt="" coords="1020,543,1169,569"/><area shape="rect" id="node36" href="../../d1/d36/tox-bootstrapd_8c.html" title="other/bootstrap_daemon\l/tox&#45;bootstrapd.c" alt="" coords="1277,379,1440,420"/><area shape="rect" id="node38" href="../../d1/de5/_l_a_n__discovery_8c.html" title="toxcore/LAN_discovery.c" alt="" coords="617,386,786,413"/><area shape="rect" id="node39" href="../../df/d75/onion__announce_8c.html" title="toxcore/onion_announce.c" alt="" coords="1078,386,1253,413"/><area shape="rect" id="node35" href="../../d2/d98/dht__test_8c.html" title="auto_tests/dht_test.c" alt="" coords="371,468,517,495"/><area shape="rect" id="node41" href="../../d6/d03/_t_c_p__server_8h.html" title="toxcore/TCP_server.h" alt="" coords="1701,155,1851,181"/><area shape="rect" id="node48" href="../../d7/dfd/onion__announce_8h.html" title="toxcore/onion_announce.h" alt="" coords="1315,304,1490,331"/><area shape="rect" id="node49" href="../../d4/d18/onion_8c.html" title="toxcore/onion.c" alt="" coords="1566,155,1677,181"/><area shape="rect" id="node42" href="../../d0/df3/_t_c_p__client_8h.html" title="toxcore/TCP_client.h" alt="" coords="1853,229,1998,256"/><area shape="rect" id="node44" href="../../d2/d8d/_t_c_p__test_8c.html" title="auto_tests/TCP_test.c" alt="" coords="1961,386,2116,413"/><area shape="rect" id="node47" href="../../d4/d40/_t_c_p__server_8c.html" title="toxcore/TCP_server.c" alt="" coords="1678,229,1829,256"/><area shape="rect" id="node43" href="../../da/d39/_t_c_p__connection_8h.html" title="toxcore/TCP_connection.h" alt="" coords="1837,304,2014,331"/><area shape="rect" id="node46" href="../../da/da1/_t_c_p__client_8c.html" title="toxcore/TCP_client.c" alt="" coords="1667,304,1813,331"/><area shape="rect" id="node45" href="../../d5/d26/_t_c_p__connection_8c.html" title="toxcore/TCP_connection.c" alt="" coords="1759,386,1937,413"/></map>
</div>
</div>
<p><a href="../../df/dad/_d_h_t_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/df1/struct_i_p_p_ts.html">IPPTs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dee/struct_hardening.html">Hardening</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d1c/struct_client__data.html">Client_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d70/struct_n_a_t.html">NAT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d07/struct_shared___keys.html">Shared_Keys</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d54/struct_cryptopacket___handles.html">Cryptopacket_Handles</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad50d158518277ca4d19cbe364f3e958c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:ad50d158518277ca4d19cbe364f3e958c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3058f857a8316099e20c95fb07adc7c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a3058f857a8316099e20c95fb07adc7c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f4cf16e79a384d7d59a3cc585ea5a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a57f4cf16e79a384d7d59a3cc585ea5a3">MAX_SENT_NODES</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a57f4cf16e79a384d7d59a3cc585ea5a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a733f0d1225f97d8acbd3388e0c0d320f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a733f0d1225f97d8acbd3388e0c0d320f">PING_TIMEOUT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a733f0d1225f97d8acbd3388e0c0d320f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa025d4328dd829fe6d532d3abaf3bc7e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#aa025d4328dd829fe6d532d3abaf3bc7e">DHT_PING_ARRAY_SIZE</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:aa025d4328dd829fe6d532d3abaf3bc7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae138d10c7cd4199e5e96377ff1f8e317"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ae138d10c7cd4199e5e96377ff1f8e317">PING_INTERVAL</a>&#160;&#160;&#160;60</td></tr>
<tr class="separator:ae138d10c7cd4199e5e96377ff1f8e317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab913d567642bd6e0575d300f2a46867f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ab913d567642bd6e0575d300f2a46867f">PINGS_MISSED_NODE_GOES_BAD</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ab913d567642bd6e0575d300f2a46867f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25f73f46016db9ae16581ab70e911a2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ab25f73f46016db9ae16581ab70e911a2">PING_ROUNDTRIP</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ab25f73f46016db9ae16581ab70e911a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c542fd03a43f340d1fb281afe54453f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>&#160;&#160;&#160;(<a class="el" href="../../df/dad/_d_h_t_8h.html#ae138d10c7cd4199e5e96377ff1f8e317">PING_INTERVAL</a> + <a class="el" href="../../df/dad/_d_h_t_8h.html#ab913d567642bd6e0575d300f2a46867f">PINGS_MISSED_NODE_GOES_BAD</a> * (<a class="el" href="../../df/dad/_d_h_t_8h.html#ae138d10c7cd4199e5e96377ff1f8e317">PING_INTERVAL</a> + <a class="el" href="../../df/dad/_d_h_t_8h.html#ab25f73f46016db9ae16581ab70e911a2">PING_ROUNDTRIP</a>))</td></tr>
<tr class="separator:a2c542fd03a43f340d1fb281afe54453f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35a63082a23b6ced97c0a3a24ba06be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ac35a63082a23b6ced97c0a3a24ba06be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a025adcf535ab2c7123fb5ea22fe20bbd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a025adcf535ab2c7123fb5ea22fe20bbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59616c5422ae79ebc665059761879d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ab59616c5422ae79ebc665059761879d5">TOX_TCP_INET</a>&#160;&#160;&#160;130</td></tr>
<tr class="separator:ab59616c5422ae79ebc665059761879d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30bf86f2e1f87bcbd6a90145943aabac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a30bf86f2e1f87bcbd6a90145943aabac">TOX_TCP_INET6</a>&#160;&#160;&#160;138</td></tr>
<tr class="separator:a30bf86f2e1f87bcbd6a90145943aabac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09839809f361926e324196bfd9450bb4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a09839809f361926e324196bfd9450bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2a8d3d5ad30ebd3efec91f27ccf394"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a5a2a8d3d5ad30ebd3efec91f27ccf394">DHT_FRIEND_MAX_LOCKS</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a5a2a8d3d5ad30ebd3efec91f27ccf394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5450da86fcf09134330aeef7cd8c35f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ae5450da86fcf09134330aeef7cd8c35f">MAX_KEYS_PER_SLOT</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ae5450da86fcf09134330aeef7cd8c35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0aff5d0e177e2fe1f826e225223867"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a1b0aff5d0e177e2fe1f826e225223867">KEYS_TIMEOUT</a>&#160;&#160;&#160;600</td></tr>
<tr class="separator:a1b0aff5d0e177e2fe1f826e225223867"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abf840e82128d3aee3c9fc5ff51e83a14"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#abf840e82128d3aee3c9fc5ff51e83a14">cryptopacket_handler_callback</a> )(void *object, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, const uint8_t *source_pubkey, const uint8_t *data, uint16_t len)</td></tr>
<tr class="separator:abf840e82128d3aee3c9fc5ff51e83a14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae7f65a76f9c4b0093f45fc1777238459"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ae7f65a76f9c4b0093f45fc1777238459">to_net_family</a> (<a class="el" href="../../d4/d6d/struct_i_p.html">IP</a> *<a class="el" href="../../db/d11/irc__syncbot_8c.html#ae81515e082f9bc33e8968181945586da">ip</a>)</td></tr>
<tr class="separator:ae7f65a76f9c4b0093f45fc1777238459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74120ec4fc551572bff2a08436854c97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a74120ec4fc551572bff2a08436854c97">to_host_family</a> (<a class="el" href="../../d4/d6d/struct_i_p.html">IP</a> *<a class="el" href="../../db/d11/irc__syncbot_8c.html#ae81515e082f9bc33e8968181945586da">ip</a>)</td></tr>
<tr class="separator:a74120ec4fc551572bff2a08436854c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa980937ac320a4389b726e04da26cb44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#aa980937ac320a4389b726e04da26cb44">packed_node_size</a> (uint8_t ip_family)</td></tr>
<tr class="separator:aa980937ac320a4389b726e04da26cb44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d6f2fcb008c989f333ae89e840f94b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a1d6f2fcb008c989f333ae89e840f94b4">pack_nodes</a> (uint8_t *data, uint16_t length, const <a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *nodes, uint16_t number)</td></tr>
<tr class="separator:a1d6f2fcb008c989f333ae89e840f94b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b33af842c0289c78c70f81e854ed62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a45b33af842c0289c78c70f81e854ed62">unpack_nodes</a> (<a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *nodes, uint16_t max_num_nodes, uint16_t *processed_data_len, const uint8_t *data, uint16_t length, uint8_t tcp_enabled)</td></tr>
<tr class="separator:a45b33af842c0289c78c70f81e854ed62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd4aa89d7bfcf6805c5ce6b273d9e9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e">get_shared_key</a> (<a class="el" href="../../d6/d07/struct_shared___keys.html">Shared_Keys</a> *shared_keys, uint8_t *shared_key, const uint8_t *secret_key, const uint8_t *public_key)</td></tr>
<tr class="separator:a6cd4aa89d7bfcf6805c5ce6b273d9e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e92f7714ab1f2b37b54e8479717cbc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a9e92f7714ab1f2b37b54e8479717cbc7">DHT_get_shared_key_recv</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, uint8_t *shared_key, const uint8_t *public_key)</td></tr>
<tr class="separator:a9e92f7714ab1f2b37b54e8479717cbc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087cceeacc5a14415b651c2980a24d34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a087cceeacc5a14415b651c2980a24d34">DHT_get_shared_key_sent</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, uint8_t *shared_key, const uint8_t *public_key)</td></tr>
<tr class="separator:a087cceeacc5a14415b651c2980a24d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a769ef744f969e1b4c55547cb74abee59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a769ef744f969e1b4c55547cb74abee59">DHT_getnodes</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> *from_ipp, const uint8_t *from_id, const uint8_t *which_id)</td></tr>
<tr class="separator:a769ef744f969e1b4c55547cb74abee59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dac5e05fd07964cb4914c17afeb9d50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a1dac5e05fd07964cb4914c17afeb9d50">DHT_addfriend</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *public_key, void(*ip_callback)(void *data, int32_t number, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>), void *data, int32_t number, uint16_t *lock_count)</td></tr>
<tr class="separator:a1dac5e05fd07964cb4914c17afeb9d50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e70f3fc186c6e459908307c935d00b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a4e70f3fc186c6e459908307c935d00b2">DHT_delfriend</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *public_key, uint16_t lock_count)</td></tr>
<tr class="separator:a4e70f3fc186c6e459908307c935d00b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963cf2afd9283277f69a94381e3fc5f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a963cf2afd9283277f69a94381e3fc5f0">DHT_getfriendip</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *public_key, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> *ip_port)</td></tr>
<tr class="separator:a963cf2afd9283277f69a94381e3fc5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a903a5bc580826fe447adb841b7782333"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a903a5bc580826fe447adb841b7782333">id_closest</a> (const uint8_t *pk, const uint8_t *pk1, const uint8_t *pk2)</td></tr>
<tr class="separator:a903a5bc580826fe447adb841b7782333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8abfc9cea3784b0cae354670bd4643cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a8abfc9cea3784b0cae354670bd4643cd">get_close_nodes</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *public_key, <a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *nodes_list, sa_family_t sa_family, uint8_t is_LAN, uint8_t want_good)</td></tr>
<tr class="separator:a8abfc9cea3784b0cae354670bd4643cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b03f88384f04514e392abd12ef30140"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a2b03f88384f04514e392abd12ef30140">closelist_nodes</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, <a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *nodes, uint16_t max_num)</td></tr>
<tr class="separator:a2b03f88384f04514e392abd12ef30140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5be9dfb66fbf1fa7c267b016f3357534"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534">do_DHT</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht)</td></tr>
<tr class="separator:a5be9dfb66fbf1fa7c267b016f3357534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d732074bab2377a7884c41c219cf96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ab6d732074bab2377a7884c41c219cf96">DHT_bootstrap</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, const uint8_t *public_key)</td></tr>
<tr class="separator:ab6d732074bab2377a7884c41c219cf96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af342c78837dbed569d4a75a0516455fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#af342c78837dbed569d4a75a0516455fc">DHT_bootstrap_from_address</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const char *address, uint8_t ipv6enabled, uint16_t <a class="el" href="../../db/d11/irc__syncbot_8c.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>, const uint8_t *public_key)</td></tr>
<tr class="separator:af342c78837dbed569d4a75a0516455fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5df2ff5066cf93898e531d320ddd675"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#ad5df2ff5066cf93898e531d320ddd675">DHT_connect_after_load</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht)</td></tr>
<tr class="separator:ad5df2ff5066cf93898e531d320ddd675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91072d384a61a04ac1e4d679dc7efb3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a91072d384a61a04ac1e4d679dc7efb3a">route_packet</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *public_key, const uint8_t *packet, uint16_t length)</td></tr>
<tr class="separator:a91072d384a61a04ac1e4d679dc7efb3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee23d763e291eefd141227cd9e3684ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#aee23d763e291eefd141227cd9e3684ab">route_tofriend</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *<a class="el" href="../../d8/dda/messenger__test_8c.html#a5d7925718457bca84bda0952f9463a3c">friend_id</a>, const uint8_t *packet, uint16_t length)</td></tr>
<tr class="separator:aee23d763e291eefd141227cd9e3684ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a097913efd03d5106a66c15eb48b0e104"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, uint8_t byte, <a class="el" href="../../df/dad/_d_h_t_8h.html#abf840e82128d3aee3c9fc5ff51e83a14">cryptopacket_handler_callback</a> cb, void *object)</td></tr>
<tr class="separator:a097913efd03d5106a66c15eb48b0e104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d92a2419bf9384e3cbfe0ec5a8f4d6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a55d92a2419bf9384e3cbfe0ec5a8f4d6">DHT_size</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht)</td></tr>
<tr class="separator:a55d92a2419bf9384e3cbfe0ec5a8f4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7510a9fdbacfffb5987590c4e193c40a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a7510a9fdbacfffb5987590c4e193c40a">DHT_save</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, uint8_t *data)</td></tr>
<tr class="separator:a7510a9fdbacfffb5987590c4e193c40a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36e42ad71b293cd0ada8a7b6de9ad86b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a36e42ad71b293cd0ada8a7b6de9ad86b">DHT_load</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, const uint8_t *data, uint32_t length)</td></tr>
<tr class="separator:a36e42ad71b293cd0ada8a7b6de9ad86b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad04fa897751b06948a172044bf1c58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58">new_DHT</a> (<a class="el" href="../../d3/d0b/struct_networking___core.html">Networking_Core</a> *net)</td></tr>
<tr class="separator:adad04fa897751b06948a172044bf1c58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a816851e4f0f454c52b93d65544a2b2bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a816851e4f0f454c52b93d65544a2b2bb">kill_DHT</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht)</td></tr>
<tr class="separator:a816851e4f0f454c52b93d65544a2b2bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93770fe498d41d1c6b420275680967b6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a93770fe498d41d1c6b420275680967b6">DHT_isconnected</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht)</td></tr>
<tr class="separator:a93770fe498d41d1c6b420275680967b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90cd93b83fdec619c4924fd20c4fc005"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a90cd93b83fdec619c4924fd20c4fc005">DHT_non_lan_connected</a> (const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht)</td></tr>
<tr class="separator:a90cd93b83fdec619c4924fd20c4fc005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d898065db0fd4adf26fdb7f80e6d7ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dad/_d_h_t_8h.html#a9d898065db0fd4adf26fdb7f80e6d7ac">addto_lists</a> (<a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, const uint8_t *public_key)</td></tr>
<tr class="separator:a9d898065db0fd4adf26fdb7f80e6d7ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a2c542fd03a43f340d1fb281afe54453f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BAD_NODE_TIMEOUT&#160;&#160;&#160;(<a class="el" href="../../df/dad/_d_h_t_8h.html#ae138d10c7cd4199e5e96377ff1f8e317">PING_INTERVAL</a> + <a class="el" href="../../df/dad/_d_h_t_8h.html#ab913d567642bd6e0575d300f2a46867f">PINGS_MISSED_NODE_GOES_BAD</a> * (<a class="el" href="../../df/dad/_d_h_t_8h.html#ae138d10c7cd4199e5e96377ff1f8e317">PING_INTERVAL</a> + <a class="el" href="../../df/dad/_d_h_t_8h.html#ab25f73f46016db9ae16581ab70e911a2">PING_ROUNDTRIP</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00052">52</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00602">Assoc_get_close_entries()</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00401">candidates_create_internal()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02066">closelist_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00631">cmp_dht_entry()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01295">DHT_getfriendip()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02471">DHT_isconnected()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02490">DHT_non_lan_connected()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01389">do_Close()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02102">do_hardening()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01328">do_ping_and_sendnode_requests()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01494">friend_iplist()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00464">get_close_nodes_inner()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01946">have_nodes_closelist()</a>, <a class="el" href="../../d9/d54/ping_8c_source.html#l00228">in_list()</a>, <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00021">mark_bad()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01562">route_tofriend()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01617">routeone_tofriend()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00677">store_node_ok()</a>.</p>

</div>
</div>
<a class="anchor" id="a09839809f361926e324196bfd9450bb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DHT_FAKE_FRIEND_NUMBER&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00061">61</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02329">DHT_save()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02295">DHT_size()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">new_DHT()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a2a8d3d5ad30ebd3efec91f27ccf394"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DHT_FRIEND_MAX_LOCKS&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00124">124</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01167">DHT_addfriend()</a>.</p>

</div>
</div>
<a class="anchor" id="aa025d4328dd829fe6d532d3abaf3bc7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DHT_PING_ARRAY_SIZE&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00044">44</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">new_DHT()</a>.</p>

</div>
</div>
<a class="anchor" id="a1b0aff5d0e177e2fe1f826e225223867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYS_TIMEOUT&#160;&#160;&#160;600</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00179">179</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00100">get_shared_key()</a>.</p>

</div>
</div>
<a class="anchor" id="a3058f857a8316099e20c95fb07adc7c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LCLIENT_LIST&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">35</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d54/ping_8c_source.html#l00260">add_to_ping()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00771">addto_lists()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02066">closelist_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02471">DHT_isconnected()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02490">DHT_non_lan_connected()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02329">DHT_save()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02295">DHT_size()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01389">do_Close()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02102">do_hardening()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02280">do_messenger()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01925">get_closelist_IPPTsPng()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00549">get_somewhat_close_nodes()</a>, <a class="el" href="../../d3/dfd/_d_h_t__test_8c_source.html#l00103">print_clientlist()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00845">returnedip_ports()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01467">route_packet()</a>, and <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00285">test_addto_lists()</a>.</p>

</div>
</div>
<a class="anchor" id="ad50d158518277ca4d19cbe364f3e958c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FRIEND_CLIENTS&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">32</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00771">addto_lists()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01167">DHT_addfriend()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01295">DHT_getfriendip()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02329">DHT_save()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02295">DHT_size()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01377">do_DHT_friends()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02280">do_messenger()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01827">do_NAT()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01494">friend_iplist()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00549">get_somewhat_close_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01733">NAT_commonip()</a>, <a class="el" href="../../d3/dfd/_d_h_t__test_8c_source.html#l00122">print_friendlist()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01778">punch_holes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00845">returnedip_ports()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01562">route_tofriend()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01617">routeone_tofriend()</a>, and <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00285">test_addto_lists()</a>.</p>

</div>
</div>
<a class="anchor" id="ae5450da86fcf09134330aeef7cd8c35f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_KEYS_PER_SLOT&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00178">178</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00100">get_shared_key()</a>.</p>

</div>
</div>
<a class="anchor" id="a57f4cf16e79a384d7d59a3cc585ea5a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SENT_NODES&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00038">38</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00570">get_close_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00464">get_close_nodes_inner()</a>, <a class="el" href="../../df/d75/onion__announce_8c_source.html#l00289">handle_announce_request()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00611">handle_announce_response()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00703">handle_dhtpk_announce()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01974">handle_hardening()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01077">handle_sendnodes_core()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01139">handle_sendnodes_ipv6()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l01204">populate_path_nodes()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l01219">populate_path_nodes_tcp()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02042">random_node()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00921">send_dhtpk_announce()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00969">sendnodes_ipv6()</a>.</p>

</div>
</div>
<a class="anchor" id="ae138d10c7cd4199e5e96377ff1f8e317"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PING_INTERVAL&#160;&#160;&#160;60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00047">47</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01328">do_ping_and_sendnode_requests()</a>.</p>

</div>
</div>
<a class="anchor" id="ab25f73f46016db9ae16581ab70e911a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PING_ROUNDTRIP&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00051">51</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

</div>
</div>
<a class="anchor" id="a733f0d1225f97d8acbd3388e0c0d320f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PING_TIMEOUT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00041">41</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">new_DHT()</a>, and <a class="el" href="../../d9/d54/ping_8c_source.html#l00322">new_ping()</a>.</p>

</div>
</div>
<a class="anchor" id="ab913d567642bd6e0575d300f2a46867f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PINGS_MISSED_NODE_GOES_BAD&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00050">50</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac35a63082a23b6ced97c0a3a24ba06be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOX_AF_INET&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00055">55</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d18/onion_8c_source.html#l00049">ip_pack()</a>, <a class="el" href="../../d4/d18/onion_8c_source.html#l00064">ip_unpack()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00207">pack_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00167">to_host_family()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00159">to_net_family()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00268">unpack_nodes()</a>.</p>

</div>
</div>
<a class="anchor" id="a025adcf535ab2c7123fb5ea22fe20bbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOX_AF_INET6&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00056">56</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00207">pack_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00167">to_host_family()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00159">to_net_family()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00268">unpack_nodes()</a>.</p>

</div>
</div>
<a class="anchor" id="ab59616c5422ae79ebc665059761879d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOX_TCP_INET&#160;&#160;&#160;130</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00057">57</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d18/onion_8c_source.html#l00049">ip_pack()</a>, <a class="el" href="../../d4/d18/onion_8c_source.html#l00064">ip_unpack()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00207">pack_nodes()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00268">unpack_nodes()</a>.</p>

</div>
</div>
<a class="anchor" id="a30bf86f2e1f87bcbd6a90145943aabac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOX_TCP_INET6&#160;&#160;&#160;138</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00058">58</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00207">pack_nodes()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00268">unpack_nodes()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="abf840e82128d3aee3c9fc5ff51e83a14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* cryptopacket_handler_callback)(void *object, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port, const uint8_t *source_pubkey, const uint8_t *data, uint16_t len)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00192">192</a> of file <a class="el" href="../../df/dad/_d_h_t_8h_source.html">DHT.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a9d898065db0fd4adf26fdb7f80e6d7ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addto_lists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>&#160;</td>
          <td class="paramname"><em>ip_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00771">771</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00552">Assoc_add_entry()</a>, <a class="el" href="../../d0/d55/struct_d_h_t___friend.html#a1ef2d93ffeb76ceb01d28ecb1244547c">DHT_Friend::callbacks</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT_Friend::client_list</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00343">client_or_ip_port_in_list()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00141">DHT_Friend::data</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00154">IP::family</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00156">IP::ip4</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00157">IP::ip6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00140">DHT_Friend::ip_callback</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00070">IPPTs::ip_port</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00169">IPV6_IPV4_IN_V6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00138">DHT_Friend::lock_count</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">MAX_FRIEND_CLIENTS</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT::num_friends</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00142">DHT_Friend::number</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00127">DHT_Friend::public_key</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00700">replace_all()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00210">DHT::self_public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00071">IPPTs::timestamp</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00139">IP4::uint32</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00147">IP6::uint32</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00049">unix_time()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d54/ping_8c_source.html#l00171">handle_ping_response()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01077">handle_sendnodes_core()</a>, <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00285">test_addto_lists()</a>, <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00149">test_addto_lists_bad()</a>, <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00255">test_addto_lists_good()</a>, <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00191">test_addto_lists_possible_bad()</a>, and <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00081">test_addto_lists_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;{</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, used = 0;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">/* convert IPv4-in-IPv6 to IPv4 */</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span> ((ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == AF_INET6) &amp;&amp; <a class="code" href="../../d9/d94/network_8h.html#aaaf5ca9c91edc4f8a7529206d7799805">IPV6_IPV4_IN_V6</a>(ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#a14c606eb5ffb078c38ad854dc4e79507">ip6</a>)) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = AF_INET;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#aca19646000f55aa927406e68fc41ecf9">ip4</a>.<a class="code" href="../../d3/da8/union_i_p4.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a> = ip_port.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#a14c606eb5ffb078c38ad854dc4e79507">ip6</a>.<a class="code" href="../../d7/dae/union_i_p6.html#a1d8ab1f6c1da5565bed41e7095610dea">uint32</a>[3];</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">/* NOTE: Current behavior if there are two clients with the same id is</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">     * to replace the first ip by the second.</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/dc1/_d_h_t_8c.html#af6cc6aba68b93656a8fdca733e2ae918">client_or_ip_port_in_list</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, ip_port)) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc1/_d_h_t_8c.html#adfcc072141badf7d1cd04542b3dd26b1">replace_all</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, ip_port, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>))</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            used++;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        used++;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *friend_foundip = 0;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/dc1/_d_h_t_8c.html#af6cc6aba68b93656a8fdca733e2ae918">client_or_ip_port_in_list</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[i].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                       <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, ip_port)) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc1/_d_h_t_8c.html#adfcc072141badf7d1cd04542b3dd26b1">replace_all</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[i].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                            <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, ip_port, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[i].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>)) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="keywordflow">if</span> (memcmp(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, friend-&gt;public_key, crypto_box_PUBLICKEYBYTES) == 0) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    friend_foundip = <span class="keyword">friend</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                used++;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">if</span> (memcmp(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, friend-&gt;public_key, crypto_box_PUBLICKEYBYTES) == 0) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                friend_foundip = <span class="keyword">friend</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            used++;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">if</span> (friend_foundip) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        uint32_t j;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; friend_foundip-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a712c4c639bfc0f5a8616eead3e24ca4e">lock_count</a>; ++j) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">if</span> (friend_foundip-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a1ef2d93ffeb76ceb01d28ecb1244547c">callbacks</a>[j].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#abc638e20365d8487c7bc56894c5ef969">ip_callback</a>)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                friend_foundip-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a1ef2d93ffeb76ceb01d28ecb1244547c">callbacks</a>[j].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#abc638e20365d8487c7bc56894c5ef969">ip_callback</a>(friend_foundip-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a1ef2d93ffeb76ceb01d28ecb1244547c">callbacks</a>[j].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a735984d41155bc1032e09bece8f8d66d">data</a>, friend_foundip-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a1ef2d93ffeb76ceb01d28ecb1244547c">callbacks</a>[j].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a875e6b85754551c9eaea424a5a4c7934">number</a>,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                        ip_port);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;assoc) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="../../dd/df1/struct_i_p_p_ts.html">IPPTs</a> ippts;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        ippts.<a class="code" href="../../dd/df1/struct_i_p_p_ts.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = ip_port;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        ippts.<a class="code" href="../../dd/df1/struct_i_p_p_ts.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> = <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <a class="code" href="../../d4/d9d/assoc_8c.html#aa0230ae0304fd8540a5bce578d242f30">Assoc_add_entry</a>(dht-&gt;assoc, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, &amp;ippts, NULL, used ? 1 : 0);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">return</span> used;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_af6cc6aba68b93656a8fdca733e2ae918"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#af6cc6aba68b93656a8fdca733e2ae918">client_or_ip_port_in_list</a></div><div class="ttdeci">static int client_or_ip_port_in_list(Client_data *list, uint16_t length, const uint8_t *public_key, IP_Port ip_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00343">DHT.c:343</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_abc638e20365d8487c7bc56894c5ef969"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#abc638e20365d8487c7bc56894c5ef969">DHT_Friend::ip_callback</a></div><div class="ttdeci">void(* ip_callback)(void *, int32_t, IP_Port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00140">DHT.h:140</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_html"><div class="ttname"><a href="../../dd/df1/struct_i_p_p_ts.html">IPPTs</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00069">DHT.h:69</a></div></div>
<div class="ttc" id="util_8c_html_ac958d9f8847cb8039444bfa3d304233a"><div class="ttname"><a href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a></div><div class="ttdeci">uint64_t unix_time()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00049">util.c:49</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00126">DHT.h:126</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a712c4c639bfc0f5a8616eead3e24ca4e"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a712c4c639bfc0f5a8616eead3e24ca4e">DHT_Friend::lock_count</a></div><div class="ttdeci">uint16_t lock_count</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00138">DHT.h:138</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_adfcc072141badf7d1cd04542b3dd26b1"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#adfcc072141badf7d1cd04542b3dd26b1">replace_all</a></div><div class="ttdeci">static int replace_all(Client_data *list, uint16_t length, const uint8_t *public_key, IP_Port ip_port, const uint8_t *comp_public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00700">DHT.c:700</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="network_8h_html_aaaf5ca9c91edc4f8a7529206d7799805"><div class="ttname"><a href="../../d9/d94/network_8h.html#aaaf5ca9c91edc4f8a7529206d7799805">IPV6_IPV4_IN_V6</a></div><div class="ttdeci">#define IPV6_IPV4_IN_V6(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00169">network.h:169</a></div></div>
<div class="ttc" id="struct_i_p_html_a14c606eb5ffb078c38ad854dc4e79507"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#a14c606eb5ffb078c38ad854dc4e79507">IP::ip6</a></div><div class="ttdeci">IP6 ip6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00157">network.h:157</a></div></div>
<div class="ttc" id="struct_i_p_html_aca19646000f55aa927406e68fc41ecf9"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#aca19646000f55aa927406e68fc41ecf9">IP::ip4</a></div><div class="ttdeci">IP4 ip4</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00156">network.h:156</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a735984d41155bc1032e09bece8f8d66d">DHT_Friend::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00141">DHT.h:141</a></div></div>
<div class="ttc" id="assoc_8c_html_aa0230ae0304fd8540a5bce578d242f30"><div class="ttname"><a href="../../d4/d9d/assoc_8c.html#aa0230ae0304fd8540a5bce578d242f30">Assoc_add_entry</a></div><div class="ttdeci">uint8_t Assoc_add_entry(Assoc *assoc, const uint8_t *id, const IPPTs *ippts_send, const IP_Port *ipp_recv, uint8_t used)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9d/assoc_8c_source.html#l00552">assoc.c:552</a></div></div>
<div class="ttc" id="struct_i_p_html_adad4493a852deb413bb8c515368deaac"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">IP::family</a></div><div class="ttdeci">uint8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="union_i_p6_html_a1d8ab1f6c1da5565bed41e7095610dea"><div class="ttname"><a href="../../d7/dae/union_i_p6.html#a1d8ab1f6c1da5565bed41e7095610dea">IP6::uint32</a></div><div class="ttdeci">uint32_t uint32[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00147">network.h:147</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="union_i_p4_html_a5ad776be1fb768f3399aafcd1b58b3a2"><div class="ttname"><a href="../../d3/da8/union_i_p4.html#a5ad776be1fb768f3399aafcd1b58b3a2">IP4::uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00139">network.h:139</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8ee1f2d7e543bce350c591a8eaac0cf8"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">DHT::num_friends</a></div><div class="ttdeci">uint16_t num_friends</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT.h:214</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae726df8bdc26380e5a6c3187a00d6881"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">DHT::self_public_key</a></div><div class="ttdeci">uint8_t self_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00210">DHT.h:210</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a1ef2d93ffeb76ceb01d28ecb1244547c"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a1ef2d93ffeb76ceb01d28ecb1244547c">DHT_Friend::callbacks</a></div><div class="ttdeci">struct DHT_Friend::@0 callbacks[DHT_FRIEND_MAX_LOCKS]</div></div>
<div class="ttc" id="struct_i_p_p_ts_html_a465bef81f6478756e5443025b1f2ddfa"><div class="ttname"><a href="../../dd/df1/struct_i_p_p_ts.html#a465bef81f6478756e5443025b1f2ddfa">IPPTs::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00071">DHT.h:71</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#aaa806bb1136fb3d4b5d8d8970b596ff7">DHT_Friend::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00127">DHT.h:127</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a49ef2b640a834a77b6e123355a4fea47"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">DHT_Friend::client_list</a></div><div class="ttdeci">Client_data client_list[MAX_FRIEND_CLIENTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT.h:128</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../dd/df1/struct_i_p_p_ts.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTs::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00070">DHT.h:70</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ad50d158518277ca4d19cbe364f3e958c"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a></div><div class="ttdeci">#define MAX_FRIEND_CLIENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00032">DHT.h:32</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a875e6b85754551c9eaea424a5a4c7934"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a875e6b85754551c9eaea424a5a4c7934">DHT_Friend::number</a></div><div class="ttdeci">int32_t number</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00142">DHT.h:142</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_cgraph" id="df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_cgraph">
<area shape="rect" id="node2" href="../../d4/d9d/assoc_8c.html#aa0230ae0304fd8540a5bce578d242f30" title="Assoc_add_entry" alt="" coords="139,281,261,308"/><area shape="rect" id="node9" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="952,521,1031,548"/><area shape="rect" id="node25" href="../../dc/dc1/_d_h_t_8c.html#af6cc6aba68b93656a8fdca733e2ae918" title="client_or_ip_port_in_list" alt="" coords="540,154,699,181"/><area shape="rect" id="node26" href="../../dc/dc1/_d_h_t_8c.html#adfcc072141badf7d1cd04542b3dd26b1" title="replace_all" alt="" coords="354,838,438,865"/><area shape="rect" id="node3" href="../../d4/d9d/assoc_8c.html#aa745e9c0a5448ce04ab65c5156b4a531" title="candidates_create_new" alt="" coords="317,560,475,586"/><area shape="rect" id="node13" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e" title="ipport_isset" alt="" coords="785,661,875,688"/><area shape="rect" id="node15" href="../../d4/d9d/assoc_8c.html#a7d1789e9568f82369268469130cff891" title="candidates_search" alt="" coords="554,205,685,232"/><area shape="rect" id="node16" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="795,104,865,130"/><area shape="rect" id="node17" href="../../d4/d9d/assoc_8c.html#a12f651ee082f440e6efcff809958e005" title="candidates_update_assoc" alt="" coords="309,382,483,409"/><area shape="rect" id="node23" href="../../d4/d9d/assoc_8c.html#aa8781ddcd6a9240db73c39a2ff844d12" title="client_id_self_update" alt="" coords="547,256,691,282"/><area shape="rect" id="node24" href="../../d4/d9d/assoc_8c.html#a89ad0cf0f7d7c45e00c8bbdd66b56e95" title="id_hash" alt="" coords="797,381,863,408"/><area shape="rect" id="node4" href="../../d4/d9d/assoc_8c.html#a0097ca62f259f8333289a89a7234a0a0" title="candidates_create_internal" alt="" coords="531,560,708,586"/><area shape="rect" id="node10" href="../../d4/d9d/assoc_8c.html#afb9b36d2d6bd5c3f463a14bbbfc5dca9" title="entry_assoc" alt="" coords="573,458,666,485"/><area shape="rect" id="node11" href="../../d4/d9d/assoc_8c.html#a521780b30ac0601ccb6b133d6f901bcd" title="entry_heard_get" alt="" coords="562,509,677,536"/><area shape="rect" id="node12" href="../../de/df1/util_8c.html#aa30049b8c1d82c280d6d872feea3353b" title="id_copy" alt="" coords="586,712,653,738"/><area shape="rect" id="node5" href="../../d4/d9d/assoc_8c.html#ace6056317cff40310ec4041c9675e093" title="candidates_id_bucket" alt="" coords="756,280,904,306"/><area shape="rect" id="node7" href="../../d4/d9d/assoc_8c.html#a2237a67d354721e3155bcb4701e386ac" title="hash_collide" alt="" coords="783,330,877,357"/><area shape="rect" id="node8" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="789,712,871,738"/><area shape="rect" id="node6" href="../../d4/d9d/assoc_8c.html#a02a00b2c4be43884c00d659524ce8081" title="id_bucket" alt="" coords="952,280,1031,306"/><area shape="rect" id="node14" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="958,661,1025,688"/><area shape="rect" id="node18" href="../../d4/d9d/assoc_8c.html#a512ebb77cd46109c11a1052a76bf0a66" title="entry_heard_store" alt="" coords="556,408,683,434"/><area shape="rect" id="node19" href="../../d6/d6e/network_8c.html#a6913335cf0b2a76303f5f61d18ea2277" title="ipport_equal" alt="" coords="784,229,876,256"/><area shape="rect" id="node21" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="797,178,863,205"/><area shape="rect" id="node20" href="../../d6/d6e/network_8c.html#af982256c6d8486349bdc13a920884ef6" title="ip_equal" alt="" coords="956,229,1027,256"/><area shape="rect" id="node22" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="956,178,1027,205"/><area shape="rect" id="node27" href="../../dc/dc1/_d_h_t_8c.html#a15d71358ca3e1f937159a7982168bb30" title="cmp_dht_entry" alt="" coords="565,965,673,992"/><area shape="rect" id="node30" href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df" title="ip_reset" alt="" coords="585,914,653,941"/><area shape="rect" id="node31" href="../../dc/dc1/_d_h_t_8c.html#addb87a718c80bb27e53e8dde5972dfe9" title="store_node_ok" alt="" coords="566,864,673,890"/><area shape="rect" id="node28" href="../../dc/dc1/_d_h_t_8c.html#a99cbbcdc9772e5c2b1ff8416074e88c0" title="hardening_correct" alt="" coords="767,965,893,992"/><area shape="rect" id="node29" href="../../dc/dc1/_d_h_t_8c.html#a903a5bc580826fe447adb841b7782333" title="id_closest" alt="" coords="789,889,871,916"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_icgraph" id="df/dad/_d_h_t_8h_a9d898065db0fd4adf26fdb7f80e6d7ac_icgraph">
<area shape="rect" id="node2" href="../../d9/d54/ping_8c.html#a3927c1053be4390271a309982aa7284f" title="handle_ping_response" alt="" coords="162,107,313,133"/><area shape="rect" id="node5" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="803,259,917,285"/><area shape="rect" id="node20" href="../../dc/dc1/_d_h_t_8c.html#a4dcc848207b2408def323b8b79b08e4a" title="handle_sendnodes_core" alt="" coords="156,157,319,184"/><area shape="rect" id="node22" href="../../d2/d98/dht__test_8c.html#a37f262581ef29d155056c14b2fa0ced1" title="test_addto_lists_bad" alt="" coords="602,309,745,336"/><area shape="rect" id="node23" href="../../d2/d98/dht__test_8c.html#a26ee6a8d6a8a726b6a03bdacfa1f3716" title="test_addto_lists_good" alt="" coords="390,385,539,412"/><area shape="rect" id="node24" href="../../d2/d98/dht__test_8c.html#a62e2c67aa707a1ea005159db3bc59e36" title="test_addto_lists_possible_bad" alt="" coords="139,360,336,387"/><area shape="rect" id="node25" href="../../d2/d98/dht__test_8c.html#a90ce4d5060f1998109da42a4e83c22c0" title="test_addto_lists_update" alt="" coords="593,208,753,235"/><area shape="rect" id="node3" href="../../d6/d2b/ping_8h.html#a86e9eeead72b88b686ce5b7c0f78c325" title="new_ping" alt="" coords="426,107,503,133"/><area shape="rect" id="node4" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="633,157,714,184"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="807,107,913,133"/><area shape="rect" id="node8" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="815,157,905,184"/><area shape="rect" id="node10" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="835,208,885,235"/><area shape="rect" id="node11" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="801,56,919,83"/><area shape="rect" id="node6" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="967,259,1073,285"/><area shape="rect" id="node9" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="967,157,1073,184"/><area shape="rect" id="node12" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="995,31,1045,57"/><area shape="rect" id="node13" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="985,81,1055,108"/><area shape="rect" id="node14" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1121,5,1228,32"/><area shape="rect" id="node15" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1143,56,1207,83"/><area shape="rect" id="node17" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1135,107,1214,133"/><area shape="rect" id="node19" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1149,157,1200,184"/><area shape="rect" id="node16" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1276,56,1327,83"/><area shape="rect" id="node18" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1276,107,1327,133"/><area shape="rect" id="node21" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514" title="handle_sendnodes_ipv6" alt="" coords="384,157,545,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2b03f88384f04514e392abd12ef30140"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t closelist_nodes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>max_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02066">2066</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00052">BAD_NODE_TIMEOUT</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00149">Node_format::ip_port</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00054">is_timeout()</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>.</p>

<p>Referenced by <a class="el" href="../../db/d79/onion__client_8c_source.html#l00921">send_dhtpk_announce()</a>.</p>
<div class="fragment"><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;{</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="keywordflow">if</span> (max_num == 0)</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    uint16_t count = 0;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *list = dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="keywordflow">for</span> (i = <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>; i != 0; --<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <a class="code" href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a> *assoc = NULL;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(list[i - 1].assoc4.timestamp, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>))</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;            assoc = &amp;list[i - 1].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(list[i - 1].assoc6.timestamp, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>)) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <span class="keywordflow">if</span> (assoc == NULL)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                assoc = &amp;list[i - 1].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rand() % 2)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                assoc = &amp;list[i - 1].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        }</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">if</span> (assoc != NULL) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            memcpy(nodes[count].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, list[i - 1].public_key, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            nodes[count].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = assoc-&gt;<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            ++count;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            <span class="keywordflow">if</span> (count &gt;= max_num)</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                <span class="keywordflow">return</span> count;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keywordflow">return</span> count;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00092">DHT.h:92</a></div></div>
<div class="ttc" id="util_8c_html_ab643c84141e04b54ba650c50165ba288"><div class="ttname"><a href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a></div><div class="ttdeci">int is_timeout(uint64_t timestamp, uint64_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00054">util.c:54</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="struct_node__format_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Node_format::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00149">DHT.h:149</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a2c542fd03a43f340d1fb281afe54453f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a></div><div class="ttdeci">#define BAD_NODE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00052">DHT.h:52</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_cgraph" id="df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_cgraph">
<area shape="rect" id="node2" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="165,5,248,32"/><area shape="rect" id="node3" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="296,5,375,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_icgraph" id="df/dad/_d_h_t_8h_a2b03f88384f04514e392abd12ef30140_icgraph">
<area shape="rect" id="node2" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="165,31,317,57"/><area shape="rect" id="node3" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="365,31,440,57"/><area shape="rect" id="node4" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="488,31,600,57"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="661,5,742,32"/><area shape="rect" id="node7" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="648,56,755,83"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="803,5,909,32"/><area shape="rect" id="node8" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="831,56,881,83"/><area shape="rect" id="node9" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="815,107,897,133"/><area shape="rect" id="node10" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="957,31,1064,57"/><area shape="rect" id="node11" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="985,81,1037,108"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="985,132,1036,159"/><area shape="rect" id="node13" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="974,183,1047,209"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1112,183,1163,209"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a097913efd03d5106a66c15eb48b0e104"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cryptopacket_registerhandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>byte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/dad/_d_h_t_8h.html#abf840e82128d3aee3c9fc5ff51e83a14">cryptopacket_handler_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>object</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02154">2154</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00231">DHT::cryptopackethandlers</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00196">Cryptopacket_Handles::function</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00197">Cryptopacket_Handles::object</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02268">kill_DHT()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l01506">kill_onion_client()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">new_DHT()</a>, and <a class="el" href="../../db/d79/onion__client_8c_source.html#l01477">new_onion_client()</a>.</p>
<div class="fragment"><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;{</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a461ccd9a581712b103785034f31d0d82">cryptopackethandlers</a>[byte].<a class="code" href="../../d5/d54/struct_cryptopacket___handles.html#a9313784040f9666743d9aff915543903">function</a> = cb;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a461ccd9a581712b103785034f31d0d82">cryptopackethandlers</a>[byte].<a class="code" href="../../d5/d54/struct_cryptopacket___handles.html#a077376d12464f945e2414d5499c79b3f">object</a> = object;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;}</div>
<div class="ttc" id="struct_cryptopacket___handles_html_a9313784040f9666743d9aff915543903"><div class="ttname"><a href="../../d5/d54/struct_cryptopacket___handles.html#a9313784040f9666743d9aff915543903">Cryptopacket_Handles::function</a></div><div class="ttdeci">cryptopacket_handler_callback function</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00196">DHT.h:196</a></div></div>
<div class="ttc" id="struct_cryptopacket___handles_html_a077376d12464f945e2414d5499c79b3f"><div class="ttname"><a href="../../d5/d54/struct_cryptopacket___handles.html#a077376d12464f945e2414d5499c79b3f">Cryptopacket_Handles::object</a></div><div class="ttdeci">void * object</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00197">DHT.h:197</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a461ccd9a581712b103785034f31d0d82"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a461ccd9a581712b103785034f31d0d82">DHT::cryptopackethandlers</a></div><div class="ttdeci">Cryptopacket_Handles cryptopackethandlers[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00231">DHT.h:231</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a097913efd03d5106a66c15eb48b0e104_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a097913efd03d5106a66c15eb48b0e104_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a097913efd03d5106a66c15eb48b0e104_icgraph" id="df/dad/_d_h_t_8h_a097913efd03d5106a66c15eb48b0e104_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#a816851e4f0f454c52b93d65544a2b2bb" title="kill_DHT" alt="" coords="243,157,316,184"/><area shape="rect" id="node8" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="385,56,466,83"/><area shape="rect" id="node22" href="../../d9/d26/onion__client_8h.html#a591041f85e43cf886ab4c72fb3b8d468" title="kill_onion_client" alt="" coords="368,309,483,336"/><area shape="rect" id="node23" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="364,259,487,285"/><area shape="rect" id="node3" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="536,5,651,32"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="540,107,647,133"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#a11b4d3c94243b8abdd439dea94ee679e" title="kill_onions" alt="" coords="552,208,635,235"/><area shape="rect" id="node11" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="535,259,652,285"/><area shape="rect" id="node20" href="../../d4/d30/_messenger_8h.html#a771c65c3057d870b0653c2fdf0a12fb7" title="kill_messenger" alt="" coords="539,309,648,336"/><area shape="rect" id="node4" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="700,5,807,32"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="700,183,807,209"/><area shape="rect" id="node9" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="548,157,639,184"/><area shape="rect" id="node10" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="568,56,619,83"/><area shape="rect" id="node12" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="728,309,779,336"/><area shape="rect" id="node13" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="718,259,789,285"/><area shape="rect" id="node14" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="855,183,961,209"/><area shape="rect" id="node15" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="876,233,940,260"/><area shape="rect" id="node17" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="869,284,947,311"/><area shape="rect" id="node19" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="883,335,933,361"/><area shape="rect" id="node16" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1009,233,1060,260"/><area shape="rect" id="node18" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1009,284,1060,311"/><area shape="rect" id="node21" href="../../da/d8f/tox_8h.html#a52259e134bfb9396d9fef4fffe94e878" title="tox_kill" alt="" coords="722,360,785,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1dac5e05fd07964cb4914c17afeb9d50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_addfriend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *data, int32_t number, <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>)&#160;</td>
          <td class="paramname"><em>ip_callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>lock_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01167">1167</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00602">Assoc_get_close_entries()</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00058">Assoc_close_entries::count</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00057">Assoc_close_entries::count_good</a>, <a class="el" href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile::data</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00124">DHT_FRIEND_MAX_LOCKS</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00437">friend_number()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00912">getnodes()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00789">ipport_isset()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00138">DHT_Friend::lock_count</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">MAX_FRIEND_CLIENTS</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT::num_friends</a>, <a class="el" href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile::public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00104">Client_data::public_key</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00053">random_64b()</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00059">Assoc_close_entries::result</a>, and <a class="el" href="../../da/d7d/assoc_8h_source.html#l00051">Assoc_close_entries::wanted_id</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00287">change_dht_pk()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00332">dht_pk_callback()</a>, <a class="el" href="../../d3/dfd/_d_h_t__test_8c_source.html#l00170">main()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">new_DHT()</a>.</p>
<div class="fragment"><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;{</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordtype">int</span> friend_num = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b">friend_number</a>(dht, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    uint16_t lock_num;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (friend_num != -1) { <span class="comment">/* Is friend already in DHT? */</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[friend_num];</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">if</span> (friend-&gt;lock_count == <a class="code" href="../../df/dad/_d_h_t_8h.html#a5a2a8d3d5ad30ebd3efec91f27ccf394">DHT_FRIEND_MAX_LOCKS</a>)</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        lock_num = <span class="keyword">friend</span>-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a712c4c639bfc0f5a8616eead3e24ca4e">lock_count</a>;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        ++<span class="keyword">friend</span>-&gt;lock_count;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keyword">friend</span>-&gt;callbacks[lock_num].ip_callback = ip_callback;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="keyword">friend</span>-&gt;callbacks[lock_num].data = <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keyword">friend</span>-&gt;callbacks[lock_num].number = number;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">if</span> (lock_count)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            *lock_count = lock_num + 1;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *temp;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    temp = realloc(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a>) * (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a> + 1));</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">if</span> (temp == NULL)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a> = temp;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>];</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    memset(<span class="keyword">friend</span>, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a>));</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    memcpy(friend-&gt;public_key, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keyword">friend</span>-&gt;nat.NATping_id = <a class="code" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e">random_64b</a>();</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    ++dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    lock_num = <span class="keyword">friend</span>-&gt;lock_count;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    ++<span class="keyword">friend</span>-&gt;lock_count;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keyword">friend</span>-&gt;callbacks[lock_num].ip_callback = ip_callback;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keyword">friend</span>-&gt;callbacks[lock_num].data = <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keyword">friend</span>-&gt;callbacks[lock_num].number = number;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">if</span> (lock_count)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        *lock_count = lock_num + 1;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;assoc) {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">/* get up to MAX_FRIEND_CLIENTS connectable nodes */</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a> - 1];</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <a class="code" href="../../d1/d41/struct_assoc__close__entries.html">Assoc_close_entries</a> close_entries;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        memset(&amp;close_entries, 0, <span class="keyword">sizeof</span>(close_entries));</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a037b65164e78b02017bd4751843037b4">wanted_id</a> = <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a086e0ce002c9491e4b99956740bb53d4">count_good</a> = <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a> / 2;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a20302e2c99a60d3f612dba57e3f6333b">count</a> = <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">result</a> = calloc(<a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>, <span class="keyword">sizeof</span>(*close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">result</a>));</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        uint8_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, found = <a class="code" href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2">Assoc_get_close_entries</a>(dht-&gt;assoc, &amp;close_entries);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; found; i++)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            memcpy(&amp;friend-&gt;client_list[i], close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">result</a>[i], <span class="keyword">sizeof</span>(*close_entries.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">result</a>[i]));</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">if</span> (found) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="comment">/* send getnodes to the &quot;best&quot; entry */</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client = &amp;<span class="keyword">friend</span>-&gt;client_list[0];</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e">ipport_isset</a>(&amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>))</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a>(dht, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, friend-&gt;public_key, NULL);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e">ipport_isset</a>(&amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>))</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a>(dht, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, friend-&gt;public_key, NULL);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div>
<div class="ttc" id="struct_assoc__close__entries_html_a40d6704f891338dadfa89f46b696be4c"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">Assoc_close_entries::result</a></div><div class="ttdeci">Client_data ** result</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00059">assoc.h:59</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a1ce51b34ab2247e750b9c2a25121eb9e"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e">random_64b</a></div><div class="ttdeci">uint64_t random_64b(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00053">crypto_core.c:53</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a6cbd0f66d63003cc0def913dc7a4254b"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b">friend_number</a></div><div class="ttdeci">static int friend_number(const DHT *dht, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00437">DHT.c:437</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00126">DHT.h:126</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a712c4c639bfc0f5a8616eead3e24ca4e"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a712c4c639bfc0f5a8616eead3e24ca4e">DHT_Friend::lock_count</a></div><div class="ttdeci">uint16_t lock_count</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00138">DHT.h:138</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_client__data_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Client_data::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00104">DHT.h:104</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a5a2a8d3d5ad30ebd3efec91f27ccf394"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a5a2a8d3d5ad30ebd3efec91f27ccf394">DHT_FRIEND_MAX_LOCKS</a></div><div class="ttdeci">#define DHT_FRIEND_MAX_LOCKS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00124">DHT.h:124</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_a037b65164e78b02017bd4751843037b4"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a037b65164e78b02017bd4751843037b4">Assoc_close_entries::wanted_id</a></div><div class="ttdeci">uint8_t * wanted_id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00051">assoc.h:51</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_a086e0ce002c9491e4b99956740bb53d4"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a086e0ce002c9491e4b99956740bb53d4">Assoc_close_entries::count_good</a></div><div class="ttdeci">uint8_t count_good</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00057">assoc.h:57</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html">Assoc_close_entries</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00049">assoc.h:49</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="network_8c_html_a8436367218afb29bcf1b5fecd071648e"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e">ipport_isset</a></div><div class="ttdeci">int ipport_isset(const IP_Port *ipport)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00789">network.c:789</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8ee1f2d7e543bce350c591a8eaac0cf8"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">DHT::num_friends</a></div><div class="ttdeci">uint16_t num_friends</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT.h:214</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a7af6c30b12e5cbda1e6d6d824794956e"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a></div><div class="ttdeci">static int getnodes(DHT *dht, IP_Port ip_port, const uint8_t *public_key, const uint8_t *client_id, const Node_format *sendback_node)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00912">DHT.c:912</a></div></div>
<div class="ttc" id="assoc_8c_html_a256dcbfb2174603496ffa30efef90ad2"><div class="ttname"><a href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2">Assoc_get_close_entries</a></div><div class="ttdeci">uint8_t Assoc_get_close_entries(Assoc *assoc, Assoc_close_entries *state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9d/assoc_8c_source.html#l00602">assoc.c:602</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_a20302e2c99a60d3f612dba57e3f6333b"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a20302e2c99a60d3f612dba57e3f6333b">Assoc_close_entries::count</a></div><div class="ttdeci">uint8_t count</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00058">assoc.h:58</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ad50d158518277ca4d19cbe364f3e958c"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a></div><div class="ttdeci">#define MAX_FRIEND_CLIENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00032">DHT.h:32</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_cgraph" id="df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_cgraph">
<area shape="rect" id="node2" href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2" title="Assoc_get_close_entries" alt="" coords="164,635,332,662"/><area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e" title="ipport_isset" alt="" coords="426,887,515,914"/><area shape="rect" id="node22" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b" title="friend_number" alt="" coords="196,458,300,484"/><area shape="rect" id="node23" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="211,255,285,282"/><area shape="rect" id="node33" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="650,154,743,180"/><area shape="rect" id="node3" href="../../d4/d9d/assoc_8c.html#ad78d05a8a1915614699da4704cd5641b" title="assoc_id_closest" alt="" coords="409,508,532,535"/><area shape="rect" id="node5" href="../../d4/d9d/assoc_8c.html#aa8781ddcd6a9240db73c39a2ff844d12" title="client_id_self_update" alt="" coords="399,559,543,586"/><area shape="rect" id="node11" href="../../d4/d9d/assoc_8c.html#a9419b231b388fff46f176830c4b9a52f" title="dist_index_bubble" alt="" coords="407,762,534,788"/><area shape="rect" id="node13" href="../../d4/d9d/assoc_8c.html#a07e9e64cd1b39d0dc9259d998e52f1ab" title="dist_index_entry" alt="" coords="843,736,961,763"/><area shape="rect" id="node14" href="../../d4/d9d/assoc_8c.html#afe8472c27f16e873da0fa3a6995c1197" title="dist_index_comp" alt="" coords="411,610,531,636"/><area shape="rect" id="node15" href="../../d4/d9d/assoc_8c.html#af9b9ca1f09c12f5ba91e06bf254e09f6" title="id_distance" alt="" coords="427,660,515,687"/><area shape="rect" id="node18" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="861,331,943,358"/><area shape="rect" id="node20" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="438,836,503,863"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a903a5bc580826fe447adb841b7782333" title="id_closest" alt="" coords="656,508,737,535"/><area shape="rect" id="node6" href="../../d4/d9d/assoc_8c.html#ace6056317cff40310ec4041c9675e093" title="candidates_id_bucket" alt="" coords="623,660,771,687"/><area shape="rect" id="node8" href="../../d4/d9d/assoc_8c.html#a2237a67d354721e3155bcb4701e386ac" title="hash_collide" alt="" coords="649,559,744,586"/><area shape="rect" id="node9" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="661,458,732,484"/><area shape="rect" id="node10" href="../../d4/d9d/assoc_8c.html#a89ad0cf0f7d7c45e00c8bbdd66b56e95" title="id_hash" alt="" coords="663,610,730,636"/><area shape="rect" id="node7" href="../../d4/d9d/assoc_8c.html#a02a00b2c4be43884c00d659524ce8081" title="id_bucket" alt="" coords="863,660,941,687"/><area shape="rect" id="node12" href="../../d4/d9d/assoc_8c.html#aebc74fa92cb369834babcadf8b73483a" title="dist_index_id" alt="" coords="647,762,746,788"/><area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="663,887,730,914"/><area shape="rect" id="node19" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1020,331,1099,358"/><area shape="rect" id="node21" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="661,836,732,863"/><area shape="rect" id="node24" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="380,306,561,332"/><area shape="rect" id="node27" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="388,154,553,180"/><area shape="rect" id="node28" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="427,255,515,282"/><area shape="rect" id="node30" href="../../df/d02/ping__array_8c.html#a67470d42ee0e3e61bedfa598f3039266" title="ping_array_add" alt="" coords="415,52,526,79"/><area shape="rect" id="node34" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="426,204,515,231"/><area shape="rect" id="node25" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="639,407,754,434"/><area shape="rect" id="node26" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="832,382,972,408"/><area shape="rect" id="node29" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="643,255,750,282"/><area shape="rect" id="node31" href="../../df/d02/ping__array_8c.html#a660fb4ff5c6564a9b61cfbc497d1191b" title="ping_array_clear_timedout" alt="" coords="609,103,784,130"/><area shape="rect" id="node32" href="../../df/d02/ping__array_8c.html#ad051ea35e31300366c9f8c167b27ca4c" title="clear_entry" alt="" coords="859,78,945,104"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_icgraph" id="df/dad/_d_h_t_8h_a1dac5e05fd07964cb4914c17afeb9d50_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="167,284,277,311"/><area shape="rect" id="node42" href="../../d7/dd9/onion__test_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="164,512,280,539"/><area shape="rect" id="node44" href="../../d3/dfd/_d_h_t__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="197,563,247,589"/><area shape="rect" id="node45" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="181,461,263,488"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="328,208,444,235"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="492,309,660,336"/><area shape="rect" id="node15" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="499,208,653,235"/><area shape="rect" id="node24" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="515,107,637,133"/><area shape="rect" id="node27" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="499,157,653,184"/><area shape="rect" id="node5" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="708,360,871,387"/><area shape="rect" id="node6" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="939,461,1056,488"/><area shape="rect" id="node7" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1172,461,1223,488"/><area shape="rect" id="node8" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1785,284,1856,311"/><area shape="rect" id="node9" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1951,309,2057,336"/><area shape="rect" id="node10" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1972,208,2036,235"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1965,360,2043,387"/><area shape="rect" id="node14" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1979,259,2029,285"/><area shape="rect" id="node11" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2105,157,2156,184"/><area shape="rect" id="node13" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2105,259,2156,285"/><area shape="rect" id="node16" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="733,259,845,285"/><area shape="rect" id="node17" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="921,107,1073,133"/><area shape="rect" id="node18" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1552,56,1659,83"/><area shape="rect" id="node19" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1795,107,1846,133"/><area shape="rect" id="node20" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1779,56,1862,83"/><area shape="rect" id="node21" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1951,5,2057,32"/><area shape="rect" id="node22" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1978,56,2030,83"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1967,157,2041,184"/><area shape="rect" id="node25" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="722,107,857,133"/><area shape="rect" id="node26" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1342,5,1449,32"/><area shape="rect" id="node28" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="735,208,844,235"/><area shape="rect" id="node29" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="951,208,1044,235"/><area shape="rect" id="node36" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="919,335,1076,361"/><area shape="rect" id="node30" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="1124,259,1271,285"/><area shape="rect" id="node32" href="../../d8/d8d/_messenger_8c.html#ad971e0d0877b61a160884d59527d39d9" title="friends_list_load" alt="" coords="1139,208,1255,235"/><area shape="rect" id="node35" href="../../da/d8f/tox_8h.html#aa921c439baad10c03f8d93fda753b0b8" title="tox_friend_add" alt="" coords="1767,208,1874,235"/><area shape="rect" id="node31" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1370,351,1421,377"/><area shape="rect" id="node33" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="1319,209,1472,250"/><area shape="rect" id="node34" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1547,216,1664,243"/><area shape="rect" id="node37" href="../../d2/dee/friends__test_8c.html#ace1a1349a29721b64c0cfcf27e867f24" title="child_got_request" alt="" coords="1135,360,1259,387"/><area shape="rect" id="node38" href="../../db/de9/_messenger__test_8c.html#a38c8dd7be210f3e938afa8e6eb4cd562" title="print_request" alt="" coords="1347,283,1444,309"/><area shape="rect" id="node39" href="../../da/d8f/tox_8h.html#ad499c853b628d04dd0f3c6ef5a14ebe4" title="tox_friend_add_norequest" alt="" coords="1520,448,1691,475"/><area shape="rect" id="node40" href="../../d0/de9/encryptsave__test_8c.html#a23435c36683784fe0b913e77c8445c32" title="accept_friend_request" alt="" coords="1745,448,1896,475"/><area shape="rect" id="node41" href="../../d9/d35/tox__test_8c.html#adb48712ca97fe3bd1c837671708d7915" title="g_accept_friend_request" alt="" coords="1739,397,1903,424"/><area shape="rect" id="node43" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="523,588,629,615"/><area shape="rect" id="node46" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="329,360,443,387"/><area shape="rect" id="node48" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="333,411,439,437"/><area shape="rect" id="node49" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="341,563,431,589"/><area shape="rect" id="node50" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="361,512,411,539"/><area shape="rect" id="node47" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="523,360,629,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab6d732074bab2377a7884c41c219cf96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHT_bootstrap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a>&#160;</td>
          <td class="paramname"><em>ip_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01420">1420</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00912">getnodes()</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00210">DHT::self_public_key</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01434">DHT_bootstrap_from_address()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02382">DHT_connect_after_load()</a>, <a class="el" href="../../d1/de5/_l_a_n__discovery_8c_source.html#l00309">handle_LANdiscovery()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00363">START_TEST()</a>, and <a class="el" href="../../d3/d69/tox_8c_source.html#l00260">tox_bootstrap()</a>.</p>
<div class="fragment"><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;{</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="comment">/*#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">       if (dht-&gt;assoc) {</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">           IPPTs ippts;</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">           ippts.ip_port = ip_port;</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">           ippts.timestamp = 0;</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">           Assoc_add_entry(dht-&gt;assoc, public_key, &amp;ippts, NULL, 0);</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">       }</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">       #endif*/</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a>(dht, ip_port, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>, NULL);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;}</div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a7af6c30b12e5cbda1e6d6d824794956e"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a></div><div class="ttdeci">static int getnodes(DHT *dht, IP_Port ip_port, const uint8_t *public_key, const uint8_t *client_id, const Node_format *sendback_node)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00912">DHT.c:912</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae726df8bdc26380e5a6c3187a00d6881"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">DHT::self_public_key</a></div><div class="ttdeci">uint8_t self_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00210">DHT.h:210</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_cgraph" id="df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="164,132,239,159"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="287,5,468,32"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="295,56,460,83"/><area shape="rect" id="node9" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="342,107,413,133"/><area shape="rect" id="node10" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="333,157,421,184"/><area shape="rect" id="node12" href="../../df/d02/ping__array_8c.html#a67470d42ee0e3e61bedfa598f3039266" title="ping_array_add" alt="" coords="322,208,433,235"/><area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="333,259,422,285"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="546,31,661,57"/><area shape="rect" id="node5" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="739,31,879,57"/><area shape="rect" id="node6" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="767,132,850,159"/><area shape="rect" id="node7" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="927,132,1005,159"/><area shape="rect" id="node11" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="550,81,657,108"/><area shape="rect" id="node13" href="../../df/d02/ping__array_8c.html#a660fb4ff5c6564a9b61cfbc497d1191b" title="ping_array_clear_timedout" alt="" coords="516,132,691,159"/><area shape="rect" id="node14" href="../../df/d02/ping__array_8c.html#ad051ea35e31300366c9f8c167b27ca4c" title="clear_entry" alt="" coords="765,208,852,235"/><area shape="rect" id="node15" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="557,183,650,209"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_icgraph" id="df/dad/_d_h_t_8h_ab6d732074bab2377a7884c41c219cf96_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#af342c78837dbed569d4a75a0516455fc" title="DHT_bootstrap_from\l_address" alt="" coords="175,231,319,273"/><area shape="rect" id="node6" href="../../df/dad/_d_h_t_8h.html#ad5df2ff5066cf93898e531d320ddd675" title="DHT_connect_after_load" alt="" coords="164,163,331,189"/><area shape="rect" id="node11" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="793,81,900,108"/><area shape="rect" id="node20" href="../../d1/de5/_l_a_n__discovery_8c.html#aeb11042ae0d160b28f8943da6ae29499" title="handle_LANdiscovery" alt="" coords="173,305,322,332"/><area shape="rect" id="node30" href="../../da/d8f/tox_8h.html#ae7e49c1e9e6c3a0f9e55bfcb78044c1e" title="tox_bootstrap" alt="" coords="953,399,1055,425"/><area shape="rect" id="node3" href="../../d1/d36/tox-bootstrapd_8c.html#a3b29f8b1522a8d051f35cc76a54f846a" title="bootstrap_from_config" alt="" coords="379,259,529,285"/><area shape="rect" id="node5" href="../../db/d5e/_d_h_t__bootstrap_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="429,208,479,235"/><area shape="rect" id="node4" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="633,259,684,285"/><area shape="rect" id="node7" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="419,157,489,184"/><area shape="rect" id="node8" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="621,208,696,235"/><area shape="rect" id="node10" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="618,107,699,133"/><area shape="rect" id="node12" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="793,157,900,184"/><area shape="rect" id="node9" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="793,208,900,235"/><area shape="rect" id="node13" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="979,157,1029,184"/><area shape="rect" id="node14" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="963,107,1045,133"/><area shape="rect" id="node15" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1103,5,1209,32"/><area shape="rect" id="node16" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1130,107,1182,133"/><area shape="rect" id="node17" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1257,157,1308,184"/><area shape="rect" id="node18" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1119,157,1193,184"/><area shape="rect" id="node19" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1257,309,1308,336"/><area shape="rect" id="node21" href="../../dd/db4/_l_a_n__discovery_8h.html#ab5177e8d5fc82b7c156f777f13649912" title="LANdiscovery_init" alt="" coords="390,309,518,336"/><area shape="rect" id="node22" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="577,309,740,336"/><area shape="rect" id="node23" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="788,309,905,336"/><area shape="rect" id="node24" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="979,259,1029,285"/><area shape="rect" id="node25" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="969,309,1039,336"/><area shape="rect" id="node26" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1103,208,1209,235"/><area shape="rect" id="node27" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1124,360,1188,387"/><area shape="rect" id="node28" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1117,309,1195,336"/><area shape="rect" id="node29" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1131,259,1181,285"/><area shape="rect" id="node31" href="../../d9/d35/tox__test_8c.html#a7d4f70e1580986cb8b3ba57d085ccc13" title="START_TEST" alt="" coords="1103,461,1209,488"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af342c78837dbed569d4a75a0516455fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_bootstrap_from_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ipv6enabled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01434">1434</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d6/d6e/network_8c_source.html#l01041">addr_resolve_or_parse_ip()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01420">DHT_bootstrap()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00154">IP::family</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00770">ip_init()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00780">ip_isset()</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00761">ip_reset()</a>, <a class="el" href="../../db/d11/irc__syncbot_8c_source.html#l00031">port</a>, and <a class="el" href="../../d9/d94/network_8h_source.html#l00164">IP_Port::port</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d36/tox-bootstrapd_8c_source.html#l00398">bootstrap_from_config()</a>, and <a class="el" href="../../db/d5e/_d_h_t__bootstrap_8c_source.html#l00102">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;{</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <a class="code" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port_v64;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <a class="code" href="../../d4/d6d/struct_i_p.html">IP</a> *ip_extra = NULL;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <a class="code" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_port_v4;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a6aa0dce9c25e370af93bf4a14f79c709">ip_init</a>(&amp;ip_port_v64.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>, ipv6enabled);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (ipv6enabled) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="comment">/* setup for getting BOTH: an IPv6 AND an IPv4 address */</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        ip_port_v64.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = AF_UNSPEC;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <a class="code" href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df">ip_reset</a>(&amp;ip_port_v4.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        ip_extra = &amp;ip_port_v4.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#a1c024648679209a12766fedc7e55d5e4">addr_resolve_or_parse_ip</a>(address, &amp;ip_port_v64.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>, ip_extra)) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        ip_port_v64.<a class="code" href="../../db/d14/struct_i_p___port.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a> = <a class="code" href="../../db/d11/irc__syncbot_8c.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96">DHT_bootstrap</a>(dht, ip_port_v64, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">if</span> ((ip_extra != NULL) &amp;&amp; <a class="code" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a>(ip_extra)) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            ip_port_v4.<a class="code" href="../../db/d14/struct_i_p___port.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a> = <a class="code" href="../../db/d11/irc__syncbot_8c.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96">DHT_bootstrap</a>(dht, ip_port_v4, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;}</div>
<div class="ttc" id="network_8c_html_a6aa0dce9c25e370af93bf4a14f79c709"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a6aa0dce9c25e370af93bf4a14f79c709">ip_init</a></div><div class="ttdeci">void ip_init(IP *ip, uint8_t ipv6enabled)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00770">network.c:770</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="network_8c_html_ac56c677f4bc8bf8311370ee105ae7cbb"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a></div><div class="ttdeci">int ip_isset(const IP *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00780">network.c:780</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ab6d732074bab2377a7884c41c219cf96"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96">DHT_bootstrap</a></div><div class="ttdeci">void DHT_bootstrap(DHT *dht, IP_Port ip_port, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01420">DHT.c:1420</a></div></div>
<div class="ttc" id="struct_i_p_html"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html">IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00153">network.h:153</a></div></div>
<div class="ttc" id="struct_i_p___port_html"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html">IP_Port</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00162">network.h:162</a></div></div>
<div class="ttc" id="struct_i_p_html_adad4493a852deb413bb8c515368deaac"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">IP::family</a></div><div class="ttdeci">uint8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a8e0798404bf2cf5dabb84c5ba9a4f236">IP_Port::port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00164">network.h:164</a></div></div>
<div class="ttc" id="network_8c_html_a1c024648679209a12766fedc7e55d5e4"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a1c024648679209a12766fedc7e55d5e4">addr_resolve_or_parse_ip</a></div><div class="ttdeci">int addr_resolve_or_parse_ip(const char *address, IP *to, IP *extra)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l01041">network.c:1041</a></div></div>
<div class="ttc" id="irc__syncbot_8c_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="../../db/d11/irc__syncbot_8c.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d11/irc__syncbot_8c_source.html#l00031">irc_syncbot.c:31</a></div></div>
<div class="ttc" id="network_8c_html_a2bfd1efbce5b035b10c879a7e85c08df"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df">ip_reset</a></div><div class="ttdeci">void ip_reset(IP *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00761">network.c:761</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_cgraph" id="df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_cgraph">
<area shape="rect" id="node2" href="../../d6/d6e/network_8c.html#a1c024648679209a12766fedc7e55d5e4" title="addr_resolve_or_parse_ip" alt="" coords="197,56,368,83"/><area shape="rect" id="node7" href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96" title="DHT_bootstrap" alt="" coords="227,132,338,159"/><area shape="rect" id="node23" href="../../d6/d6e/network_8c.html#a6aa0dce9c25e370af93bf4a14f79c709" title="ip_init" alt="" coords="255,183,311,209"/><area shape="rect" id="node24" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="249,233,316,260"/><area shape="rect" id="node25" href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df" title="ip_reset" alt="" coords="249,284,317,311"/><area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#af329b139810a0b31f336bdf416333b24" title="addr_resolve" alt="" coords="419,56,515,83"/><area shape="rect" id="node6" href="../../d6/d6e/network_8c.html#a944255f7a47e106de5faea1bf7387a28" title="addr_parse_ip" alt="" coords="416,5,519,32"/><area shape="rect" id="node4" href="../../d6/d6e/network_8c.html#ad953dedd6d25d03cf441960dd1e1fed1" title="networking_at_startup" alt="" coords="582,31,733,57"/><area shape="rect" id="node5" href="../../d6/d6e/network_8c.html#a9f5cd2a713e4a17d4c6d36650336cab0" title="current_time_actual" alt="" coords="815,31,951,57"/><area shape="rect" id="node8" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="430,183,505,209"/><area shape="rect" id="node9" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="567,132,748,159"/><area shape="rect" id="node14" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="575,183,740,209"/><area shape="rect" id="node15" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="622,233,693,260"/><area shape="rect" id="node16" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="613,284,701,311"/><area shape="rect" id="node18" href="../../df/d02/ping__array_8c.html#a67470d42ee0e3e61bedfa598f3039266" title="ping_array_add" alt="" coords="602,335,713,361"/><area shape="rect" id="node22" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="613,81,702,108"/><area shape="rect" id="node10" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="826,157,941,184"/><area shape="rect" id="node11" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="1019,208,1159,235"/><area shape="rect" id="node12" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="1047,259,1130,285"/><area shape="rect" id="node13" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1207,259,1285,285"/><area shape="rect" id="node17" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="830,208,937,235"/><area shape="rect" id="node19" href="../../df/d02/ping__array_8c.html#a660fb4ff5c6564a9b61cfbc497d1191b" title="ping_array_clear_timedout" alt="" coords="796,259,971,285"/><area shape="rect" id="node20" href="../../df/d02/ping__array_8c.html#ad051ea35e31300366c9f8c167b27ca4c" title="clear_entry" alt="" coords="1045,309,1132,336"/><area shape="rect" id="node21" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="837,360,930,387"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_icgraph" id="df/dad/_d_h_t_8h_af342c78837dbed569d4a75a0516455fc_icgraph">
<area shape="rect" id="node2" href="../../d1/d36/tox-bootstrapd_8c.html#a3b29f8b1522a8d051f35cc76a54f846a" title="bootstrap_from_config" alt="" coords="197,5,348,32"/><area shape="rect" id="node4" href="../../db/d5e/_d_h_t__bootstrap_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="247,56,298,83"/><area shape="rect" id="node3" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="396,5,447,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad5df2ff5066cf93898e531d320ddd675"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_connect_after_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02382">2382</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01420">DHT_bootstrap()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02490">DHT_non_lan_connected()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00149">Node_format::ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00218">DHT::loaded_nodes_index</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00216">DHT::loaded_nodes_list</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00217">DHT::loaded_num_nodes</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00148">Node_format::public_key</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02379">SAVE_BOOTSTAP_FREQUENCY</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02242">do_DHT()</a>.</p>
<div class="fragment"><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;{</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="keywordflow">if</span> (dht == NULL)</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="keywordflow">if</span> (!dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">loaded_nodes_list</a>)</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="comment">/* DHT is connected, stop. */</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/dc1/_d_h_t_8c.html#a90cd93b83fdec619c4924fd20c4fc005">DHT_non_lan_connected</a>(dht)) {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        free(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">loaded_nodes_list</a>);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">loaded_nodes_list</a> = NULL;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aef4ce67d5df5f093247c73b3a024b73e">loaded_num_nodes</a> = 0;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aef4ce67d5df5f093247c73b3a024b73e">loaded_num_nodes</a> &amp;&amp; i &lt; <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a696df5fcb740674dfec58340660641be">SAVE_BOOTSTAP_FREQUENCY</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a6525da58097b462adbe2ad9000a6d77d">loaded_nodes_index</a> % dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aef4ce67d5df5f093247c73b3a024b73e">loaded_num_nodes</a>;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96">DHT_bootstrap</a>(dht, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">loaded_nodes_list</a>[index].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">loaded_nodes_list</a>[index].<a class="code" href="../../d3/d53/struct_node__format.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        ++dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a6525da58097b462adbe2ad9000a6d77d">loaded_nodes_index</a>;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8c_html_a696df5fcb740674dfec58340660641be"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a696df5fcb740674dfec58340660641be">SAVE_BOOTSTAP_FREQUENCY</a></div><div class="ttdeci">#define SAVE_BOOTSTAP_FREQUENCY</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02379">DHT.c:2379</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ab6d732074bab2377a7884c41c219cf96"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96">DHT_bootstrap</a></div><div class="ttdeci">void DHT_bootstrap(DHT *dht, IP_Port ip_port, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01420">DHT.c:1420</a></div></div>
<div class="ttc" id="struct_node__format_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d3/d53/struct_node__format.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Node_format::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00148">DHT.h:148</a></div></div>
<div class="ttc" id="struct_node__format_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Node_format::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00149">DHT.h:149</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a3050c21873637c51d8001c807f62fa74"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">DHT::loaded_nodes_list</a></div><div class="ttdeci">Node_format * loaded_nodes_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00216">DHT.h:216</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a6525da58097b462adbe2ad9000a6d77d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a6525da58097b462adbe2ad9000a6d77d">DHT::loaded_nodes_index</a></div><div class="ttdeci">unsigned int loaded_nodes_index</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00218">DHT.h:218</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aef4ce67d5df5f093247c73b3a024b73e"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aef4ce67d5df5f093247c73b3a024b73e">DHT::loaded_num_nodes</a></div><div class="ttdeci">uint32_t loaded_num_nodes</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00217">DHT.h:217</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a90cd93b83fdec619c4924fd20c4fc005"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a90cd93b83fdec619c4924fd20c4fc005">DHT_non_lan_connected</a></div><div class="ttdeci">int DHT_non_lan_connected(const DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02490">DHT.c:2490</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_cgraph" id="df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96" title="DHT_bootstrap" alt="" coords="249,189,360,216"/><area shape="rect" id="node18" href="../../dc/dc1/_d_h_t_8c.html#a90cd93b83fdec619c4924fd20c4fc005" title="DHT_non_lan_connected" alt="" coords="220,303,389,329"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="462,157,537,184"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="609,157,791,184"/><area shape="rect" id="node9" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="617,208,783,235"/><area shape="rect" id="node10" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="665,5,735,32"/><area shape="rect" id="node11" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="656,56,744,83"/><area shape="rect" id="node13" href="../../df/d02/ping__array_8c.html#a67470d42ee0e3e61bedfa598f3039266" title="ping_array_add" alt="" coords="645,309,755,336"/><area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="655,107,745,133"/><area shape="rect" id="node5" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="869,183,983,209"/><area shape="rect" id="node6" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="1061,183,1201,209"/><area shape="rect" id="node7" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="1090,284,1173,311"/><area shape="rect" id="node8" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1249,284,1328,311"/><area shape="rect" id="node12" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="873,56,979,83"/><area shape="rect" id="node14" href="../../df/d02/ping__array_8c.html#a660fb4ff5c6564a9b61cfbc497d1191b" title="ping_array_clear_timedout" alt="" coords="839,360,1013,387"/><area shape="rect" id="node15" href="../../df/d02/ping__array_8c.html#ad051ea35e31300366c9f8c167b27ca4c" title="clear_entry" alt="" coords="1088,385,1175,412"/><area shape="rect" id="node16" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="879,309,973,336"/><area shape="rect" id="node19" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="467,409,532,436"/><area shape="rect" id="node21" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="437,335,561,361"/><area shape="rect" id="node20" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="665,435,735,461"/><area shape="rect" id="node22" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="619,360,781,387"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_icgraph" id="df/dad/_d_h_t_8h_ad5df2ff5066cf93898e531d320ddd675_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="220,81,291,108"/><area shape="rect" id="node3" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="355,5,429,32"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="351,56,433,83"/><area shape="rect" id="node7" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="367,107,417,133"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="339,157,445,184"/><area shape="rect" id="node4" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="493,5,600,32"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="493,56,600,83"/><area shape="rect" id="node9" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="521,132,572,159"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="505,183,588,209"/><area shape="rect" id="node11" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="648,107,755,133"/><area shape="rect" id="node12" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="675,157,727,184"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="676,208,727,235"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="665,259,738,285"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="803,259,853,285"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4e70f3fc186c6e459908307c935d00b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_delfriend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>lock_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01250">1250</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00437">friend_number()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00138">DHT_Friend::lock_count</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT::num_friends</a>.</p>

<p>Referenced by <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00287">change_dht_pk()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00791">do_friend_connections()</a>, and <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00690">kill_friend_connection()</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordtype">int</span> friend_num = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b">friend_number</a>(dht, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span> (friend_num == -1) {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[friend_num];</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    --<span class="keyword">friend</span>-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a712c4c639bfc0f5a8616eead3e24ca4e">lock_count</a>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="keywordflow">if</span> (friend-&gt;lock_count &amp;&amp; lock_count) { <span class="comment">/* DHT friend is still in use.*/</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        --lock_count;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keyword">friend</span>-&gt;callbacks[lock_count].ip_callback = NULL;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keyword">friend</span>-&gt;callbacks[lock_count].data = NULL;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keyword">friend</span>-&gt;callbacks[lock_count].number = 0;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *temp;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    --dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a> != friend_num) {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        memcpy( &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[friend_num],</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>],</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a>) );</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a> == 0) {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        free(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a> = NULL;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    temp = realloc(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a>) * (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>));</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">if</span> (temp == NULL)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a> = temp;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8c_html_a6cbd0f66d63003cc0def913dc7a4254b"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b">friend_number</a></div><div class="ttdeci">static int friend_number(const DHT *dht, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00437">DHT.c:437</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00126">DHT.h:126</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a712c4c639bfc0f5a8616eead3e24ca4e"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a712c4c639bfc0f5a8616eead3e24ca4e">DHT_Friend::lock_count</a></div><div class="ttdeci">uint16_t lock_count</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00138">DHT.h:138</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8ee1f2d7e543bce350c591a8eaac0cf8"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">DHT::num_friends</a></div><div class="ttdeci">uint16_t num_friends</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT.h:214</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_cgraph" id="df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b" title="friend_number" alt="" coords="160,5,264,32"/><area shape="rect" id="node3" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="312,5,383,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_icgraph" id="df/dad/_d_h_t_8h_a4e70f3fc186c6e459908307c935d00b2_icgraph">
<area shape="rect" id="node2" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="178,235,289,262"/><area shape="rect" id="node11" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="773,83,925,110"/><area shape="rect" id="node26" href="../../d0/d08/friend__connection_8h.html#a5f311791c0ec4ecd8fdf5359cf7fb95a" title="kill_friend_connection" alt="" coords="160,466,307,493"/><area shape="rect" id="node3" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="370,185,486,211"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="549,286,717,313"/><area shape="rect" id="node9" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="556,185,711,211"/><area shape="rect" id="node19" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="572,33,695,59"/><area shape="rect" id="node22" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="556,134,711,161"/><area shape="rect" id="node5" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="767,337,930,363"/><area shape="rect" id="node6" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1000,454,1117,481"/><area shape="rect" id="node7" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1245,479,1295,506"/><area shape="rect" id="node8" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1235,543,1305,570"/><area shape="rect" id="node10" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="793,235,905,262"/><area shape="rect" id="node12" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1005,83,1112,110"/><area shape="rect" id="node13" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1245,109,1295,135"/><area shape="rect" id="node14" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1776,421,1859,447"/><area shape="rect" id="node15" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1907,471,2013,498"/><area shape="rect" id="node16" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1934,370,1986,397"/><area shape="rect" id="node17" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1935,421,1985,447"/><area shape="rect" id="node18" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1923,589,1997,615"/><area shape="rect" id="node20" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1421,286,1555,313"/><area shape="rect" id="node21" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1621,421,1728,447"/><area shape="rect" id="node23" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="794,134,903,161"/><area shape="rect" id="node24" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1012,134,1105,161"/><area shape="rect" id="node25" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="980,235,1137,262"/><area shape="rect" id="node27" href="../../df/de9/toxcore_2group_8c.html#a812cc4cdcdb4821a6624c886e71e2a6c" title="remove_close_conn" alt="" coords="359,493,497,519"/><area shape="rect" id="node33" href="../../dd/de4/toxcore_2group_8h.html#a526817b20616bdf13250e1020d2a1808" title="del_groupchat" alt="" coords="797,809,900,835"/><area shape="rect" id="node43" href="../../df/de9/toxcore_2group_8c.html#aadd3b840d1ca411fc2345ec2c9f6bfe7" title="handle_packet_online" alt="" coords="355,387,501,414"/><area shape="rect" id="node44" href="../../df/de9/toxcore_2group_8c.html#a5f0da219f2f87c142bd8c95f6d43e32c" title="handle_direct_packet" alt="" coords="355,439,501,466"/><area shape="rect" id="node45" href="../../d0/d08/friend__connection_8h.html#a2ef8cdbd93f21f11ff0333a9527c2c02" title="kill_friend_connections" alt="" coords="771,555,926,582"/><area shape="rect" id="node47" href="../../d4/d30/_messenger_8h.html#a7a7b52e12232948dfe96d8e7dea50610" title="m_delfriend" alt="" coords="804,657,893,683"/><area shape="rect" id="node28" href="../../df/de9/toxcore_2group_8c.html#a54efac41dbd172d4443518f006d89b05" title="delpeer" alt="" coords="601,497,665,523"/><area shape="rect" id="node29" href="../../df/de9/toxcore_2group_8c.html#acfda9051487bdd5f51667aea724952e9" title="groupchat_clear_timedout" alt="" coords="1403,589,1573,615"/><area shape="rect" id="node30" href="../../df/de9/toxcore_2group_8c.html#a1a33e6d2f2651603b3e37ff90cfd6dee" title="handle_message_packet\l_group" alt="" coords="765,489,932,531"/><area shape="rect" id="node31" href="../../df/de9/toxcore_2group_8c.html#a0b63c2cb5a61d6418705d22a30a8d4ef" title="handle_packet" alt="" coords="1005,395,1112,422"/><area shape="rect" id="node32" href="../../df/de9/toxcore_2group_8c.html#ab48e96a53cc90551754943ce3df01673" title="add_conn_to_groupchat" alt="" coords="1190,366,1350,393"/><area shape="rect" id="node34" href="../../d8/da5/toxav_2group_8h.html#a0cf061415a40de14b1dca48921a6f687" title="add_av_groupchat" alt="" coords="995,935,1123,962"/><area shape="rect" id="node36" href="../../d8/da5/toxav_2group_8h.html#a3bb53f02b23ac60cb1e76d3717a4e2e5" title="join_av_groupchat" alt="" coords="995,809,1122,835"/><area shape="rect" id="node38" href="../../dd/de4/toxcore_2group_8h.html#af203efe57203e3b774d8e4f5e29cca81" title="kill_groupchats" alt="" coords="1004,758,1113,785"/><area shape="rect" id="node40" href="../../d3/d8f/tox__old__code_8h.html#a2a5c2f4bc3730d20bc784e512bc116b5" title="tox_del_groupchat" alt="" coords="995,859,1123,886"/><area shape="rect" id="node35" href="../../d9/d82/toxav_8h.html#a71c8622e709969f80a862ee56da27184" title="toxav_add_av_groupchat" alt="" coords="1187,961,1353,987"/><area shape="rect" id="node37" href="../../d9/d82/toxav_8h.html#a02fd1017fbe8e974c2c0a39ee08067d7" title="toxav_join_av_groupchat" alt="" coords="1187,809,1353,835"/><area shape="rect" id="node39" href="../../da/d8f/tox_8h.html#a52259e134bfb9396d9fef4fffe94e878" title="tox_kill" alt="" coords="1239,758,1301,785"/><area shape="rect" id="node41" href="../../d9/d35/tox__test_8c.html#a999b8d0cb6f7a7ea6f983f4f32e18f25" title="START_TEST" alt="" coords="1217,859,1323,886"/><area shape="rect" id="node42" href="../../db/d11/irc__syncbot_8c.html#ae3a0e6382b8d202501525dc6315bec08" title="callback_friend_message" alt="" coords="1185,910,1355,937"/><area shape="rect" id="node46" href="../../d4/d30/_messenger_8h.html#a771c65c3057d870b0653c2fdf0a12fb7" title="kill_messenger" alt="" coords="1004,555,1113,582"/><area shape="rect" id="node48" href="../../d8/dda/messenger__test_8c.html#a0d7e5cba3f1de72c42741b80489f5df0" title="START_TEST" alt="" coords="1005,657,1112,683"/><area shape="rect" id="node49" href="../../d8/dda/messenger__test_8c.html#a921391ba2a74ae4536cfcd2c789c78f9" title="messenger_suite" alt="" coords="998,505,1119,531"/><area shape="rect" id="node50" href="../../da/d8f/tox_8h.html#ae7909e1bb1cf6d8073d38aac41c2fb9c" title="tox_friend_delete" alt="" coords="1427,639,1549,666"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9e92f7714ab1f2b37b54e8479717cbc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHT_get_shared_key_recv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>shared_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00146">146</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00100">get_shared_key()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT::self_secret_key</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00220">DHT::shared_keys_recv</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01018">handle_getnodes()</a>, and <a class="el" href="../../d9/d54/ping_8c_source.html#l00132">handle_ping_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e">get_shared_key</a>(&amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a4c647e235c4b9d2d6d68d760c7cb1b30">shared_keys_recv</a>, shared_key, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="ttc" id="struct_d_h_t_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">DHT::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT.h:211</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a4c647e235c4b9d2d6d68d760c7cb1b30"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a4c647e235c4b9d2d6d68d760c7cb1b30">DHT::shared_keys_recv</a></div><div class="ttdeci">Shared_Keys shared_keys_recv</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00220">DHT.h:220</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a6cd4aa89d7bfcf6805c5ce6b273d9e9e"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e">get_shared_key</a></div><div class="ttdeci">void get_shared_key(Shared_Keys *shared_keys, uint8_t *shared_key, const uint8_t *secret_key, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00100">DHT.c:100</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_cgraph" id="df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="235,56,349,83"/><area shape="rect" id="node3" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="397,5,537,32"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="426,56,509,83"/><area shape="rect" id="node5" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="585,81,664,108"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_icgraph" id="df/dad/_d_h_t_8h_a9e92f7714ab1f2b37b54e8479717cbc7_icgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383" title="handle_getnodes" alt="" coords="424,81,544,108"/><area shape="rect" id="node19" href="../../d9/d54/ping_8c.html#a8bb0298504d1f6a612100d0b17e3ab90" title="handle_ping_request" alt="" coords="235,132,376,159"/><area shape="rect" id="node3" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="592,107,673,133"/><area shape="rect" id="node4" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="723,5,837,32"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="727,56,833,83"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="735,107,825,133"/><area shape="rect" id="node9" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="755,157,805,184"/><area shape="rect" id="node10" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="721,208,839,235"/><area shape="rect" id="node5" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="887,5,993,32"/><area shape="rect" id="node8" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="887,107,993,133"/><area shape="rect" id="node11" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="915,183,965,209"/><area shape="rect" id="node12" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="905,233,975,260"/><area shape="rect" id="node13" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1041,157,1148,184"/><area shape="rect" id="node14" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1063,208,1127,235"/><area shape="rect" id="node16" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1055,259,1134,285"/><area shape="rect" id="node18" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1069,309,1120,336"/><area shape="rect" id="node15" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1196,208,1247,235"/><area shape="rect" id="node17" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1196,259,1247,285"/><area shape="rect" id="node20" href="../../d6/d2b/ping_8h.html#a86e9eeead72b88b686ce5b7c0f78c325" title="new_ping" alt="" coords="445,132,523,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a087cceeacc5a14415b651c2980a24d34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHT_get_shared_key_sent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>shared_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00154">154</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00100">get_shared_key()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT::self_secret_key</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00221">DHT::shared_keys_sent</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00067">create_cookie_request()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00912">getnodes()</a>, <a class="el" href="../../d8/dc6/net__crypto_8c_source.html#l00174">handle_cookie_request()</a>, <a class="el" href="../../d9/d54/ping_8c_source.html#l00171">handle_ping_response()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01077">handle_sendnodes_core()</a>, and <a class="el" href="../../d9/d54/ping_8c_source.html#l00061">send_ping_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e">get_shared_key</a>(&amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a07b2f51891b851ec0cd7dfe729412f77">shared_keys_sent</a>, shared_key, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="ttc" id="struct_d_h_t_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">DHT::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT.h:211</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a07b2f51891b851ec0cd7dfe729412f77"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a07b2f51891b851ec0cd7dfe729412f77">DHT::shared_keys_sent</a></div><div class="ttdeci">Shared_Keys shared_keys_sent</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00221">DHT.h:221</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a6cd4aa89d7bfcf6805c5ce6b273d9e9e"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e">get_shared_key</a></div><div class="ttdeci">void get_shared_key(Shared_Keys *shared_keys, uint8_t *shared_key, const uint8_t *secret_key, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00100">DHT.c:100</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_cgraph" id="df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="235,56,349,83"/><area shape="rect" id="node3" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="397,5,537,32"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="426,56,509,83"/><area shape="rect" id="node5" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="585,81,664,108"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_icgraph" id="df/dad/_d_h_t_8h_a087cceeacc5a14415b651c2980a24d34_icgraph">
<area shape="rect" id="node2" href="../../d8/dc6/net__crypto_8c.html#a5b67a38d23f1bbe5ff0ba96ea57520a4" title="create_cookie_request" alt="" coords="239,39,393,65"/><area shape="rect" id="node10" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="279,467,353,493"/><area shape="rect" id="node36" href="../../d8/dc6/net__crypto_8c.html#ae86cc5b9c02d6a9f61916e1ff1a1b768" title="handle_cookie_request" alt="" coords="239,148,393,175"/><area shape="rect" id="node43" href="../../d9/d54/ping_8c.html#a3927c1053be4390271a309982aa7284f" title="handle_ping_response" alt="" coords="241,224,391,251"/><area shape="rect" id="node45" href="../../dc/dc1/_d_h_t_8c.html#a4dcc848207b2408def323b8b79b08e4a" title="handle_sendnodes_core" alt="" coords="235,275,397,301"/><area shape="rect" id="node47" href="../../d6/d2b/ping_8h.html#a1b3882fdfddc79be369ff230cd3e7a6a" title="send_ping_request" alt="" coords="251,792,381,819"/><area shape="rect" id="node3" href="../../de/d42/net__crypto_8h.html#ae09413aa94644bc88bf73b88f48ef814" title="new_crypto_connection" alt="" coords="457,5,616,32"/><area shape="rect" id="node4" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="682,5,837,32"/><area shape="rect" id="node5" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="911,119,1023,145"/><area shape="rect" id="node7" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="1256,19,1372,45"/><area shape="rect" id="node9" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="891,68,1043,95"/><area shape="rect" id="node6" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="1094,107,1205,133"/><area shape="rect" id="node8" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="1420,57,1588,84"/><area shape="rect" id="node11" href="../../df/dad/_d_h_t_8h.html#a1dac5e05fd07964cb4914c17afeb9d50" title="DHT_addfriend" alt="" coords="704,371,815,397"/><area shape="rect" id="node21" href="../../df/dad/_d_h_t_8h.html#ab6d732074bab2377a7884c41c219cf96" title="DHT_bootstrap" alt="" coords="481,517,592,544"/><area shape="rect" id="node29" href="../../df/dad/_d_h_t_8h.html#a769ef744f969e1b4c55547cb74abee59" title="DHT_getnodes" alt="" coords="481,691,592,717"/><area shape="rect" id="node32" href="../../dc/dc1/_d_h_t_8c.html#a1d3aa20a7622e95d168e3220f61f6227" title="do_ping_and_sendnode\l_requests" alt="" coords="457,785,616,826"/><area shape="rect" id="node35" href="../../dc/dc1/_d_h_t_8c.html#aa38b3670da696f600f37989e79ce4966" title="handle_hardening" alt="" coords="475,351,598,377"/><area shape="rect" id="node12" href="../../d7/dd9/onion__test_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="1091,415,1207,441"/><area shape="rect" id="node14" href="../../d3/dfd/_d_h_t__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="941,364,992,391"/><area shape="rect" id="node15" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="926,308,1007,335"/><area shape="rect" id="node13" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1261,415,1367,441"/><area shape="rect" id="node16" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="1092,308,1207,335"/><area shape="rect" id="node17" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1096,359,1203,385"/><area shape="rect" id="node18" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1104,257,1195,284"/><area shape="rect" id="node19" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1124,535,1175,561"/><area shape="rect" id="node20" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1091,181,1208,208"/><area shape="rect" id="node22" href="../../df/dad/_d_h_t_8h.html#af342c78837dbed569d4a75a0516455fc" title="DHT_bootstrap_from\l_address" alt="" coords="687,523,831,565"/><area shape="rect" id="node25" href="../../df/dad/_d_h_t_8h.html#ad5df2ff5066cf93898e531d320ddd675" title="DHT_connect_after_load" alt="" coords="676,640,843,667"/><area shape="rect" id="node27" href="../../d1/de5/_l_a_n__discovery_8c.html#aeb11042ae0d160b28f8943da6ae29499" title="handle_LANdiscovery" alt="" coords="685,421,834,448"/><area shape="rect" id="node28" href="../../da/d8f/tox_8h.html#ae7e49c1e9e6c3a0f9e55bfcb78044c1e" title="tox_bootstrap" alt="" coords="709,472,810,499"/><area shape="rect" id="node23" href="../../d1/d36/tox-bootstrapd_8c.html#a3b29f8b1522a8d051f35cc76a54f846a" title="bootstrap_from_config" alt="" coords="891,535,1042,561"/><area shape="rect" id="node24" href="../../db/d5e/_d_h_t__bootstrap_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="941,484,992,511"/><area shape="rect" id="node26" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="931,792,1002,819"/><area shape="rect" id="node30" href="../../da/d7d/assoc_8h.html#a36aff33785fb0db2565cf4cb5b080327" title="do_Assoc" alt="" coords="719,691,799,717"/><area shape="rect" id="node31" href="../../db/d79/onion__client_8c.html#ac9b7f86cb71b27c5db73d341b910745c" title="handle_dhtpk_announce" alt="" coords="678,741,841,768"/><area shape="rect" id="node33" href="../../dc/dc1/_d_h_t_8c.html#ae05715389aba7cec9083bdf9efad7a78" title="do_Close" alt="" coords="721,792,798,819"/><area shape="rect" id="node34" href="../../dc/dc1/_d_h_t_8c.html#ad1bcb472a3fd0ff8ab579551c4528b62" title="do_DHT_friends" alt="" coords="701,843,818,869"/><area shape="rect" id="node37" href="../../d8/dc6/net__crypto_8c.html#a04fc41a4cb0d904536626006f3b7d7dd" title="udp_handle_cookie_request" alt="" coords="445,123,628,149"/><area shape="rect" id="node39" href="../../d8/dc6/net__crypto_8c.html#a9308f183e47e29869d5562d03a01f88a" title="tcp_handle_cookie_request" alt="" coords="447,173,627,200"/><area shape="rect" id="node41" href="../../d8/dc6/net__crypto_8c.html#ae88369484d37b525d33c5c87c846606b" title="tcp_oob_handle_cookie\l_request" alt="" coords="457,57,616,98"/><area shape="rect" id="node38" href="../../de/d42/net__crypto_8h.html#a5e46c6f42e93e2aa968f8f63de90a53c" title="new_net_crypto" alt="" coords="909,169,1024,196"/><area shape="rect" id="node40" href="../../d8/dc6/net__crypto_8c.html#ab2eaad4448a5deca58a00316b522e380" title="tcp_data_callback" alt="" coords="696,168,823,195"/><area shape="rect" id="node42" href="../../d8/dc6/net__crypto_8c.html#a86a3ff661a8b9b10fd7c0daee3901091" title="tcp_oob_callback" alt="" coords="698,65,821,92"/><area shape="rect" id="node44" href="../../d6/d2b/ping_8h.html#a86e9eeead72b88b686ce5b7c0f78c325" title="new_ping" alt="" coords="721,219,798,245"/><area shape="rect" id="node46" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514" title="handle_sendnodes_ipv6" alt="" coords="456,275,617,301"/><area shape="rect" id="node48" href="../../dc/dc1/_d_h_t_8c.html#a7efc873280e2d502bf49489d3ebacc9c" title="punch_holes" alt="" coords="489,933,584,960"/><area shape="rect" id="node50" href="../../d6/d2b/ping_8h.html#af1ade820101b833a4615cb9fb58bebad" title="do_to_ping" alt="" coords="494,861,579,888"/><area shape="rect" id="node49" href="../../dc/dc1/_d_h_t_8c.html#a9243f57fde4a9312f11575eb4e7b1275" title="do_NAT" alt="" coords="724,944,795,971"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a963cf2afd9283277f69a94381e3fc5f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_getfriendip </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> *&#160;</td>
          <td class="paramname"><em>ip_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01295">1295</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00052">BAD_NODE_TIMEOUT</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT_Friend::client_list</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00061">id_equal()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00761">ip_reset()</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00054">is_timeout()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">MAX_FRIEND_CLIENTS</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT::num_friends</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00164">IP_Port::port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00104">Client_data::public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00127">DHT_Friend::public_key</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00094">IPPTsPng::timestamp</a>.</p>

<p>Referenced by <a class="el" href="../../db/d79/onion__client_8c_source.html#l01165">onion_getfriendip()</a>, and <a class="el" href="../../d3/dfd/_d_h_t__test_8c_source.html#l00122">print_friendlist()</a>.</p>
<div class="fragment"><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;{</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df">ip_reset</a>(&amp;ip_port-&gt;<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    ip_port-&gt;<a class="code" href="../../db/d14/struct_i_p___port.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a> = 0;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="comment">/* Equal */</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1">id_equal</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[i].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>)) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>; ++j) {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j];</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1">id_equal</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>)) {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                    <a class="code" href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a> *assoc = NULL;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                    uint32_t a;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    <span class="keywordflow">for</span> (a = 0, assoc = &amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>; a &lt; 2; a++, assoc = &amp;client-&gt;assoc4)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(assoc-&gt;<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>)) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                            *ip_port = assoc-&gt;<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                        }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;}</div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00092">DHT.h:92</a></div></div>
<div class="ttc" id="util_8c_html_ab643c84141e04b54ba650c50165ba288"><div class="ttname"><a href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a></div><div class="ttdeci">int is_timeout(uint64_t timestamp, uint64_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00054">util.c:54</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_client__data_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Client_data::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00104">DHT.h:104</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a2c542fd03a43f340d1fb281afe54453f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a></div><div class="ttdeci">#define BAD_NODE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00052">DHT.h:52</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a8e0798404bf2cf5dabb84c5ba9a4f236">IP_Port::port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00164">network.h:164</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8ee1f2d7e543bce350c591a8eaac0cf8"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">DHT::num_friends</a></div><div class="ttdeci">uint16_t num_friends</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT.h:214</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a465bef81f6478756e5443025b1f2ddfa"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">IPPTsPng::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00094">DHT.h:94</a></div></div>
<div class="ttc" id="util_8c_html_ada3d44b4f530d3c8c9cb69b732be94b1"><div class="ttname"><a href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1">id_equal</a></div><div class="ttdeci">bool id_equal(const uint8_t *dest, const uint8_t *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00061">util.c:61</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#aaa806bb1136fb3d4b5d8d8970b596ff7">DHT_Friend::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00127">DHT.h:127</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a49ef2b640a834a77b6e123355a4fea47"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">DHT_Friend::client_list</a></div><div class="ttdeci">Client_data client_list[MAX_FRIEND_CLIENTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT.h:128</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ad50d158518277ca4d19cbe364f3e958c"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a></div><div class="ttdeci">#define MAX_FRIEND_CLIENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00032">DHT.h:32</a></div></div>
<div class="ttc" id="network_8c_html_a2bfd1efbce5b035b10c879a7e85c08df"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df">ip_reset</a></div><div class="ttdeci">void ip_reset(IP *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00761">network.c:761</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_cgraph" id="df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_cgraph">
<area shape="rect" id="node2" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="177,5,247,32"/><area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df" title="ip_reset" alt="" coords="178,56,246,83"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="171,107,253,133"/><area shape="rect" id="node5" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="301,107,380,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_icgraph" id="df/dad/_d_h_t_8h_a963cf2afd9283277f69a94381e3fc5f0_icgraph">
<area shape="rect" id="node2" href="../../d9/d26/onion__client_8h.html#a729c34e35841408f6d775179f4e7a48b" title="onion_getfriendip" alt="" coords="171,5,291,32"/><area shape="rect" id="node4" href="../../d3/dfd/_d_h_t__test_8c.html#ad94c4250d373760f1702fb8d55050ed7" title="print_friendlist" alt="" coords="179,56,282,83"/><area shape="rect" id="node3" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="339,5,445,32"/><area shape="rect" id="node5" href="../../d3/dfd/_d_h_t__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="367,56,417,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a769ef744f969e1b4c55547cb74abee59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHT_getnodes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d14/struct_i_p___port.html">IP_Port</a> *&#160;</td>
          <td class="paramname"><em>from_ipp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>from_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>which_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01415">1415</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00912">getnodes()</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00886">do_Assoc()</a>, and <a class="el" href="../../db/d79/onion__client_8c_source.html#l00703">handle_dhtpk_announce()</a>.</p>
<div class="fragment"><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;{</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a>(dht, *from_ipp, from_id, which_id, NULL);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8c_html_a7af6c30b12e5cbda1e6d6d824794956e"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e">getnodes</a></div><div class="ttdeci">static int getnodes(DHT *dht, IP_Port ip_port, const uint8_t *public_key, const uint8_t *client_id, const Node_format *sendback_node)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00912">DHT.c:912</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_cgraph" id="df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="164,132,239,159"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="287,5,468,32"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="295,56,460,83"/><area shape="rect" id="node9" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="342,107,413,133"/><area shape="rect" id="node10" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="333,157,421,184"/><area shape="rect" id="node12" href="../../df/d02/ping__array_8c.html#a67470d42ee0e3e61bedfa598f3039266" title="ping_array_add" alt="" coords="322,208,433,235"/><area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="333,259,422,285"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a6cd4aa89d7bfcf6805c5ce6b273d9e9e" title="get_shared_key" alt="" coords="546,31,661,57"/><area shape="rect" id="node5" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="739,31,879,57"/><area shape="rect" id="node6" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="767,132,850,159"/><area shape="rect" id="node7" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="927,132,1005,159"/><area shape="rect" id="node11" href="../../dc/d85/crypto__core_8c.html#a15ef255ab026d4881a16b99148b05dd7" title="random_nonce" alt="" coords="550,81,657,108"/><area shape="rect" id="node13" href="../../df/d02/ping__array_8c.html#a660fb4ff5c6564a9b61cfbc497d1191b" title="ping_array_clear_timedout" alt="" coords="516,132,691,159"/><area shape="rect" id="node14" href="../../df/d02/ping__array_8c.html#ad051ea35e31300366c9f8c167b27ca4c" title="clear_entry" alt="" coords="765,208,852,235"/><area shape="rect" id="node15" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="557,183,650,209"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_icgraph" id="df/dad/_d_h_t_8h_a769ef744f969e1b4c55547cb74abee59_icgraph">
<area shape="rect" id="node2" href="../../da/d7d/assoc_8h.html#a36aff33785fb0db2565cf4cb5b080327" title="do_Assoc" alt="" coords="205,107,285,133"/><area shape="rect" id="node17" href="../../db/d79/onion__client_8c.html#ac9b7f86cb71b27c5db73d341b910745c" title="handle_dhtpk_announce" alt="" coords="164,157,327,184"/><area shape="rect" id="node3" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="573,107,643,133"/><area shape="rect" id="node4" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="739,5,813,32"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="735,107,817,133"/><area shape="rect" id="node8" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="751,157,801,184"/><area shape="rect" id="node9" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="723,56,829,83"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="883,5,989,32"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="883,171,989,197"/><area shape="rect" id="node10" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="911,56,961,83"/><area shape="rect" id="node11" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="895,107,977,133"/><area shape="rect" id="node12" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1037,69,1144,96"/><area shape="rect" id="node13" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1065,120,1117,147"/><area shape="rect" id="node14" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1192,69,1243,96"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1054,171,1127,197"/><area shape="rect" id="node16" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1192,221,1243,248"/><area shape="rect" id="node18" href="../../db/d79/onion__client_8c.html#a0686761fa3196a2bded47c2b95c7edc4" title="handle_dht_dhtpk" alt="" coords="375,208,499,235"/><area shape="rect" id="node19" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="547,208,669,235"/><area shape="rect" id="node20" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="731,208,821,235"/><area shape="rect" id="node21" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="717,259,835,285"/><area shape="rect" id="node22" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="911,247,961,273"/><area shape="rect" id="node23" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="901,297,971,324"/><area shape="rect" id="node24" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1037,373,1144,400"/><area shape="rect" id="node25" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1059,221,1123,248"/><area shape="rect" id="node26" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1051,272,1130,299"/><area shape="rect" id="node27" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1065,323,1116,349"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a93770fe498d41d1c6b420275680967b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_isconnected </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02471">2471</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00052">BAD_NODE_TIMEOUT</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00054">is_timeout()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00094">IPPTsPng::timestamp</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../d2/dee/friends__test_8c_source.html#l00061">do_tox()</a>, <a class="el" href="../../d1/d36/tox-bootstrapd_8c_source.html#l00519">main()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00126">random_nodes_path_onion()</a>, and <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00363">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;{</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>) ||</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                !<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>))</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    }</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="util_8c_html_ab643c84141e04b54ba650c50165ba288"><div class="ttname"><a href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a></div><div class="ttdeci">int is_timeout(uint64_t timestamp, uint64_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00054">util.c:54</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a2c542fd03a43f340d1fb281afe54453f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a></div><div class="ttdeci">#define BAD_NODE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00052">DHT.h:52</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a465bef81f6478756e5443025b1f2ddfa"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">IPPTsPng::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00094">DHT.h:94</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_cgraph" id="df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_cgraph">
<area shape="rect" id="node2" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="201,5,283,32"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="180,56,304,83"/><area shape="rect" id="node3" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="393,5,472,32"/><area shape="rect" id="node5" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="352,56,513,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_icgraph" id="df/dad/_d_h_t_8h_a93770fe498d41d1c6b420275680967b6_icgraph">
<area shape="rect" id="node2" href="../../d2/dee/friends__test_8c.html#a4cefd91a5733f30557835867b0174103" title="do_tox" alt="" coords="238,23,299,50"/><area shape="rect" id="node6" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="243,74,294,100"/><area shape="rect" id="node7" href="../../db/d79/onion__client_8c.html#a62aaed2b6aee07c4c0fb8ffd97a03172" title="random_nodes_path_onion" alt="" coords="180,200,357,227"/><area shape="rect" id="node15" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1760,200,1867,227"/><area shape="rect" id="node3" href="../../d2/dee/friends__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="674,23,725,50"/><area shape="rect" id="node4" href="../../d2/dee/friends__test_8c.html#a7266443b3a915168c8c968318182d3d5" title="parent_friend_request" alt="" coords="417,23,564,50"/><area shape="rect" id="node5" href="../../d2/dee/friends__test_8c.html#a4e65a94fb68746f22250369cc581148c" title="parent_wait_for_message" alt="" coords="405,74,576,100"/><area shape="rect" id="node8" href="../../db/d79/onion__client_8c.html#a0ec6065dac34021e69682691f70b667c" title="random_path" alt="" coords="442,226,539,252"/><area shape="rect" id="node9" href="../../db/d79/onion__client_8c.html#a4253f1739f978c9aac584c97b7a55f48" title="client_send_announce\l_request" alt="" coords="624,218,775,260"/><area shape="rect" id="node35" href="../../d9/d26/onion__client_8h.html#aa1be42b5ea93bd068f47271831157927" title="send_onion_data" alt="" coords="639,327,759,354"/><area shape="rect" id="node10" href="../../db/d79/onion__client_8c.html#a934df896ad375a9dbd82f563fb27144f" title="client_ping_nodes" alt="" coords="835,175,962,202"/><area shape="rect" id="node25" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="1077,276,1151,303"/><area shape="rect" id="node34" href="../../db/d79/onion__client_8c.html#ae37f00e2304222b24cef2cce370e58d3" title="do_announce" alt="" coords="849,226,948,252"/><area shape="rect" id="node11" href="../../db/d79/onion__client_8c.html#acef82e3853e62dce8cd45450ff028f97" title="handle_announce_response" alt="" coords="1023,175,1205,202"/><area shape="rect" id="node12" href="../../db/d79/onion__client_8c.html#a3519dd95525df398b46b0e4a928f54f0" title="handle_tcp_onion" alt="" coords="1253,226,1376,252"/><area shape="rect" id="node13" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="1424,214,1547,240"/><area shape="rect" id="node14" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1608,200,1699,227"/><area shape="rect" id="node16" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1595,302,1712,328"/><area shape="rect" id="node17" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1788,314,1839,340"/><area shape="rect" id="node18" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1778,263,1849,290"/><area shape="rect" id="node19" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1915,215,2021,242"/><area shape="rect" id="node20" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1936,164,2000,191"/><area shape="rect" id="node22" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1929,316,2007,343"/><area shape="rect" id="node24" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1943,266,1993,292"/><area shape="rect" id="node21" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2069,215,2120,242"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2069,367,2120,394"/><area shape="rect" id="node26" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="1259,276,1371,303"/><area shape="rect" id="node27" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="1445,276,1526,303"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1432,375,1539,402"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1628,368,1679,395"/><area shape="rect" id="node30" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1772,419,1855,446"/><area shape="rect" id="node31" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1915,519,2021,546"/><area shape="rect" id="node32" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1942,468,1994,495"/><area shape="rect" id="node33" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1931,418,2005,444"/><area shape="rect" id="node36" href="../../d0/d08/friend__connection_8h.html#a2af492c22c086276ed147d0826839d25" title="send_friend_request\l_packet" alt="" coords="1045,370,1183,412"/><area shape="rect" id="node38" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="823,327,975,354"/><area shape="rect" id="node37" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="1273,376,1356,403"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a36e42ad71b293cd0ada8a7b6de9ad86b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02452">2452</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02409">dht_load_state_callback()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02287">DHT_STATE_COOKIE_GLOBAL</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02289">DHT_STATE_COOKIE_TYPE</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00105">lendian_to_host32()</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00117">load_state()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02648">messenger_load_state_callback()</a>, and <a class="el" href="../../d8/dda/messenger__test_8c_source.html#l00219">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;{</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    uint32_t cookie_len = <span class="keyword">sizeof</span>(uint32_t);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keywordflow">if</span> (length &gt; cookie_len) {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        uint32_t data32;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <a class="code" href="../../de/df1/util_8c.html#a4a7b1a2d62e6d6842bc0fefece837ad2">lendian_to_host32</a>(&amp;data32, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        <span class="keywordflow">if</span> (data32 == <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6a842db82e30616af13990781cf13ab3">DHT_STATE_COOKIE_GLOBAL</a>)</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../de/df1/util_8c.html#a779943554d12b56f6e35e8f5ba2cf7f5">load_state</a>(<a class="code" href="../../dc/dc1/_d_h_t_8c.html#a266c420f5eb745eddcf184e316b157be">dht_load_state_callback</a>, dht, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + cookie_len,</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                              length - cookie_len, <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a48a9324191a79b2e05af9b6499addba6">DHT_STATE_COOKIE_TYPE</a>);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    }</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;}</div>
<div class="ttc" id="util_8c_html_a4a7b1a2d62e6d6842bc0fefece837ad2"><div class="ttname"><a href="../../de/df1/util_8c.html#a4a7b1a2d62e6d6842bc0fefece837ad2">lendian_to_host32</a></div><div class="ttdeci">void lendian_to_host32(uint32_t *dest, const uint8_t *lendian)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00105">util.c:105</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a266c420f5eb745eddcf184e316b157be"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a266c420f5eb745eddcf184e316b157be">dht_load_state_callback</a></div><div class="ttdeci">static int dht_load_state_callback(void *outer, const uint8_t *data, uint32_t length, uint16_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02409">DHT.c:2409</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a48a9324191a79b2e05af9b6499addba6"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a48a9324191a79b2e05af9b6499addba6">DHT_STATE_COOKIE_TYPE</a></div><div class="ttdeci">#define DHT_STATE_COOKIE_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02289">DHT.c:2289</a></div></div>
<div class="ttc" id="util_8c_html_a779943554d12b56f6e35e8f5ba2cf7f5"><div class="ttname"><a href="../../de/df1/util_8c.html#a779943554d12b56f6e35e8f5ba2cf7f5">load_state</a></div><div class="ttdeci">int load_state(load_state_callback_func load_state_callback, void *outer, const uint8_t *data, uint32_t length, uint16_t cookie_inner)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00117">util.c:117</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a6a842db82e30616af13990781cf13ab3"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6a842db82e30616af13990781cf13ab3">DHT_STATE_COOKIE_GLOBAL</a></div><div class="ttdeci">#define DHT_STATE_COOKIE_GLOBAL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02287">DHT.c:2287</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_cgraph" id="df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a266c420f5eb745eddcf184e316b157be" title="dht_load_state_callback" alt="" coords="135,5,297,32"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#a4a7b1a2d62e6d6842bc0fefece837ad2" title="lendian_to_host32" alt="" coords="345,56,472,83"/><area shape="rect" id="node5" href="../../de/df1/util_8c.html#a779943554d12b56f6e35e8f5ba2cf7f5" title="load_state" alt="" coords="175,107,257,133"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#a45b33af842c0289c78c70f81e854ed62" title="unpack_nodes" alt="" coords="355,5,462,32"/><area shape="rect" id="node6" href="../../de/df1/util_8c.html#a0c594c8cdb07dc8fda7e5545ebdab86b" title="lendian_to_host16" alt="" coords="345,107,472,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_icgraph" id="df/dad/_d_h_t_8h_a36e42ad71b293cd0ada8a7b6de9ad86b_icgraph">
<area shape="rect" id="node2" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="135,49,288,90"/><area shape="rect" id="node13" href="../../d8/dda/messenger__test_8c.html#a86a26950f83bcd6bd68640da6a5c96a4" title="START_TEST" alt="" coords="158,115,265,141"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="336,56,453,83"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="501,5,608,32"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="529,56,580,83"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="519,107,590,133"/><area shape="rect" id="node7" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="656,31,763,57"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="677,81,741,108"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="670,132,749,159"/><area shape="rect" id="node12" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="684,183,735,209"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="811,81,861,108"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="811,132,861,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a90cd93b83fdec619c4924fd20c4fc005"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DHT_non_lan_connected </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02490">2490</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00052">BAD_NODE_TIMEOUT</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00054">is_timeout()</a>, <a class="el" href="../../d1/de5/_l_a_n__discovery_8c_source.html#l00259">LAN_ip()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00094">IPPTsPng::timestamp</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02382">DHT_connect_after_load()</a>, and <a class="el" href="../../db/d79/onion__client_8c_source.html#l01431">do_onion_client()</a>.</p>
<div class="fragment"><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;{</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>) &amp;&amp; <a class="code" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152">LAN_ip</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>) == -1)</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>) &amp;&amp; <a class="code" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152">LAN_ip</a>(client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>) == -1)</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    }</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="util_8c_html_ab643c84141e04b54ba650c50165ba288"><div class="ttname"><a href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a></div><div class="ttdeci">int is_timeout(uint64_t timestamp, uint64_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00054">util.c:54</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a2c542fd03a43f340d1fb281afe54453f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a></div><div class="ttdeci">#define BAD_NODE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00052">DHT.h:52</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a465bef81f6478756e5443025b1f2ddfa"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">IPPTsPng::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00094">DHT.h:94</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
<div class="ttc" id="_l_a_n__discovery_8c_html_a2d80a53390598eb8ededbc63f4e9c152"><div class="ttname"><a href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152">LAN_ip</a></div><div class="ttdeci">int LAN_ip(IP ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de5/_l_a_n__discovery_8c_source.html#l00259">LAN_discovery.c:259</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_cgraph" id="df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_cgraph">
<area shape="rect" id="node2" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="243,5,326,32"/><area shape="rect" id="node4" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="252,80,317,107"/><area shape="rect" id="node6" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="223,131,347,157"/><area shape="rect" id="node3" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="436,5,515,32"/><area shape="rect" id="node5" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="440,80,511,107"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="395,131,556,157"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_icgraph" id="df/dad/_d_h_t_8h_a90cd93b83fdec619c4924fd20c4fc005_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#ad5df2ff5066cf93898e531d320ddd675" title="DHT_connect_after_load" alt="" coords="223,81,389,108"/><area shape="rect" id="node17" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="437,132,549,159"/><area shape="rect" id="node3" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="458,81,529,108"/><area shape="rect" id="node4" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="613,5,688,32"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="610,107,691,133"/><area shape="rect" id="node8" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="625,56,676,83"/><area shape="rect" id="node9" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="597,157,704,184"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="752,5,859,32"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="752,107,859,133"/><area shape="rect" id="node10" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="780,157,831,184"/><area shape="rect" id="node11" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="764,208,847,235"/><area shape="rect" id="node12" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="907,132,1013,159"/><area shape="rect" id="node13" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="934,183,986,209"/><area shape="rect" id="node14" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="935,233,985,260"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="923,284,997,311"/><area shape="rect" id="node16" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1061,284,1112,311"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7510a9fdbacfffb5987590c4e193c40a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHT_save </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02329">2329</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT_Friend::client_list</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile::data</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00061">DHT_FAKE_FRIEND_NUMBER</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02287">DHT_STATE_COOKIE_GLOBAL</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02290">DHT_STATE_TYPE_NODES</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00096">host_to_lendian32()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00149">Node_format::ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">MAX_FRIEND_CLIENTS</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02292">MAX_SAVED_DHT_NODES</a>, <a class="el" href="../../d9/d35/tox__test_8c_source.html#l00246">num</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT::num_friends</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00207">pack_nodes()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00104">Client_data::public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00094">IPPTsPng::timestamp</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02318">z_state_save_subheader()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02565">messenger_save()</a>, and <a class="el" href="../../d8/dda/messenger__test_8c_source.html#l00219">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;{</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#aebd439a002cb183420a08996f7ffdbef">host_to_lendian32</a>(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>,  <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6a842db82e30616af13990781cf13ab3">DHT_STATE_COOKIE_GLOBAL</a>);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> += <span class="keyword">sizeof</span>(uint32_t);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    uint32_t <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>, <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    uint8_t *old_data = <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="comment">/* get right offset. we write the actual header later. */</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a910e4555ff14d9974e6f1dd227d8dd99">z_state_save_subheader</a>(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>, 0, 0);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <a class="code" href="../../d3/d53/struct_node__format.html">Node_format</a> clients[<a class="code" href="../../dc/dc1/_d_h_t_8c.html#a4ebd02f5b13bf2d343bef7c55b88ef93">MAX_SAVED_DHT_NODES</a>];</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordflow">for</span> (num = 0, i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[i].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0) {</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            memcpy(clients[num].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[i].<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            clients[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            ++<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        }</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[i].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0) {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            memcpy(clients[num].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[i].<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            clients[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            ++<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    }</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a> &amp;&amp; i &lt; dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *fr = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>; ++j) {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0) {</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                memcpy(clients[num].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                clients[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                ++<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            <span class="keywordflow">if</span> (fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0) {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                memcpy(clients[num].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                clients[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                ++<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        }</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    }</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a910e4555ff14d9974e6f1dd227d8dd99">z_state_save_subheader</a>(old_data, <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a1d6f2fcb008c989f333ae89e840f94b4">pack_nodes</a>(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d53/struct_node__format.html">Node_format</a>) * num, clients, num), <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a2244b83e3fbf401e240bb5fa9a576e9e">DHT_STATE_TYPE_NODES</a>);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a4ebd02f5b13bf2d343bef7c55b88ef93"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a4ebd02f5b13bf2d343bef7c55b88ef93">MAX_SAVED_DHT_NODES</a></div><div class="ttdeci">#define MAX_SAVED_DHT_NODES</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02292">DHT.c:2292</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a2244b83e3fbf401e240bb5fa9a576e9e"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a2244b83e3fbf401e240bb5fa9a576e9e">DHT_STATE_TYPE_NODES</a></div><div class="ttdeci">#define DHT_STATE_TYPE_NODES</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02290">DHT.c:2290</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00126">DHT.h:126</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a910e4555ff14d9974e6f1dd227d8dd99"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a910e4555ff14d9974e6f1dd227d8dd99">z_state_save_subheader</a></div><div class="ttdeci">static uint8_t * z_state_save_subheader(uint8_t *data, uint32_t len, uint16_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02318">DHT.c:2318</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="tox__test_8c_html_abea371f9030e15a5d2a4c181576833d8"><div class="ttname"><a href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a></div><div class="ttdeci">uint8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/tox__test_8c_source.html#l00246">tox_test.c:246</a></div></div>
<div class="ttc" id="struct_client__data_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Client_data::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00104">DHT.h:104</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="struct_node__format_html"><div class="ttname"><a href="../../d3/d53/struct_node__format.html">Node_format</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00147">DHT.h:147</a></div></div>
<div class="ttc" id="struct_node__format_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Node_format::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00149">DHT.h:149</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8ee1f2d7e543bce350c591a8eaac0cf8"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">DHT::num_friends</a></div><div class="ttdeci">uint16_t num_friends</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT.h:214</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a09839809f361926e324196bfd9450bb4"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a></div><div class="ttdeci">#define DHT_FAKE_FRIEND_NUMBER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00061">DHT.h:61</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a465bef81f6478756e5443025b1f2ddfa"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">IPPTsPng::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00094">DHT.h:94</a></div></div>
<div class="ttc" id="util_8c_html_aebd439a002cb183420a08996f7ffdbef"><div class="ttname"><a href="../../de/df1/util_8c.html#aebd439a002cb183420a08996f7ffdbef">host_to_lendian32</a></div><div class="ttdeci">void host_to_lendian32(uint8_t *dest, uint32_t num)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00096">util.c:96</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a1d6f2fcb008c989f333ae89e840f94b4"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a1d6f2fcb008c989f333ae89e840f94b4">pack_nodes</a></div><div class="ttdeci">int pack_nodes(uint8_t *data, uint16_t length, const Node_format *nodes, uint16_t number)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00207">DHT.c:207</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a49ef2b640a834a77b6e123355a4fea47"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">DHT_Friend::client_list</a></div><div class="ttdeci">Client_data client_list[MAX_FRIEND_CLIENTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT.h:128</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ad50d158518277ca4d19cbe364f3e958c"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a></div><div class="ttdeci">#define MAX_FRIEND_CLIENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00032">DHT.h:32</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a6a842db82e30616af13990781cf13ab3"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6a842db82e30616af13990781cf13ab3">DHT_STATE_COOKIE_GLOBAL</a></div><div class="ttdeci">#define DHT_STATE_COOKIE_GLOBAL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02287">DHT.c:2287</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_cgraph" id="df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_cgraph">
<area shape="rect" id="node2" href="../../de/df1/util_8c.html#aebd439a002cb183420a08996f7ffdbef" title="host_to_lendian32" alt="" coords="353,25,480,51"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#a1d6f2fcb008c989f333ae89e840f94b4" title="pack_nodes" alt="" coords="176,25,268,51"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a910e4555ff14d9974e6f1dd227d8dd99" title="z_state_save_subheader" alt="" coords="139,75,305,102"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_icgraph" id="df/dad/_d_h_t_8h_a7510a9fdbacfffb5987590c4e193c40a_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#af0dfac679b1b57a0036f6511e12fe777" title="messenger_save" alt="" coords="139,56,260,83"/><area shape="rect" id="node11" href="../../d8/dda/messenger__test_8c.html#a86a26950f83bcd6bd68640da6a5c96a4" title="START_TEST" alt="" coords="146,107,253,133"/><area shape="rect" id="node3" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="317,5,424,32"/><area shape="rect" id="node4" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="345,56,396,83"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#a63116d9c9454da73a56463d9093e53e4" title="tox_get_savedata" alt="" coords="308,107,433,133"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="481,81,588,108"/><area shape="rect" id="node7" href="../../d2/d65/n_tox_8c.html#a631b615f9972e1b5609e5773d809f9b4" title="save_data" alt="" coords="493,132,576,159"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="653,107,726,133"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a86825faeca35dae8e6c4ab666d4543d6" title="save_data_file" alt="" coords="636,157,743,184"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="791,132,841,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a55d92a2419bf9384e3cbfe0ec5a8f4d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t DHT_size </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02295">2295</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT_Friend::client_list</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00061">DHT_FAKE_FRIEND_NUMBER</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">MAX_FRIEND_CLIENTS</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT::num_friends</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00186">packed_node_size()</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00094">IPPTsPng::timestamp</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02565">messenger_save()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02540">messenger_size()</a>, and <a class="el" href="../../d8/dda/messenger__test_8c_source.html#l00219">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;{</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    uint32_t numv4 = 0, numv6 = 0, <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        numv4 += (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        numv6 += (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    }</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a> &amp;&amp; <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">num_friends</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *fr = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>; ++j) {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            numv4 += (fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            numv6 += (fr-&gt;<a class="code" href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">client_list</a>[j].<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">timestamp</a> != 0);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    }</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    uint32_t size32 = <span class="keyword">sizeof</span>(uint32_t), sizesubhead = size32 * 2;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">return</span> size32 + sizesubhead + (<a class="code" href="../../dc/dc1/_d_h_t_8c.html#aa980937ac320a4389b726e04da26cb44">packed_node_size</a>(AF_INET) * numv4) + (<a class="code" href="../../dc/dc1/_d_h_t_8c.html#aa980937ac320a4389b726e04da26cb44">packed_node_size</a>(AF_INET6) * numv6);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00126">DHT.h:126</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_aa980937ac320a4389b726e04da26cb44"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#aa980937ac320a4389b726e04da26cb44">packed_node_size</a></div><div class="ttdeci">int packed_node_size(uint8_t ip_family)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00186">DHT.c:186</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8ee1f2d7e543bce350c591a8eaac0cf8"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8ee1f2d7e543bce350c591a8eaac0cf8">DHT::num_friends</a></div><div class="ttdeci">uint16_t num_friends</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00214">DHT.h:214</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a09839809f361926e324196bfd9450bb4"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a></div><div class="ttdeci">#define DHT_FAKE_FRIEND_NUMBER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00061">DHT.h:61</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a465bef81f6478756e5443025b1f2ddfa"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a465bef81f6478756e5443025b1f2ddfa">IPPTsPng::timestamp</a></div><div class="ttdeci">uint64_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00094">DHT.h:94</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html_a49ef2b640a834a77b6e123355a4fea47"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html#a49ef2b640a834a77b6e123355a4fea47">DHT_Friend::client_list</a></div><div class="ttdeci">Client_data client_list[MAX_FRIEND_CLIENTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00128">DHT.h:128</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ad50d158518277ca4d19cbe364f3e958c"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a></div><div class="ttdeci">#define MAX_FRIEND_CLIENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00032">DHT.h:32</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_cgraph" id="df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#aa980937ac320a4389b726e04da26cb44" title="packed_node_size" alt="" coords="135,5,265,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_icgraph" id="df/dad/_d_h_t_8h_a55d92a2419bf9384e3cbfe0ec5a8f4d6_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#af0dfac679b1b57a0036f6511e12fe777" title="messenger_save" alt="" coords="300,5,421,32"/><area shape="rect" id="node11" href="../../d4/d30/_messenger_8h.html#a4ae119dad636f15f1a5d628a13b107d8" title="messenger_size" alt="" coords="135,56,252,83"/><area shape="rect" id="node13" href="../../d8/dda/messenger__test_8c.html#a86a26950f83bcd6bd68640da6a5c96a4" title="START_TEST" alt="" coords="140,107,247,133"/><area shape="rect" id="node3" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="494,56,601,83"/><area shape="rect" id="node4" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="522,107,573,133"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#a63116d9c9454da73a56463d9093e53e4" title="tox_get_savedata" alt="" coords="485,5,610,32"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="673,31,780,57"/><area shape="rect" id="node7" href="../../d2/d65/n_tox_8c.html#a631b615f9972e1b5609e5773d809f9b4" title="save_data" alt="" coords="685,132,768,159"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="845,107,918,133"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a86825faeca35dae8e6c4ab666d4543d6" title="save_data_file" alt="" coords="828,157,935,184"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="983,132,1033,159"/><area shape="rect" id="node12" href="../../da/d8f/tox_8h.html#ac2b90c8597ff7afa2e9532e81b65d412" title="tox_get_savedata_size" alt="" coords="469,157,625,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5be9dfb66fbf1fa7c267b016f3357534"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void do_DHT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02242">2242</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02382">DHT_connect_after_load()</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00886">do_Assoc()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01389">do_Close()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01377">do_DHT_friends()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02102">do_hardening()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01827">do_NAT()</a>, <a class="el" href="../../d9/d54/ping_8c_source.html#l00299">do_to_ping()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00229">DHT::last_run</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00217">DHT::loaded_num_nodes</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00223">DHT::ping</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00049">unix_time()</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02280">do_messenger()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00026">do_onion()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00287">do_onions()</a>, and <a class="el" href="../../d1/d36/tox-bootstrapd_8c_source.html#l00519">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;{</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a73e8197b772061572cb931a378ade3e4">last_run</a> == <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>()) {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="comment">// Load friends/clients if first call to do_DHT</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aef4ce67d5df5f093247c73b3a024b73e">loaded_num_nodes</a>) {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ad5df2ff5066cf93898e531d320ddd675">DHT_connect_after_load</a>(dht);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ae05715389aba7cec9083bdf9efad7a78">do_Close</a>(dht);</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ad1bcb472a3fd0ff8ab579551c4528b62">do_DHT_friends</a>(dht);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9243f57fde4a9312f11575eb4e7b1275">do_NAT</a>(dht);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <a class="code" href="../../d9/d54/ping_8c.html#af1ade820101b833a4615cb9fb58bebad">do_to_ping</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">ping</a>);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9480aac51c9c74c667267ce89a76604a">do_hardening</a>(dht);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;assoc)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <a class="code" href="../../d4/d9d/assoc_8c.html#a36aff33785fb0db2565cf4cb5b080327">do_Assoc</a>(dht-&gt;assoc, dht);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a73e8197b772061572cb931a378ade3e4">last_run</a> = <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>();</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;}</div>
<div class="ttc" id="ping_8c_html_af1ade820101b833a4615cb9fb58bebad"><div class="ttname"><a href="../../d9/d54/ping_8c.html#af1ade820101b833a4615cb9fb58bebad">do_to_ping</a></div><div class="ttdeci">void do_to_ping(PING *ping)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d54/ping_8c_source.html#l00299">ping.c:299</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ad1bcb472a3fd0ff8ab579551c4528b62"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ad1bcb472a3fd0ff8ab579551c4528b62">do_DHT_friends</a></div><div class="ttdeci">static void do_DHT_friends(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01377">DHT.c:1377</a></div></div>
<div class="ttc" id="util_8c_html_ac958d9f8847cb8039444bfa3d304233a"><div class="ttname"><a href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a></div><div class="ttdeci">uint64_t unix_time()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00049">util.c:49</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ae05715389aba7cec9083bdf9efad7a78"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ae05715389aba7cec9083bdf9efad7a78">do_Close</a></div><div class="ttdeci">static void do_Close(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01389">DHT.c:1389</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a9243f57fde4a9312f11575eb4e7b1275"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a9243f57fde4a9312f11575eb4e7b1275">do_NAT</a></div><div class="ttdeci">static void do_NAT(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01827">DHT.c:1827</a></div></div>
<div class="ttc" id="assoc_8c_html_a36aff33785fb0db2565cf4cb5b080327"><div class="ttname"><a href="../../d4/d9d/assoc_8c.html#a36aff33785fb0db2565cf4cb5b080327">do_Assoc</a></div><div class="ttdeci">void do_Assoc(Assoc *assoc, DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9d/assoc_8c_source.html#l00886">assoc.c:886</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a73e8197b772061572cb931a378ade3e4"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a73e8197b772061572cb931a378ade3e4">DHT::last_run</a></div><div class="ttdeci">uint64_t last_run</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00229">DHT.h:229</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ad5df2ff5066cf93898e531d320ddd675"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ad5df2ff5066cf93898e531d320ddd675">DHT_connect_after_load</a></div><div class="ttdeci">int DHT_connect_after_load(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02382">DHT.c:2382</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aef4ce67d5df5f093247c73b3a024b73e"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aef4ce67d5df5f093247c73b3a024b73e">DHT::loaded_num_nodes</a></div><div class="ttdeci">uint32_t loaded_num_nodes</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00217">DHT.h:217</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae3f68e3d55e46726b05717fc88198321"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">DHT::ping</a></div><div class="ttdeci">struct PING * ping</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00223">DHT.h:223</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a9480aac51c9c74c667267ce89a76604a"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a9480aac51c9c74c667267ce89a76604a">do_hardening</a></div><div class="ttdeci">void do_hardening(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02102">DHT.c:2102</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_cgraph" id="df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#ad5df2ff5066cf93898e531d320ddd675" title="DHT_connect_after_load" alt="" coords="301,945,468,972"/><area shape="rect" id="node10" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="1234,333,1313,360"/><area shape="rect" id="node16" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="767,1296,891,1322"/><area shape="rect" id="node18" href="../../d4/d9d/assoc_8c.html#a36aff33785fb0db2565cf4cb5b080327" title="do_Assoc" alt="" coords="345,220,425,246"/><area shape="rect" id="node23" href="../../dc/dc1/_d_h_t_8c.html#ae05715389aba7cec9083bdf9efad7a78" title="do_Close" alt="" coords="346,169,423,196"/><area shape="rect" id="node27" href="../../dc/dc1/_d_h_t_8c.html#ad1bcb472a3fd0ff8ab579551c4528b62" title="do_DHT_friends" alt="" coords="124,341,241,368"/><area shape="rect" id="node28" href="../../dc/dc1/_d_h_t_8c.html#a9480aac51c9c74c667267ce89a76604a" title="do_hardening" alt="" coords="133,1097,232,1124"/><area shape="rect" id="node39" href="../../dc/dc1/_d_h_t_8c.html#a9243f57fde4a9312f11575eb4e7b1275" title="do_NAT" alt="" coords="147,641,218,668"/><area shape="rect" id="node50" href="../../d9/d54/ping_8c.html#af1ade820101b833a4615cb9fb58bebad" title="do_to_ping" alt="" coords="570,388,655,414"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#ab6d732074bab2377a7884c41c219cf96" title="DHT_bootstrap" alt="" coords="557,692,668,718"/><area shape="rect" id="node12" href="../../dc/dc1/_d_h_t_8c.html#a90cd93b83fdec619c4924fd20c4fc005" title="DHT_non_lan_connected" alt="" coords="528,1296,697,1322"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="792,282,867,309"/><area shape="rect" id="node5" href="../../dc/dc1/_d_h_t_8c.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="961,384,1143,410"/><area shape="rect" id="node6" href="../../dc/d85/crypto__core_8c.html#a81efc0a4a6e0efe372651e26e342a6e5" title="encrypt_data_symmetric" alt="" coords="1191,434,1356,461"/><area shape="rect" id="node7" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="1017,536,1087,562"/><area shape="rect" id="node8" href="../../dc/d85/crypto__core_8c.html#a8b1033efb47c625779d11be7d8eb9e24" title="new_nonce" alt="" coords="1008,485,1096,512"/><area shape="rect" id="node9" href="../../df/d02/ping__array_8c.html#a67470d42ee0e3e61bedfa598f3039266" title="ping_array_add" alt="" coords="997,333,1107,360"/><area shape="rect" id="node11" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="1007,738,1097,765"/><area shape="rect" id="node13" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="1011,840,1093,866"/><area shape="rect" id="node14" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="1019,1430,1085,1457"/><area shape="rect" id="node15" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="1238,1430,1309,1457"/><area shape="rect" id="node17" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="971,1296,1133,1322"/><area shape="rect" id="node19" href="../../dc/dc1/_d_h_t_8c.html#a769ef744f969e1b4c55547cb74abee59" title="DHT_getnodes" alt="" coords="557,220,668,246"/><area shape="rect" id="node20" href="../../d6/dc0/toxav__many__test_8c.html#a8799beff27c0e5459ef50f9ca1efe92c" title="for" alt="" coords="593,100,632,126"/><area shape="rect" id="node22" href="../../d6/d6e/network_8c.html#af71f49c78ce7b76ccf08785c6ec08706" title="ip_ntoa" alt="" coords="581,49,645,76"/><area shape="rect" id="node21" href="../../d6/dc0/toxav__many__test_8c.html#a4bd4b2294bdedc4af8c708ecc5c58516" title="ck_assert_msg" alt="" coords="774,80,885,106"/><area shape="rect" id="node24" href="../../dc/dc1/_d_h_t_8c.html#a1d3aa20a7622e95d168e3220f61f6227" title="do_ping_and_sendnode\l_requests" alt="" coords="533,271,692,312"/><area shape="rect" id="node25" href="../../d9/d54/ping_8c.html#a1b3882fdfddc79be369ff230cd3e7a6a" title="send_ping_request" alt="" coords="764,333,895,360"/><area shape="rect" id="node26" href="../../de/df1/util_8c.html#aa30049b8c1d82c280d6d872feea3353b" title="id_copy" alt="" coords="1019,789,1085,816"/><area shape="rect" id="node29" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e" title="ipport_isset" alt="" coords="1007,1540,1097,1566"/><area shape="rect" id="node31" href="../../dc/dc1/_d_h_t_8c.html#af89838d6c1c8e0ec82dfadbe2953e06d" title="random_node" alt="" coords="335,1300,435,1326"/><area shape="rect" id="node35" href="../../dc/dc1/_d_h_t_8c.html#a3322fa3865c8dbbcd21b1a9a4955c193" title="send_hardening_getnode_req" alt="" coords="289,1046,480,1073"/><area shape="rect" id="node30" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="1240,1017,1307,1044"/><area shape="rect" id="node32" href="../../dc/dc1/_d_h_t_8c.html#a8abfc9cea3784b0cae354670bd4643cd" title="get_close_nodes" alt="" coords="553,1482,673,1509"/><area shape="rect" id="node33" href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2" title="Assoc_get_close_entries" alt="" coords="745,1514,913,1541"/><area shape="rect" id="node34" href="../../dc/dc1/_d_h_t_8c.html#ab7f89880bce923390748449ef6f60004" title="get_somewhat_close\l_nodes" alt="" coords="757,1448,902,1490"/><area shape="rect" id="node36" href="../../dc/dc1/_d_h_t_8c.html#a6461cdeec360ffa10fa03beb6af29aaf" title="send_hardening_req" alt="" coords="543,945,682,972"/><area shape="rect" id="node37" href="../../dc/d85/crypto__core_8c.html#a73129647dfd9e436ae6abc908daa4c21" title="create_request" alt="" coords="775,890,883,917"/><area shape="rect" id="node38" href="../../dc/d85/crypto__core_8c.html#a014149333522d211490304255e139ec3" title="encrypt_data" alt="" coords="1003,890,1101,917"/><area shape="rect" id="node40" href="../../dc/dc1/_d_h_t_8c.html#a1b3c1814260eace443e6feb13227cc82" title="friend_iplist" alt="" coords="785,738,873,765"/><area shape="rect" id="node41" href="../../dc/dc1/_d_h_t_8c.html#ae24a26ad9533b87cfbcb0093430bf136" title="NAT_commonip" alt="" coords="327,489,443,516"/><area shape="rect" id="node44" href="../../dc/dc1/_d_h_t_8c.html#a987dbba116d9982c336ea818f05e8c7c" title="NAT_getports" alt="" coords="333,540,436,566"/><area shape="rect" id="node45" href="../../dc/dc1/_d_h_t_8c.html#a7efc873280e2d502bf49489d3ebacc9c" title="punch_holes" alt="" coords="337,590,432,617"/><area shape="rect" id="node47" href="../../dc/dc1/_d_h_t_8c.html#a25f7b3704b34bb8745a0a60939e1f49c" title="send_NATping" alt="" coords="331,844,439,870"/><area shape="rect" id="node42" href="../../d6/d6e/network_8c.html#af982256c6d8486349bdc13a920884ef6" title="ip_equal" alt="" coords="577,489,648,516"/><area shape="rect" id="node43" href="../../d6/d6e/network_8c.html#a2bfd1efbce5b035b10c879a7e85c08df" title="ip_reset" alt="" coords="795,586,863,613"/><area shape="rect" id="node46" href="../../d6/d6e/network_8c.html#a66563da83f68de4f5e9d7c5f2f72c8f3" title="ip_copy" alt="" coords="579,590,646,617"/><area shape="rect" id="node48" href="../../dc/dc1/_d_h_t_8c.html#aee23d763e291eefd141227cd9e3684ab" title="route_tofriend" alt="" coords="562,844,663,870"/><area shape="rect" id="node49" href="../../dc/dc1/_d_h_t_8c.html#ad1a9a37b7cda1411149867eb77070bd1" title="routeone_tofriend" alt="" coords="768,992,891,1018"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_icgraph" id="df/dad/_d_h_t_8h_a5be9dfb66fbf1fa7c267b016f3357534_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="124,81,231,108"/><area shape="rect" id="node10" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="140,132,215,159"/><area shape="rect" id="node12" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="137,183,218,209"/><area shape="rect" id="node14" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="152,233,203,260"/><area shape="rect" id="node3" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="307,31,357,57"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="291,81,373,108"/><area shape="rect" id="node5" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="433,5,540,32"/><area shape="rect" id="node6" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="461,56,513,83"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="461,107,512,133"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="450,157,523,184"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="588,157,639,184"/><area shape="rect" id="node11" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="279,132,385,159"/><area shape="rect" id="node13" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="279,183,385,209"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8abfc9cea3784b0cae354670bd4643cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_close_nodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *&#160;</td>
          <td class="paramname"><em>nodes_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sa_family_t&#160;</td>
          <td class="paramname"><em>sa_family</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>is_LAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>want_good</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00570">570</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00602">Assoc_get_close_entries()</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00058">Assoc_close_entries::count</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00057">Assoc_close_entries::count_good</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00052">Assoc_close_entries::flags</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00549">get_somewhat_close_nodes()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00066">id_copy()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00149">Node_format::ip_port</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00789">ipport_isset()</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00046">LANOk</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00087">LOGGER_DEBUG</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00038">MAX_SENT_NODES</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00044">ProtoIPv4</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00045">ProtoIPv6</a>, <a class="el" href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile::public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00104">Client_data::public_key</a>, <a class="el" href="../../da/d7d/assoc_8h_source.html#l00059">Assoc_close_entries::result</a>, and <a class="el" href="../../da/d7d/assoc_8h_source.html#l00051">Assoc_close_entries::wanted_id</a>.</p>

<p>Referenced by <a class="el" href="../../df/d75/onion__announce_8c_source.html#l00289">handle_announce_request()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l01204">populate_path_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02042">random_node()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00969">sendnodes_ipv6()</a>.</p>
<div class="fragment"><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    memset(nodes_list, 0, <a class="code" href="../../df/dad/_d_h_t_8h.html#a57f4cf16e79a384d7d59a3cc585ea5a3">MAX_SENT_NODES</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d53/struct_node__format.html">Node_format</a>));</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (!dht-&gt;assoc)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ab7f89880bce923390748449ef6f60004">get_somewhat_close_nodes</a>(dht, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, nodes_list, sa_family, is_LAN, want_good);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">//TODO: assoc, sa_family 0 (don&#39;t care if ipv4 or ipv6) support.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *result[<a class="code" href="../../df/dad/_d_h_t_8h.html#a57f4cf16e79a384d7d59a3cc585ea5a3">MAX_SENT_NODES</a>];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="../../d1/d41/struct_assoc__close__entries.html">Assoc_close_entries</a> request;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    memset(&amp;request, 0, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a20302e2c99a60d3f612dba57e3f6333b">count</a> = <a class="code" href="../../df/dad/_d_h_t_8h.html#a57f4cf16e79a384d7d59a3cc585ea5a3">MAX_SENT_NODES</a>;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a086e0ce002c9491e4b99956740bb53d4">count_good</a> = <a class="code" href="../../df/dad/_d_h_t_8h.html#a57f4cf16e79a384d7d59a3cc585ea5a3">MAX_SENT_NODES</a> - 2; <span class="comment">/* allow 2 &#39;indirect&#39; nodes */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">result</a> = result;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a037b65164e78b02017bd4751843037b4">wanted_id</a> = <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#aa2585d779da0ab21273a8d92de9a0ebe">flags</a> = (is_LAN ? <a class="code" href="../../da/d7d/assoc_8h.html#a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6">LANOk</a> : 0) + (sa_family == AF_INET ? <a class="code" href="../../da/d7d/assoc_8h.html#a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c">ProtoIPv4</a> : <a class="code" href="../../da/d7d/assoc_8h.html#a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca">ProtoIPv6</a>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    uint8_t num_found = <a class="code" href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2">Assoc_get_close_entries</a>(dht-&gt;assoc, &amp;request);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (!num_found) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="../../d1/d8c/logger_8h.html#a9885ca09ce5f94d936c91a5b0856a024">LOGGER_DEBUG</a>(<span class="stringliteral">&quot;get_close_nodes(): Assoc_get_close_entries() returned zero nodes&quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/dc1/_d_h_t_8c.html#ab7f89880bce923390748449ef6f60004">get_somewhat_close_nodes</a>(dht, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, nodes_list, sa_family, is_LAN, want_good);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="../../d1/d8c/logger_8h.html#a9885ca09ce5f94d936c91a5b0856a024">LOGGER_DEBUG</a>(<span class="stringliteral">&quot;get_close_nodes(): Assoc_get_close_entries() returned %i &#39;direct&#39; and %i &#39;indirect&#39; nodes&quot;</span>,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                 request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a086e0ce002c9491e4b99956740bb53d4">count_good</a>, num_found - request.<a class="code" href="../../d1/d41/struct_assoc__close__entries.html#a086e0ce002c9491e4b99956740bb53d4">count_good</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    uint8_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, num_returned = 0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; num_found; i++) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client = result[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span> (client) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="../../de/df1/util_8c.html#aa30049b8c1d82c280d6d872feea3353b">id_copy</a>(nodes_list[num_returned].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordflow">if</span> (sa_family == AF_INET)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e">ipport_isset</a>(&amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>)) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    nodes_list[num_returned].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    num_returned++;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">if</span> (sa_family == AF_INET6)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e">ipport_isset</a>(&amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>)) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    nodes_list[num_returned].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a> = client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    num_returned++;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">return</span> num_returned;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div>
<div class="ttc" id="struct_assoc__close__entries_html_a40d6704f891338dadfa89f46b696be4c"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a40d6704f891338dadfa89f46b696be4c">Assoc_close_entries::result</a></div><div class="ttdeci">Client_data ** result</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00059">assoc.h:59</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="util_8c_html_aa30049b8c1d82c280d6d872feea3353b"><div class="ttname"><a href="../../de/df1/util_8c.html#aa30049b8c1d82c280d6d872feea3353b">id_copy</a></div><div class="ttdeci">uint32_t id_copy(uint8_t *dest, const uint8_t *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00066">util.c:66</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="assoc_8h_html_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c"><div class="ttname"><a href="../../da/d7d/assoc_8h.html#a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c">ProtoIPv4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00044">assoc.h:44</a></div></div>
<div class="ttc" id="struct_client__data_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Client_data::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00104">DHT.h:104</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a57f4cf16e79a384d7d59a3cc585ea5a3"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a57f4cf16e79a384d7d59a3cc585ea5a3">MAX_SENT_NODES</a></div><div class="ttdeci">#define MAX_SENT_NODES</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00038">DHT.h:38</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ab7f89880bce923390748449ef6f60004"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ab7f89880bce923390748449ef6f60004">get_somewhat_close_nodes</a></div><div class="ttdeci">static int get_somewhat_close_nodes(const DHT *dht, const uint8_t *public_key, Node_format *nodes_list, sa_family_t sa_family, uint8_t is_LAN, uint8_t want_good)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00549">DHT.c:549</a></div></div>
<div class="ttc" id="assoc_8h_html_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca"><div class="ttname"><a href="../../da/d7d/assoc_8h.html#a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca">ProtoIPv6</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00045">assoc.h:45</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_a037b65164e78b02017bd4751843037b4"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a037b65164e78b02017bd4751843037b4">Assoc_close_entries::wanted_id</a></div><div class="ttdeci">uint8_t * wanted_id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00051">assoc.h:51</a></div></div>
<div class="ttc" id="struct_node__format_html"><div class="ttname"><a href="../../d3/d53/struct_node__format.html">Node_format</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00147">DHT.h:147</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_a086e0ce002c9491e4b99956740bb53d4"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a086e0ce002c9491e4b99956740bb53d4">Assoc_close_entries::count_good</a></div><div class="ttdeci">uint8_t count_good</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00057">assoc.h:57</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html">Assoc_close_entries</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00049">assoc.h:49</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_aa2585d779da0ab21273a8d92de9a0ebe"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#aa2585d779da0ab21273a8d92de9a0ebe">Assoc_close_entries::flags</a></div><div class="ttdeci">uint8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00052">assoc.h:52</a></div></div>
<div class="ttc" id="struct_node__format_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Node_format::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00149">DHT.h:149</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="network_8c_html_a8436367218afb29bcf1b5fecd071648e"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e">ipport_isset</a></div><div class="ttdeci">int ipport_isset(const IP_Port *ipport)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00789">network.c:789</a></div></div>
<div class="ttc" id="assoc_8h_html_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6"><div class="ttname"><a href="../../da/d7d/assoc_8h.html#a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6">LANOk</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00046">assoc.h:46</a></div></div>
<div class="ttc" id="logger_8h_html_a9885ca09ce5f94d936c91a5b0856a024"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a9885ca09ce5f94d936c91a5b0856a024">LOGGER_DEBUG</a></div><div class="ttdeci">#define LOGGER_DEBUG(format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00087">logger.h:87</a></div></div>
<div class="ttc" id="assoc_8c_html_a256dcbfb2174603496ffa30efef90ad2"><div class="ttname"><a href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2">Assoc_get_close_entries</a></div><div class="ttdeci">uint8_t Assoc_get_close_entries(Assoc *assoc, Assoc_close_entries *state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9d/assoc_8c_source.html#l00602">assoc.c:602</a></div></div>
<div class="ttc" id="struct_assoc__close__entries_html_a20302e2c99a60d3f612dba57e3f6333b"><div class="ttname"><a href="../../d1/d41/struct_assoc__close__entries.html#a20302e2c99a60d3f612dba57e3f6333b">Assoc_close_entries::count</a></div><div class="ttdeci">uint8_t count</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/assoc_8h_source.html#l00058">assoc.h:58</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_cgraph" id="df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_cgraph">
<area shape="rect" id="node2" href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2" title="Assoc_get_close_entries" alt="" coords="173,372,341,399"/><area shape="rect" id="node16" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e" title="ipport_isset" alt="" coords="422,637,511,664"/><area shape="rect" id="node22" href="../../dc/dc1/_d_h_t_8c.html#ab7f89880bce923390748449ef6f60004" title="get_somewhat_close\l_nodes" alt="" coords="185,222,330,263"/><area shape="rect" id="node26" href="../../de/df1/util_8c.html#aa30049b8c1d82c280d6d872feea3353b" title="id_copy" alt="" coords="224,473,291,500"/><area shape="rect" id="node3" href="../../d4/d9d/assoc_8c.html#ad78d05a8a1915614699da4704cd5641b" title="assoc_id_closest" alt="" coords="405,56,528,83"/><area shape="rect" id="node5" href="../../d4/d9d/assoc_8c.html#aa8781ddcd6a9240db73c39a2ff844d12" title="client_id_self_update" alt="" coords="395,423,539,449"/><area shape="rect" id="node11" href="../../d4/d9d/assoc_8c.html#a9419b231b388fff46f176830c4b9a52f" title="dist_index_bubble" alt="" coords="403,499,530,525"/><area shape="rect" id="node13" href="../../d4/d9d/assoc_8c.html#a07e9e64cd1b39d0dc9259d998e52f1ab" title="dist_index_entry" alt="" coords="788,561,905,588"/><area shape="rect" id="node14" href="../../d4/d9d/assoc_8c.html#afe8472c27f16e873da0fa3a6995c1197" title="dist_index_comp" alt="" coords="407,220,527,247"/><area shape="rect" id="node15" href="../../d4/d9d/assoc_8c.html#af9b9ca1f09c12f5ba91e06bf254e09f6" title="id_distance" alt="" coords="423,321,511,348"/><area shape="rect" id="node18" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="625,208,707,235"/><area shape="rect" id="node20" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="633,283,699,309"/><area shape="rect" id="node4" href="../../dc/dc1/_d_h_t_8c.html#a903a5bc580826fe447adb841b7782333" title="id_closest" alt="" coords="625,5,707,32"/><area shape="rect" id="node6" href="../../d4/d9d/assoc_8c.html#ace6056317cff40310ec4041c9675e093" title="candidates_id_bucket" alt="" coords="592,485,740,512"/><area shape="rect" id="node8" href="../../d4/d9d/assoc_8c.html#a2237a67d354721e3155bcb4701e386ac" title="hash_collide" alt="" coords="619,435,713,461"/><area shape="rect" id="node9" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="811,157,882,184"/><area shape="rect" id="node10" href="../../d4/d9d/assoc_8c.html#a89ad0cf0f7d7c45e00c8bbdd66b56e95" title="id_hash" alt="" coords="633,384,699,411"/><area shape="rect" id="node7" href="../../d4/d9d/assoc_8c.html#a02a00b2c4be43884c00d659524ce8081" title="id_bucket" alt="" coords="807,485,886,512"/><area shape="rect" id="node12" href="../../d4/d9d/assoc_8c.html#aebc74fa92cb369834babcadf8b73483a" title="dist_index_id" alt="" coords="617,536,715,563"/><area shape="rect" id="node17" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="633,637,699,664"/><area shape="rect" id="node19" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="807,208,886,235"/><area shape="rect" id="node21" href="../../d1/de5/_l_a_n__discovery_8c.html#a56fb8ae3cd774c1b1d5670b9c4fb8959" title="Local_ip" alt="" coords="811,283,882,309"/><area shape="rect" id="node23" href="../../dc/dc1/_d_h_t_8c.html#a40b090e4bc0b1280a8689b7931f320c6" title="get_close_nodes_inner" alt="" coords="389,157,544,184"/><area shape="rect" id="node24" href="../../dc/dc1/_d_h_t_8c.html#ac2887d26ab67ac2ca1347b0ed8dadbf5" title="client_in_nodelist" alt="" coords="605,157,727,184"/><area shape="rect" id="node25" href="../../dc/dc1/_d_h_t_8c.html#a99cbbcdc9772e5c2b1ff8416074e88c0" title="hardening_correct" alt="" coords="603,56,729,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_icgraph" id="df/dad/_d_h_t_8h_a8abfc9cea3784b0cae354670bd4643cd_icgraph">
<area shape="rect" id="node2" href="../../df/d75/onion__announce_8c.html#a5cc40944c42a4e0d1d3d702cf93ac8ad" title="handle_announce_request" alt="" coords="173,212,347,239"/><area shape="rect" id="node17" href="../../db/d79/onion__client_8c.html#a18daedee61cc5670d52904fc89e4b32b" title="populate_path_nodes" alt="" coords="187,351,333,377"/><area shape="rect" id="node26" href="../../dc/dc1/_d_h_t_8c.html#af89838d6c1c8e0ec82dfadbe2953e06d" title="random_node" alt="" coords="210,288,310,315"/><area shape="rect" id="node30" href="../../dc/dc1/_d_h_t_8c.html#acce043cdc5108edffc35e6e879197d20" title="sendnodes_ipv6" alt="" coords="202,160,318,187"/><area shape="rect" id="node3" href="../../d7/dfd/onion__announce_8h.html#a1807a1d99b93e29c2a27648afe3e6c2c" title="new_onion_announce" alt="" coords="563,208,709,235"/><area shape="rect" id="node4" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="923,157,1029,184"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="771,208,861,235"/><area shape="rect" id="node7" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="791,259,841,285"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="757,56,875,83"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="923,233,1029,260"/><area shape="rect" id="node9" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="951,107,1001,133"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="941,56,1011,83"/><area shape="rect" id="node11" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1077,56,1184,83"/><area shape="rect" id="node12" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1099,5,1163,32"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1091,157,1170,184"/><area shape="rect" id="node16" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1105,107,1156,133"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1232,157,1283,184"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1232,208,1283,235"/><area shape="rect" id="node18" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="580,360,692,387"/><area shape="rect" id="node19" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="775,360,857,387"/><area shape="rect" id="node20" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="763,411,869,437"/><area shape="rect" id="node21" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="951,411,1001,437"/><area shape="rect" id="node22" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="935,309,1017,336"/><area shape="rect" id="node23" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1077,360,1184,387"/><area shape="rect" id="node24" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1105,309,1157,336"/><area shape="rect" id="node25" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1094,259,1167,285"/><area shape="rect" id="node27" href="../../dc/dc1/_d_h_t_8c.html#a9480aac51c9c74c667267ce89a76604a" title="do_hardening" alt="" coords="405,303,504,329"/><area shape="rect" id="node28" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="601,309,671,336"/><area shape="rect" id="node29" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="779,309,853,336"/><area shape="rect" id="node31" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383" title="handle_getnodes" alt="" coords="395,160,515,187"/><area shape="rect" id="node32" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="595,132,677,159"/><area shape="rect" id="node33" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="759,5,873,32"/><area shape="rect" id="node34" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="923,5,1029,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6cd4aa89d7bfcf6805c5ce6b273d9e9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_shared_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d07/struct_shared___keys.html">Shared_Keys</a> *&#160;</td>
          <td class="paramname"><em>shared_keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>shared_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>secret_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00100">100</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00079">encrypt_precompute()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00054">is_timeout()</a>, <a class="el" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">Shared_Keys::keys</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00179">KEYS_TIMEOUT</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00178">MAX_KEYS_PER_SLOT</a>, <a class="el" href="../../d9/d35/tox__test_8c_source.html#l00246">num</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00182">Shared_Keys::public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00183">Shared_Keys::shared_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00185">Shared_Keys::stored</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00186">Shared_Keys::time_last_requested</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00184">Shared_Keys::times_requested</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00049">unix_time()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00146">DHT_get_shared_key_recv()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00154">DHT_get_shared_key_sent()</a>, <a class="el" href="../../df/d75/onion__announce_8c_source.html#l00289">handle_announce_request()</a>, <a class="el" href="../../d4/d18/onion_8c_source.html#l00370">handle_send_1()</a>, <a class="el" href="../../d4/d18/onion_8c_source.html#l00420">handle_send_2()</a>, and <a class="el" href="../../d4/d18/onion_8c_source.html#l00309">handle_send_initial()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a> = ~0, curr = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#ae5450da86fcf09134330aeef7cd8c35f">MAX_KEYS_PER_SLOT</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordtype">int</span> index = <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>[30] * MAX_KEYS_PER_SLOT + <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">if</span> (shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#a252513c1d10b32b19859efae45136a75">stored</a>) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">if</span> (memcmp(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, crypto_box_PUBLICKEYBYTES) == 0) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                memcpy(shared_key, shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#a81ead9fac55a0cedc30a96253a2c5119">shared_key</a>, crypto_box_BEFORENMBYTES);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                ++shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#ae433d486c059f93505368567603c2748">times_requested</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#a682dfdf8b648a40e36dd5865f16da424">time_last_requested</a> = <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span> (num != 0) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#a682dfdf8b648a40e36dd5865f16da424">time_last_requested</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a1b0aff5d0e177e2fe1f826e225223867">KEYS_TIMEOUT</a>)) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    num = 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    curr = index;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num &gt; shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#ae433d486c059f93505368567603c2748">times_requested</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    num = shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[index].<a class="code" href="../../d6/d07/struct_shared___keys.html#ae433d486c059f93505368567603c2748">times_requested</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    curr = index;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordflow">if</span> (num != 0) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                num = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                curr = index;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d">encrypt_precompute</a>(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, secret_key, shared_key);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (num != (uint32_t)~0) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[curr].<a class="code" href="../../d6/d07/struct_shared___keys.html#a252513c1d10b32b19859efae45136a75">stored</a> = 1;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[curr].<a class="code" href="../../d6/d07/struct_shared___keys.html#ae433d486c059f93505368567603c2748">times_requested</a> = 1;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        memcpy(shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[curr].<a class="code" href="../../d6/d07/struct_shared___keys.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        memcpy(shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[curr].<a class="code" href="../../d6/d07/struct_shared___keys.html#a81ead9fac55a0cedc30a96253a2c5119">shared_key</a>, shared_key, crypto_box_BEFORENMBYTES);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        shared_keys-&gt;<a class="code" href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">keys</a>[curr].<a class="code" href="../../d6/d07/struct_shared___keys.html#a682dfdf8b648a40e36dd5865f16da424">time_last_requested</a> = <a class="code" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="ttc" id="util_8c_html_ac958d9f8847cb8039444bfa3d304233a"><div class="ttname"><a href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a">unix_time</a></div><div class="ttdeci">uint64_t unix_time()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00049">util.c:49</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a0d8eaef49981c5dc3ada078866b42f6d"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d">encrypt_precompute</a></div><div class="ttdeci">void encrypt_precompute(const uint8_t *public_key, const uint8_t *secret_key, uint8_t *enc_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00079">crypto_core.c:79</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ae5450da86fcf09134330aeef7cd8c35f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ae5450da86fcf09134330aeef7cd8c35f">MAX_KEYS_PER_SLOT</a></div><div class="ttdeci">#define MAX_KEYS_PER_SLOT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00178">DHT.h:178</a></div></div>
<div class="ttc" id="util_8c_html_ab643c84141e04b54ba650c50165ba288"><div class="ttname"><a href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a></div><div class="ttdeci">int is_timeout(uint64_t timestamp, uint64_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00054">util.c:54</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="struct_shared___keys_html_a682dfdf8b648a40e36dd5865f16da424"><div class="ttname"><a href="../../d6/d07/struct_shared___keys.html#a682dfdf8b648a40e36dd5865f16da424">Shared_Keys::time_last_requested</a></div><div class="ttdeci">uint64_t time_last_requested</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00186">DHT.h:186</a></div></div>
<div class="ttc" id="tox__test_8c_html_abea371f9030e15a5d2a4c181576833d8"><div class="ttname"><a href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a></div><div class="ttdeci">uint8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/tox__test_8c_source.html#l00246">tox_test.c:246</a></div></div>
<div class="ttc" id="struct_shared___keys_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d6/d07/struct_shared___keys.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Shared_Keys::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00182">DHT.h:182</a></div></div>
<div class="ttc" id="struct_shared___keys_html_a15077d043938aa92f7ee5278d0036f7f"><div class="ttname"><a href="../../d6/d07/struct_shared___keys.html#a15077d043938aa92f7ee5278d0036f7f">Shared_Keys::keys</a></div><div class="ttdeci">struct Shared_Keys::@1 keys[256 *MAX_KEYS_PER_SLOT]</div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_shared___keys_html_a81ead9fac55a0cedc30a96253a2c5119"><div class="ttname"><a href="../../d6/d07/struct_shared___keys.html#a81ead9fac55a0cedc30a96253a2c5119">Shared_Keys::shared_key</a></div><div class="ttdeci">uint8_t shared_key[crypto_box_BEFORENMBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00183">DHT.h:183</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a1b0aff5d0e177e2fe1f826e225223867"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a1b0aff5d0e177e2fe1f826e225223867">KEYS_TIMEOUT</a></div><div class="ttdeci">#define KEYS_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00179">DHT.h:179</a></div></div>
<div class="ttc" id="struct_shared___keys_html_ae433d486c059f93505368567603c2748"><div class="ttname"><a href="../../d6/d07/struct_shared___keys.html#ae433d486c059f93505368567603c2748">Shared_Keys::times_requested</a></div><div class="ttdeci">uint32_t times_requested</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00184">DHT.h:184</a></div></div>
<div class="ttc" id="struct_shared___keys_html_a252513c1d10b32b19859efae45136a75"><div class="ttname"><a href="../../d6/d07/struct_shared___keys.html#a252513c1d10b32b19859efae45136a75">Shared_Keys::stored</a></div><div class="ttdeci">uint8_t stored</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00185">DHT.h:185</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_cgraph" id="df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_cgraph">
<area shape="rect" id="node2" href="../../dc/d85/crypto__core_8c.html#a0d8eaef49981c5dc3ada078866b42f6d" title="encrypt_precompute" alt="" coords="168,5,308,32"/><area shape="rect" id="node3" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="197,56,279,83"/><area shape="rect" id="node4" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="356,81,435,108"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_icgraph" id="df/dad/_d_h_t_8h_a6cd4aa89d7bfcf6805c5ce6b273d9e9e_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#a9e92f7714ab1f2b37b54e8479717cbc7" title="DHT_get_shared_key_recv" alt="" coords="168,781,349,808"/><area shape="rect" id="node13" href="../../df/dad/_d_h_t_8h.html#a087cceeacc5a14415b651c2980a24d34" title="DHT_get_shared_key_sent" alt="" coords="168,512,349,539"/><area shape="rect" id="node45" href="../../df/d75/onion__announce_8c.html#a5cc40944c42a4e0d1d3d702cf93ac8ad" title="handle_announce_request" alt="" coords="172,832,345,859"/><area shape="rect" id="node47" href="../../d4/d18/onion_8c.html#af8b808b43786292e39b10d6e05ba1cb7" title="handle_send_1" alt="" coords="204,933,313,960"/><area shape="rect" id="node49" href="../../d4/d18/onion_8c.html#a60a847c1f3f33f8e2efdc13ede5f7ecc" title="handle_send_2" alt="" coords="204,984,313,1011"/><area shape="rect" id="node50" href="../../d4/d18/onion_8c.html#ad1a4dfd05094ff479cda552ed94059f7" title="handle_send_initial" alt="" coords="193,883,325,909"/><area shape="rect" id="node3" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383" title="handle_getnodes" alt="" coords="419,781,539,808"/><area shape="rect" id="node11" href="../../d9/d54/ping_8c.html#a8bb0298504d1f6a612100d0b17e3ab90" title="handle_ping_request" alt="" coords="408,731,549,757"/><area shape="rect" id="node4" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="881,731,963,757"/><area shape="rect" id="node5" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="1055,680,1169,707"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1059,883,1165,909"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1067,781,1157,808"/><area shape="rect" id="node9" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1087,832,1137,859"/><area shape="rect" id="node10" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1053,731,1171,757"/><area shape="rect" id="node8" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1219,629,1325,656"/><area shape="rect" id="node12" href="../../d6/d2b/ping_8h.html#a86e9eeead72b88b686ce5b7c0f78c325" title="new_ping" alt="" coords="661,731,738,757"/><area shape="rect" id="node14" href="../../d8/dc6/net__crypto_8c.html#a5b67a38d23f1bbe5ff0ba96ea57520a4" title="create_cookie_request" alt="" coords="402,103,555,129"/><area shape="rect" id="node17" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="441,385,516,412"/><area shape="rect" id="node34" href="../../d8/dc6/net__crypto_8c.html#ae86cc5b9c02d6a9f61916e1ff1a1b768" title="handle_cookie_request" alt="" coords="401,579,556,605"/><area shape="rect" id="node39" href="../../d9/d54/ping_8c.html#a3927c1053be4390271a309982aa7284f" title="handle_ping_response" alt="" coords="403,663,554,689"/><area shape="rect" id="node40" href="../../dc/dc1/_d_h_t_8c.html#a4dcc848207b2408def323b8b79b08e4a" title="handle_sendnodes_core" alt="" coords="397,512,560,539"/><area shape="rect" id="node42" href="../../d6/d2b/ping_8h.html#a1b3882fdfddc79be369ff230cd3e7a6a" title="send_ping_request" alt="" coords="413,251,544,277"/><area shape="rect" id="node15" href="../../de/d42/net__crypto_8h.html#ae09413aa94644bc88bf73b88f48ef814" title="new_crypto_connection" alt="" coords="620,48,779,75"/><area shape="rect" id="node16" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="845,5,999,32"/><area shape="rect" id="node18" href="../../df/dad/_d_h_t_8h.html#a1dac5e05fd07964cb4914c17afeb9d50" title="DHT_addfriend" alt="" coords="644,411,755,437"/><area shape="rect" id="node22" href="../../df/dad/_d_h_t_8h.html#ab6d732074bab2377a7884c41c219cf96" title="DHT_bootstrap" alt="" coords="644,309,755,336"/><area shape="rect" id="node27" href="../../df/dad/_d_h_t_8h.html#a769ef744f969e1b4c55547cb74abee59" title="DHT_getnodes" alt="" coords="644,360,755,387"/><area shape="rect" id="node30" href="../../dc/dc1/_d_h_t_8c.html#a1d3aa20a7622e95d168e3220f61f6227" title="do_ping_and_sendnode\l_requests" alt="" coords="620,243,779,285"/><area shape="rect" id="node33" href="../../dc/dc1/_d_h_t_8c.html#aa38b3670da696f600f37989e79ce4966" title="handle_hardening" alt="" coords="638,461,761,488"/><area shape="rect" id="node19" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="867,579,977,605"/><area shape="rect" id="node20" href="../../d7/dd9/onion__test_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="1054,629,1170,656"/><area shape="rect" id="node21" href="../../d3/dfd/_d_h_t__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="897,528,947,555"/><area shape="rect" id="node23" href="../../df/dad/_d_h_t_8h.html#af342c78837dbed569d4a75a0516455fc" title="DHT_bootstrap_from\l_address" alt="" coords="850,361,994,402"/><area shape="rect" id="node24" href="../../df/dad/_d_h_t_8h.html#ad5df2ff5066cf93898e531d320ddd675" title="DHT_connect_after_load" alt="" coords="839,157,1005,184"/><area shape="rect" id="node25" href="../../d1/de5/_l_a_n__discovery_8c.html#aeb11042ae0d160b28f8943da6ae29499" title="handle_LANdiscovery" alt="" coords="847,208,997,235"/><area shape="rect" id="node26" href="../../da/d8f/tox_8h.html#ae7e49c1e9e6c3a0f9e55bfcb78044c1e" title="tox_bootstrap" alt="" coords="871,309,973,336"/><area shape="rect" id="node28" href="../../da/d7d/assoc_8h.html#a36aff33785fb0db2565cf4cb5b080327" title="do_Assoc" alt="" coords="882,477,962,504"/><area shape="rect" id="node29" href="../../db/d79/onion__client_8c.html#ac9b7f86cb71b27c5db73d341b910745c" title="handle_dhtpk_announce" alt="" coords="841,427,1003,453"/><area shape="rect" id="node31" href="../../dc/dc1/_d_h_t_8c.html#ae05715389aba7cec9083bdf9efad7a78" title="do_Close" alt="" coords="883,107,961,133"/><area shape="rect" id="node32" href="../../dc/dc1/_d_h_t_8c.html#ad1bcb472a3fd0ff8ab579551c4528b62" title="do_DHT_friends" alt="" coords="863,56,981,83"/><area shape="rect" id="node35" href="../../d8/dc6/net__crypto_8c.html#a04fc41a4cb0d904536626006f3b7d7dd" title="udp_handle_cookie_request" alt="" coords="608,563,791,589"/><area shape="rect" id="node37" href="../../d8/dc6/net__crypto_8c.html#a9308f183e47e29869d5562d03a01f88a" title="tcp_handle_cookie_request" alt="" coords="609,613,789,640"/><area shape="rect" id="node38" href="../../d8/dc6/net__crypto_8c.html#ae88369484d37b525d33c5c87c846606b" title="tcp_oob_handle_cookie\l_request" alt="" coords="620,665,779,706"/><area shape="rect" id="node36" href="../../de/d42/net__crypto_8h.html#a5e46c6f42e93e2aa968f8f63de90a53c" title="new_net_crypto" alt="" coords="865,680,979,707"/><area shape="rect" id="node41" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514" title="handle_sendnodes_ipv6" alt="" coords="619,512,780,539"/><area shape="rect" id="node43" href="../../dc/dc1/_d_h_t_8c.html#a7efc873280e2d502bf49489d3ebacc9c" title="punch_holes" alt="" coords="652,141,747,168"/><area shape="rect" id="node44" href="../../d6/d2b/ping_8h.html#af1ade820101b833a4615cb9fb58bebad" title="do_to_ping" alt="" coords="657,192,742,219"/><area shape="rect" id="node46" href="../../d7/dfd/onion__announce_8h.html#a1807a1d99b93e29c2a27648afe3e6c2c" title="new_onion_announce" alt="" coords="849,832,995,859"/><area shape="rect" id="node48" href="../../d3/db9/onion_8h.html#a71877ec5931feec418ed1ae10b0963d8" title="new_onion" alt="" coords="880,883,964,909"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a903a5bc580826fe447adb841b7782333"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int id_closest </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pk1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>pk2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00074">74</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>.</p>

<p>Referenced by <a class="el" href="../../df/d75/onion__announce_8c_source.html#l00255">add_to_entries()</a>, <a class="el" href="../../d9/d54/ping_8c_source.html#l00260">add_to_ping()</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00318">assoc_id_closest()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00472">client_add_to_list()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00557">client_ping_nodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00631">cmp_dht_entry()</a>, <a class="el" href="../../df/d75/onion__announce_8c_source.html#l00222">cmp_entry()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00464">get_close_nodes_inner()</a>, <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00059">is_furthest()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00677">store_node_ok()</a>, and <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00191">test_addto_lists_possible_bad()</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">size_t</span>   <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    uint8_t distance1, distance2;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; crypto_box_PUBLICKEYBYTES; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        distance1 = pk[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^ pk1[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        distance2 = pk[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] ^ pk2[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (distance1 &lt; distance2)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> (distance1 &gt; distance2)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a903a5bc580826fe447adb841b7782333_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a903a5bc580826fe447adb841b7782333_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a903a5bc580826fe447adb841b7782333_icgraph" id="df/dad/_d_h_t_8h_a903a5bc580826fe447adb841b7782333_icgraph">
<area shape="rect" id="node2" href="../../df/d75/onion__announce_8c.html#a8a782c6968d8bec9a92dfdd0bd32b00f" title="add_to_entries" alt="" coords="381,91,488,117"/><area shape="rect" id="node12" href="../../d6/d2b/ping_8h.html#a088e8f057d04ba6808f300cde41fa6af" title="add_to_ping" alt="" coords="595,295,687,321"/><area shape="rect" id="node19" href="../../d4/d9d/assoc_8c.html#ad78d05a8a1915614699da4704cd5641b" title="assoc_id_closest" alt="" coords="151,244,273,271"/><area shape="rect" id="node30" href="../../db/d79/onion__client_8c.html#a4f1e9a581f96d31f2f822ca6be9cc0eb" title="client_add_to_list" alt="" coords="151,345,273,372"/><area shape="rect" id="node34" href="../../db/d79/onion__client_8c.html#a934df896ad375a9dbd82f563fb27144f" title="client_ping_nodes" alt="" coords="149,396,275,423"/><area shape="rect" id="node35" href="../../dc/dc1/_d_h_t_8c.html#a15d71358ca3e1f937159a7982168bb30" title="cmp_dht_entry" alt="" coords="158,557,266,584"/><area shape="rect" id="node43" href="../../d2/d98/dht__test_8c.html#a62e2c67aa707a1ea005159db3bc59e36" title="test_addto_lists_possible_bad" alt="" coords="751,816,948,843"/><area shape="rect" id="node45" href="../../df/d75/onion__announce_8c.html#a8b4a60d685081d29b3b61256241acaf5" title="cmp_entry" alt="" coords="171,92,253,119"/><area shape="rect" id="node46" href="../../dc/dc1/_d_h_t_8c.html#a40b090e4bc0b1280a8689b7931f320c6" title="get_close_nodes_inner" alt="" coords="135,193,289,220"/><area shape="rect" id="node48" href="../../d2/d98/dht__test_8c.html#a5c88d7abe9fccf7d3d3d28efc2408fef" title="is_furthest" alt="" coords="600,460,683,487"/><area shape="rect" id="node49" href="../../dc/dc1/_d_h_t_8c.html#addb87a718c80bb27e53e8dde5972dfe9" title="store_node_ok" alt="" coords="159,507,265,533"/><area shape="rect" id="node3" href="../../df/d75/onion__announce_8c.html#a5cc40944c42a4e0d1d3d702cf93ac8ad" title="handle_announce_request" alt="" coords="763,5,936,32"/><area shape="rect" id="node4" href="../../d7/dfd/onion__announce_8h.html#a1807a1d99b93e29c2a27648afe3e6c2c" title="new_onion_announce" alt="" coords="1205,157,1352,184"/><area shape="rect" id="node5" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1405,208,1512,235"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1413,259,1504,285"/><area shape="rect" id="node8" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1433,157,1484,184"/><area shape="rect" id="node9" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1400,309,1517,336"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1565,171,1672,197"/><area shape="rect" id="node10" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1593,335,1644,361"/><area shape="rect" id="node11" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1583,284,1654,311"/><area shape="rect" id="node13" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383" title="handle_getnodes" alt="" coords="1017,259,1137,285"/><area shape="rect" id="node17" href="../../d9/d54/ping_8c.html#a8bb0298504d1f6a612100d0b17e3ab90" title="handle_ping_request" alt="" coords="779,309,920,336"/><area shape="rect" id="node14" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="1238,309,1319,336"/><area shape="rect" id="node15" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="1401,664,1516,691"/><area shape="rect" id="node16" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="1565,664,1672,691"/><area shape="rect" id="node18" href="../../d6/d2b/ping_8h.html#a86e9eeead72b88b686ce5b7c0f78c325" title="new_ping" alt="" coords="1038,309,1115,336"/><area shape="rect" id="node20" href="../../da/d7d/assoc_8h.html#ad8b38a62362a313e54af7ae07c36606f" title="Assoc_get_close_entries" alt="" coords="351,208,519,235"/><area shape="rect" id="node21" href="../../df/dad/_d_h_t_8h.html#a1dac5e05fd07964cb4914c17afeb9d50" title="DHT_addfriend" alt="" coords="1021,208,1132,235"/><area shape="rect" id="node25" href="../../df/dad/_d_h_t_8h.html#a8abfc9cea3784b0cae354670bd4643cd" title="get_close_nodes" alt="" coords="581,107,701,133"/><area shape="rect" id="node29" href="../../db/d0f/assoc__test_8c.html#a242f6c133a1fef9d5e86336e74b7ddae" title="START_TEST" alt="" coords="588,157,695,184"/><area shape="rect" id="node22" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="1223,259,1334,285"/><area shape="rect" id="node23" href="../../d7/dd9/onion__test_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="1221,107,1337,133"/><area shape="rect" id="node24" href="../../d3/dfd/_d_h_t__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1253,208,1304,235"/><area shape="rect" id="node26" href="../../db/d79/onion__client_8c.html#a18daedee61cc5670d52904fc89e4b32b" title="populate_path_nodes" alt="" coords="777,56,922,83"/><area shape="rect" id="node27" href="../../dc/dc1/_d_h_t_8c.html#af89838d6c1c8e0ec82dfadbe2953e06d" title="random_node" alt="" coords="799,107,899,133"/><area shape="rect" id="node28" href="../../dc/dc1/_d_h_t_8c.html#acce043cdc5108edffc35e6e879197d20" title="sendnodes_ipv6" alt="" coords="791,157,907,184"/><area shape="rect" id="node31" href="../../db/d79/onion__client_8c.html#acef82e3853e62dce8cd45450ff028f97" title="handle_announce_response" alt="" coords="343,372,526,399"/><area shape="rect" id="node32" href="../../db/d79/onion__client_8c.html#a3519dd95525df398b46b0e4a928f54f0" title="handle_tcp_onion" alt="" coords="580,359,703,385"/><area shape="rect" id="node33" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="1217,360,1340,387"/><area shape="rect" id="node36" href="../../dc/dc1/_d_h_t_8c.html#adfcc072141badf7d1cd04542b3dd26b1" title="replace_all" alt="" coords="393,557,477,584"/><area shape="rect" id="node37" href="../../df/dad/_d_h_t_8h.html#a9d898065db0fd4adf26fdb7f80e6d7ac" title="addto_lists" alt="" coords="599,639,684,665"/><area shape="rect" id="node38" href="../../d9/d54/ping_8c.html#a3927c1053be4390271a309982aa7284f" title="handle_ping_response" alt="" coords="774,512,925,539"/><area shape="rect" id="node39" href="../../dc/dc1/_d_h_t_8c.html#a4dcc848207b2408def323b8b79b08e4a" title="handle_sendnodes_core" alt="" coords="768,613,931,640"/><area shape="rect" id="node41" href="../../d2/d98/dht__test_8c.html#a37f262581ef29d155056c14b2fa0ced1" title="test_addto_lists_bad" alt="" coords="1005,664,1148,691"/><area shape="rect" id="node42" href="../../d2/d98/dht__test_8c.html#a26ee6a8d6a8a726b6a03bdacfa1f3716" title="test_addto_lists_good" alt="" coords="775,563,924,589"/><area shape="rect" id="node44" href="../../d2/d98/dht__test_8c.html#a90ce4d5060f1998109da42a4e83c22c0" title="test_addto_lists_update" alt="" coords="997,715,1157,741"/><area shape="rect" id="node40" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514" title="handle_sendnodes_ipv6" alt="" coords="996,461,1157,488"/><area shape="rect" id="node47" href="../../dc/dc1/_d_h_t_8c.html#ab7f89880bce923390748449ef6f60004" title="get_somewhat_close\l_nodes" alt="" coords="362,142,507,183"/><area shape="rect" id="node50" href="../../dc/dc1/_d_h_t_8c.html#ac03ed08d34d4135aa259515936209616" title="ping_node_from_getnodes_ok" alt="" coords="337,507,532,533"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a816851e4f0f454c52b93d65544a2b2bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kill_DHT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02268">2268</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dd/d3e/crypto__core_8h_source.html#l00125">CRYPTO_PACKET_HARDENING</a>, <a class="el" href="../../dd/d3e/crypto__core_8h_source.html#l00127">CRYPTO_PACKET_NAT_PING</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02154">cryptopacket_registerhandler()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00225">DHT::dht_harden_ping_array</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00224">DHT::dht_ping_array</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00968">kill_Assoc()</a>, <a class="el" href="../../d9/d54/ping_8c_source.html#l00341">kill_ping()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00216">DHT::loaded_nodes_list</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT::net</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00099">NET_PACKET_GET_NODES</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00100">NET_PACKET_SEND_NODES_IPV6</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00409">networking_registerhandler()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00223">DHT::ping</a>, and <a class="el" href="../../df/d02/ping__array_8c_source.html#l00151">ping_array_free_all()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01848">kill_messenger()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00294">kill_onions()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">new_DHT()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01751">new_messenger()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00129">START_TEST()</a>, and <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00285">test_addto_lists()</a>.</p>
<div class="fragment"><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;{</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <a class="code" href="../../d4/d9d/assoc_8c.html#a26d82e35d047181d0e883a4b91373793">kill_Assoc</a>(dht-&gt;assoc);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a861e63c2b32751aa406f11283f5b0925">NET_PACKET_GET_NODES</a>, NULL, NULL);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a868cfc97dcb064ca456278fc89f9b512">NET_PACKET_SEND_NODES_IPV6</a>, NULL, NULL);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a>(dht, <a class="code" href="../../dd/d3e/crypto__core_8h.html#accd0074d1bd9133de6460d75b10b1e21">CRYPTO_PACKET_NAT_PING</a>, NULL, NULL);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a>(dht, <a class="code" href="../../dd/d3e/crypto__core_8h.html#a703b04f256fec46afbcc98b86c86d5a7">CRYPTO_PACKET_HARDENING</a>, NULL, NULL);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <a class="code" href="../../df/d02/ping__array_8c.html#a7e093974e6d616c5bbcadfd434b49824">ping_array_free_all</a>(&amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8432234ba71a00ac9c516cb80a70f29d">dht_ping_array</a>);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <a class="code" href="../../df/d02/ping__array_8c.html#a7e093974e6d616c5bbcadfd434b49824">ping_array_free_all</a>(&amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a957126e184a8b8001228effc56b9db95">dht_harden_ping_array</a>);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <a class="code" href="../../d9/d54/ping_8c.html#a9487f04f4bb6ac4be59a4166236ec896">kill_ping</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">ping</a>);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    free(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    free(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">loaded_nodes_list</a>);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    free(dht);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;}</div>
<div class="ttc" id="network_8h_html_a861e63c2b32751aa406f11283f5b0925"><div class="ttname"><a href="../../d9/d94/network_8h.html#a861e63c2b32751aa406f11283f5b0925">NET_PACKET_GET_NODES</a></div><div class="ttdeci">#define NET_PACKET_GET_NODES</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00099">network.h:99</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8432234ba71a00ac9c516cb80a70f29d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8432234ba71a00ac9c516cb80a70f29d">DHT::dht_ping_array</a></div><div class="ttdeci">Ping_Array dht_ping_array</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00224">DHT.h:224</a></div></div>
<div class="ttc" id="ping_8c_html_a9487f04f4bb6ac4be59a4166236ec896"><div class="ttname"><a href="../../d9/d54/ping_8c.html#a9487f04f4bb6ac4be59a4166236ec896">kill_ping</a></div><div class="ttdeci">void kill_ping(PING *ping)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d54/ping_8c_source.html#l00341">ping.c:341</a></div></div>
<div class="ttc" id="crypto__core_8h_html_a703b04f256fec46afbcc98b86c86d5a7"><div class="ttname"><a href="../../dd/d3e/crypto__core_8h.html#a703b04f256fec46afbcc98b86c86d5a7">CRYPTO_PACKET_HARDENING</a></div><div class="ttdeci">#define CRYPTO_PACKET_HARDENING</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d3e/crypto__core_8h_source.html#l00125">crypto_core.h:125</a></div></div>
<div class="ttc" id="crypto__core_8h_html_accd0074d1bd9133de6460d75b10b1e21"><div class="ttname"><a href="../../dd/d3e/crypto__core_8h.html#accd0074d1bd9133de6460d75b10b1e21">CRYPTO_PACKET_NAT_PING</a></div><div class="ttdeci">#define CRYPTO_PACKET_NAT_PING</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d3e/crypto__core_8h_source.html#l00127">crypto_core.h:127</a></div></div>
<div class="ttc" id="assoc_8c_html_a26d82e35d047181d0e883a4b91373793"><div class="ttname"><a href="../../d4/d9d/assoc_8c.html#a26d82e35d047181d0e883a4b91373793">kill_Assoc</a></div><div class="ttdeci">void kill_Assoc(Assoc *assoc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9d/assoc_8c_source.html#l00968">assoc.c:968</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa14ea2f67950f57fe4235d7375a2216c"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">DHT::net</a></div><div class="ttdeci">Networking_Core * net</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT.h:201</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a3050c21873637c51d8001c807f62fa74"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a3050c21873637c51d8001c807f62fa74">DHT::loaded_nodes_list</a></div><div class="ttdeci">Node_format * loaded_nodes_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00216">DHT.h:216</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a097913efd03d5106a66c15eb48b0e104"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a></div><div class="ttdeci">void cryptopacket_registerhandler(DHT *dht, uint8_t byte, cryptopacket_handler_callback cb, void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02154">DHT.c:2154</a></div></div>
<div class="ttc" id="network_8c_html_a230a192ca9463ec4985d4f86de439733"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a></div><div class="ttdeci">void networking_registerhandler(Networking_Core *net, uint8_t byte, packet_handler_callback cb, void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00409">network.c:409</a></div></div>
<div class="ttc" id="network_8h_html_a868cfc97dcb064ca456278fc89f9b512"><div class="ttname"><a href="../../d9/d94/network_8h.html#a868cfc97dcb064ca456278fc89f9b512">NET_PACKET_SEND_NODES_IPV6</a></div><div class="ttdeci">#define NET_PACKET_SEND_NODES_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00100">network.h:100</a></div></div>
<div class="ttc" id="ping__array_8c_html_a7e093974e6d616c5bbcadfd434b49824"><div class="ttname"><a href="../../df/d02/ping__array_8c.html#a7e093974e6d616c5bbcadfd434b49824">ping_array_free_all</a></div><div class="ttdeci">void ping_array_free_all(Ping_Array *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d02/ping__array_8c_source.html#l00151">ping_array.c:151</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a957126e184a8b8001228effc56b9db95"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a957126e184a8b8001228effc56b9db95">DHT::dht_harden_ping_array</a></div><div class="ttdeci">Ping_Array dht_harden_ping_array</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00225">DHT.h:225</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae3f68e3d55e46726b05717fc88198321"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">DHT::ping</a></div><div class="ttdeci">struct PING * ping</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00223">DHT.h:223</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_cgraph" id="df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104" title="cryptopacket_registerhandler" alt="" coords="127,5,316,32"/><area shape="rect" id="node3" href="../../d4/d9d/assoc_8c.html#a26d82e35d047181d0e883a4b91373793" title="kill_Assoc" alt="" coords="180,56,263,83"/><area shape="rect" id="node4" href="../../d9/d54/ping_8c.html#a9487f04f4bb6ac4be59a4166236ec896" title="kill_ping" alt="" coords="187,157,256,184"/><area shape="rect" id="node5" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733" title="networking_registerhandler" alt="" coords="364,132,541,159"/><area shape="rect" id="node6" href="../../df/d02/ping__array_8c.html#a7e093974e6d616c5bbcadfd434b49824" title="ping_array_free_all" alt="" coords="387,195,518,221"/><area shape="rect" id="node7" href="../../df/d02/ping__array_8c.html#ad051ea35e31300366c9f8c167b27ca4c" title="clear_entry" alt="" coords="589,195,676,221"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_icgraph" id="df/dad/_d_h_t_8h_a816851e4f0f454c52b93d65544a2b2bb_icgraph">
<area shape="rect" id="node2" href="../../d4/d30/_messenger_8h.html#a771c65c3057d870b0653c2fdf0a12fb7" title="kill_messenger" alt="" coords="261,56,371,83"/><area shape="rect" id="node12" href="../../d7/dd9/onion__test_8c.html#a11b4d3c94243b8abdd439dea94ee679e" title="kill_onions" alt="" coords="127,347,209,373"/><area shape="rect" id="node14" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="127,208,209,235"/><area shape="rect" id="node15" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="259,157,373,184"/><area shape="rect" id="node17" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="263,309,369,336"/><area shape="rect" id="node20" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="257,107,375,133"/><area shape="rect" id="node3" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="451,56,501,83"/><area shape="rect" id="node4" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="441,107,511,133"/><area shape="rect" id="node11" href="../../da/d8f/tox_8h.html#a52259e134bfb9396d9fef4fffe94e878" title="tox_kill" alt="" coords="445,5,507,32"/><area shape="rect" id="node5" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="577,31,684,57"/><area shape="rect" id="node6" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="599,81,663,108"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="591,132,670,159"/><area shape="rect" id="node10" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="605,183,656,209"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="732,81,783,108"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="732,132,783,159"/><area shape="rect" id="node13" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="423,284,529,311"/><area shape="rect" id="node18" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="271,208,361,235"/><area shape="rect" id="node19" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="291,259,341,285"/><area shape="rect" id="node16" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="423,157,529,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adad04fa897751b06948a172044bf1c58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a>* new_DHT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d0b/struct_networking___core.html">Networking_Core</a> *&#160;</td>
          <td class="paramname"><em>net</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02196">2196</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dd/d3e/crypto__core_8h_source.html#l00125">CRYPTO_PACKET_HARDENING</a>, <a class="el" href="../../dd/d3e/crypto__core_8h_source.html#l00127">CRYPTO_PACKET_NAT_PING</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02160">cryptopacket_handle()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02154">cryptopacket_registerhandler()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01167">DHT_addfriend()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00061">DHT_FAKE_FRIEND_NUMBER</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00225">DHT::dht_harden_ping_array</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00224">DHT::dht_ping_array</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00044">DHT_PING_ARRAY_SIZE</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01018">handle_getnodes()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01974">handle_hardening()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01694">handle_NATping()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01139">handle_sendnodes_ipv6()</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02268">kill_DHT()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT::net</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00105">NET_PACKET_CRYPTO</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00099">NET_PACKET_GET_NODES</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00100">NET_PACKET_SEND_NODES_IPV6</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00409">networking_registerhandler()</a>, <a class="el" href="../../d4/d9d/assoc_8c_source.html#l00864">new_Assoc_default()</a>, <a class="el" href="../../d9/d54/ping_8c_source.html#l00322">new_ping()</a>, <a class="el" href="../../dc/d85/crypto__core_8c_source.html#l00182">new_symmetric_key()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00223">DHT::ping</a>, <a class="el" href="../../df/d02/ping__array_8c_source.html#l00133">ping_array_init()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00041">PING_TIMEOUT</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00208">DHT::secret_symmetric_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00210">DHT::self_public_key</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT::self_secret_key</a>, and <a class="el" href="../../de/df1/util_8c_source.html#l00041">unix_time_update()</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d36/tox-bootstrapd_8c_source.html#l00519">main()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l01751">new_messenger()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00269">new_onions()</a>, <a class="el" href="../../d7/dd9/onion__test_8c_source.html#l00129">START_TEST()</a>, and <a class="el" href="../../d2/d98/dht__test_8c_source.html#l00285">test_addto_lists()</a>.</p>
<div class="fragment"><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;{</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">/* init time */</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <a class="code" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a>();</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="keywordflow">if</span> (net == NULL)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <a class="code" href="../../de/d15/struct_d_h_t.html">DHT</a> *dht = calloc(1, <span class="keyword">sizeof</span>(<a class="code" href="../../de/d15/struct_d_h_t.html">DHT</a>));</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordflow">if</span> (dht == NULL)</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a> = net;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">ping</a> = <a class="code" href="../../d9/d54/ping_8c.html#a86e9eeead72b88b686ce5b7c0f78c325">new_ping</a>(dht);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">if</span> (dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">ping</a> == NULL) {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a816851e4f0f454c52b93d65544a2b2bb">kill_DHT</a>(dht);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    }</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a861e63c2b32751aa406f11283f5b0925">NET_PACKET_GET_NODES</a>, &amp;<a class="code" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383">handle_getnodes</a>, dht);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#a868cfc97dcb064ca456278fc89f9b512">NET_PACKET_SEND_NODES_IPV6</a>, &amp;<a class="code" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514">handle_sendnodes_ipv6</a>, dht);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <a class="code" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, <a class="code" href="../../d9/d94/network_8h.html#aebd9a38e63bac9807d0c2c1cfed68a15">NET_PACKET_CRYPTO</a>, &amp;<a class="code" href="../../dc/dc1/_d_h_t_8c.html#aa8dd9b8abd89728492c0c9c6299c0a8b">cryptopacket_handle</a>, dht);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a>(dht, <a class="code" href="../../dd/d3e/crypto__core_8h.html#accd0074d1bd9133de6460d75b10b1e21">CRYPTO_PACKET_NAT_PING</a>, &amp;<a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9684ffd3987f6c79663c1f07eed0c007">handle_NATping</a>, dht);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a>(dht, <a class="code" href="../../dd/d3e/crypto__core_8h.html#a703b04f256fec46afbcc98b86c86d5a7">CRYPTO_PACKET_HARDENING</a>, &amp;<a class="code" href="../../dc/dc1/_d_h_t_8c.html#aa38b3670da696f600f37989e79ce4966">handle_hardening</a>, dht);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <a class="code" href="../../dc/d85/crypto__core_8c.html#a89b4a1a4a7d8bfabdf0e1b60f074e531">new_symmetric_key</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ab9f2ff47bc0b1e5110202a6e4be86390">secret_symmetric_key</a>);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    crypto_box_keypair(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">self_secret_key</a>);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <a class="code" href="../../df/d02/ping__array_8c.html#a2d42b1adf1e6ff6a690fc515b9bb2570">ping_array_init</a>(&amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a8432234ba71a00ac9c516cb80a70f29d">dht_ping_array</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#aa025d4328dd829fe6d532d3abaf3bc7e">DHT_PING_ARRAY_SIZE</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a733f0d1225f97d8acbd3388e0c0d320f">PING_TIMEOUT</a>);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <a class="code" href="../../df/d02/ping__array_8c.html#a2d42b1adf1e6ff6a690fc515b9bb2570">ping_array_init</a>(&amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a957126e184a8b8001228effc56b9db95">dht_harden_ping_array</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#aa025d4328dd829fe6d532d3abaf3bc7e">DHT_PING_ARRAY_SIZE</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a733f0d1225f97d8acbd3388e0c0d320f">PING_TIMEOUT</a>);</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="preprocessor">#ifdef ENABLE_ASSOC_DHT</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    dht-&gt;assoc = <a class="code" href="../../d4/d9d/assoc_8c.html#ab7f978008ad6c86ab5063e989fe49d0c">new_Assoc_default</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">self_public_key</a>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        uint8_t random_key_bytes[crypto_box_PUBLICKEYBYTES];</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        randombytes(random_key_bytes, <span class="keyword">sizeof</span>(random_key_bytes));</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a1dac5e05fd07964cb4914c17afeb9d50">DHT_addfriend</a>(dht, random_key_bytes, 0, 0, 0, 0);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    }</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="keywordflow">return</span> dht;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;}</div>
<div class="ttc" id="network_8h_html_aebd9a38e63bac9807d0c2c1cfed68a15"><div class="ttname"><a href="../../d9/d94/network_8h.html#aebd9a38e63bac9807d0c2c1cfed68a15">NET_PACKET_CRYPTO</a></div><div class="ttdeci">#define NET_PACKET_CRYPTO</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00105">network.h:105</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa05050f86513ff53fe9da81f73c72267"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa05050f86513ff53fe9da81f73c72267">DHT::self_secret_key</a></div><div class="ttdeci">uint8_t self_secret_key[crypto_box_SECRETKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00211">DHT.h:211</a></div></div>
<div class="ttc" id="network_8h_html_a861e63c2b32751aa406f11283f5b0925"><div class="ttname"><a href="../../d9/d94/network_8h.html#a861e63c2b32751aa406f11283f5b0925">NET_PACKET_GET_NODES</a></div><div class="ttdeci">#define NET_PACKET_GET_NODES</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00099">network.h:99</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a816851e4f0f454c52b93d65544a2b2bb"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a816851e4f0f454c52b93d65544a2b2bb">kill_DHT</a></div><div class="ttdeci">void kill_DHT(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02268">DHT.c:2268</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_aa38b3670da696f600f37989e79ce4966"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#aa38b3670da696f600f37989e79ce4966">handle_hardening</a></div><div class="ttdeci">static int handle_hardening(void *object, IP_Port source, const uint8_t *source_pubkey, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01974">DHT.c:1974</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_aa025d4328dd829fe6d532d3abaf3bc7e"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#aa025d4328dd829fe6d532d3abaf3bc7e">DHT_PING_ARRAY_SIZE</a></div><div class="ttdeci">#define DHT_PING_ARRAY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00044">DHT.h:44</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a8432234ba71a00ac9c516cb80a70f29d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a8432234ba71a00ac9c516cb80a70f29d">DHT::dht_ping_array</a></div><div class="ttdeci">Ping_Array dht_ping_array</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00224">DHT.h:224</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_afa4f13a29cbe60809f2446267d109383"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383">handle_getnodes</a></div><div class="ttdeci">static int handle_getnodes(void *object, IP_Port source, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01018">DHT.c:1018</a></div></div>
<div class="ttc" id="ping__array_8c_html_a2d42b1adf1e6ff6a690fc515b9bb2570"><div class="ttname"><a href="../../df/d02/ping__array_8c.html#a2d42b1adf1e6ff6a690fc515b9bb2570">ping_array_init</a></div><div class="ttdeci">int ping_array_init(Ping_Array *empty_array, uint32_t size, uint32_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d02/ping__array_8c_source.html#l00133">ping_array.c:133</a></div></div>
<div class="ttc" id="crypto__core_8h_html_a703b04f256fec46afbcc98b86c86d5a7"><div class="ttname"><a href="../../dd/d3e/crypto__core_8h.html#a703b04f256fec46afbcc98b86c86d5a7">CRYPTO_PACKET_HARDENING</a></div><div class="ttdeci">#define CRYPTO_PACKET_HARDENING</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d3e/crypto__core_8h_source.html#l00125">crypto_core.h:125</a></div></div>
<div class="ttc" id="ping_8c_html_a86e9eeead72b88b686ce5b7c0f78c325"><div class="ttname"><a href="../../d9/d54/ping_8c.html#a86e9eeead72b88b686ce5b7c0f78c325">new_ping</a></div><div class="ttdeci">PING * new_ping(DHT *dht)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d54/ping_8c_source.html#l00322">ping.c:322</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_ac70b27be10ded8565ffcb94829e40514"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514">handle_sendnodes_ipv6</a></div><div class="ttdeci">static int handle_sendnodes_ipv6(void *object, IP_Port source, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01139">DHT.c:1139</a></div></div>
<div class="ttc" id="crypto__core_8h_html_accd0074d1bd9133de6460d75b10b1e21"><div class="ttname"><a href="../../dd/d3e/crypto__core_8h.html#accd0074d1bd9133de6460d75b10b1e21">CRYPTO_PACKET_NAT_PING</a></div><div class="ttdeci">#define CRYPTO_PACKET_NAT_PING</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d3e/crypto__core_8h_source.html#l00127">crypto_core.h:127</a></div></div>
<div class="ttc" id="assoc_8c_html_ab7f978008ad6c86ab5063e989fe49d0c"><div class="ttname"><a href="../../d4/d9d/assoc_8c.html#ab7f978008ad6c86ab5063e989fe49d0c">new_Assoc_default</a></div><div class="ttdeci">Assoc * new_Assoc_default(const uint8_t *public_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9d/assoc_8c_source.html#l00864">assoc.c:864</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa14ea2f67950f57fe4235d7375a2216c"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">DHT::net</a></div><div class="ttdeci">Networking_Core * net</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT.h:201</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a1dac5e05fd07964cb4914c17afeb9d50"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a1dac5e05fd07964cb4914c17afeb9d50">DHT_addfriend</a></div><div class="ttdeci">int DHT_addfriend(DHT *dht, const uint8_t *public_key, void(*ip_callback)(void *data, int32_t number, IP_Port), void *data, int32_t number, uint16_t *lock_count)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01167">DHT.c:1167</a></div></div>
<div class="ttc" id="crypto__core_8c_html_a89b4a1a4a7d8bfabdf0e1b60f074e531"><div class="ttname"><a href="../../dc/d85/crypto__core_8c.html#a89b4a1a4a7d8bfabdf0e1b60f074e531">new_symmetric_key</a></div><div class="ttdeci">void new_symmetric_key(uint8_t *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d85/crypto__core_8c_source.html#l00182">crypto_core.c:182</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a9684ffd3987f6c79663c1f07eed0c007"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a9684ffd3987f6c79663c1f07eed0c007">handle_NATping</a></div><div class="ttdeci">static int handle_NATping(void *object, IP_Port source, const uint8_t *source_pubkey, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01694">DHT.c:1694</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="struct_d_h_t_html"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html">DHT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00200">DHT.h:200</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a09839809f361926e324196bfd9450bb4"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a09839809f361926e324196bfd9450bb4">DHT_FAKE_FRIEND_NUMBER</a></div><div class="ttdeci">#define DHT_FAKE_FRIEND_NUMBER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00061">DHT.h:61</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_aa8dd9b8abd89728492c0c9c6299c0a8b"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#aa8dd9b8abd89728492c0c9c6299c0a8b">cryptopacket_handle</a></div><div class="ttdeci">static int cryptopacket_handle(void *object, IP_Port source, const uint8_t *packet, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02160">DHT.c:2160</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a097913efd03d5106a66c15eb48b0e104"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104">cryptopacket_registerhandler</a></div><div class="ttdeci">void cryptopacket_registerhandler(DHT *dht, uint8_t byte, cryptopacket_handler_callback cb, void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l02154">DHT.c:2154</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae726df8bdc26380e5a6c3187a00d6881"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae726df8bdc26380e5a6c3187a00d6881">DHT::self_public_key</a></div><div class="ttdeci">uint8_t self_public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00210">DHT.h:210</a></div></div>
<div class="ttc" id="network_8c_html_a230a192ca9463ec4985d4f86de439733"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733">networking_registerhandler</a></div><div class="ttdeci">void networking_registerhandler(Networking_Core *net, uint8_t byte, packet_handler_callback cb, void *object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00409">network.c:409</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ab9f2ff47bc0b1e5110202a6e4be86390"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ab9f2ff47bc0b1e5110202a6e4be86390">DHT::secret_symmetric_key</a></div><div class="ttdeci">uint8_t secret_symmetric_key[crypto_box_KEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00208">DHT.h:208</a></div></div>
<div class="ttc" id="network_8h_html_a868cfc97dcb064ca456278fc89f9b512"><div class="ttname"><a href="../../d9/d94/network_8h.html#a868cfc97dcb064ca456278fc89f9b512">NET_PACKET_SEND_NODES_IPV6</a></div><div class="ttdeci">#define NET_PACKET_SEND_NODES_IPV6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00100">network.h:100</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a733f0d1225f97d8acbd3388e0c0d320f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a733f0d1225f97d8acbd3388e0c0d320f">PING_TIMEOUT</a></div><div class="ttdeci">#define PING_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00041">DHT.h:41</a></div></div>
<div class="ttc" id="util_8c_html_a849af10dd491723cf3abdef599846897"><div class="ttname"><a href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897">unix_time_update</a></div><div class="ttdeci">void unix_time_update()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00041">util.c:41</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a957126e184a8b8001228effc56b9db95"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a957126e184a8b8001228effc56b9db95">DHT::dht_harden_ping_array</a></div><div class="ttdeci">Ping_Array dht_harden_ping_array</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00225">DHT.h:225</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae3f68e3d55e46726b05717fc88198321"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae3f68e3d55e46726b05717fc88198321">DHT::ping</a></div><div class="ttdeci">struct PING * ping</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00223">DHT.h:223</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_cgraph" id="df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#aa8dd9b8abd89728492c0c9c6299c0a8b" title="cryptopacket_handle" alt="" coords="135,1152,277,1178"/><area shape="rect" id="node10" href="../../dc/dc1/_d_h_t_8c.html#a097913efd03d5106a66c15eb48b0e104" title="cryptopacket_registerhandler" alt="" coords="325,1608,515,1634"/><area shape="rect" id="node11" href="../../dc/dc1/_d_h_t_8c.html#a1dac5e05fd07964cb4914c17afeb9d50" title="DHT_addfriend" alt="" coords="151,822,261,849"/><area shape="rect" id="node22" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383" title="handle_getnodes" alt="" coords="360,1050,480,1077"/><area shape="rect" id="node26" href="../../dc/dc1/_d_h_t_8c.html#aa38b3670da696f600f37989e79ce4966" title="handle_hardening" alt="" coords="145,113,267,140"/><area shape="rect" id="node30" href="../../dc/dc1/_d_h_t_8c.html#a9684ffd3987f6c79663c1f07eed0c007" title="handle_NATping" alt="" coords="147,746,265,773"/><area shape="rect" id="node32" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514" title="handle_sendnodes_ipv6" alt="" coords="339,392,501,418"/><area shape="rect" id="node37" href="../../dc/dc1/_d_h_t_8c.html#a816851e4f0f454c52b93d65544a2b2bb" title="kill_DHT" alt="" coords="169,1456,243,1482"/><area shape="rect" id="node40" href="../../d6/d6e/network_8c.html#a230a192ca9463ec4985d4f86de439733" title="networking_registerhandler" alt="" coords="571,1405,749,1432"/><area shape="rect" id="node42" href="../../d4/d9d/assoc_8c.html#ab7f978008ad6c86ab5063e989fe49d0c" title="new_Assoc_default" alt="" coords="138,645,274,672"/><area shape="rect" id="node44" href="../../d9/d54/ping_8c.html#a86e9eeead72b88b686ce5b7c0f78c325" title="new_ping" alt="" coords="167,1202,245,1229"/><area shape="rect" id="node45" href="../../df/d02/ping__array_8c.html#a2d42b1adf1e6ff6a690fc515b9bb2570" title="ping_array_init" alt="" coords="367,1304,473,1330"/><area shape="rect" id="node48" href="../../dc/d85/crypto__core_8c.html#a89b4a1a4a7d8bfabdf0e1b60f074e531" title="new_symmetric_key" alt="" coords="135,1557,277,1584"/><area shape="rect" id="node49" href="../../de/df1/util_8c.html#a849af10dd491723cf3abdef599846897" title="unix_time_update" alt="" coords="144,1633,268,1660"/><area shape="rect" id="node3" href="../../dc/d85/crypto__core_8c.html#a58ee334ab33d4a0283067145d3160a57" title="handle_request" alt="" coords="365,1152,475,1178"/><area shape="rect" id="node6" href="../../dc/dc1/_d_h_t_8c.html#a91072d384a61a04ac1e4d679dc7efb3a" title="route_packet" alt="" coords="611,949,709,976"/><area shape="rect" id="node4" href="../../dc/d85/crypto__core_8c.html#ab0aff79180f3852c24ad8f6fd88caf18" title="decrypt_data" alt="" coords="611,1354,709,1381"/><area shape="rect" id="node5" href="../../dc/d85/crypto__core_8c.html#a824b257fcff74b9d17c5247223fbed29" title="decrypt_data_symmetric" alt="" coords="805,1253,971,1280"/><area shape="rect" id="node7" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="853,746,923,773"/><area shape="rect" id="node8" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="855,949,921,976"/><area shape="rect" id="node9" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="843,594,933,621"/><area shape="rect" id="node12" href="../../d4/d9d/assoc_8c.html#a256dcbfb2174603496ffa30efef90ad2" title="Assoc_get_close_entries" alt="" coords="336,797,504,824"/><area shape="rect" id="node15" href="../../d6/d6e/network_8c.html#a8436367218afb29bcf1b5fecd071648e" title="ipport_isset" alt="" coords="615,898,705,925"/><area shape="rect" id="node19" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b" title="friend_number" alt="" coords="368,848,472,874"/><area shape="rect" id="node20" href="../../dc/dc1/_d_h_t_8c.html#a7af6c30b12e5cbda1e6d6d824794956e" title="getnodes" alt="" coords="383,696,457,722"/><area shape="rect" id="node21" href="../../dc/d85/crypto__core_8c.html#a1ce51b34ab2247e750b9c2a25121eb9e" title="random_64b" alt="" coords="373,746,467,773"/><area shape="rect" id="node13" href="../../d4/d9d/assoc_8c.html#ad78d05a8a1915614699da4704cd5641b" title="assoc_id_closest" alt="" coords="599,797,721,824"/><area shape="rect" id="node14" href="../../d4/d9d/assoc_8c.html#aa8781ddcd6a9240db73c39a2ff844d12" title="client_id_self_update" alt="" coords="588,696,732,722"/><area shape="rect" id="node16" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="619,88,701,114"/><area shape="rect" id="node18" href="../../d1/de5/_l_a_n__discovery_8c.html#a2d80a53390598eb8ededbc63f4e9c152" title="LAN_ip" alt="" coords="855,493,921,520"/><area shape="rect" id="node17" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="849,265,927,292"/><area shape="rect" id="node23" href="../../d9/d54/ping_8c.html#a088e8f057d04ba6808f300cde41fa6af" title="add_to_ping" alt="" coords="614,1050,706,1077"/><area shape="rect" id="node24" href="../../dc/dc1/_d_h_t_8c.html#a9e92f7714ab1f2b37b54e8479717cbc7" title="DHT_get_shared_key_recv" alt="" coords="569,1152,751,1178"/><area shape="rect" id="node25" href="../../dc/dc1/_d_h_t_8c.html#acce043cdc5108edffc35e6e879197d20" title="sendnodes_ipv6" alt="" coords="602,544,718,570"/><area shape="rect" id="node27" href="../../dc/dc1/_d_h_t_8c.html#a0595b79448a6183eba8b2bcd77afcc8a" title="get_closelist_IPPTsPng" alt="" coords="579,37,741,64"/><area shape="rect" id="node28" href="../../dc/dc1/_d_h_t_8c.html#a014ce120084edcbc79a5fda25820fe1a" title="have_nodes_closelist" alt="" coords="347,138,493,165"/><area shape="rect" id="node29" href="../../dc/dc1/_d_h_t_8c.html#a45b33af842c0289c78c70f81e854ed62" title="unpack_nodes" alt="" coords="835,62,941,89"/><area shape="rect" id="node31" href="../../dc/dc1/_d_h_t_8c.html#a25f7b3704b34bb8745a0a60939e1f49c" title="send_NATping" alt="" coords="366,645,474,672"/><area shape="rect" id="node33" href="../../dc/dc1/_d_h_t_8c.html#a4dcc848207b2408def323b8b79b08e4a" title="handle_sendnodes_core" alt="" coords="579,290,741,317"/><area shape="rect" id="node34" href="../../dc/dc1/_d_h_t_8c.html#ac03ed08d34d4135aa259515936209616" title="ping_node_from_getnodes_ok" alt="" coords="563,189,757,216"/><area shape="rect" id="node35" href="../../dc/dc1/_d_h_t_8c.html#a8c25b3f909399fff843f905f2ad9615f" title="returnedip_ports" alt="" coords="603,392,717,418"/><area shape="rect" id="node36" href="../../d9/d54/ping_8c.html#a1b3882fdfddc79be369ff230cd3e7a6a" title="send_ping_request" alt="" coords="595,645,725,672"/><area shape="rect" id="node38" href="../../d4/d9d/assoc_8c.html#a26d82e35d047181d0e883a4b91373793" title="kill_Assoc" alt="" coords="379,1456,461,1482"/><area shape="rect" id="node39" href="../../d9/d54/ping_8c.html#a9487f04f4bb6ac4be59a4166236ec896" title="kill_ping" alt="" coords="385,1506,455,1533"/><area shape="rect" id="node41" href="../../df/d02/ping__array_8c.html#a7e093974e6d616c5bbcadfd434b49824" title="ping_array_free_all" alt="" coords="595,1532,725,1558"/><area shape="rect" id="node43" href="../../d4/d9d/assoc_8c.html#ae180bc47f7e0f171ed9bbedd7d50e416" title="new_Assoc" alt="" coords="375,594,465,621"/><area shape="rect" id="node46" href="../../d9/d54/ping_8c.html#a8bb0298504d1f6a612100d0b17e3ab90" title="handle_ping_request" alt="" coords="349,1101,491,1128"/><area shape="rect" id="node47" href="../../d9/d54/ping_8c.html#a3927c1053be4390271a309982aa7284f" title="handle_ping_response" alt="" coords="585,1253,735,1280"/><area shape="rect" id="node50" href="../../db/d11/irc__syncbot_8c.html#ae8ecaef140b786a2720eadbb85918e81" title="current_time_monotonic" alt="" coords="339,1658,501,1685"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_icgraph" id="df/dad/_d_h_t_8h_adad04fa897751b06948a172044bf1c58_icgraph">
<area shape="rect" id="node2" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="168,31,219,57"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="135,81,252,108"/><area shape="rect" id="node12" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="148,132,239,159"/><area shape="rect" id="node14" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="140,183,247,209"/><area shape="rect" id="node15" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="136,233,251,260"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="328,31,379,57"/><area shape="rect" id="node5" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="318,81,389,108"/><area shape="rect" id="node6" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="455,5,561,32"/><area shape="rect" id="node7" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="476,56,540,83"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="469,107,547,133"/><area shape="rect" id="node11" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="483,157,533,184"/><area shape="rect" id="node8" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="609,56,660,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="609,107,660,133"/><area shape="rect" id="node13" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="300,132,407,159"/><area shape="rect" id="node16" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="300,233,407,260"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1d6f2fcb008c989f333ae89e840f94b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pack_nodes </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00207">207</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00180">PACKED_NODE_SIZE_IP4</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00181">PACKED_NODE_SIZE_IP6</a>, <a class="el" href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile::public_key</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00171">SIZE_IP4</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00172">SIZE_IP6</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00132">TCP_INET</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00133">TCP_INET6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00055">TOX_AF_INET</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00056">TOX_AF_INET6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00057">TOX_TCP_INET</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00058">TOX_TCP_INET6</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02329">DHT_save()</a>, <a class="el" href="../../df/d75/onion__announce_8c_source.html#l00289">handle_announce_request()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02565">messenger_save()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00921">send_dhtpk_announce()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00210">send_relays()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00969">sendnodes_ipv6()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, packed_length = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; number; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordtype">int</span> ipv6 = -1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        uint8_t net_family;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (nodes[i].ip_port.ip.family == AF_INET) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            ipv6 = 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            net_family = <a class="code" href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nodes[i].ip_port.ip.family == <a class="code" href="../../d9/d94/network_8h.html#a38cdd2f189180d6790d5b181f55ca047">TCP_INET</a>) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            ipv6 = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            net_family = <a class="code" href="../../df/dad/_d_h_t_8h.html#ab59616c5422ae79ebc665059761879d5">TOX_TCP_INET</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nodes[i].ip_port.ip.family == AF_INET6) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            ipv6 = 1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            net_family = <a class="code" href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nodes[i].ip_port.ip.family == <a class="code" href="../../d9/d94/network_8h.html#a7cd884776d628ca50049592d963c10cc">TCP_INET6</a>) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            ipv6 = 1;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            net_family = <a class="code" href="../../df/dad/_d_h_t_8h.html#a30bf86f2e1f87bcbd6a90145943aabac">TOX_TCP_INET6</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (ipv6 == 0) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            uint32_t size = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">if</span> (packed_length + size &gt; length)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[packed_length] = net_family;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            memcpy(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + packed_length + 1, &amp;nodes[i].ip_port.ip.ip4, <a class="code" href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            memcpy(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + packed_length + 1 + <a class="code" href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a>, &amp;nodes[i].ip_port.port, <span class="keyword">sizeof</span>(uint16_t));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            memcpy(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + packed_length + 1 + <a class="code" href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a> + <span class="keyword">sizeof</span>(uint16_t), nodes[i].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            packed_length += size;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipv6 == 1) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            uint32_t size = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (packed_length + size &gt; length)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[packed_length] = net_family;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            memcpy(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + packed_length + 1, &amp;nodes[i].ip_port.ip.ip6, <a class="code" href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            memcpy(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + packed_length + 1 + <a class="code" href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a>, &amp;nodes[i].ip_port.port, <span class="keyword">sizeof</span>(uint16_t));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            memcpy(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + packed_length + 1 + <a class="code" href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a> + <span class="keyword">sizeof</span>(uint16_t), nodes[i].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            packed_length += size;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> packed_length;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;}</div>
<div class="ttc" id="network_8h_html_af01e75c1c63a39bcd2aacdf3018b18c9"><div class="ttname"><a href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a></div><div class="ttdeci">#define SIZE_IP4</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00171">network.h:171</a></div></div>
<div class="ttc" id="network_8h_html_a38cdd2f189180d6790d5b181f55ca047"><div class="ttname"><a href="../../d9/d94/network_8h.html#a38cdd2f189180d6790d5b181f55ca047">TCP_INET</a></div><div class="ttdeci">#define TCP_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00132">network.h:132</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a03601baefa220335487dfc838c08d268"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a></div><div class="ttdeci">#define PACKED_NODE_SIZE_IP4</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00180">DHT.c:180</a></div></div>
<div class="ttc" id="network_8h_html_a5d7430ad26f80239b9fe1bbcd51b5ed2"><div class="ttname"><a href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a></div><div class="ttdeci">#define SIZE_IP6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00172">network.h:172</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a025adcf535ab2c7123fb5ea22fe20bbd"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a></div><div class="ttdeci">#define TOX_AF_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00056">DHT.h:56</a></div></div>
<div class="ttc" id="network_8h_html_a7cd884776d628ca50049592d963c10cc"><div class="ttname"><a href="../../d9/d94/network_8h.html#a7cd884776d628ca50049592d963c10cc">TCP_INET6</a></div><div class="ttdeci">#define TCP_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00133">network.h:133</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a30bf86f2e1f87bcbd6a90145943aabac"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a30bf86f2e1f87bcbd6a90145943aabac">TOX_TCP_INET6</a></div><div class="ttdeci">#define TOX_TCP_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00058">DHT.h:58</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a9b47e23b0610a17f01902680f55d7963"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a></div><div class="ttdeci">#define PACKED_NODE_SIZE_IP6</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00181">DHT.c:181</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ac35a63082a23b6ced97c0a3a24ba06be"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a></div><div class="ttdeci">#define TOX_AF_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00055">DHT.h:55</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ab59616c5422ae79ebc665059761879d5"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ab59616c5422ae79ebc665059761879d5">TOX_TCP_INET</a></div><div class="ttdeci">#define TOX_TCP_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00057">DHT.h:57</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a1d6f2fcb008c989f333ae89e840f94b4_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a1d6f2fcb008c989f333ae89e840f94b4_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a1d6f2fcb008c989f333ae89e840f94b4_icgraph" id="df/dad/_d_h_t_8h_a1d6f2fcb008c989f333ae89e840f94b4_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#a7510a9fdbacfffb5987590c4e193c40a" title="DHT_save" alt="" coords="400,157,485,184"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#af0dfac679b1b57a0036f6511e12fe777" title="messenger_save" alt="" coords="579,107,701,133"/><area shape="rect" id="node13" href="../../df/d75/onion__announce_8c.html#a5cc40944c42a4e0d1d3d702cf93ac8ad" title="handle_announce_request" alt="" coords="145,335,319,361"/><area shape="rect" id="node26" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="156,259,308,285"/><area shape="rect" id="node34" href="../../d2/db1/friend__connection_8c.html#a6e0e582317de001468faab8240bd2b5c" title="send_relays" alt="" coords="186,208,278,235"/><area shape="rect" id="node36" href="../../dc/dc1/_d_h_t_8c.html#acce043cdc5108edffc35e6e879197d20" title="sendnodes_ipv6" alt="" coords="174,392,290,419"/><area shape="rect" id="node12" href="../../d8/dda/messenger__test_8c.html#a86a26950f83bcd6bd68640da6a5c96a4" title="START_TEST" alt="" coords="587,157,693,184"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="771,107,877,133"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="963,208,1013,235"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a63116d9c9454da73a56463d9093e53e4" title="tox_get_savedata" alt="" coords="761,56,887,83"/><area shape="rect" id="node7" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1089,259,1196,285"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a631b615f9972e1b5609e5773d809f9b4" title="save_data" alt="" coords="947,56,1029,83"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1106,56,1179,83"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a86825faeca35dae8e6c4ab666d4543d6" title="save_data_file" alt="" coords="1089,5,1196,32"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1244,56,1295,83"/><area shape="rect" id="node14" href="../../d7/dfd/onion__announce_8h.html#a1807a1d99b93e29c2a27648afe3e6c2c" title="new_onion_announce" alt="" coords="567,360,713,387"/><area shape="rect" id="node15" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="771,411,877,437"/><area shape="rect" id="node16" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="779,309,869,336"/><area shape="rect" id="node18" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="799,360,849,387"/><area shape="rect" id="node19" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="765,461,883,488"/><area shape="rect" id="node17" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="935,284,1041,311"/><area shape="rect" id="node20" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="963,461,1013,488"/><area shape="rect" id="node21" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="953,360,1023,387"/><area shape="rect" id="node22" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1111,360,1175,387"/><area shape="rect" id="node24" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1103,309,1182,336"/><area shape="rect" id="node25" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1117,411,1168,437"/><area shape="rect" id="node23" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1244,284,1295,311"/><area shape="rect" id="node27" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="405,259,480,285"/><area shape="rect" id="node28" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="584,259,696,285"/><area shape="rect" id="node29" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="783,259,865,285"/><area shape="rect" id="node30" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="771,208,877,235"/><area shape="rect" id="node31" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="947,107,1029,133"/><area shape="rect" id="node32" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1089,157,1196,184"/><area shape="rect" id="node33" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1117,107,1169,133"/><area shape="rect" id="node35" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="367,208,519,235"/><area shape="rect" id="node37" href="../../dc/dc1/_d_h_t_8c.html#afa4f13a29cbe60809f2446267d109383" title="handle_getnodes" alt="" coords="383,404,503,431"/><area shape="rect" id="node38" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="599,411,681,437"/><area shape="rect" id="node39" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="767,512,881,539"/><area shape="rect" id="node40" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="935,512,1041,539"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa980937ac320a4389b726e04da26cb44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int packed_node_size </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ip_family</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00186">186</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00180">PACKED_NODE_SIZE_IP4</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00181">PACKED_NODE_SIZE_IP6</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00132">TCP_INET</a>, and <a class="el" href="../../d9/d94/network_8h_source.html#l00133">TCP_INET6</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02295">DHT_size()</a>, <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02565">messenger_save()</a>, and <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02540">messenger_size()</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (ip_family == AF_INET) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip_family == <a class="code" href="../../d9/d94/network_8h.html#a38cdd2f189180d6790d5b181f55ca047">TCP_INET</a>) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip_family == AF_INET6) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip_family == <a class="code" href="../../d9/d94/network_8h.html#a7cd884776d628ca50049592d963c10cc">TCP_INET6</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="ttc" id="network_8h_html_a38cdd2f189180d6790d5b181f55ca047"><div class="ttname"><a href="../../d9/d94/network_8h.html#a38cdd2f189180d6790d5b181f55ca047">TCP_INET</a></div><div class="ttdeci">#define TCP_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00132">network.h:132</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a03601baefa220335487dfc838c08d268"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a></div><div class="ttdeci">#define PACKED_NODE_SIZE_IP4</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00180">DHT.c:180</a></div></div>
<div class="ttc" id="network_8h_html_a7cd884776d628ca50049592d963c10cc"><div class="ttname"><a href="../../d9/d94/network_8h.html#a7cd884776d628ca50049592d963c10cc">TCP_INET6</a></div><div class="ttdeci">#define TCP_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00133">network.h:133</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a9b47e23b0610a17f01902680f55d7963"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a></div><div class="ttdeci">#define PACKED_NODE_SIZE_IP6</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00181">DHT.c:181</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_aa980937ac320a4389b726e04da26cb44_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_aa980937ac320a4389b726e04da26cb44_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_aa980937ac320a4389b726e04da26cb44_icgraph" id="df/dad/_d_h_t_8h_aa980937ac320a4389b726e04da26cb44_icgraph">
<area shape="rect" id="node2" href="../../df/dad/_d_h_t_8h.html#a55d92a2419bf9384e3cbfe0ec5a8f4d6" title="DHT_size" alt="" coords="184,56,265,83"/><area shape="rect" id="node3" href="../../d4/d30/_messenger_8h.html#af0dfac679b1b57a0036f6511e12fe777" title="messenger_save" alt="" coords="479,5,600,32"/><area shape="rect" id="node12" href="../../d4/d30/_messenger_8h.html#a4ae119dad636f15f1a5d628a13b107d8" title="messenger_size" alt="" coords="313,107,431,133"/><area shape="rect" id="node14" href="../../d8/dda/messenger__test_8c.html#a86a26950f83bcd6bd68640da6a5c96a4" title="START_TEST" alt="" coords="319,56,425,83"/><area shape="rect" id="node4" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="673,56,779,83"/><area shape="rect" id="node5" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="701,107,751,133"/><area shape="rect" id="node6" href="../../da/d8f/tox_8h.html#a63116d9c9454da73a56463d9093e53e4" title="tox_get_savedata" alt="" coords="663,5,789,32"/><area shape="rect" id="node7" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="852,107,959,133"/><area shape="rect" id="node8" href="../../d2/d65/n_tox_8c.html#a631b615f9972e1b5609e5773d809f9b4" title="save_data" alt="" coords="864,31,947,57"/><area shape="rect" id="node9" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1023,5,1097,32"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#a86825faeca35dae8e6c4ab666d4543d6" title="save_data_file" alt="" coords="1007,56,1113,83"/><area shape="rect" id="node10" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1161,31,1212,57"/><area shape="rect" id="node13" href="../../da/d8f/tox_8h.html#ac2b90c8597ff7afa2e9532e81b65d412" title="tox_get_savedata_size" alt="" coords="648,157,804,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a91072d384a61a04ac1e4d679dc7efb3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int route_packet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01467">1467</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT::close_clientlist</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00061">id_equal()</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00780">ip_isset()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00035">LCLIENT_LIST</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT::net</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00104">Client_data::public_key</a>, and <a class="el" href="../../d6/d6e/network_8c_source.html#l00295">sendpacket()</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02160">cryptopacket_handle()</a>.</p>
<div class="fragment"><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;{</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1">id_equal</a>(<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[i].<a class="code" href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">public_key</a>)) {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">close_clientlist</a>[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a>(&amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>))</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1">sendpacket</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, packet, length);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a>(&amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>))</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1">sendpacket</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>.<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, packet, length);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a3058f857a8316099e20c95fb07adc7c1"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a3058f857a8316099e20c95fb07adc7c1">LCLIENT_LIST</a></div><div class="ttdeci">#define LCLIENT_LIST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00035">DHT.h:35</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="network_8c_html_ac56c677f4bc8bf8311370ee105ae7cbb"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a></div><div class="ttdeci">int ip_isset(const IP *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00780">network.c:780</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_a00ef35d5b0e7a791ef08a30b3bacbf9d"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#a00ef35d5b0e7a791ef08a30b3bacbf9d">DHT::close_clientlist</a></div><div class="ttdeci">Client_data close_clientlist[LCLIENT_LIST]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00203">DHT.h:203</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa14ea2f67950f57fe4235d7375a2216c"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">DHT::net</a></div><div class="ttdeci">Networking_Core * net</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT.h:201</a></div></div>
<div class="ttc" id="struct_client__data_html_aaa806bb1136fb3d4b5d8d8970b596ff7"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#aaa806bb1136fb3d4b5d8d8970b596ff7">Client_data::public_key</a></div><div class="ttdeci">uint8_t public_key[crypto_box_PUBLICKEYBYTES]</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00104">DHT.h:104</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="util_8c_html_ada3d44b4f530d3c8c9cb69b732be94b1"><div class="ttname"><a href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1">id_equal</a></div><div class="ttdeci">bool id_equal(const uint8_t *dest, const uint8_t *src)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00061">util.c:61</a></div></div>
<div class="ttc" id="network_8c_html_a7b90f87f3ba60cc5c66dd6dd77cd5cb1"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1">sendpacket</a></div><div class="ttdeci">int sendpacket(Networking_Core *net, IP_Port ip_port, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00295">network.c:295</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_cgraph" id="df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_cgraph">
<area shape="rect" id="node2" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="160,5,231,32"/><area shape="rect" id="node3" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="162,56,229,83"/><area shape="rect" id="node4" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="151,107,240,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_icgraph" id="df/dad/_d_h_t_8h_a91072d384a61a04ac1e4d679dc7efb3a_icgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#aa8dd9b8abd89728492c0c9c6299c0a8b" title="cryptopacket_handle" alt="" coords="151,132,293,159"/><area shape="rect" id="node3" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="341,132,423,159"/><area shape="rect" id="node4" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="504,31,555,57"/><area shape="rect" id="node5" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="471,81,588,108"/><area shape="rect" id="node14" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="484,132,575,159"/><area shape="rect" id="node16" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="476,183,583,209"/><area shape="rect" id="node17" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="472,233,587,260"/><area shape="rect" id="node6" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="664,31,715,57"/><area shape="rect" id="node7" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="654,81,725,108"/><area shape="rect" id="node8" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="791,5,897,32"/><area shape="rect" id="node9" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="812,56,876,83"/><area shape="rect" id="node11" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="805,107,883,133"/><area shape="rect" id="node13" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="819,157,869,184"/><area shape="rect" id="node10" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="945,56,996,83"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="945,107,996,133"/><area shape="rect" id="node15" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="636,132,743,159"/><area shape="rect" id="node18" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="636,233,743,260"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aee23d763e291eefd141227cd9e3684ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int route_tofriend </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d15/struct_d_h_t.html">DHT</a> *&#160;</td>
          <td class="paramname"><em>dht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>friend_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01562">1562</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00105">Client_data::assoc4</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00106">Client_data::assoc6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00052">BAD_NODE_TIMEOUT</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01494">friend_iplist()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00437">friend_number()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT::friends_list</a>, <a class="el" href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">i</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../d6/d6e/network_8c_source.html#l00780">ip_isset()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00093">IPPTsPng::ip_port</a>, <a class="el" href="../../de/df1/util_8c_source.html#l00054">is_timeout()</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00032">MAX_FRIEND_CLIENTS</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT::net</a>, <a class="el" href="../../d9/d35/tox__test_8c_source.html#l00246">num</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00099">IPPTsPng::ret_ip_port</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00100">IPPTsPng::ret_timestamp</a>, and <a class="el" href="../../d6/d6e/network_8c_source.html#l00295">sendpacket()</a>.</p>

<p>Referenced by <a class="el" href="../../db/d79/onion__client_8c_source.html#l00858">send_dht_dhtpk()</a>, and <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01666">send_NATping()</a>.</p>
<div class="fragment"><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;{</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a> = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b">friend_number</a>(dht, <a class="code" href="../../d8/dda/messenger__test_8c.html#a5d7925718457bca84bda0952f9463a3c">friend_id</a>);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">if</span> (num == -1)</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    uint32_t <a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, sent = 0;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    uint8_t friend_sent[<a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>] = {0};</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <a class="code" href="../../db/d14/struct_i_p___port.html">IP_Port</a> ip_list[<a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>];</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordtype">int</span> ip_num = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a1b3c1814260eace443e6feb13227cc82">friend_iplist</a>(dht, ip_list, num);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">if</span> (ip_num &lt; (<a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a> / 4))</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">return</span> 0; <span class="comment">/* Reason for that? */</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <a class="code" href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a> *<span class="keyword">friend</span> = &amp;dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">friends_list</a>[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>];</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <a class="code" href="../../d8/d1c/struct_client__data.html">Client_data</a> *client;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">/* extra legwork, because having the outside allocating the space for us</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">     * is *usually* good(tm) (bites us in the behind in this case though) */</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    uint32_t a;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="keywordflow">for</span> (a = 0; a &lt; 2; a++)</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a>; ++<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            <span class="keywordflow">if</span> (friend_sent[i])<span class="comment">/* Send one packet per client.*/</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            client = &amp;<span class="keyword">friend</span>-&gt;client_list[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <a class="code" href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a> *assoc = NULL;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            <span class="keywordflow">if</span> (!a)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                assoc = &amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">assoc4</a>;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                assoc = &amp;client-&gt;<a class="code" href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">assoc6</a>;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <span class="comment">/* If ip is not zero and node is good. */</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a>(&amp;assoc-&gt;<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a28f2dcc657352ee4855d05ed42e4a4af">ret_ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>) &amp;&amp;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                    !<a class="code" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a>(assoc-&gt;<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a5a40b83400feebb632862f593ad5e4a7">ret_timestamp</a>, <a class="code" href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a>)) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                <span class="keywordtype">int</span> retval = <a class="code" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1">sendpacket</a>(dht-&gt;<a class="code" href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">net</a>, assoc-&gt;<a class="code" href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>, packet, length);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)retval == length) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                    ++sent;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                    friend_sent[<a class="code" href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">return</span> sent;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;}</div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">IPPTsPng::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00093">DHT.h:93</a></div></div>
<div class="ttc" id="struct_client__data_html_ac9843379cbcd02bdfa5c180a1474a6c5"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#ac9843379cbcd02bdfa5c180a1474a6c5">Client_data::assoc4</a></div><div class="ttdeci">IPPTsPng assoc4</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00105">DHT.h:105</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a6cbd0f66d63003cc0def913dc7a4254b"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b">friend_number</a></div><div class="ttdeci">static int friend_number(const DHT *dht, const uint8_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00437">DHT.c:437</a></div></div>
<div class="ttc" id="messenger__test_8c_html_a5d7925718457bca84bda0952f9463a3c"><div class="ttname"><a href="../../d8/dda/messenger__test_8c.html#a5d7925718457bca84bda0952f9463a3c">friend_id</a></div><div class="ttdeci">unsigned char * friend_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dda/messenger__test_8c_source.html#l00037">messenger_test.c:37</a></div></div>
<div class="ttc" id="struct_d_h_t___friend_html"><div class="ttname"><a href="../../d0/d55/struct_d_h_t___friend.html">DHT_Friend</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00126">DHT.h:126</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a28f2dcc657352ee4855d05ed42e4a4af"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a28f2dcc657352ee4855d05ed42e4a4af">IPPTsPng::ret_ip_port</a></div><div class="ttdeci">IP_Port ret_ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00099">DHT.h:99</a></div></div>
<div class="ttc" id="struct_client__data_html"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html">Client_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00103">DHT.h:103</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html">IPPTsPng</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00092">DHT.h:92</a></div></div>
<div class="ttc" id="util_8c_html_ab643c84141e04b54ba650c50165ba288"><div class="ttname"><a href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288">is_timeout</a></div><div class="ttdeci">int is_timeout(uint64_t timestamp, uint64_t timeout)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df1/util_8c_source.html#l00054">util.c:54</a></div></div>
<div class="ttc" id="network_8c_html_ac56c677f4bc8bf8311370ee105ae7cbb"><div class="ttname"><a href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb">ip_isset</a></div><div class="ttdeci">int ip_isset(const IP *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00780">network.c:780</a></div></div>
<div class="ttc" id="struct_client__data_html_a87d394929a2604f6f785fec949fac618"><div class="ttname"><a href="../../d8/d1c/struct_client__data.html#a87d394929a2604f6f785fec949fac618">Client_data::assoc6</a></div><div class="ttdeci">IPPTsPng assoc6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00106">DHT.h:106</a></div></div>
<div class="ttc" id="struct_d_h_t_html_ae97c6b057d770e7c4f3905cbe33b188b"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#ae97c6b057d770e7c4f3905cbe33b188b">DHT::friends_list</a></div><div class="ttdeci">DHT_Friend * friends_list</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00213">DHT.h:213</a></div></div>
<div class="ttc" id="struct_d_h_t_html_aa14ea2f67950f57fe4235d7375a2216c"><div class="ttname"><a href="../../de/d15/struct_d_h_t.html#aa14ea2f67950f57fe4235d7375a2216c">DHT::net</a></div><div class="ttdeci">Networking_Core * net</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00201">DHT.h:201</a></div></div>
<div class="ttc" id="tox__test_8c_html_abea371f9030e15a5d2a4c181576833d8"><div class="ttname"><a href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a></div><div class="ttdeci">uint8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/tox__test_8c_source.html#l00246">tox_test.c:246</a></div></div>
<div class="ttc" id="struct_i_p___port_html"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html">IP_Port</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00162">network.h:162</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a1b3c1814260eace443e6feb13227cc82"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a1b3c1814260eace443e6feb13227cc82">friend_iplist</a></div><div class="ttdeci">static int friend_iplist(const DHT *dht, IP_Port *ip_portlist, uint16_t friend_num)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l01494">DHT.c:1494</a></div></div>
<div class="ttc" id="struct_i_p_p_ts_png_html_a5a40b83400feebb632862f593ad5e4a7"><div class="ttname"><a href="../../de/d25/struct_i_p_p_ts_png.html#a5a40b83400feebb632862f593ad5e4a7">IPPTsPng::ret_timestamp</a></div><div class="ttdeci">uint64_t ret_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00100">DHT.h:100</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="toxav__many__test_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d6/dc0/toxav__many__test_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc0/toxav__many__test_8c_source.html#l00278">toxav_many_test.c:278</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a2c542fd03a43f340d1fb281afe54453f"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a2c542fd03a43f340d1fb281afe54453f">BAD_NODE_TIMEOUT</a></div><div class="ttdeci">#define BAD_NODE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00052">DHT.h:52</a></div></div>
<div class="ttc" id="network_8c_html_a7b90f87f3ba60cc5c66dd6dd77cd5cb1"><div class="ttname"><a href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1">sendpacket</a></div><div class="ttdeci">int sendpacket(Networking_Core *net, IP_Port ip_port, const uint8_t *data, uint16_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6e/network_8c_source.html#l00295">network.c:295</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ad50d158518277ca4d19cbe364f3e958c"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ad50d158518277ca4d19cbe364f3e958c">MAX_FRIEND_CLIENTS</a></div><div class="ttdeci">#define MAX_FRIEND_CLIENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00032">DHT.h:32</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_cgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_cgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_cgraph" id="df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_cgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a1b3c1814260eace443e6feb13227cc82" title="friend_iplist" alt="" coords="163,107,251,133"/><area shape="rect" id="node4" href="../../d6/d6e/network_8c.html#ac56c677f4bc8bf8311370ee105ae7cbb" title="ip_isset" alt="" coords="315,95,381,121"/><area shape="rect" id="node5" href="../../de/df1/util_8c.html#ab643c84141e04b54ba650c50165ba288" title="is_timeout" alt="" coords="307,145,389,172"/><area shape="rect" id="node7" href="../../dc/dc1/_d_h_t_8c.html#a6cbd0f66d63003cc0def913dc7a4254b" title="friend_number" alt="" coords="155,5,259,32"/><area shape="rect" id="node8" href="../../d6/d6e/network_8c.html#a7b90f87f3ba60cc5c66dd6dd77cd5cb1" title="sendpacket" alt="" coords="162,208,251,235"/><area shape="rect" id="node3" href="../../de/df1/util_8c.html#ada3d44b4f530d3c8c9cb69b732be94b1" title="id_equal" alt="" coords="313,19,383,45"/><area shape="rect" id="node6" href="../../de/df1/util_8c.html#ac958d9f8847cb8039444bfa3d304233a" title="unix_time" alt="" coords="437,145,516,172"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_icgraph" id="df/dad/_d_h_t_8h_aee23d763e291eefd141227cd9e3684ab_icgraph">
<area shape="rect" id="node2" href="../../db/d79/onion__client_8c.html#a35bf565e3fc2b84ba3434d7cb38ba0e4" title="send_dht_dhtpk" alt="" coords="155,67,269,94"/><area shape="rect" id="node16" href="../../dc/dc1/_d_h_t_8c.html#a25f7b3704b34bb8745a0a60939e1f49c" title="send_NATping" alt="" coords="339,118,447,145"/><area shape="rect" id="node3" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="317,67,469,94"/><area shape="rect" id="node4" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="539,67,614,94"/><area shape="rect" id="node5" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="684,67,796,94"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="862,67,943,94"/><area shape="rect" id="node8" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="849,17,956,43"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1009,121,1116,147"/><area shape="rect" id="node9" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1037,70,1088,97"/><area shape="rect" id="node10" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1021,19,1104,46"/><area shape="rect" id="node11" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1164,82,1271,109"/><area shape="rect" id="node12" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1191,133,1243,159"/><area shape="rect" id="node13" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1319,86,1369,113"/><area shape="rect" id="node14" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1181,31,1254,58"/><area shape="rect" id="node15" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1319,189,1369,215"/><area shape="rect" id="node17" href="../../dc/dc1/_d_h_t_8c.html#a9243f57fde4a9312f11575eb4e7b1275" title="do_NAT" alt="" coords="541,118,612,145"/><area shape="rect" id="node22" href="../../dc/dc1/_d_h_t_8c.html#a9684ffd3987f6c79663c1f07eed0c007" title="handle_NATping" alt="" coords="517,219,636,246"/><area shape="rect" id="node18" href="../../df/dad/_d_h_t_8h.html#a5be9dfb66fbf1fa7c267b016f3357534" title="do_DHT" alt="" coords="705,118,775,145"/><area shape="rect" id="node19" href="../../d7/dd9/onion__test_8c.html#a3c2943b251ccd76e2814f77ada04f51e" title="do_onion" alt="" coords="865,118,940,145"/><area shape="rect" id="node21" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="877,169,928,195"/><area shape="rect" id="node20" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1009,245,1116,271"/><area shape="rect" id="node23" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="699,245,781,271"/><area shape="rect" id="node24" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="844,371,961,398"/><area shape="rect" id="node31" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="857,219,948,246"/><area shape="rect" id="node32" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="845,270,960,297"/><area shape="rect" id="node25" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1037,371,1088,398"/><area shape="rect" id="node26" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1027,295,1098,322"/><area shape="rect" id="node27" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1164,243,1271,270"/><area shape="rect" id="node28" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1185,190,1249,217"/><area shape="rect" id="node29" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1178,345,1257,371"/><area shape="rect" id="node30" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1192,294,1243,321"/><area shape="rect" id="node33" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="1009,194,1116,221"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a74120ec4fc551572bff2a08436854c97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int to_host_family </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d6d/struct_i_p.html">IP</a> *&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00167">167</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d9/d94/network_8h_source.html#l00154">IP::family</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00055">TOX_AF_INET</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00056">TOX_AF_INET6</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d18/onion_8c_source.html#l00064">ip_unpack()</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == <a class="code" href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a>) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = AF_INET;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == <a class="code" href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a>) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = AF_INET6;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a025adcf535ab2c7123fb5ea22fe20bbd"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a></div><div class="ttdeci">#define TOX_AF_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00056">DHT.h:56</a></div></div>
<div class="ttc" id="struct_i_p_html_adad4493a852deb413bb8c515368deaac"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">IP::family</a></div><div class="ttdeci">uint8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ac35a63082a23b6ced97c0a3a24ba06be"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a></div><div class="ttdeci">#define TOX_AF_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00055">DHT.h:55</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a74120ec4fc551572bff2a08436854c97_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a74120ec4fc551572bff2a08436854c97_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a74120ec4fc551572bff2a08436854c97_icgraph" id="df/dad/_d_h_t_8h_a74120ec4fc551572bff2a08436854c97_icgraph">
<area shape="rect" id="node2" href="../../d4/d18/onion_8c.html#a0687fad9fd17ea53d6b84a6cfc7e0d78" title="ip_unpack" alt="" coords="160,208,241,235"/><area shape="rect" id="node3" href="../../d4/d18/onion_8c.html#a5134cc15375a918b584e3c408e038331" title="ipport_unpack" alt="" coords="289,208,392,235"/><area shape="rect" id="node4" href="../../d3/db9/onion_8h.html#a112ff3dd6d8a1e104516eb4b465fc2fa" title="onion_send_1" alt="" coords="442,81,545,108"/><area shape="rect" id="node36" href="../../d4/d18/onion_8c.html#af8b808b43786292e39b10d6e05ba1cb7" title="handle_send_1" alt="" coords="610,132,719,159"/><area shape="rect" id="node37" href="../../d4/d18/onion_8c.html#a60a847c1f3f33f8e2efdc13ede5f7ecc" title="handle_send_2" alt="" coords="610,183,719,209"/><area shape="rect" id="node38" href="../../d4/d18/onion_8c.html#aad67ae9de051b78358faf690eaa03099" title="handle_recv_3" alt="" coords="440,233,547,260"/><area shape="rect" id="node39" href="../../d4/d18/onion_8c.html#a2efffc024cccd53f433718980ccf4541" title="handle_recv_2" alt="" coords="440,284,547,311"/><area shape="rect" id="node40" href="../../d4/d18/onion_8c.html#a733219ca8d321d01a999f10447b2e301" title="handle_recv_1" alt="" coords="440,335,547,361"/><area shape="rect" id="node5" href="../../d4/d18/onion_8c.html#ad1a4dfd05094ff479cda552ed94059f7" title="handle_send_initial" alt="" coords="599,81,731,108"/><area shape="rect" id="node20" href="../../d4/d40/_t_c_p__server_8c.html#a904af6fcbd24cb3f75c4a04470be46de" title="handle_TCP_packet" alt="" coords="595,31,735,57"/><area shape="rect" id="node6" href="../../d3/db9/onion_8h.html#a71877ec5931feec418ed1ae10b0963d8" title="new_onion" alt="" coords="825,208,909,235"/><area shape="rect" id="node7" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1004,107,1111,133"/><area shape="rect" id="node8" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1012,157,1103,184"/><area shape="rect" id="node10" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1553,183,1603,209"/><area shape="rect" id="node11" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1359,259,1476,285"/><area shape="rect" id="node9" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="1183,157,1290,184"/><area shape="rect" id="node12" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1553,309,1603,336"/><area shape="rect" id="node13" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1543,259,1613,285"/><area shape="rect" id="node14" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1680,208,1787,235"/><area shape="rect" id="node15" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1701,259,1765,285"/><area shape="rect" id="node17" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1849,309,1927,336"/><area shape="rect" id="node19" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1708,360,1759,387"/><area shape="rect" id="node16" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1863,247,1913,273"/><area shape="rect" id="node18" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1989,221,2040,248"/><area shape="rect" id="node21" href="../../d4/d40/_t_c_p__server_8c.html#a00813f259948ef060f6ab7ec40da2f2c" title="confirm_TCP_connection" alt="" coords="783,56,952,83"/><area shape="rect" id="node34" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="801,5,933,32"/><area shape="rect" id="node22" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="1000,56,1115,83"/><area shape="rect" id="node23" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="1163,56,1311,83"/><area shape="rect" id="node24" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5" title="do_TCP_server" alt="" coords="1361,56,1474,83"/><area shape="rect" id="node25" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1525,5,1631,32"/><area shape="rect" id="node26" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="1524,56,1632,83"/><area shape="rect" id="node28" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1525,107,1631,133"/><area shape="rect" id="node27" href="../../d2/d8d/_t_c_p__test_8c.html#a0ee98d716eb7311dd4b6d217289734ff" title="START_TEST" alt="" coords="1680,56,1787,83"/><area shape="rect" id="node29" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1708,157,1759,184"/><area shape="rect" id="node30" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1692,107,1775,133"/><area shape="rect" id="node31" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1835,171,1941,197"/><area shape="rect" id="node32" href="../../d6/dc0/toxav__many__test_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39" title="while" alt="" coords="1862,69,1914,96"/><area shape="rect" id="node33" href="../../d2/d65/n_tox_8c.html#a1e3c1630c0ca8b687a6a878aa27dd69c" title="line_eval" alt="" coords="1851,120,1925,147"/><area shape="rect" id="node35" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="1169,5,1304,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae7f65a76f9c4b0093f45fc1777238459"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void to_net_family </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d6d/struct_i_p.html">IP</a> *&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00159">159</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d9/d94/network_8h_source.html#l00154">IP::family</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00055">TOX_AF_INET</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00056">TOX_AF_INET6</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d18/onion_8c_source.html#l00049">ip_pack()</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == AF_INET)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = <a class="code" href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> == AF_INET6)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        ip-&gt;<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = <a class="code" href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="ttc" id="_d_h_t_8h_html_a025adcf535ab2c7123fb5ea22fe20bbd"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a></div><div class="ttdeci">#define TOX_AF_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00056">DHT.h:56</a></div></div>
<div class="ttc" id="struct_i_p_html_adad4493a852deb413bb8c515368deaac"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">IP::family</a></div><div class="ttdeci">uint8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ac35a63082a23b6ced97c0a3a24ba06be"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a></div><div class="ttdeci">#define TOX_AF_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00055">DHT.h:55</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_ae7f65a76f9c4b0093f45fc1777238459_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_ae7f65a76f9c4b0093f45fc1777238459_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_ae7f65a76f9c4b0093f45fc1777238459_icgraph" id="df/dad/_d_h_t_8h_ae7f65a76f9c4b0093f45fc1777238459_icgraph">
<area shape="rect" id="node2" href="../../d4/d18/onion_8c.html#a6b9b6abcbb6fde502e7822236a978118" title="ip_pack" alt="" coords="153,273,220,300"/><area shape="rect" id="node3" href="../../d4/d18/onion_8c.html#ae9d8dde9317c06fe493658b8145de853" title="ipport_pack" alt="" coords="268,273,357,300"/><area shape="rect" id="node4" href="../../d3/db9/onion_8h.html#a34cf7934690ab5336b99844383a445a8" title="create_onion_packet" alt="" coords="417,107,560,133"/><area shape="rect" id="node35" href="../../d3/db9/onion_8h.html#ab04a946f429ee9f9e79ac83e95ec6271" title="create_onion_packet_tcp" alt="" coords="405,192,572,219"/><area shape="rect" id="node36" href="../../d3/db9/onion_8h.html#a112ff3dd6d8a1e104516eb4b465fc2fa" title="onion_send_1" alt="" coords="437,375,540,401"/><area shape="rect" id="node49" href="../../d4/d18/onion_8c.html#af8b808b43786292e39b10d6e05ba1cb7" title="handle_send_1" alt="" coords="434,273,543,300"/><area shape="rect" id="node50" href="../../d4/d18/onion_8c.html#a60a847c1f3f33f8e2efdc13ede5f7ecc" title="handle_send_2" alt="" coords="434,324,543,351"/><area shape="rect" id="node5" href="../../d3/db9/onion_8h.html#af06edfff31b42d31803e24fc7f47d365" title="send_onion_packet" alt="" coords="872,56,1007,83"/><area shape="rect" id="node7" href="../../d7/dfd/onion__announce_8h.html#adf4563e859323282731b183ef62cfbcc" title="send_announce_request" alt="" coords="632,107,795,133"/><area shape="rect" id="node8" href="../../d7/dfd/onion__announce_8h.html#a16a4948e44b16b56b9c0de61d2988082" title="send_data_request" alt="" coords="647,5,779,32"/><area shape="rect" id="node9" href="../../db/d79/onion__client_8c.html#a4be9a76607f006a407f4f96dd49f25da" title="send_onion_packet_tcp_udp" alt="" coords="620,171,807,197"/><area shape="rect" id="node6" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1095,31,1201,57"/><area shape="rect" id="node10" href="../../db/d79/onion__client_8c.html#a4253f1739f978c9aac584c97b7a55f48" title="client_send_announce\l_request" alt="" coords="864,158,1015,199"/><area shape="rect" id="node31" href="../../d9/d26/onion__client_8h.html#aa1be42b5ea93bd068f47271831157927" title="send_onion_data" alt="" coords="879,224,999,251"/><area shape="rect" id="node11" href="../../db/d79/onion__client_8c.html#a934df896ad375a9dbd82f563fb27144f" title="client_ping_nodes" alt="" coords="1085,233,1211,260"/><area shape="rect" id="node26" href="../../db/d79/onion__client_8c.html#a02301d507ab3c11bfee8112560f36f87" title="do_friend" alt="" coords="1326,132,1401,159"/><area shape="rect" id="node30" href="../../db/d79/onion__client_8c.html#ae37f00e2304222b24cef2cce370e58d3" title="do_announce" alt="" coords="1314,81,1413,108"/><area shape="rect" id="node12" href="../../db/d79/onion__client_8c.html#acef82e3853e62dce8cd45450ff028f97" title="handle_announce_response" alt="" coords="1272,217,1455,244"/><area shape="rect" id="node13" href="../../db/d79/onion__client_8c.html#a3519dd95525df398b46b0e4a928f54f0" title="handle_tcp_onion" alt="" coords="1503,183,1625,209"/><area shape="rect" id="node14" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="1673,233,1796,260"/><area shape="rect" id="node15" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="1857,233,1948,260"/><area shape="rect" id="node17" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1844,284,1961,311"/><area shape="rect" id="node16" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="2009,208,2116,235"/><area shape="rect" id="node18" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2037,321,2088,348"/><area shape="rect" id="node19" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="2027,271,2098,297"/><area shape="rect" id="node20" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="2164,195,2271,221"/><area shape="rect" id="node21" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="2185,245,2249,272"/><area shape="rect" id="node23" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="2178,296,2257,323"/><area shape="rect" id="node25" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2192,347,2243,373"/><area shape="rect" id="node22" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2319,245,2369,272"/><area shape="rect" id="node24" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2319,296,2369,323"/><area shape="rect" id="node27" href="../../d9/d26/onion__client_8h.html#aa1771a7c1ebf446973e8d2bbb7ea8c2d" title="do_onion_client" alt="" coords="1508,132,1620,159"/><area shape="rect" id="node28" href="../../d7/dd9/onion__test_8c.html#ab45bd517e9eb750ba65272a4a8ebc250" title="do_onions" alt="" coords="1862,183,1943,209"/><area shape="rect" id="node29" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1681,284,1788,311"/><area shape="rect" id="node32" href="../../d0/d08/friend__connection_8h.html#a2af492c22c086276ed147d0826839d25" title="send_friend_request\l_packet" alt="" coords="1294,269,1433,310"/><area shape="rect" id="node34" href="../../db/d79/onion__client_8c.html#a64e317f7dd22c983c325f62aed9ecfae" title="send_dhtpk_announce" alt="" coords="1072,183,1224,209"/><area shape="rect" id="node33" href="../../d8/d8d/_messenger_8c.html#a5e3bee5110a3531eedb8f92ffd600af8" title="do_friends" alt="" coords="1523,284,1605,311"/><area shape="rect" id="node37" href="../../d4/d18/onion_8c.html#ad1a4dfd05094ff479cda552ed94059f7" title="handle_send_initial" alt="" coords="647,375,779,401"/><area shape="rect" id="node40" href="../../d4/d40/_t_c_p__server_8c.html#a904af6fcbd24cb3f75c4a04470be46de" title="handle_TCP_packet" alt="" coords="643,487,783,513"/><area shape="rect" id="node38" href="../../d3/db9/onion_8h.html#a71877ec5931feec418ed1ae10b0963d8" title="new_onion" alt="" coords="897,335,981,361"/><area shape="rect" id="node39" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1709,436,1760,463"/><area shape="rect" id="node41" href="../../d4/d40/_t_c_p__server_8c.html#a00813f259948ef060f6ab7ec40da2f2c" title="confirm_TCP_connection" alt="" coords="855,537,1024,564"/><area shape="rect" id="node47" href="../../d4/d40/_t_c_p__server_8c.html#ab84742dd52ed6c8e83287ea5202e4326" title="do_confirmed_recv" alt="" coords="873,487,1005,513"/><area shape="rect" id="node42" href="../../d4/d40/_t_c_p__server_8c.html#a8cdae1ef768b85b02dcc79ff2258606f" title="do_unconfirmed" alt="" coords="1091,537,1205,564"/><area shape="rect" id="node43" href="../../d4/d40/_t_c_p__server_8c.html#aed90b296bcb98bcb905565ae68548c9a" title="do_TCP_unconfirmed" alt="" coords="1289,537,1437,564"/><area shape="rect" id="node44" href="../../d6/d03/_t_c_p__server_8h.html#a40e8a0302a359dd4f712eb1e9c346fe5" title="do_TCP_server" alt="" coords="1507,487,1621,513"/><area shape="rect" id="node45" href="../../d2/d8d/_t_c_p__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="1681,487,1788,513"/><area shape="rect" id="node46" href="../../d2/d8d/_t_c_p__test_8c.html#a8958ca530ce6534e81eaa06e582a26ad" title="new_TCP_con" alt="" coords="1681,537,1789,564"/><area shape="rect" id="node48" href="../../d4/d40/_t_c_p__server_8c.html#a001f38d27860442b6fe9fe7dd030a7a0" title="do_TCP_confirmed" alt="" coords="1081,487,1215,513"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45b33af842c0289c78c70f81e854ed62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int unpack_nodes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d53/struct_node__format.html">Node_format</a> *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>max_num_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>processed_data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>tcp_enabled</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00268">268</a> of file <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html">DHT.c</a>.</p>

<p>References <a class="el" href="../../d9/d94/network_8h_source.html#l00154">IP::family</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00163">IP_Port::ip</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00149">Node_format::ip_port</a>, <a class="el" href="../../d9/d35/tox__test_8c_source.html#l00246">num</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00180">PACKED_NODE_SIZE_IP4</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l00181">PACKED_NODE_SIZE_IP6</a>, <a class="el" href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile::public_key</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00171">SIZE_IP4</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00172">SIZE_IP6</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00132">TCP_INET</a>, <a class="el" href="../../d9/d94/network_8h_source.html#l00133">TCP_INET6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00055">TOX_AF_INET</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00056">TOX_AF_INET6</a>, <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00057">TOX_TCP_INET</a>, and <a class="el" href="../../df/dad/_d_h_t_8h_source.html#l00058">TOX_TCP_INET6</a>.</p>

<p>Referenced by <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l02409">dht_load_state_callback()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00611">handle_announce_response()</a>, <a class="el" href="../../db/d79/onion__client_8c_source.html#l00703">handle_dhtpk_announce()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01974">handle_hardening()</a>, <a class="el" href="../../d2/db1/friend__connection_8c_source.html#l00375">handle_packet()</a>, <a class="el" href="../../dc/dc1/_d_h_t_8c_source.html#l01077">handle_sendnodes_core()</a>, and <a class="el" href="../../d8/d8d/_messenger_8c_source.html#l02648">messenger_load_state_callback()</a>.</p>
<div class="fragment"><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    uint32_t <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a> = 0, len_processed = 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">while</span> (num &lt; max_num_nodes &amp;&amp; len_processed &lt; length) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordtype">int</span> ipv6 = -1;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        uint8_t host_family;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[len_processed] == <a class="code" href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a>) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            ipv6 = 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            host_family = AF_INET;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[len_processed] == <a class="code" href="../../df/dad/_d_h_t_8h.html#ab59616c5422ae79ebc665059761879d5">TOX_TCP_INET</a>) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">if</span> (!tcp_enabled)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            ipv6 = 0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            host_family = <a class="code" href="../../d9/d94/network_8h.html#a38cdd2f189180d6790d5b181f55ca047">TCP_INET</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[len_processed] == <a class="code" href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a>) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            ipv6 = 1;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            host_family = AF_INET6;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a>[len_processed] == <a class="code" href="../../df/dad/_d_h_t_8h.html#a30bf86f2e1f87bcbd6a90145943aabac">TOX_TCP_INET6</a>) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span> (!tcp_enabled)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            ipv6 = 1;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            host_family = <a class="code" href="../../d9/d94/network_8h.html#a7cd884776d628ca50049592d963c10cc">TCP_INET6</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (ipv6 == 0) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            uint32_t size = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span> (len_processed + size &gt; length)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            nodes[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = host_family;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            memcpy(&amp;nodes[num].ip_port.ip.ip4, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + len_processed + 1, <a class="code" href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            memcpy(&amp;nodes[num].ip_port.port, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + len_processed + 1 + <a class="code" href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a>, <span class="keyword">sizeof</span>(uint16_t));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            memcpy(nodes[num].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + len_processed + 1 + <a class="code" href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a> + <span class="keyword">sizeof</span>(uint16_t), crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            len_processed += size;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            ++<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ipv6 == 1) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            uint32_t size = <a class="code" href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">if</span> (len_processed + size &gt; length)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            nodes[<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>].<a class="code" href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">ip_port</a>.<a class="code" href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">ip</a>.<a class="code" href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">family</a> = host_family;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            memcpy(&amp;nodes[num].ip_port.ip.ip6, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + len_processed + 1, <a class="code" href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            memcpy(&amp;nodes[num].ip_port.port, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + len_processed + 1 + <a class="code" href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a>, <span class="keyword">sizeof</span>(uint16_t));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            memcpy(nodes[num].<a class="code" href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">public_key</a>, <a class="code" href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">data</a> + len_processed + 1 + <a class="code" href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a> + <span class="keyword">sizeof</span>(uint16_t), crypto_box_PUBLICKEYBYTES);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            len_processed += size;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            ++<a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (processed_data_len)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        *processed_data_len = len_processed;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="ttc" id="network_8h_html_af01e75c1c63a39bcd2aacdf3018b18c9"><div class="ttname"><a href="../../d9/d94/network_8h.html#af01e75c1c63a39bcd2aacdf3018b18c9">SIZE_IP4</a></div><div class="ttdeci">#define SIZE_IP4</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00171">network.h:171</a></div></div>
<div class="ttc" id="network_8h_html_a38cdd2f189180d6790d5b181f55ca047"><div class="ttname"><a href="../../d9/d94/network_8h.html#a38cdd2f189180d6790d5b181f55ca047">TCP_INET</a></div><div class="ttdeci">#define TCP_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00132">network.h:132</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a03601baefa220335487dfc838c08d268"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a03601baefa220335487dfc838c08d268">PACKED_NODE_SIZE_IP4</a></div><div class="ttdeci">#define PACKED_NODE_SIZE_IP4</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00180">DHT.c:180</a></div></div>
<div class="ttc" id="network_8h_html_a5d7430ad26f80239b9fe1bbcd51b5ed2"><div class="ttname"><a href="../../d9/d94/network_8h.html#a5d7430ad26f80239b9fe1bbcd51b5ed2">SIZE_IP6</a></div><div class="ttdeci">#define SIZE_IP6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00172">network.h:172</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_a6734667aeff5c30ad9e5624ccb556a87"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#a6734667aeff5c30ad9e5624ccb556a87">make-funny-savefile.public_key</a></div><div class="ttdeci">list public_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00068">make-funny-savefile.py:68</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a025adcf535ab2c7123fb5ea22fe20bbd"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a025adcf535ab2c7123fb5ea22fe20bbd">TOX_AF_INET6</a></div><div class="ttdeci">#define TOX_AF_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00056">DHT.h:56</a></div></div>
<div class="ttc" id="network_8h_html_a7cd884776d628ca50049592d963c10cc"><div class="ttname"><a href="../../d9/d94/network_8h.html#a7cd884776d628ca50049592d963c10cc">TCP_INET6</a></div><div class="ttdeci">#define TCP_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00133">network.h:133</a></div></div>
<div class="ttc" id="tox__test_8c_html_abea371f9030e15a5d2a4c181576833d8"><div class="ttname"><a href="../../d9/d35/tox__test_8c.html#abea371f9030e15a5d2a4c181576833d8">num</a></div><div class="ttdeci">uint8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d35/tox__test_8c_source.html#l00246">tox_test.c:246</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_a30bf86f2e1f87bcbd6a90145943aabac"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#a30bf86f2e1f87bcbd6a90145943aabac">TOX_TCP_INET6</a></div><div class="ttdeci">#define TOX_TCP_INET6</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00058">DHT.h:58</a></div></div>
<div class="ttc" id="namespacemake-funny-savefile_html_aa7a0efb8690a34f61a95b00cc723ca27"><div class="ttname"><a href="../../df/db5/namespacemake-funny-savefile.html#aa7a0efb8690a34f61a95b00cc723ca27">make-funny-savefile.data</a></div><div class="ttdeci">tuple data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d01/make-funny-savefile_8py_source.html#l00098">make-funny-savefile.py:98</a></div></div>
<div class="ttc" id="struct_i_p_html_adad4493a852deb413bb8c515368deaac"><div class="ttname"><a href="../../d4/d6d/struct_i_p.html#adad4493a852deb413bb8c515368deaac">IP::family</a></div><div class="ttdeci">uint8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00154">network.h:154</a></div></div>
<div class="ttc" id="struct_i_p___port_html_a0c6193a337a223c63411b2fe722d79ec"><div class="ttname"><a href="../../db/d14/struct_i_p___port.html#a0c6193a337a223c63411b2fe722d79ec">IP_Port::ip</a></div><div class="ttdeci">IP ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00163">network.h:163</a></div></div>
<div class="ttc" id="_d_h_t_8c_html_a9b47e23b0610a17f01902680f55d7963"><div class="ttname"><a href="../../dc/dc1/_d_h_t_8c.html#a9b47e23b0610a17f01902680f55d7963">PACKED_NODE_SIZE_IP6</a></div><div class="ttdeci">#define PACKED_NODE_SIZE_IP6</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc1/_d_h_t_8c_source.html#l00181">DHT.c:181</a></div></div>
<div class="ttc" id="struct_node__format_html_a86e2a5a56c0dd22df6e8b8a10e40f9e4"><div class="ttname"><a href="../../d3/d53/struct_node__format.html#a86e2a5a56c0dd22df6e8b8a10e40f9e4">Node_format::ip_port</a></div><div class="ttdeci">IP_Port ip_port</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00149">DHT.h:149</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ac35a63082a23b6ced97c0a3a24ba06be"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ac35a63082a23b6ced97c0a3a24ba06be">TOX_AF_INET</a></div><div class="ttdeci">#define TOX_AF_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00055">DHT.h:55</a></div></div>
<div class="ttc" id="_d_h_t_8h_html_ab59616c5422ae79ebc665059761879d5"><div class="ttname"><a href="../../df/dad/_d_h_t_8h.html#ab59616c5422ae79ebc665059761879d5">TOX_TCP_INET</a></div><div class="ttdeci">#define TOX_TCP_INET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dad/_d_h_t_8h_source.html#l00057">DHT.h:57</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dad/_d_h_t_8h_a45b33af842c0289c78c70f81e854ed62_icgraph.png" border="0" usemap="#df/dad/_d_h_t_8h_a45b33af842c0289c78c70f81e854ed62_icgraph" alt=""/></div>
<map name="df/dad/_d_h_t_8h_a45b33af842c0289c78c70f81e854ed62_icgraph" id="df/dad/_d_h_t_8h_a45b33af842c0289c78c70f81e854ed62_icgraph">
<area shape="rect" id="node2" href="../../dc/dc1/_d_h_t_8c.html#a266c420f5eb745eddcf184e316b157be" title="dht_load_state_callback" alt="" coords="170,13,333,40"/><area shape="rect" id="node4" href="../../d8/d8d/_messenger_8c.html#a122e94907e1063fdff78f54ee4b0852b" title="messenger_load_state\l_callback" alt="" coords="600,57,753,98"/><area shape="rect" id="node16" href="../../db/d79/onion__client_8c.html#acef82e3853e62dce8cd45450ff028f97" title="handle_announce_response" alt="" coords="160,317,343,344"/><area shape="rect" id="node23" href="../../db/d79/onion__client_8c.html#ac9b7f86cb71b27c5db73d341b910745c" title="handle_dhtpk_announce" alt="" coords="170,216,333,243"/><area shape="rect" id="node25" href="../../dc/dc1/_d_h_t_8c.html#aa38b3670da696f600f37989e79ce4966" title="handle_hardening" alt="" coords="410,165,533,192"/><area shape="rect" id="node31" href="../../d2/db1/friend__connection_8c.html#a5f8ad19d23bf2ff57659934d2c2eb904" title="handle_packet" alt="" coords="198,419,305,445"/><area shape="rect" id="node49" href="../../dc/dc1/_d_h_t_8c.html#a4dcc848207b2408def323b8b79b08e4a" title="handle_sendnodes_core" alt="" coords="170,115,333,141"/><area shape="rect" id="node3" href="../../df/dad/_d_h_t_8h.html#a36e42ad71b293cd0ada8a7b6de9ad86b" title="DHT_load" alt="" coords="431,13,512,40"/><area shape="rect" id="node15" href="../../d8/dda/messenger__test_8c.html#a86a26950f83bcd6bd68640da6a5c96a4" title="START_TEST" alt="" coords="623,5,730,32"/><area shape="rect" id="node5" href="../../d4/d30/_messenger_8h.html#a4871cd41d2a53b07ee4b2467a844e17e" title="messenger_load" alt="" coords="1611,317,1728,344"/><area shape="rect" id="node6" href="../../d8/dda/messenger__test_8c.html#a9c4405dc5f0fb39abca715cf5fe62007" title="START_TEST" alt="" coords="1796,317,1903,344"/><area shape="rect" id="node7" href="../../db/de9/_messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1824,469,1875,496"/><area shape="rect" id="node8" href="../../da/d8f/tox_8h.html#aa0e6afccd06a766b84a0633e259f9165" title="Creates and initialises a new Tox instance with the options passed. " alt="" coords="1814,368,1885,395"/><area shape="rect" id="node9" href="../../d0/de9/encryptsave__test_8c.html#abfc6ca1e662bc2b41efecb0b9e35cc9d" title="START_TEST" alt="" coords="1951,304,2057,331"/><area shape="rect" id="node10" href="../../db/d11/irc__syncbot_8c.html#a7a3ec256dab5cbac9fc01ff328980da7" title="init_tox" alt="" coords="1972,405,2036,432"/><area shape="rect" id="node12" href="../../d2/d65/n_tox_8c.html#ac47fc78dd12365ddfd46c70003627250" title="load_data" alt="" coords="1965,355,2043,381"/><area shape="rect" id="node14" href="../../d7/db1/tox__shell_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1979,456,2029,483"/><area shape="rect" id="node11" href="../../db/d11/irc__syncbot_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2105,456,2156,483"/><area shape="rect" id="node13" href="../../d2/d65/n_tox_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="2105,355,2156,381"/><area shape="rect" id="node17" href="../../db/d79/onion__client_8c.html#a3519dd95525df398b46b0e4a928f54f0" title="handle_tcp_onion" alt="" coords="410,368,533,395"/><area shape="rect" id="node18" href="../../d9/d26/onion__client_8h.html#a9a6ae3a9c70a5221a65bd1c9be751a2e" title="new_onion_client" alt="" coords="615,317,738,344"/><area shape="rect" id="node19" href="../../d7/dd9/onion__test_8c.html#a5945771cafdfe39074adf8ddd47ae81b" title="new_onions" alt="" coords="813,317,904,344"/><area shape="rect" id="node21" href="../../d4/d30/_messenger_8h.html#af015ea2e74c58196e0564719a6c6a112" title="new_messenger" alt="" coords="1611,368,1728,395"/><area shape="rect" id="node20" href="../../d7/dd9/onion__test_8c.html#a1bd0e98b361db6749c50308a7555a192" title="START_TEST" alt="" coords="987,317,1093,344"/><area shape="rect" id="node22" href="../../d8/dda/messenger__test_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="1824,419,1875,445"/><area shape="rect" id="node24" href="../../db/d79/onion__client_8c.html#a0686761fa3196a2bded47c2b95c7edc4" title="handle_dht_dhtpk" alt="" coords="409,267,533,293"/><area shape="rect" id="node26" href="../../df/dad/_d_h_t_8h.html#adad04fa897751b06948a172044bf1c58" title="new_DHT" alt="" coords="636,165,717,192"/><area shape="rect" id="node27" href="../../d1/d36/tox-bootstrapd_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="833,165,884,192"/><area shape="rect" id="node28" href="../../d7/dd9/onion__test_8c.html#ad7475d1539db4bb3bcf8673dd7f7cf68" title="START_TEST" alt="" coords="805,216,912,243"/><area shape="rect" id="node29" href="../../d2/d98/dht__test_8c.html#aa4b7c82b70f87539daa26f6935d06a03" title="test_addto_lists" alt="" coords="801,115,916,141"/><area shape="rect" id="node30" href="../../d2/d98/dht__test_8c.html#a1d9c8c274c7bcbb86b2c757ad3d3c0bd" title="START_TEST" alt="" coords="987,115,1093,141"/><area shape="rect" id="node32" href="../../d2/db1/friend__connection_8c.html#ad12421e11a4e0a8ca7223e0d715d2b0c" title="handle_new_connections" alt="" coords="1164,425,1332,452"/><area shape="rect" id="node34" href="../../d2/db1/friend__connection_8c.html#ac2af058fd8684e6abc7b136889f5f4e5" title="friend_new_connection" alt="" coords="394,532,549,559"/><area shape="rect" id="node33" href="../../d0/d08/friend__connection_8h.html#a319bec2419cf5fc5525af4fae03b86ef" title="new_friend_connections" alt="" coords="1380,419,1543,445"/><area shape="rect" id="node35" href="../../d2/db1/friend__connection_8c.html#a6aa37bc6ee3246c06d37000677b205e8" title="dht_ip_callback" alt="" coords="621,469,733,496"/><area shape="rect" id="node37" href="../../d2/db1/friend__connection_8c.html#a53d1bd9e6126683e05e0e14cc70d1a8a" title="dht_pk_callback" alt="" coords="982,520,1098,547"/><area shape="rect" id="node47" href="../../d0/d08/friend__connection_8h.html#aea88c3aa2deff558e9b13ed5229cbb6b" title="do_friend_connections" alt="" coords="964,591,1116,617"/><area shape="rect" id="node36" href="../../d2/db1/friend__connection_8c.html#aa293768f213199a635ce0b4a94489cdf" title="change_dht_pk" alt="" coords="803,469,914,496"/><area shape="rect" id="node38" href="../../d0/d08/friend__connection_8h.html#a04fb221a2ac726ec3ca86be7b1e63238" title="set_dht_temp_pk" alt="" coords="1187,532,1309,559"/><area shape="rect" id="node43" href="../../d0/d08/friend__connection_8h.html#a613a80a004fccd616de2a67d84a25d3c" title="new_friend_connection" alt="" coords="1171,481,1325,508"/><area shape="rect" id="node39" href="../../df/de9/toxcore_2group_8c.html#ab08da4834d9772b1ef1f3b35ae5197c1" title="connect_to_closest" alt="" coords="1394,532,1529,559"/><area shape="rect" id="node40" href="../../dd/de4/toxcore_2group_8h.html#a9529a2149c68cbff38d43419d9ebeecc" title="do_groupchats" alt="" coords="1616,571,1723,597"/><area shape="rect" id="node41" href="../../da/d8f/tox_8h.html#a649c8740c523fb52272396cb0b70b8dc" title="tox_iterate" alt="" coords="1808,532,1891,559"/><area shape="rect" id="node42" href="../../d9/d35/tox__test_8c.html#a4c612d3a3f15c8fbf2e4bde8002bc33b" title="START_TEST" alt="" coords="1951,557,2057,584"/><area shape="rect" id="node44" href="../../d8/d8d/_messenger_8c.html#aa3be5ad998d2b0ced07aceab765eaa2f" title="init_new_friend" alt="" coords="1407,469,1516,496"/><area shape="rect" id="node45" href="../../d4/d30/_messenger_8h.html#ac77431b1ab0b12af003657e11057bd9c" title="m_addfriend" alt="" coords="1623,469,1716,496"/><area shape="rect" id="node46" href="../../d4/d30/_messenger_8h.html#a2f7aa06733a25e8c0edc8f31a22a78dc" title="m_addfriend_norequest" alt="" coords="1591,419,1748,445"/><area shape="rect" id="node48" href="../../d4/d30/_messenger_8h.html#ae0686caa878183a98920aeb7486afcb6" title="do_messenger" alt="" coords="1616,520,1723,547"/><area shape="rect" id="node50" href="../../dc/dc1/_d_h_t_8c.html#ac70b27be10ded8565ffcb94829e40514" title="handle_sendnodes_ipv6" alt="" coords="391,115,552,141"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 2 2015 23:41:22 for libtoxcore by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
