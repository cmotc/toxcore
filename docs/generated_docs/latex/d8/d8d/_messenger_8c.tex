\hypertarget{_messenger_8c}{\section{toxcore/\+Messenger.c File Reference}
\label{_messenger_8c}\index{toxcore/\+Messenger.\+c@{toxcore/\+Messenger.\+c}}
}
{\ttfamily \#include \char`\"{}logger.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Messenger.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}assoc.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}network.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}util.\+h\char`\"{}}\\*
Include dependency graph for Messenger.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d23/_messenger_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{_messenger_8c_a6773b93f3093658c3dcb569de3b4bdb2}{M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H}~255
\item 
\#define \hyperlink{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E}~(\hyperlink{net__crypto_8h_a1b6e5122f9fdc5ef548ccf920f0c246e}{M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E} -\/ 2)
\item 
\#define \hyperlink{_messenger_8c_a752ad5152ba85410624aa9f3434c320c}{M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E}~(\hyperlink{net__crypto_8h_ab0d2e7f3b3f18b516bb0a512c91b2914}{C\+R\+Y\+P\+T\+O\+\_\+\+M\+I\+N\+\_\+\+Q\+U\+E\+U\+E\+\_\+\+L\+E\+N\+G\+T\+H} / 4)
\item 
\#define \hyperlink{_messenger_8c_a5e98fb56f9865b4041b3ac9f3ff1fbd7}{M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}~50
\item 
\#define \hyperlink{_messenger_8c_a3e84561adca7ef2861635cd81ed71914}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L}~0x15ed1b1f
\item 
\#define \hyperlink{_messenger_8c_a2d38314cc90c702f4cde6cfd6f7760db}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E}~0x01ce
\item 
\#define \hyperlink{_messenger_8c_af7c141a97170e9f2f3e6cf961e23c947}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S}~1
\item 
\#define \hyperlink{_messenger_8c_ae6c05fc174cd87a755972ef8f7679981}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T}~2
\item 
\#define \hyperlink{_messenger_8c_a4d8769af27d9fbce16ca1e130853bde5}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S}~3
\item 
\#define \hyperlink{_messenger_8c_afd99074ae265873e4fdff404d37394d4}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E}~4
\item 
\#define \hyperlink{_messenger_8c_a43f7448cfa20d85c9b793cbde6715ffc}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E}~5
\item 
\#define \hyperlink{_messenger_8c_a51d08227e8515e67d7969289cd18f4cd}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S}~6
\item 
\#define \hyperlink{_messenger_8c_a64f45a4a72c35453d48355edcc2fdea7}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y}~10
\item 
\#define \hyperlink{_messenger_8c_ac7f0d1335af95f7bd8fae885c1bfcfc9}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E}~11
\item 
\#define \hyperlink{_messenger_8c_ad1aedc06debd945aca3bd7cb5b6dd46f}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D}~255
\item 
\#define \hyperlink{_messenger_8c_a5546558d2255f81d24707b447cb5bb94}{S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E}~1024
\item 
\#define \hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S}~8
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{set\+\_\+friend\+\_\+status} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t status)
\item 
static int \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\+\_\+cryptpacket\+\_\+id} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t packet\+\_\+id, const uint8\+\_\+t $\ast$data, uint32\+\_\+t length, uint8\+\_\+t congestion\+\_\+control)
\item 
static uint8\+\_\+t \hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\+\_\+not\+\_\+valid} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_ade10ae2516f68845c8b2e0c5eb95bd41}{realloc\+\_\+friendlist} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num})
\item 
int32\+\_\+t \hyperlink{_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc}{getfriend\+\_\+id} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$real\+\_\+pk)
\item 
int \hyperlink{_messenger_8c_a8348df936215ea10b7c3ca129100f5ce}{get\+\_\+real\+\_\+pk} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t $\ast$real\+\_\+pk)
\item 
int \hyperlink{_messenger_8c_adde4551a2e1898aab1de8e0b7f7c9792}{getfriendcon\+\_\+id} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static uint16\+\_\+t \hyperlink{_messenger_8c_a31c1f385ae903fdf82773998b54009fc}{address\+\_\+checksum} (const uint8\+\_\+t $\ast$address, uint32\+\_\+t len)
\item 
void \hyperlink{_messenger_8c_a50d7f1102c25158f02b2943dcfe253c8}{getaddress} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint8\+\_\+t $\ast$address)
\item 
static int \hyperlink{_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b}{send\+\_\+online\+\_\+packet} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static int \hyperlink{_messenger_8c_ab4bf3c92ac721d93b6c8a014cd6ddfea}{send\+\_\+offline\+\_\+packet} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int friendcon\+\_\+id)
\item 
static int \hyperlink{_messenger_8c_a2be56d7329b8b89d95918eba9b692c71}{handle\+\_\+status} (void $\ast$object, int \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, uint8\+\_\+t status)
\item 
static int \hyperlink{_messenger_8c_a8fce9b8564a3a552ff2b77a9f81914ad}{handle\+\_\+packet} (void $\ast$object, int \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, uint8\+\_\+t $\ast$temp, uint16\+\_\+t len)
\item 
static int \hyperlink{_messenger_8c_a24c5719d515558a6e9d768a861d6dc22}{handle\+\_\+custom\+\_\+lossy\+\_\+packet} (void $\ast$object, int friend\+\_\+num, const uint8\+\_\+t $\ast$packet, uint16\+\_\+t length)
\item 
static int32\+\_\+t \hyperlink{_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f}{init\+\_\+new\+\_\+friend} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$real\+\_\+pk, uint8\+\_\+t status)
\item 
int32\+\_\+t \hyperlink{_messenger_8c_ac77431b1ab0b12af003657e11057bd9c}{m\+\_\+addfriend} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$address, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
int32\+\_\+t \hyperlink{_messenger_8c_a2f7aa06733a25e8c0edc8f31a22a78dc}{m\+\_\+addfriend\+\_\+norequest} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$real\+\_\+pk)
\item 
static int \hyperlink{_messenger_8c_a3206124b119b06401ce65affb690976d}{clear\+\_\+receipts} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static int \hyperlink{_messenger_8c_a669d4111f5309184034fcbbe4ee1372c}{add\+\_\+receipt} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t packet\+\_\+num, uint32\+\_\+t msg\+\_\+id)
\item 
static int \hyperlink{_messenger_8c_a27839390fa4224c2474ad304ee6a199c}{friend\+\_\+received\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t number)
\item 
static int \hyperlink{_messenger_8c_ac9dcb9b0a9c69f521369a559a1835c57}{do\+\_\+receipts} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_a7a7b52e12232948dfe96d8e7dea50610}{m\+\_\+delfriend} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_a4b1f7ee3f635e7a80c8f3cbe98588e4d}{m\+\_\+get\+\_\+friend\+\_\+connectionstatus} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_ac652e6df9a2c7024fae6700bb7927c61}{m\+\_\+friend\+\_\+exists} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_a23c8b52187d4ab113cce5497a19ac997}{m\+\_\+send\+\_\+message\+\_\+generic} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t type, const uint8\+\_\+t $\ast$message, uint32\+\_\+t length, uint32\+\_\+t $\ast$message\+\_\+id)
\item 
static int \hyperlink{_messenger_8c_a5328e9c55aff292c735e70c1953d49d4}{m\+\_\+sendname} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$name, uint16\+\_\+t length)
\item 
int \hyperlink{_messenger_8c_a732b3e72ea8d98d4e038f7ed83fbe5be}{setfriendname} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$name, uint16\+\_\+t length)
\item 
int \hyperlink{_messenger_8c_a74824e98cf3b2607cb8624d46cd2e227}{setname} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$name, uint16\+\_\+t length)
\item 
uint16\+\_\+t \hyperlink{_messenger_8c_a6d4bfd8f9f8ecfff61c2619988fd3bb9}{getself\+\_\+name} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint8\+\_\+t $\ast$name)
\item 
int \hyperlink{_messenger_8c_a59c33c3a3b0e1dd9f86267f59c380bee}{getname} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t $\ast$name)
\item 
int \hyperlink{_messenger_8c_aadf7f2cd48886fe7b9a38e6c63b2ff9d}{m\+\_\+get\+\_\+name\+\_\+size} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_a2a734fe4ba57e01e77ed5b7e315134eb}{m\+\_\+get\+\_\+self\+\_\+name\+\_\+size} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
int \hyperlink{_messenger_8c_ae826ef8eb56b45f67f3d37be99df7270}{m\+\_\+set\+\_\+statusmessage} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$status, uint16\+\_\+t length)
\item 
int \hyperlink{_messenger_8c_ab4a416ae0bb471de245dcbd790367420}{m\+\_\+set\+\_\+userstatus} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint8\+\_\+t status)
\item 
int \hyperlink{_messenger_8c_a84d0c0e28a2c64f66e114a69619414aa}{m\+\_\+get\+\_\+statusmessage\+\_\+size} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_a0cb2504665138d987877e8521619810f}{m\+\_\+copy\+\_\+statusmessage} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t $\ast$buf, uint32\+\_\+t maxlen)
\item 
int \hyperlink{_messenger_8c_a58e1ad3598173e54d41cb6d01e958409}{m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
int \hyperlink{_messenger_8c_ad8ece651ed3e70433480141c77f36402}{m\+\_\+copy\+\_\+self\+\_\+statusmessage} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint8\+\_\+t $\ast$buf)
\item 
uint8\+\_\+t \hyperlink{_messenger_8c_a6c699e7ecf369c5647813d60eace4099}{m\+\_\+get\+\_\+userstatus} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
uint8\+\_\+t \hyperlink{_messenger_8c_a13b0520deb579b74ec832dcfd1a94daf}{m\+\_\+get\+\_\+self\+\_\+userstatus} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
uint64\+\_\+t \hyperlink{_messenger_8c_aa8a02cf70f67a4b6ea2888fffa5c16b1}{m\+\_\+get\+\_\+last\+\_\+online} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
int \hyperlink{_messenger_8c_ab6577e36e916635816dd0de10c06150e}{m\+\_\+set\+\_\+usertyping} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t is\+\_\+typing)
\item 
int \hyperlink{_messenger_8c_aa3cd2055220195e3bd840d8f1f36281c}{m\+\_\+get\+\_\+istyping} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static int \hyperlink{_messenger_8c_a5ad1d3522f42e05278a777c9b5c70f66}{send\+\_\+statusmessage} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$status, uint16\+\_\+t length)
\item 
static int \hyperlink{_messenger_8c_aa43271679d82439481418e3251f5db4a}{send\+\_\+userstatus} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t status)
\item 
static int \hyperlink{_messenger_8c_a9cc7b7b8bc1c2acd9b63bbcc64d570df}{send\+\_\+user\+\_\+istyping} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t is\+\_\+typing)
\item 
static int \hyperlink{_messenger_8c_ad317d62e3ddf9894af11093d30cae31b}{set\+\_\+friend\+\_\+statusmessage} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$status, uint16\+\_\+t length)
\item 
static void \hyperlink{_messenger_8c_a57a114bf07876ef46d27c7cfee31137f}{set\+\_\+friend\+\_\+userstatus} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t status)
\item 
static void \hyperlink{_messenger_8c_abed35de4c690ded50f67fdaf5e96324c}{set\+\_\+friend\+\_\+typing} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t is\+\_\+typing)
\item 
void \hyperlink{_messenger_8c_ac913636e02281cae396b1b7494cd760a}{m\+\_\+callback\+\_\+friendrequest} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a5bf6f3f6a919d32a34dbd8150f26ec1e}{m\+\_\+callback\+\_\+friendmessage} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, unsigned int, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_aa23b0f583cef231f792cde932d14ee28}{m\+\_\+callback\+\_\+namechange} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_ac4c378ad47edf48aa2d17c0b78395eb4}{m\+\_\+callback\+\_\+statusmessage} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a3106958c3c2bcee8eb40a39bcc12959b}{m\+\_\+callback\+\_\+userstatus} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, unsigned int, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_ada19c886734fb0ed3c66d0235cd6fefe}{m\+\_\+callback\+\_\+typingchange} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, \+\_\+\+Bool, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a7af72369c1fa00ab940aefa25b6794f8}{m\+\_\+callback\+\_\+read\+\_\+receipt} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, uint32\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a7afea43fa4a1f455c381dc93711ed68e}{m\+\_\+callback\+\_\+connectionstatus} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, unsigned int, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a2320c0c6f211341e8757e062d3c1ca67}{m\+\_\+callback\+\_\+core\+\_\+connection} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, unsigned int, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a306c3602085500d8d23adbd52ac59006}{m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, uint8\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
static void \hyperlink{_messenger_8c_a6177eb11440d9263eae1465810989cfd}{check\+\_\+friend\+\_\+tcp\+\_\+udp} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static void \hyperlink{_messenger_8c_a2c0567bd0161368d60f7d9a93ecefa50}{break\+\_\+files} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static void \hyperlink{_messenger_8c_a961f02c4cb668e9932894d0f8969dbb1}{check\+\_\+friend\+\_\+connectionstatus} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t status)
\item 
void \hyperlink{_messenger_8c_a8f44fb569e74f4612c53da8264d16aac}{m\+\_\+callback\+\_\+group\+\_\+invite} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, uint16\+\_\+t))
\item 
int \hyperlink{_messenger_8c_a64b0347daadcf7ef303ab013481b1eb2}{send\+\_\+group\+\_\+invite\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
void \hyperlink{_messenger_8c_ac72a8b0dcbbb5d359476e1d978e1cba2}{callback\+\_\+file\+\_\+sendrequest} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, uint32\+\_\+t, uint32\+\_\+t, uint64\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a97fde93e5944768530b23c8120219f36}{callback\+\_\+file\+\_\+control} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, uint32\+\_\+t, unsigned int, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a0e2d1738c18e9220dac9e23122011de9}{callback\+\_\+file\+\_\+data} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, uint32\+\_\+t, uint64\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
void \hyperlink{_messenger_8c_a0c7a3d860cfa4e141ca842dfa107d34d}{callback\+\_\+file\+\_\+reqchunk} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, uint32\+\_\+t, uint64\+\_\+t, size\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
int \hyperlink{_messenger_8c_a974c036e51abc5ad1e409f685f8667d3}{file\+\_\+get\+\_\+id} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t filenumber, uint8\+\_\+t $\ast$file\+\_\+id)
\item 
static int \hyperlink{_messenger_8c_af0e440a0c993bf8a9adbf85b37753337}{file\+\_\+sendrequest} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t filenumber, uint32\+\_\+t file\+\_\+type, uint64\+\_\+t filesize, const uint8\+\_\+t $\ast$file\+\_\+id, const uint8\+\_\+t $\ast$filename, uint16\+\_\+t filename\+\_\+length)
\item 
long int \hyperlink{_messenger_8c_a9390d980f0320f6c53c932c7244fa504}{new\+\_\+filesender} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t file\+\_\+type, uint64\+\_\+t filesize, const uint8\+\_\+t $\ast$file\+\_\+id, const uint8\+\_\+t $\ast$filename, uint16\+\_\+t filename\+\_\+length)
\item 
int \hyperlink{_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df}{send\+\_\+file\+\_\+control\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t send\+\_\+receive, uint8\+\_\+t filenumber, uint8\+\_\+t control\+\_\+type, uint8\+\_\+t $\ast$data, uint16\+\_\+t data\+\_\+length)
\item 
int \hyperlink{_messenger_8c_a903e700229aa9c1e9bc85286c0cc538e}{file\+\_\+control} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t filenumber, unsigned int control)
\item 
int \hyperlink{_messenger_8c_afb102dea48881485a6ea82b43468b327}{file\+\_\+seek} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t filenumber, uint64\+\_\+t position)
\item 
static int64\+\_\+t \hyperlink{_messenger_8c_a2daa1e5d6fa9bc3c7c92d3cd46b11fb7}{send\+\_\+file\+\_\+data\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t filenumber, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
int \hyperlink{_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4}{file\+\_\+data} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint32\+\_\+t filenumber, uint64\+\_\+t position, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
uint64\+\_\+t \hyperlink{_messenger_8c_a5d437aa0730d3c59af535b242a64c5ef}{file\+\_\+dataremaining} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t filenumber, uint8\+\_\+t send\+\_\+receive)
\item 
static void \hyperlink{_messenger_8c_a74c09bcf488256da7b3ed899f541fc8c}{do\+\_\+reqchunk\+\_\+filecb} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber)
\item 
static int \hyperlink{_messenger_8c_a56b6a138fb4522b859fda806c8ca4c20}{handle\+\_\+filecontrol} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t receive\+\_\+send, uint8\+\_\+t filenumber, uint8\+\_\+t control\+\_\+type, uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
void \hyperlink{_messenger_8c_a6f1431ef7ea09d3bac1b93f4dfa75764}{m\+\_\+callback\+\_\+msi\+\_\+packet} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$function)(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, uint16\+\_\+t, void $\ast$), void $\ast$userdata)
\item 
int \hyperlink{_messenger_8c_a2374f56c7aeb5fa6d1a3f1a29bb5016b}{m\+\_\+msi\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
void \hyperlink{_messenger_8c_a8c615f14e641a971c44c3c6096ab54a1}{custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$\hyperlink{network_8h_a01fb3f0e3fd19ed8eefe335b64934156}{packet\+\_\+handler\+\_\+callback})(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, size\+\_\+t len, void $\ast$object), void $\ast$object)
\item 
int \hyperlink{_messenger_8c_a536d47dbfa35fb02c78068e1d11a1d2a}{m\+\_\+callback\+\_\+rtp\+\_\+packet} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, uint8\+\_\+t byte, int($\ast$\hyperlink{network_8h_a01fb3f0e3fd19ed8eefe335b64934156}{packet\+\_\+handler\+\_\+callback})(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, uint16\+\_\+t len, void $\ast$object), void $\ast$object)
\item 
int \hyperlink{_messenger_8c_a2ebb5527b47fb87384093c4aa3c384c0}{send\+\_\+custom\+\_\+lossy\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, uint32\+\_\+t length)
\item 
static int \hyperlink{_messenger_8c_a4816c8b0bbf3b241f07654a2b6593fee}{handle\+\_\+custom\+\_\+lossless\+\_\+packet} (void $\ast$object, int friend\+\_\+num, const uint8\+\_\+t $\ast$packet, uint16\+\_\+t length)
\item 
void \hyperlink{_messenger_8c_a6ab92b46caa30782c31ea7b3b8d24b45}{custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, void($\ast$\hyperlink{network_8h_a01fb3f0e3fd19ed8eefe335b64934156}{packet\+\_\+handler\+\_\+callback})(\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, size\+\_\+t len, void $\ast$object), void $\ast$object)
\item 
int \hyperlink{_messenger_8c_a14ab15b529cd99d1f87ecf21c75456e1}{send\+\_\+custom\+\_\+lossless\+\_\+packet} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, int32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, uint32\+\_\+t length)
\item 
static int \hyperlink{_messenger_8c_a7e298e314b0ad2a4e789728379ceeab2}{friend\+\_\+already\+\_\+added} (const uint8\+\_\+t $\ast$real\+\_\+pk, void $\ast$data)
\item 
\hyperlink{struct_messenger}{Messenger} $\ast$ \hyperlink{_messenger_8c_af015ea2e74c58196e0564719a6c6a112}{new\+\_\+messenger} (\hyperlink{struct_messenger___options}{Messenger\+\_\+\+Options} $\ast$options, unsigned int $\ast$\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error})
\item 
void \hyperlink{_messenger_8c_a771c65c3057d870b0653c2fdf0a12fb7}{kill\+\_\+messenger} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
static void \hyperlink{_messenger_8c_a00b3a64396035b3b700ba9d19140a201}{check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, uint64\+\_\+t t)
\item 
void \hyperlink{_messenger_8c_a5e3bee5110a3531eedb8f92ffd600af8}{do\+\_\+friends} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
static void \hyperlink{_messenger_8c_a65b3475ffdbddbf6aab3fd087c550f4b}{connection\+\_\+status\+\_\+cb} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
uint32\+\_\+t \hyperlink{_messenger_8c_ae99fff78f4ac1f79f1faa817d31c7dfe}{messenger\+\_\+run\+\_\+interval} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
void \hyperlink{_messenger_8c_ae0686caa878183a98920aeb7486afcb6}{do\+\_\+messenger} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
static uint32\+\_\+t \hyperlink{_messenger_8c_ad436fa7850d7bf55222df42ff527c375}{saved\+\_\+friendslist\+\_\+size} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
static uint32\+\_\+t \hyperlink{_messenger_8c_a25018a4f99e9bba64b138fbc5fe35eea}{friends\+\_\+list\+\_\+save} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint8\+\_\+t $\ast$data)
\item 
static int \hyperlink{_messenger_8c_ad971e0d0877b61a160884d59527d39d9}{friends\+\_\+list\+\_\+load} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$data, uint32\+\_\+t length)
\item 
uint32\+\_\+t \hyperlink{_messenger_8c_a4ae119dad636f15f1a5d628a13b107d8}{messenger\+\_\+size} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
static uint8\+\_\+t $\ast$ \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\+\_\+state\+\_\+save\+\_\+subheader} (uint8\+\_\+t $\ast$data, uint32\+\_\+t len, uint16\+\_\+t type)
\item 
void \hyperlink{_messenger_8c_af0dfac679b1b57a0036f6511e12fe777}{messenger\+\_\+save} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint8\+\_\+t $\ast$data)
\item 
static int \hyperlink{_messenger_8c_a122e94907e1063fdff78f54ee4b0852b}{messenger\+\_\+load\+\_\+state\+\_\+callback} (void $\ast$outer, const uint8\+\_\+t $\ast$data, uint32\+\_\+t length, uint16\+\_\+t type)
\item 
int \hyperlink{_messenger_8c_a4871cd41d2a53b07ee4b2467a844e17e}{messenger\+\_\+load} (\hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, const uint8\+\_\+t $\ast$data, uint32\+\_\+t length)
\item 
uint32\+\_\+t \hyperlink{_messenger_8c_ab3db39cd14385440de61a378e25f03f1}{count\+\_\+friendlist} (const \hyperlink{struct_messenger}{Messenger} $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m})
\item 
uint32\+\_\+t \hyperlink{_messenger_8c_af7181add8f82138b95e524478a3a74af}{copy\+\_\+friendlist} (\hyperlink{struct_messenger}{Messenger} const $\ast$\hyperlink{_messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}, uint32\+\_\+t $\ast$out\+\_\+list, uint32\+\_\+t list\+\_\+size)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{\index{Messenger.\+c@{Messenger.\+c}!M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E@{M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E}}
\index{M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E@{M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E~({\bf M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E} -\/ 2)}}\label{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}


Definition at line 1305 of file Messenger.\+c.



Referenced by do\+\_\+reqchunk\+\_\+filecb(), file\+\_\+data(), and handle\+\_\+packet().

\hypertarget{_messenger_8c_a6773b93f3093658c3dcb569de3b4bdb2}{\index{Messenger.\+c@{Messenger.\+c}!M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H@{M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H}}
\index{M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H@{M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H~255}}\label{_messenger_8c_a6773b93f3093658c3dcb569de3b4bdb2}


Definition at line 985 of file Messenger.\+c.



Referenced by file\+\_\+sendrequest(), handle\+\_\+packet(), and new\+\_\+filesender().

\hypertarget{_messenger_8c_a3e84561adca7ef2861635cd81ed71914}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L~0x15ed1b1f}}\label{_messenger_8c_a3e84561adca7ef2861635cd81ed71914}


Definition at line 2423 of file Messenger.\+c.



Referenced by messenger\+\_\+load(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_a2d38314cc90c702f4cde6cfd6f7760db}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E~0x01ce}}\label{_messenger_8c_a2d38314cc90c702f4cde6cfd6f7760db}


Definition at line 2425 of file Messenger.\+c.



Referenced by messenger\+\_\+load(), and z\+\_\+state\+\_\+save\+\_\+subheader().

\hypertarget{_messenger_8c_ae6c05fc174cd87a755972ef8f7679981}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T~2}}\label{_messenger_8c_ae6c05fc174cd87a755972ef8f7679981}


Definition at line 2427 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_ad1aedc06debd945aca3bd7cb5b6dd46f}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D~255}}\label{_messenger_8c_ad1aedc06debd945aca3bd7cb5b6dd46f}


Definition at line 2434 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_a4d8769af27d9fbce16ca1e130853bde5}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S~3}}\label{_messenger_8c_a4d8769af27d9fbce16ca1e130853bde5}


Definition at line 2428 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_afd99074ae265873e4fdff404d37394d4}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E~4}}\label{_messenger_8c_afd99074ae265873e4fdff404d37394d4}


Definition at line 2429 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_af7c141a97170e9f2f3e6cf961e23c947}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S~1}}\label{_messenger_8c_af7c141a97170e9f2f3e6cf961e23c947}


Definition at line 2426 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_ac7f0d1335af95f7bd8fae885c1bfcfc9}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E~11}}\label{_messenger_8c_ac7f0d1335af95f7bd8fae885c1bfcfc9}


Definition at line 2433 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_a51d08227e8515e67d7969289cd18f4cd}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S~6}}\label{_messenger_8c_a51d08227e8515e67d7969289cd18f4cd}


Definition at line 2431 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_a43f7448cfa20d85c9b793cbde6715ffc}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E~5}}\label{_messenger_8c_a43f7448cfa20d85c9b793cbde6715ffc}


Definition at line 2430 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_a64f45a4a72c35453d48355edcc2fdea7}{\index{Messenger.\+c@{Messenger.\+c}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y~10}}\label{_messenger_8c_a64f45a4a72c35453d48355edcc2fdea7}


Definition at line 2432 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), and messenger\+\_\+save().

\hypertarget{_messenger_8c_a5e98fb56f9865b4041b3ac9f3ff1fbd7}{\index{Messenger.\+c@{Messenger.\+c}!M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}}
\index{M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L~50}}\label{_messenger_8c_a5e98fb56f9865b4041b3ac9f3ff1fbd7}


Definition at line 2261 of file Messenger.\+c.



Referenced by messenger\+\_\+run\+\_\+interval().

\hypertarget{_messenger_8c_a752ad5152ba85410624aa9f3434c320c}{\index{Messenger.\+c@{Messenger.\+c}!M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E@{M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E}}
\index{M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E@{M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E~({\bf C\+R\+Y\+P\+T\+O\+\_\+\+M\+I\+N\+\_\+\+Q\+U\+E\+U\+E\+\_\+\+L\+E\+N\+G\+T\+H} / 4)}}\label{_messenger_8c_a752ad5152ba85410624aa9f3434c320c}


Definition at line 1306 of file Messenger.\+c.



Referenced by do\+\_\+reqchunk\+\_\+filecb(), and file\+\_\+data().

\hypertarget{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{\index{Messenger.\+c@{Messenger.\+c}!N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S@{N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S}}
\index{N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S@{N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S~8}}\label{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}


Definition at line 2437 of file Messenger.\+c.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), messenger\+\_\+save(), and messenger\+\_\+size().

\hypertarget{_messenger_8c_a5546558d2255f81d24707b447cb5bb94}{\index{Messenger.\+c@{Messenger.\+c}!S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E@{S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E}}
\index{S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E@{S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E~1024}}\label{_messenger_8c_a5546558d2255f81d24707b447cb5bb94}


Definition at line 2436 of file Messenger.\+c.



Referenced by friends\+\_\+list\+\_\+save().



\subsection{Function Documentation}
\hypertarget{_messenger_8c_a669d4111f5309184034fcbbe4ee1372c}{\index{Messenger.\+c@{Messenger.\+c}!add\+\_\+receipt@{add\+\_\+receipt}}
\index{add\+\_\+receipt@{add\+\_\+receipt}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{add\+\_\+receipt}]{\setlength{\rightskip}{0pt plus 5cm}static int add\+\_\+receipt (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{packet\+\_\+num, }
\item[{uint32\+\_\+t}]{msg\+\_\+id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a669d4111f5309184034fcbbe4ee1372c}


Definition at line 311 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Receipts\+::msg\+\_\+id, Receipts\+::next, Receipts\+::packet\+\_\+num, Friend\+::receipts\+\_\+end, and Friend\+::receipts\+\_\+start.



Referenced by m\+\_\+send\+\_\+message\+\_\+generic().


\begin{DoxyCode}
312 \{
313     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
314         \textcolor{keywordflow}{return} -1;
315 
316     \textcolor{keyword}{struct }\hyperlink{struct_receipts}{Receipts} *\textcolor{keyword}{new} = calloc(1, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{struct_receipts}{Receipts}));
317 
318     \textcolor{keywordflow}{if} (!\textcolor{keyword}{new})
319         \textcolor{keywordflow}{return} -1;
320 
321     \textcolor{keyword}{new}->packet\_num = \hyperlink{struct_receipts_a3110fa374a202ca37de05e1bb9c95f17}{packet\_num};
322     \textcolor{keyword}{new}->msg\_id = \hyperlink{struct_receipts_a8d62bc717240dc62a7c3595d7b2a75ff}{msg\_id};
323 
324     \textcolor{keywordflow}{if} (!m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start}) \{
325         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start} = \textcolor{keyword}{new};
326     \} \textcolor{keywordflow}{else} \{
327         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ad4ff64ea096ee2af6b53f8d9f7901776}{receipts\_end}->\hyperlink{struct_receipts_a4cf1c9c7aa66ba420c540e3070555c89}{next} = \textcolor{keyword}{new};
328     \}
329 
330     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ad4ff64ea096ee2af6b53f8d9f7901776}{receipts\_end} = \textcolor{keyword}{new};
331     \textcolor{keyword}{new}->\hyperlink{struct_receipts_a4cf1c9c7aa66ba420c540e3070555c89}{next} = NULL;
332     \textcolor{keywordflow}{return} 0;
333 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{d8/d8d/_messenger_8c_a669d4111f5309184034fcbbe4ee1372c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a669d4111f5309184034fcbbe4ee1372c_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a31c1f385ae903fdf82773998b54009fc}{\index{Messenger.\+c@{Messenger.\+c}!address\+\_\+checksum@{address\+\_\+checksum}}
\index{address\+\_\+checksum@{address\+\_\+checksum}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{address\+\_\+checksum}]{\setlength{\rightskip}{0pt plus 5cm}static uint16\+\_\+t address\+\_\+checksum (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$}]{address, }
\item[{uint32\+\_\+t}]{len}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a31c1f385ae903fdf82773998b54009fc}


Definition at line 121 of file Messenger.\+c.



References i.



Referenced by friends\+\_\+list\+\_\+load(), getaddress(), and m\+\_\+addfriend().


\begin{DoxyCode}
122 \{
123     uint8\_t checksum[2] = \{0\};
124     uint16\_t check;
125     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
126 
127     \textcolor{keywordflow}{for} (i = 0; i < len; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i})
128         checksum[i % 2] ^= address[i];
129 
130     memcpy(&check, checksum, \textcolor{keyword}{sizeof}(check));
131     \textcolor{keywordflow}{return} check;
132 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a31c1f385ae903fdf82773998b54009fc_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2c0567bd0161368d60f7d9a93ecefa50}{\index{Messenger.\+c@{Messenger.\+c}!break\+\_\+files@{break\+\_\+files}}
\index{break\+\_\+files@{break\+\_\+files}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{break\+\_\+files}]{\setlength{\rightskip}{0pt plus 5cm}static void break\+\_\+files (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a2c0567bd0161368d60f7d9a93ecefa50}


Definition at line 1490 of file Messenger.\+c.



References Friend\+::file\+\_\+receiving, Friend\+::file\+\_\+sending, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, Messenger\+::friendlist, i, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, and File\+\_\+\+Transfers\+::status.



Referenced by check\+\_\+friend\+\_\+connectionstatus().


\begin{DoxyCode}
1491 \{
1492     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1493 
1494     \textcolor{comment}{//TODO: Inform the client which file transfers get killed with a callback?}
1495     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1496         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[i].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1497             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE};
1498 
1499         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[i].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1500             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE};
1501     \}
1502 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2c0567bd0161368d60f7d9a93ecefa50_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a97fde93e5944768530b23c8120219f36}{\index{Messenger.\+c@{Messenger.\+c}!callback\+\_\+file\+\_\+control@{callback\+\_\+file\+\_\+control}}
\index{callback\+\_\+file\+\_\+control@{callback\+\_\+file\+\_\+control}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{callback\+\_\+file\+\_\+control}]{\setlength{\rightskip}{0pt plus 5cm}void callback\+\_\+file\+\_\+control (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, uint32\+\_\+t, unsigned int, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a97fde93e5944768530b23c8120219f36}


Definition at line 954 of file Messenger.\+c.



References Messenger\+::file\+\_\+filecontrol, and Messenger\+::file\+\_\+filecontrol\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+file\+\_\+recv\+\_\+control().


\begin{DoxyCode}
956 \{
957     m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol} = \textcolor{keyword}{function};
958     m->\hyperlink{struct_messenger_a34ba46a8cf11b02a23f7a7d219608c3b}{file\_filecontrol\_userdata} = userdata;
959 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a97fde93e5944768530b23c8120219f36_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a0e2d1738c18e9220dac9e23122011de9}{\index{Messenger.\+c@{Messenger.\+c}!callback\+\_\+file\+\_\+data@{callback\+\_\+file\+\_\+data}}
\index{callback\+\_\+file\+\_\+data@{callback\+\_\+file\+\_\+data}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{callback\+\_\+file\+\_\+data}]{\setlength{\rightskip}{0pt plus 5cm}void callback\+\_\+file\+\_\+data (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, uint32\+\_\+t, uint64\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a0e2d1738c18e9220dac9e23122011de9}


Definition at line 966 of file Messenger.\+c.



References Messenger\+::file\+\_\+filedata, and Messenger\+::file\+\_\+filedata\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+file\+\_\+recv\+\_\+chunk().


\begin{DoxyCode}
968 \{
969     m->\hyperlink{struct_messenger_a2f2875b7bf0dda7ed90908d4e1139493}{file\_filedata} = \textcolor{keyword}{function};
970     m->\hyperlink{struct_messenger_a69c2b7ef494a50568b37c4ade72fdb62}{file\_filedata\_userdata} = userdata;
971 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a0e2d1738c18e9220dac9e23122011de9_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a0c7a3d860cfa4e141ca842dfa107d34d}{\index{Messenger.\+c@{Messenger.\+c}!callback\+\_\+file\+\_\+reqchunk@{callback\+\_\+file\+\_\+reqchunk}}
\index{callback\+\_\+file\+\_\+reqchunk@{callback\+\_\+file\+\_\+reqchunk}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{callback\+\_\+file\+\_\+reqchunk}]{\setlength{\rightskip}{0pt plus 5cm}void callback\+\_\+file\+\_\+reqchunk (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, uint32\+\_\+t, uint64\+\_\+t, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a0c7a3d860cfa4e141ca842dfa107d34d}


Definition at line 978 of file Messenger.\+c.



References Messenger\+::file\+\_\+reqchunk, and Messenger\+::file\+\_\+reqchunk\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+file\+\_\+chunk\+\_\+request().


\begin{DoxyCode}
980 \{
981     m->\hyperlink{struct_messenger_a8e913b9866264d0e9518d54b08cc4eeb}{file\_reqchunk} = \textcolor{keyword}{function};
982     m->\hyperlink{struct_messenger_afab0bf4f4929791bf8cab5603f400391}{file\_reqchunk\_userdata} = userdata;
983 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a0c7a3d860cfa4e141ca842dfa107d34d_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ac72a8b0dcbbb5d359476e1d978e1cba2}{\index{Messenger.\+c@{Messenger.\+c}!callback\+\_\+file\+\_\+sendrequest@{callback\+\_\+file\+\_\+sendrequest}}
\index{callback\+\_\+file\+\_\+sendrequest@{callback\+\_\+file\+\_\+sendrequest}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{callback\+\_\+file\+\_\+sendrequest}]{\setlength{\rightskip}{0pt plus 5cm}void callback\+\_\+file\+\_\+sendrequest (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, uint32\+\_\+t, uint32\+\_\+t, uint64\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ac72a8b0dcbbb5d359476e1d978e1cba2}


Definition at line 942 of file Messenger.\+c.



References Messenger\+::file\+\_\+sendrequest, and Messenger\+::file\+\_\+sendrequest\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+file\+\_\+recv().


\begin{DoxyCode}
944 \{
945     m->\hyperlink{struct_messenger_a1d83804ee0bfe9249fda05cdd755a37f}{file\_sendrequest} = \textcolor{keyword}{function};
946     m->\hyperlink{struct_messenger_a26be37effc113183fae96f3a7279ebb0}{file\_sendrequest\_userdata} = userdata;
947 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac72a8b0dcbbb5d359476e1d978e1cba2_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a961f02c4cb668e9932894d0f8969dbb1}{\index{Messenger.\+c@{Messenger.\+c}!check\+\_\+friend\+\_\+connectionstatus@{check\+\_\+friend\+\_\+connectionstatus}}
\index{check\+\_\+friend\+\_\+connectionstatus@{check\+\_\+friend\+\_\+connectionstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{check\+\_\+friend\+\_\+connectionstatus}]{\setlength{\rightskip}{0pt plus 5cm}static void check\+\_\+friend\+\_\+connectionstatus (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a961f02c4cb668e9932894d0f8969dbb1}


Definition at line 858 of file Messenger.\+c.



References break\+\_\+files(), check\+\_\+friend\+\_\+tcp\+\_\+udp(), clear\+\_\+receipts(), Messenger\+::friend\+\_\+connectionstatuschange\+\_\+internal, Messenger\+::friend\+\_\+connectionstatuschange\+\_\+internal\+\_\+userdata, F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Messenger\+::friendlist, Friend\+::name\+\_\+sent, N\+O\+F\+R\+I\+E\+N\+D, Friend\+::status, Friend\+::statusmessage\+\_\+sent, Friend\+::user\+\_\+istyping\+\_\+sent, and Friend\+::userstatus\+\_\+sent.



Referenced by set\+\_\+friend\+\_\+status().


\begin{DoxyCode}
859 \{
860     \textcolor{keywordflow}{if} (status == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ead051772af60ca4a39271bab1829fc61c}{NOFRIEND})
861         \textcolor{keywordflow}{return};
862 
863     \textcolor{keyword}{const} uint8\_t was\_online = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE};
864     \textcolor{keyword}{const} uint8\_t is\_online = status == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE};
865 
866     \textcolor{keywordflow}{if} (is\_online != was\_online) \{
867         \textcolor{keywordflow}{if} (was\_online) \{
868             \hyperlink{_messenger_8c_a2c0567bd0161368d60f7d9a93ecefa50}{break\_files}(m, friendnumber);
869             \hyperlink{_messenger_8c_a3206124b119b06401ce65affb690976d}{clear\_receipts}(m, friendnumber);
870         \} \textcolor{keywordflow}{else} \{
871             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_acc966be04e3e27e15dfd493c3e9cff89}{name\_sent} = 0;
872             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_af7c74fd36acb972c3a8641fb0781e37e}{userstatus\_sent} = 0;
873             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ad39189cd22b356c314e4d980b55db259}{statusmessage\_sent} = 0;
874             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a8d9e9aef86444e0cde8ec0314f60907e}{user\_istyping\_sent} = 0;
875         \}
876 
877         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} = status;
878 
879         \hyperlink{_messenger_8c_a6177eb11440d9263eae1465810989cfd}{check\_friend\_tcp\_udp}(m, friendnumber);
880 
881         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_abfd5a34f887ae1fda52d86f4b01ea572}{friend\_connectionstatuschange\_internal})
882             m->\hyperlink{struct_messenger_abfd5a34f887ae1fda52d86f4b01ea572}{friend\_connectionstatuschange\_internal}(m, friendnumber
      , is\_online,
883                     m->\hyperlink{struct_messenger_af915663b78a533e88c4f56cacbeeefdc}{friend\_connectionstatuschange\_internal\_userdata}
      );
884     \}
885 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a961f02c4cb668e9932894d0f8969dbb1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a961f02c4cb668e9932894d0f8969dbb1_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a00b3a64396035b3b700ba9d19140a201}{\index{Messenger.\+c@{Messenger.\+c}!check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out@{check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out}}
\index{check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out@{check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out}]{\setlength{\rightskip}{0pt plus 5cm}static void check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{uint32\+\_\+t}]{i, }
\item[{uint64\+\_\+t}]{t}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a00b3a64396035b3b700ba9d19140a201}


Definition at line 1880 of file Messenger.\+c.



References F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+E\+D, Messenger\+::friendlist, Friend\+::friendrequest\+\_\+lastsent, Friend\+::friendrequest\+\_\+timeout, i, and set\+\_\+friend\+\_\+status().



Referenced by do\+\_\+friends().


\begin{DoxyCode}
1881 \{
1882     \hyperlink{struct_friend}{Friend} *f = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}];
1883 
1884     \textcolor{keywordflow}{if} (f->\hyperlink{struct_friend_a1cea2470caaf4282313efe944e95bf35}{friendrequest\_lastsent} + f->
      \hyperlink{struct_friend_a671d1f4ab926cb9dc297c3f2743560d4}{friendrequest\_timeout} < t) \{
1885         \hyperlink{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{set\_friend\_status}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea931f0d7c482a759d79e5ba50d9c03503}{FRIEND\_ADDED});
1886         \textcolor{comment}{/* Double the default timeout every time if friendrequest is assumed}
1887 \textcolor{comment}{         * to have been sent unsuccessfully.}
1888 \textcolor{comment}{         */}
1889         f->\hyperlink{struct_friend_a671d1f4ab926cb9dc297c3f2743560d4}{friendrequest\_timeout} *= 2;
1890     \}
1891 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a00b3a64396035b3b700ba9d19140a201_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a00b3a64396035b3b700ba9d19140a201_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a6177eb11440d9263eae1465810989cfd}{\index{Messenger.\+c@{Messenger.\+c}!check\+\_\+friend\+\_\+tcp\+\_\+udp@{check\+\_\+friend\+\_\+tcp\+\_\+udp}}
\index{check\+\_\+friend\+\_\+tcp\+\_\+udp@{check\+\_\+friend\+\_\+tcp\+\_\+udp}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{check\+\_\+friend\+\_\+tcp\+\_\+udp}]{\setlength{\rightskip}{0pt plus 5cm}static void check\+\_\+friend\+\_\+tcp\+\_\+udp (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a6177eb11440d9263eae1465810989cfd}


Definition at line 832 of file Messenger.\+c.



References C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+C\+P, C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+U\+D\+P, C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+U\+N\+K\+N\+O\+W\+N, Messenger\+::friend\+\_\+connectionstatuschange, Messenger\+::friend\+\_\+connectionstatuschange\+\_\+userdata, Messenger\+::friendlist, Friend\+::last\+\_\+connection\+\_\+udp\+\_\+tcp, and m\+\_\+get\+\_\+friend\+\_\+connectionstatus().



Referenced by check\+\_\+friend\+\_\+connectionstatus(), and do\+\_\+friends().


\begin{DoxyCode}
833 \{
834     \textcolor{keywordtype}{int} last\_connection\_udp\_tcp = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_ac213b32e59c2e4a64923c453b100c4e4}{last\_connection\_udp\_tcp};
835 
836     \textcolor{keywordtype}{int} ret = \hyperlink{_messenger_8c_a4b1f7ee3f635e7a80c8f3cbe98588e4d}{m\_get\_friend\_connectionstatus}(m, friendnumber);
837 
838     \textcolor{keywordflow}{if} (ret == -1)
839         \textcolor{keywordflow}{return};
840 
841     \textcolor{keywordflow}{if} (ret == \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25aaa98c30b12cac8536b62c99df201f423}{CONNECTION\_UNKNOWN}) \{
842         \textcolor{keywordflow}{if} (last\_connection\_udp\_tcp == \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25aaa6bcb092cadcf56c3637f282fac13c6}{CONNECTION\_UDP}) \{
843             \textcolor{keywordflow}{return};
844         \} \textcolor{keywordflow}{else} \{
845             ret = \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25aa393b364b51a891ecf2ef9292ff5192c}{CONNECTION\_TCP};
846         \}
847     \}
848 
849     \textcolor{keywordflow}{if} (last\_connection\_udp\_tcp != ret) \{
850         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_afb2bb77a40eb1445cc3e67cccc20a6ac}{friend\_connectionstatuschange})
851             m->\hyperlink{struct_messenger_afb2bb77a40eb1445cc3e67cccc20a6ac}{friend\_connectionstatuschange}(m, friendnumber, ret, m->
      \hyperlink{struct_messenger_a69af1b3dc5153b752781cf61ff660b89}{friend\_connectionstatuschange\_userdata});
852     \}
853 
854     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ac213b32e59c2e4a64923c453b100c4e4}{last\_connection\_udp\_tcp} = ret;
855 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a6177eb11440d9263eae1465810989cfd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a6177eb11440d9263eae1465810989cfd_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a3206124b119b06401ce65affb690976d}{\index{Messenger.\+c@{Messenger.\+c}!clear\+\_\+receipts@{clear\+\_\+receipts}}
\index{clear\+\_\+receipts@{clear\+\_\+receipts}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{clear\+\_\+receipts}]{\setlength{\rightskip}{0pt plus 5cm}static int clear\+\_\+receipts (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a3206124b119b06401ce65affb690976d}


Definition at line 293 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Receipts\+::next, Friend\+::receipts\+\_\+end, and Friend\+::receipts\+\_\+start.



Referenced by check\+\_\+friend\+\_\+connectionstatus(), kill\+\_\+messenger(), and m\+\_\+delfriend().


\begin{DoxyCode}
294 \{
295     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
296         \textcolor{keywordflow}{return} -1;
297 
298     \textcolor{keyword}{struct }\hyperlink{struct_receipts}{Receipts} *receipts = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start};
299 
300     \textcolor{keywordflow}{while} (receipts) \{
301         \textcolor{keyword}{struct }\hyperlink{struct_receipts}{Receipts} *temp\_r = receipts->\hyperlink{struct_receipts_a4cf1c9c7aa66ba420c540e3070555c89}{next};
302         free(receipts);
303         receipts = temp\_r;
304     \}
305 
306     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start} = NULL;
307     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ad4ff64ea096ee2af6b53f8d9f7901776}{receipts\_end} = NULL;
308     \textcolor{keywordflow}{return} 0;
309 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{d8/d8d/_messenger_8c_a3206124b119b06401ce65affb690976d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a3206124b119b06401ce65affb690976d_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a65b3475ffdbddbf6aab3fd087c550f4b}{\index{Messenger.\+c@{Messenger.\+c}!connection\+\_\+status\+\_\+cb@{connection\+\_\+status\+\_\+cb}}
\index{connection\+\_\+status\+\_\+cb@{connection\+\_\+status\+\_\+cb}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{connection\+\_\+status\+\_\+cb}]{\setlength{\rightskip}{0pt plus 5cm}static void connection\+\_\+status\+\_\+cb (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a65b3475ffdbddbf6aab3fd087c550f4b}


Definition at line 2230 of file Messenger.\+c.



References Messenger\+::core\+\_\+connection\+\_\+change, Messenger\+::core\+\_\+connection\+\_\+change\+\_\+userdata, Messenger\+::last\+\_\+connection\+\_\+status, Messenger\+::onion\+\_\+c, and onion\+\_\+connection\+\_\+status().



Referenced by do\+\_\+messenger().


\begin{DoxyCode}
2231 \{
2232     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} conn\_status = \hyperlink{onion__client_8c_a851cc0015a7360b9abfb7d92b997b2b4}{onion\_connection\_status}(m->
      \hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c});
2233 
2234     \textcolor{keywordflow}{if} (conn\_status != m->\hyperlink{struct_messenger_a97e16f5111643baf9c4f055af6b90e8c}{last\_connection\_status}) \{
2235         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a04d6d710a221e33282b2305ec4158ac4}{core\_connection\_change})
2236             (*m->\hyperlink{struct_messenger_a04d6d710a221e33282b2305ec4158ac4}{core\_connection\_change})(m, conn\_status, m->
      \hyperlink{struct_messenger_a55d1d5f05bdf28588035d0bffd52ac3a}{core\_connection\_change\_userdata});
2237 
2238         m->\hyperlink{struct_messenger_a97e16f5111643baf9c4f055af6b90e8c}{last\_connection\_status} = conn\_status;
2239     \}
2240 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a65b3475ffdbddbf6aab3fd087c550f4b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a65b3475ffdbddbf6aab3fd087c550f4b_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_af7181add8f82138b95e524478a3a74af}{\index{Messenger.\+c@{Messenger.\+c}!copy\+\_\+friendlist@{copy\+\_\+friendlist}}
\index{copy\+\_\+friendlist@{copy\+\_\+friendlist}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{copy\+\_\+friendlist}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t copy\+\_\+friendlist (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} const $\ast$}]{m, }
\item[{uint32\+\_\+t $\ast$}]{out\+\_\+list, }
\item[{uint32\+\_\+t}]{list\+\_\+size}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_af7181add8f82138b95e524478a3a74af}


Definition at line 2784 of file Messenger.\+c.



References Messenger\+::friendlist, i, Messenger\+::numfriends, and Friend\+::status.



Referenced by tox\+\_\+self\+\_\+get\+\_\+friend\+\_\+list().


\begin{DoxyCode}
2785 \{
2786     \textcolor{keywordflow}{if} (!out\_list)
2787         \textcolor{keywordflow}{return} 0;
2788 
2789     \textcolor{keywordflow}{if} (\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends} == 0) \{
2790         \textcolor{keywordflow}{return} 0;
2791     \}
2792 
2793     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2794     uint32\_t ret = 0;
2795 
2796     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; i++) \{
2797         \textcolor{keywordflow}{if} (ret >= list\_size) \{
2798             \textcolor{keywordflow}{break}; \textcolor{comment}{/* Abandon ship */}
2799         \}
2800 
2801         \textcolor{keywordflow}{if} (\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} > 0) \{
2802             out\_list[ret] = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2803             ret++;
2804         \}
2805     \}
2806 
2807     \textcolor{keywordflow}{return} ret;
2808 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{d8/d8d/_messenger_8c_af7181add8f82138b95e524478a3a74af_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ab3db39cd14385440de61a378e25f03f1}{\index{Messenger.\+c@{Messenger.\+c}!count\+\_\+friendlist@{count\+\_\+friendlist}}
\index{count\+\_\+friendlist@{count\+\_\+friendlist}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{count\+\_\+friendlist}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t count\+\_\+friendlist (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ab3db39cd14385440de61a378e25f03f1}


Definition at line 2765 of file Messenger.\+c.



References Messenger\+::friendlist, i, Messenger\+::numfriends, and Friend\+::status.



Referenced by saved\+\_\+friendslist\+\_\+size(), and tox\+\_\+self\+\_\+get\+\_\+friend\+\_\+list\+\_\+size().


\begin{DoxyCode}
2766 \{
2767     uint32\_t ret = 0;
2768     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2769 
2770     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; i++) \{
2771         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} > 0) \{
2772             ret++;
2773         \}
2774     \}
2775 
2776     \textcolor{keywordflow}{return} ret;
2777 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ab3db39cd14385440de61a378e25f03f1_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a6ab92b46caa30782c31ea7b3b8d24b45}{\index{Messenger.\+c@{Messenger.\+c}!custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler@{custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler}}
\index{custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler@{custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler}]{\setlength{\rightskip}{0pt plus 5cm}void custom\+\_\+lossless\+\_\+packet\+\_\+registerhandler (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, size\+\_\+t len, void $\ast$object)}]{packet\+\_\+handler\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a6ab92b46caa30782c31ea7b3b8d24b45}


Definition at line 1707 of file Messenger.\+c.



References Messenger\+::lossless\+\_\+packethandler, and Messenger\+::lossless\+\_\+packethandler\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+lossless\+\_\+packet().


\begin{DoxyCode}
1709 \{
1710     m->\hyperlink{struct_messenger_ade523661676bfd811bd8676c29600900}{lossless\_packethandler} = \hyperlink{network_8h_a01fb3f0e3fd19ed8eefe335b64934156}{packet\_handler\_callback};
1711     m->\hyperlink{struct_messenger_aa46ae2a29721e8b27e0d4aac8b64b195}{lossless\_packethandler\_userdata} = object;
1712 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a6ab92b46caa30782c31ea7b3b8d24b45_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a8c615f14e641a971c44c3c6096ab54a1}{\index{Messenger.\+c@{Messenger.\+c}!custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler@{custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler}}
\index{custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler@{custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler}]{\setlength{\rightskip}{0pt plus 5cm}void custom\+\_\+lossy\+\_\+packet\+\_\+registerhandler (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, size\+\_\+t len, void $\ast$object)}]{packet\+\_\+handler\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a8c615f14e641a971c44c3c6096ab54a1}


Definition at line 1637 of file Messenger.\+c.



References Messenger\+::lossy\+\_\+packethandler, and Messenger\+::lossy\+\_\+packethandler\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+lossy\+\_\+packet().


\begin{DoxyCode}
1639 \{
1640     m->\hyperlink{struct_messenger_afba23a025d7275ca11e8f7d56386d3d1}{lossy\_packethandler} = \hyperlink{network_8h_a01fb3f0e3fd19ed8eefe335b64934156}{packet\_handler\_callback};
1641     m->\hyperlink{struct_messenger_a2b87de1f33a502c6dd105cd69a905c35}{lossy\_packethandler\_userdata} = object;
1642 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a8c615f14e641a971c44c3c6096ab54a1_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a5e3bee5110a3531eedb8f92ffd600af8}{\index{Messenger.\+c@{Messenger.\+c}!do\+\_\+friends@{do\+\_\+friends}}
\index{do\+\_\+friends@{do\+\_\+friends}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{do\+\_\+friends}]{\setlength{\rightskip}{0pt plus 5cm}void do\+\_\+friends (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a5e3bee5110a3531eedb8f92ffd600af8}


Definition at line 2173 of file Messenger.\+c.



References check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out(), check\+\_\+friend\+\_\+tcp\+\_\+udp(), do\+\_\+receipts(), do\+\_\+reqchunk\+\_\+filecb(), Messenger\+::fr\+\_\+c, F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+E\+D, F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+F\+I\+R\+M\+E\+D, F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+E\+D, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, Friend\+::friendrequest\+\_\+lastsent, Friend\+::friendrequest\+\_\+nospam, i, Friend\+::info, Friend\+::info\+\_\+size, Friend\+::last\+\_\+seen\+\_\+time, m\+\_\+sendname(), Messenger\+::name, Messenger\+::name\+\_\+length, Friend\+::name\+\_\+sent, Messenger\+::numfriends, send\+\_\+friend\+\_\+request\+\_\+packet(), send\+\_\+statusmessage(), send\+\_\+user\+\_\+istyping(), send\+\_\+userstatus(), set\+\_\+friend\+\_\+status(), Friend\+::status, Messenger\+::statusmessage, Messenger\+::statusmessage\+\_\+length, Friend\+::statusmessage\+\_\+sent, unix\+\_\+time(), Friend\+::user\+\_\+istyping, Friend\+::user\+\_\+istyping\+\_\+sent, Messenger\+::userstatus, and Friend\+::userstatus\+\_\+sent.



Referenced by do\+\_\+messenger().


\begin{DoxyCode}
2174 \{
2175     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2176     uint64\_t temp\_time = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
2177 
2178     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
2179         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea931f0d7c482a759d79e5ba50d9c03503}{FRIEND\_ADDED}) \{
2180             \textcolor{keywordtype}{int} fr = \hyperlink{friend__connection_8c_a2af492c22c086276ed147d0826839d25}{send\_friend\_request\_packet}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_a0fae9801a4789a368f90125119e31f3f}{friendrequest\_nospam},
2181                                                 m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ae1a1264e17ce4eedae67c283a09236e6}{info},
2182                                                 m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_ac0ae002db55ef8f8366de10ec005b65a}{info\_size});
2183 
2184             \textcolor{keywordflow}{if} (fr >= 0) \{
2185                 \hyperlink{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{set\_friend\_status}(m, i, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9eacf8f15cc509c59b259e53ece9ca4aa42}{FRIEND\_REQUESTED});
2186                 m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a1cea2470caaf4282313efe944e95bf35}{friendrequest\_lastsent} = temp\_time;
2187             \}
2188         \}
2189 
2190         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9eacf8f15cc509c59b259e53ece9ca4aa42}{FRIEND\_REQUESTED}
2191                 || m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea96745ef6bf5398e7e4488c21492f57a8}{FRIEND\_CONFIRMED}) \{ \textcolor{comment}{/* friend
       is not online. */}
2192             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9eacf8f15cc509c59b259e53ece9ca4aa42}{FRIEND\_REQUESTED}) \{
2193                 \textcolor{comment}{/* If we didn't connect to friend after successfully sending him a friend request the
       request is deemed}
2194 \textcolor{comment}{                 * unsuccessful so we set the status back to FRIEND\_ADDED and try again.}
2195 \textcolor{comment}{                 */}
2196                 \hyperlink{_messenger_8c_a00b3a64396035b3b700ba9d19140a201}{check\_friend\_request\_timed\_out}(m, i, temp\_time);
2197             \}
2198         \}
2199 
2200         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE}) \{ \textcolor{comment}{/* friend is online. 
      */}
2201             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_acc966be04e3e27e15dfd493c3e9cff89}{name\_sent} == 0) \{
2202                 \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a5328e9c55aff292c735e70c1953d49d4}{m\_sendname}(m, i, m->\hyperlink{struct_messenger_a11b8cc6595eea79e65c978209278e683}{name}, m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length}))
2203                     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_acc966be04e3e27e15dfd493c3e9cff89}{name\_sent} = 1;
2204             \}
2205 
2206             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ad39189cd22b356c314e4d980b55db259}{statusmessage\_sent} == 0) \{
2207                 \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a5ad1d3522f42e05278a777c9b5c70f66}{send\_statusmessage}(m, i, m->\hyperlink{struct_messenger_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, m->
      \hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length}))
2208                     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_ad39189cd22b356c314e4d980b55db259}{statusmessage\_sent} = 1;
2209             \}
2210 
2211             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_af7c74fd36acb972c3a8641fb0781e37e}{userstatus\_sent} == 0) \{
2212                 \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_aa43271679d82439481418e3251f5db4a}{send\_userstatus}(m, i, m->\hyperlink{struct_messenger_adde524f5a15465585cbc2543cd0b2710}{userstatus}))
2213                     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_af7c74fd36acb972c3a8641fb0781e37e}{userstatus\_sent} = 1;
2214             \}
2215 
2216             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_a8d9e9aef86444e0cde8ec0314f60907e}{user\_istyping\_sent} == 0) \{
2217                 \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a9cc7b7b8bc1c2acd9b63bbcc64d570df}{send\_user\_istyping}(m, i, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_a68e945edd5a63c22371edf481c788d88}{user\_istyping}))
2218                     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a8d9e9aef86444e0cde8ec0314f60907e}{user\_istyping\_sent} = 1;
2219             \}
2220 
2221             \hyperlink{_messenger_8c_a6177eb11440d9263eae1465810989cfd}{check\_friend\_tcp\_udp}(m, i);
2222             \hyperlink{_messenger_8c_ac9dcb9b0a9c69f521369a559a1835c57}{do\_receipts}(m, i);
2223             \hyperlink{_messenger_8c_a74c09bcf488256da7b3ed899f541fc8c}{do\_reqchunk\_filecb}(m, i);
2224 
2225             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time} = (uint64\_t) time(NULL);
2226         \}
2227     \}
2228 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5e3bee5110a3531eedb8f92ffd600af8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5e3bee5110a3531eedb8f92ffd600af8_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ae0686caa878183a98920aeb7486afcb6}{\index{Messenger.\+c@{Messenger.\+c}!do\+\_\+messenger@{do\+\_\+messenger}}
\index{do\+\_\+messenger@{do\+\_\+messenger}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{do\+\_\+messenger}]{\setlength{\rightskip}{0pt plus 5cm}void do\+\_\+messenger (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ae0686caa878183a98920aeb7486afcb6}


Definition at line 2280 of file Messenger.\+c.



References add\+\_\+tcp\+\_\+relay(), Client\+\_\+data\+::assoc4, D\+H\+T\+\_\+\+Friend\+::client\+\_\+list, D\+H\+T\+::close\+\_\+clientlist, connection\+\_\+status\+\_\+cb(), Messenger\+::dht, do\+\_\+\+D\+H\+T(), do\+\_\+friend\+\_\+connections(), do\+\_\+friends(), do\+\_\+net\+\_\+crypto(), do\+\_\+onion\+\_\+client(), do\+\_\+\+T\+C\+P\+\_\+server(), I\+P\+::family, Messenger\+::fr\+\_\+c, Messenger\+::friendlist, D\+H\+T\+::friends\+\_\+list, Messenger\+::has\+\_\+added\+\_\+relays, i, id\+\_\+equal(), I\+P\+\_\+\+Port\+::ip, I\+P\+::ip4, ip\+\_\+isset(), ip\+\_\+ntoa(), I\+P\+P\+Ts\+Png\+::ip\+\_\+port, Node\+\_\+format\+::ip\+\_\+port, I\+P\+P\+Ts\+Png\+::last\+\_\+pinged, L\+C\+L\+I\+E\+N\+T\+\_\+\+L\+I\+S\+T, Messenger\+::loaded\+\_\+relays, L\+O\+G\+G\+E\+R\+\_\+\+T\+R\+A\+C\+E, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+L\+I\+E\+N\+T\+S, Friend\+::name, Messenger\+::net, Messenger\+::net\+\_\+crypto, networking\+\_\+poll(), D\+H\+T\+::num\+\_\+friends, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S, Messenger\+::numfriends, Messenger\+::onion\+\_\+c, Messenger\+::options, I\+P\+\_\+\+Port\+::port, Client\+\_\+data\+::public\+\_\+key, D\+H\+T\+\_\+\+Friend\+::public\+\_\+key, T\+C\+P\+\_\+\+Server\+::public\+\_\+key, Node\+\_\+format\+::public\+\_\+key, Friend\+::real\+\_\+pk, Messenger\+::tcp\+\_\+server, Messenger\+\_\+\+Options\+::tcp\+\_\+server\+\_\+port, Messenger\+\_\+\+Options\+::udp\+\_\+disabled, I\+P4\+::uint32, unix\+\_\+time(), and unix\+\_\+time\+\_\+update().



Referenced by main(), and tox\+\_\+iterate().


\begin{DoxyCode}
2281 \{
2282     \textcolor{comment}{// Add the TCP relays, but only if this is the first time calling do\_messenger}
2283     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_af97bc78d4a1b6b87167a479a1cb9920c}{has\_added\_relays} == 0) \{
2284         m->\hyperlink{struct_messenger_af97bc78d4a1b6b87167a479a1cb9920c}{has\_added\_relays} = 1;
2285 
2286         \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2287 
2288         \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_messenger_8h_a7b9306b33798fe1ba98b6f04de976866}{NUM\_SAVED\_TCP\_RELAYS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
2289             \hyperlink{net__crypto_8c_a632021583d7dd2484614071a7080f311}{add\_tcp\_relay}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, m->\hyperlink{struct_messenger_a75d4e8cfc84896f1684dd7c62c1be397}{loaded\_relays}[i].
      \hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}, m->\hyperlink{struct_messenger_a75d4e8cfc84896f1684dd7c62c1be397}{loaded\_relays}[i].\hyperlink{struct_node__format_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key});
2290         \}
2291 
2292         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server}) \{
2293             \textcolor{comment}{/* Add self tcp server. */}
2294             \hyperlink{struct_i_p___port}{IP\_Port} local\_ip\_port;
2295             local\_ip\_port.\hyperlink{struct_i_p___port_a8e0798404bf2cf5dabb84c5ba9a4f236}{port} = m->\hyperlink{struct_messenger_a180dba994d1fff627e19da4179148669}{options}.\hyperlink{struct_messenger___options_a9f404f426cc09060b42b9a61523cc573}{tcp\_server\_port};
2296             local\_ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} = AF\_INET;
2297             local\_ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_aca19646000f55aa927406e68fc41ecf9}{ip4}.\hyperlink{union_i_p4_a5ad776be1fb768f3399aafcd1b58b3a2}{uint32} = INADDR\_LOOPBACK;
2298             \hyperlink{net__crypto_8c_a632021583d7dd2484614071a7080f311}{add\_tcp\_relay}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, local\_ip\_port, m->
      \hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server}->\hyperlink{struct_t_c_p___server_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key});
2299         \}
2300     \}
2301 
2302     \hyperlink{util_8c_a849af10dd491723cf3abdef599846897}{unix\_time\_update}();
2303 
2304     \textcolor{keywordflow}{if} (!m->\hyperlink{struct_messenger_a180dba994d1fff627e19da4179148669}{options}.\hyperlink{struct_messenger___options_a1510f9751065ec1a6d485c4b3072b9d7}{udp\_disabled}) \{
2305         \hyperlink{network_8c_ab6765fe4b08536210a20ac728f991e13}{networking\_poll}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
2306         \hyperlink{_d_h_t_8c_a5be9dfb66fbf1fa7c267b016f3357534}{do\_DHT}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
2307     \}
2308 
2309     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server}) \{
2310         \hyperlink{_t_c_p__server_8c_a40e8a0302a359dd4f712eb1e9c346fe5}{do\_TCP\_server}(m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server});
2311     \}
2312 
2313     \hyperlink{net__crypto_8c_a6fa028eb320bf09ecd619c5053580436}{do\_net\_crypto}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto});
2314     \hyperlink{onion__client_8c_aa1771a7c1ebf446973e8d2bbb7ea8c2d}{do\_onion\_client}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c});
2315     \hyperlink{friend__connection_8c_aea88c3aa2deff558e9b13ed5229cbb6b}{do\_friend\_connections}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c});
2316     \hyperlink{_messenger_8c_a5e3bee5110a3531eedb8f92ffd600af8}{do\_friends}(m);
2317     \hyperlink{_messenger_8c_a65b3475ffdbddbf6aab3fd087c550f4b}{connection\_status\_cb}(m);
2318 
2319 \textcolor{preprocessor}{#ifdef LOGGING}
2320 
2321     \textcolor{keywordflow}{if} (\hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}() > lastdump + DUMPING\_CLIENTS\_FRIENDS\_EVERY\_N\_SECONDS) \{
2322 
2323 \textcolor{preprocessor}{#ifdef ENABLE\_ASSOC\_DHT}
2324         Assoc\_status(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->assoc);
2325 \textcolor{preprocessor}{#endif}
2326 
2327         lastdump = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
2328         uint32\_t client, last\_pinged;
2329 
2330         \textcolor{keywordflow}{for} (client = 0; client < \hyperlink{_d_h_t_8h_a3058f857a8316099e20c95fb07adc7c1}{LCLIENT\_LIST}; client++) \{
2331             \hyperlink{struct_client__data}{Client\_data} *cptr = &m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_a00ef35d5b0e7a791ef08a30b3bacbf9d}{close\_clientlist}[client];
2332             \hyperlink{struct_i_p_p_ts_png}{IPPTsPng} *assoc = NULL;
2333             uint32\_t a;
2334 
2335             \textcolor{keywordflow}{for} (a = 0, assoc = &cptr->\hyperlink{struct_client__data_ac9843379cbcd02bdfa5c180a1474a6c5}{assoc4}; a < 2; a++, assoc = &cptr->assoc6)
2336                 \textcolor{keywordflow}{if} (\hyperlink{network_8c_ac56c677f4bc8bf8311370ee105ae7cbb}{ip\_isset}(&assoc->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip})) \{
2337                     last\_pinged = lastdump - assoc->\hyperlink{struct_i_p_p_ts_png_a4049204f6c392628d31be6c39f03e031}{last\_pinged};
2338 
2339                     \textcolor{keywordflow}{if} (last\_pinged > 999)
2340                         last\_pinged = 999;
2341 
2342                     \hyperlink{logger_8h_afee12d0927aff018449c48be1d55a5a2}{LOGGER\_TRACE}(\textcolor{stringliteral}{"C[%2u] %s:%u [%3u] %s"},
2343                                  client, \hyperlink{network_8c_af71f49c78ce7b76ccf08785c6ec08706}{ip\_ntoa}(&assoc->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.
      \hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}), ntohs(assoc->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a8e0798404bf2cf5dabb84c5ba9a4f236}{port}),
2344                                  last\_pinged, ID2String(cptr->\hyperlink{struct_client__data_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}));
2345                 \}
2346         \}
2347 
2348 
2349         uint32\_t \textcolor{keyword}{friend}, dhtfriend;
2350 
2351         \textcolor{comment}{/* dht contains additional "friends" (requests) */}
2352         uint32\_t num\_dhtfriends = m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_a8ee1f2d7e543bce350c591a8eaac0cf8}{num\_friends};
2353         int32\_t m2dht[num\_dhtfriends];
2354         int32\_t dht2m[num\_dhtfriends];
2355 
2356         \textcolor{keywordflow}{for} (\textcolor{keyword}{friend} = 0; \textcolor{keyword}{friend} < num\_dhtfriends; \textcolor{keyword}{friend}++) \{
2357             m2dht[\textcolor{keyword}{friend}] = -1;
2358             dht2m[\textcolor{keyword}{friend}] = -1;
2359 
2360             \textcolor{keywordflow}{if} (\textcolor{keyword}{friend} >= m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends})
2361                 \textcolor{keywordflow}{continue};
2362 
2363             \textcolor{keywordflow}{for} (dhtfriend = 0; dhtfriend < m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_a8ee1f2d7e543bce350c591a8eaac0cf8}{num\_friends}; dhtfriend++)
2364                 \textcolor{keywordflow}{if} (\hyperlink{util_8c_ada3d44b4f530d3c8c9cb69b732be94b1}{id\_equal}(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\textcolor{keyword}{friend}].\hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}, m->
      \hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_ae97c6b057d770e7c4f3905cbe33b188b}{friends\_list}[dhtfriend].\hyperlink{struct_d_h_t___friend_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key})) \{
2365                     m2dht[\textcolor{keyword}{friend}] = dhtfriend;
2366                     \textcolor{keywordflow}{break};
2367                 \}
2368         \}
2369 
2370         \textcolor{keywordflow}{for} (\textcolor{keyword}{friend} = 0; \textcolor{keyword}{friend} < num\_dhtfriends; \textcolor{keyword}{friend}++)
2371             \textcolor{keywordflow}{if} (m2dht[\textcolor{keyword}{friend}] >= 0)
2372                 dht2m[m2dht[\textcolor{keyword}{friend}]] = \textcolor{keyword}{friend};
2373 
2374         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends} != m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_a8ee1f2d7e543bce350c591a8eaac0cf8}{num\_friends}) \{
2375             \hyperlink{logger_8h_afee12d0927aff018449c48be1d55a5a2}{LOGGER\_TRACE}(\textcolor{stringliteral}{"Friend num in DHT %u != friend num in msger %u\(\backslash\)n"}, m->
      \hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_a8ee1f2d7e543bce350c591a8eaac0cf8}{num\_friends}, m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends});
2376         \}
2377 
2378         \hyperlink{struct_friend}{Friend} *msgfptr;
2379         \hyperlink{struct_d_h_t___friend}{DHT\_Friend} *dhtfptr;
2380 
2381         \textcolor{keywordflow}{for} (\textcolor{keyword}{friend} = 0; \textcolor{keyword}{friend} < num\_dhtfriends; \textcolor{keyword}{friend}++) \{
2382             \textcolor{keywordflow}{if} (dht2m[\textcolor{keyword}{friend}] >= 0)
2383                 msgfptr = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[dht2m[\textcolor{keyword}{friend}]];
2384             \textcolor{keywordflow}{else}
2385                 msgfptr = NULL;
2386 
2387             dhtfptr = &m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->\hyperlink{struct_d_h_t_ae97c6b057d770e7c4f3905cbe33b188b}{friends\_list}[\textcolor{keyword}{friend}];
2388 
2389             \textcolor{keywordflow}{if} (msgfptr) \{
2390                 \hyperlink{logger_8h_afee12d0927aff018449c48be1d55a5a2}{LOGGER\_TRACE}(\textcolor{stringliteral}{"F[%2u:%2u] <%s> %s"},
2391                              dht2m[\textcolor{keyword}{friend}], \textcolor{keyword}{friend}, msgfptr->\hyperlink{struct_friend_a11b8cc6595eea79e65c978209278e683}{name},
2392                              ID2String(msgfptr->\hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}));
2393             \} \textcolor{keywordflow}{else} \{
2394                 \hyperlink{logger_8h_afee12d0927aff018449c48be1d55a5a2}{LOGGER\_TRACE}(\textcolor{stringliteral}{"F[--:%2u] %s"}, \textcolor{keyword}{friend}, ID2String(dhtfptr->
      \hyperlink{struct_d_h_t___friend_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}));
2395             \}
2396 
2397             \textcolor{keywordflow}{for} (client = 0; client < \hyperlink{_d_h_t_8h_ad50d158518277ca4d19cbe364f3e958c}{MAX\_FRIEND\_CLIENTS}; client++) \{
2398                 \hyperlink{struct_client__data}{Client\_data} *cptr = &dhtfptr->\hyperlink{struct_d_h_t___friend_a49ef2b640a834a77b6e123355a4fea47}{client\_list}[client];
2399                 \hyperlink{struct_i_p_p_ts_png}{IPPTsPng} *assoc = NULL;
2400                 uint32\_t a;
2401 
2402                 \textcolor{keywordflow}{for} (a = 0, assoc = &cptr->\hyperlink{struct_client__data_ac9843379cbcd02bdfa5c180a1474a6c5}{assoc4}; a < 2; a++, assoc = &cptr->assoc6)
2403                     \textcolor{keywordflow}{if} (\hyperlink{network_8c_ac56c677f4bc8bf8311370ee105ae7cbb}{ip\_isset}(&assoc->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip})) \{
2404                         last\_pinged = lastdump - assoc->\hyperlink{struct_i_p_p_ts_png_a4049204f6c392628d31be6c39f03e031}{last\_pinged};
2405 
2406                         \textcolor{keywordflow}{if} (last\_pinged > 999)
2407                             last\_pinged = 999;
2408 
2409                         \hyperlink{logger_8h_afee12d0927aff018449c48be1d55a5a2}{LOGGER\_TRACE}(\textcolor{stringliteral}{"F[%2u] => C[%2u] %s:%u [%3u] %s"},
2410                                      \textcolor{keyword}{friend}, client, \hyperlink{network_8c_af71f49c78ce7b76ccf08785c6ec08706}{ip\_ntoa}(&assoc->
      \hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}),
2411                                      ntohs(assoc->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a8e0798404bf2cf5dabb84c5ba9a4f236}{port}), last\_pinged,
2412                                      ID2String(cptr->\hyperlink{struct_client__data_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}));
2413                     \}
2414             \}
2415         \}
2416     \}
2417 
2418 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* LOGGING */}\textcolor{preprocessor}{}
2419 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d8/d8d/_messenger_8c_ae0686caa878183a98920aeb7486afcb6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ae0686caa878183a98920aeb7486afcb6_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ac9dcb9b0a9c69f521369a559a1835c57}{\index{Messenger.\+c@{Messenger.\+c}!do\+\_\+receipts@{do\+\_\+receipts}}
\index{do\+\_\+receipts@{do\+\_\+receipts}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{do\+\_\+receipts}]{\setlength{\rightskip}{0pt plus 5cm}static int do\+\_\+receipts (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_ac9dcb9b0a9c69f521369a559a1835c57}


Definition at line 347 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), friend\+\_\+received\+\_\+packet(), Messenger\+::friendlist, Receipts\+::msg\+\_\+id, Receipts\+::next, Receipts\+::packet\+\_\+num, Messenger\+::read\+\_\+receipt, Messenger\+::read\+\_\+receipt\+\_\+userdata, Friend\+::receipts\+\_\+end, and Friend\+::receipts\+\_\+start.



Referenced by do\+\_\+friends().


\begin{DoxyCode}
348 \{
349     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
350         \textcolor{keywordflow}{return} -1;
351 
352     \textcolor{keyword}{struct }\hyperlink{struct_receipts}{Receipts} *receipts = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start};
353 
354     \textcolor{keywordflow}{while} (receipts) \{
355         \textcolor{keyword}{struct }\hyperlink{struct_receipts}{Receipts} *temp\_r = receipts->\hyperlink{struct_receipts_a4cf1c9c7aa66ba420c540e3070555c89}{next};
356 
357         \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a27839390fa4224c2474ad304ee6a199c}{friend\_received\_packet}(m, friendnumber, receipts->
      \hyperlink{struct_receipts_a3110fa374a202ca37de05e1bb9c95f17}{packet\_num}) == -1)
358             \textcolor{keywordflow}{break};
359 
360         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_aa90ada8f04c210bdf2a6da03422ef96b}{read\_receipt})
361             (*m->\hyperlink{struct_messenger_aa90ada8f04c210bdf2a6da03422ef96b}{read\_receipt})(m, friendnumber, receipts->\hyperlink{struct_receipts_a8d62bc717240dc62a7c3595d7b2a75ff}{msg\_id}, m->
      \hyperlink{struct_messenger_a82edcd1ba67ee440c38eb01b3003b900}{read\_receipt\_userdata});
362 
363         free(receipts);
364         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start} = temp\_r;
365         receipts = temp\_r;
366     \}
367 
368     \textcolor{keywordflow}{if} (!m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a49fea7d214384bfdb887ce868fef0e93}{receipts\_start})
369         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ad4ff64ea096ee2af6b53f8d9f7901776}{receipts\_end} = NULL;
370 
371     \textcolor{keywordflow}{return} 0;
372 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac9dcb9b0a9c69f521369a559a1835c57_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac9dcb9b0a9c69f521369a559a1835c57_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a74c09bcf488256da7b3ed899f541fc8c}{\index{Messenger.\+c@{Messenger.\+c}!do\+\_\+reqchunk\+\_\+filecb@{do\+\_\+reqchunk\+\_\+filecb}}
\index{do\+\_\+reqchunk\+\_\+filecb@{do\+\_\+reqchunk\+\_\+filecb}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{do\+\_\+reqchunk\+\_\+filecb}]{\setlength{\rightskip}{0pt plus 5cm}static void do\+\_\+reqchunk\+\_\+filecb (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a74c09bcf488256da7b3ed899f541fc8c}


Definition at line 1404 of file Messenger.\+c.



References crypto\+\_\+num\+\_\+free\+\_\+sendqueue\+\_\+slots(), file\+\_\+data(), F\+I\+L\+E\+\_\+\+P\+A\+U\+S\+E\+\_\+\+N\+O\+T, Messenger\+::file\+\_\+reqchunk, Messenger\+::file\+\_\+reqchunk\+\_\+userdata, Friend\+::file\+\_\+sending, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+F\+I\+N\+I\+S\+H\+E\+D, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+T\+R\+A\+N\+S\+F\+E\+R\+R\+I\+N\+G, Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+received\+\_\+packet(), Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, i, File\+\_\+\+Transfers\+::last\+\_\+packet\+\_\+number, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, max\+\_\+speed\+\_\+reached(), M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E, Messenger\+::net\+\_\+crypto, num, Friend\+::num\+\_\+sending\+\_\+files, File\+\_\+\+Transfers\+::paused, File\+\_\+\+Transfers\+::requested, File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::slots\+\_\+allocated, File\+\_\+\+Transfers\+::status, and File\+\_\+\+Transfers\+::transferred.



Referenced by do\+\_\+friends().


\begin{DoxyCode}
1405 \{
1406     \textcolor{keywordflow}{if} (!m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ac4dcaccdfc6f354a321622e84b27b856}{num\_sending\_files})
1407         \textcolor{keywordflow}{return};
1408 
1409     \textcolor{keywordtype}{int} free\_slots = \hyperlink{net__crypto_8c_a4680603c9714e8742ad580b74ff1d891}{crypto\_num\_free\_sendqueue\_slots}(m->
      \hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
1410                      m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}));
1411 
1412     \textcolor{keywordflow}{if} (free\_slots < \hyperlink{_messenger_8c_a752ad5152ba85410624aa9f3434c320c}{MIN\_SLOTS\_FREE}) \{
1413         free\_slots = 0;
1414     \} \textcolor{keywordflow}{else} \{
1415         free\_slots -= \hyperlink{_messenger_8c_a752ad5152ba85410624aa9f3434c320c}{MIN\_SLOTS\_FREE};
1416     \}
1417 
1418     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_ac4dcaccdfc6f354a321622e84b27b856}{num\_sending\_files};
1419 
1420     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1421         \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}];
1422 
1423         \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE}) \{
1424             --\hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num};
1425 
1426             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea3390080edc54d4bd98c5dc83f5b546ef}{FILESTATUS\_FINISHED}) \{
1427                 \textcolor{comment}{/* Check if file was entirely sent. */}
1428                 \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a27839390fa4224c2474ad304ee6a199c}{friend\_received\_packet}(m, friendnumber, ft->
      \hyperlink{struct_file___transfers_a14f807289cc5523a0081c7f87aed647e}{last\_packet\_number}) == 0) \{
1429                     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a8e913b9866264d0e9518d54b08cc4eeb}{file\_reqchunk})
1430                         (*m->\hyperlink{struct_messenger_a8e913b9866264d0e9518d54b08cc4eeb}{file\_reqchunk})(m, friendnumber, i, ft->
      \hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred}, 0, m->\hyperlink{struct_messenger_afab0bf4f4929791bf8cab5603f400391}{file\_reqchunk\_userdata});
1431 
1432                     ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE};
1433                     --m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ac4dcaccdfc6f354a321622e84b27b856}{num\_sending\_files};
1434                 \}
1435             \}
1436 
1437             \textcolor{comment}{/* TODO: if file is too slow, switch to the next. */}
1438             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ae5c1661a0e1ed999ed054d837989556b}{slots\_allocated} > (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})free\_slots) \{
1439                 free\_slots = 0;
1440             \} \textcolor{keywordflow}{else} \{
1441                 free\_slots -= ft->\hyperlink{struct_file___transfers_ae5c1661a0e1ed999ed054d837989556b}{slots\_allocated};
1442             \}
1443         \}
1444 
1445         \textcolor{keywordflow}{while} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING} && (ft->
      \hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} == \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaabdbd52b891cdbc93735f408af784cac8}{FILE\_PAUSE\_NOT})) \{
1446             \textcolor{keywordflow}{if} (\hyperlink{net__crypto_8c_ac2a5448ebee4fd4f8fd32cc7e3ac69c0}{max\_speed\_reached}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
1447                                   m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}))) \{
1448                 free\_slots = 0;
1449             \}
1450 
1451             \textcolor{keywordflow}{if} (free\_slots == 0)
1452                 \textcolor{keywordflow}{break};
1453 
1454             uint16\_t length = \hyperlink{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{MAX\_FILE\_DATA\_SIZE};
1455 
1456             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} == 0) \{
1457                 \textcolor{comment}{/* Send 0 data to friend if file is 0 length. */}
1458                 \hyperlink{_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4}{file\_data}(m, friendnumber, i, 0, 0, 0);
1459                 \textcolor{keywordflow}{break};
1460             \}
1461 
1462             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} == ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested}) \{
1463                 \textcolor{keywordflow}{break};
1464             \}
1465 
1466             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} - ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested} < length) \{
1467                 length = ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} - ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested};
1468             \}
1469 
1470             ++ft->\hyperlink{struct_file___transfers_ae5c1661a0e1ed999ed054d837989556b}{slots\_allocated};
1471 
1472             uint64\_t position = ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested};
1473             ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested} += length;
1474 
1475             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a8e913b9866264d0e9518d54b08cc4eeb}{file\_reqchunk})
1476                 (*m->\hyperlink{struct_messenger_a8e913b9866264d0e9518d54b08cc4eeb}{file\_reqchunk})(m, friendnumber, i, position, length, m->
      \hyperlink{struct_messenger_afab0bf4f4929791bf8cab5603f400391}{file\_reqchunk\_userdata});
1477 
1478             --free\_slots;
1479 
1480         \}
1481 
1482         \textcolor{keywordflow}{if} (num == 0)
1483             \textcolor{keywordflow}{break};
1484     \}
1485 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a74c09bcf488256da7b3ed899f541fc8c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a74c09bcf488256da7b3ed899f541fc8c_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a903e700229aa9c1e9bc85286c0cc538e}{\index{Messenger.\+c@{Messenger.\+c}!file\+\_\+control@{file\+\_\+control}}
\index{file\+\_\+control@{file\+\_\+control}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{file\+\_\+control}]{\setlength{\rightskip}{0pt plus 5cm}int file\+\_\+control (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{filenumber, }
\item[{unsigned int}]{control}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a903e700229aa9c1e9bc85286c0cc538e}


Definition at line 1137 of file Messenger.\+c.



References F\+I\+L\+E\+\_\+\+P\+A\+U\+S\+E\+\_\+\+O\+T\+H\+E\+R, F\+I\+L\+E\+\_\+\+P\+A\+U\+S\+E\+\_\+\+U\+S, Friend\+::file\+\_\+receiving, Friend\+::file\+\_\+sending, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+A\+C\+C\+E\+P\+T, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+K\+I\+L\+L, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+P\+A\+U\+S\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+T\+\_\+\+A\+C\+C\+E\+P\+T\+E\+D, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+T\+R\+A\+N\+S\+F\+E\+R\+R\+I\+N\+G, friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Messenger\+::friendlist, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, Friend\+::num\+\_\+sending\+\_\+files, File\+\_\+\+Transfers\+::paused, send\+\_\+file\+\_\+control\+\_\+packet(), File\+\_\+\+Transfers\+::status, and Friend\+::status.



Referenced by tox\+\_\+file\+\_\+control().


\begin{DoxyCode}
1138 \{
1139     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1140         \textcolor{keywordflow}{return} -1;
1141 
1142     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
1143         \textcolor{keywordflow}{return} -2;
1144 
1145     uint32\_t temp\_filenum;
1146     uint8\_t send\_receive, file\_number;
1147 
1148     \textcolor{keywordflow}{if} (filenumber >= (1 << 16)) \{
1149         send\_receive = 1;
1150         temp\_filenum = (filenumber >> 16) - 1;
1151     \} \textcolor{keywordflow}{else} \{
1152         send\_receive = 0;
1153         temp\_filenum = filenumber;
1154     \}
1155 
1156     \textcolor{keywordflow}{if} (temp\_filenum >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
1157         \textcolor{keywordflow}{return} -3;
1158 
1159     file\_number = temp\_filenum;
1160 
1161     \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft;
1162 
1163     \textcolor{keywordflow}{if} (send\_receive) \{
1164         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[file\_number];
1165     \} \textcolor{keywordflow}{else} \{
1166         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[file\_number];
1167     \}
1168 
1169     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1170         \textcolor{keywordflow}{return} -3;
1171 
1172     \textcolor{keywordflow}{if} (control > \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaabfc83d4371d6ffa4b02ada9796608d25}{FILECONTROL\_KILL})
1173         \textcolor{keywordflow}{return} -4;
1174 
1175     \textcolor{keywordflow}{if} (control == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaaa3341676bedcc9c05d1b3e371b1d124a}{FILECONTROL\_PAUSE} && ((ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} & 
      \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa31d756cd773da3e3e09c2de2c345c8b7}{FILE\_PAUSE\_US}) || ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING}))
1176         \textcolor{keywordflow}{return} -5;
1177 
1178     \textcolor{keywordflow}{if} (control == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaab3e2718f2b69cc09dbfa5ae95cb9c95f}{FILECONTROL\_ACCEPT}) \{
1179         \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING}) \{
1180             \textcolor{keywordflow}{if} (!(ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} & \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa31d756cd773da3e3e09c2de2c345c8b7}{FILE\_PAUSE\_US})) \{
1181                 \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} & \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa6476b02aafc1383b3d5a1582426c8dd4}{FILE\_PAUSE\_OTHER}) \{
1182                     \textcolor{keywordflow}{return} -6;
1183                 \} \textcolor{keywordflow}{else} \{
1184                     \textcolor{keywordflow}{return} -7;
1185                 \}
1186             \}
1187         \} \textcolor{keywordflow}{else} \{
1188             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1c5e323395e3d4810670c26aac40a0fd}{FILESTATUS\_NOT\_ACCEPTED})
1189                 \textcolor{keywordflow}{return} -7;
1190 
1191             \textcolor{keywordflow}{if} (!send\_receive)
1192                 \textcolor{keywordflow}{return} -6;
1193         \}
1194     \}
1195 
1196     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df}{send\_file\_control\_packet}(m, friendnumber, send\_receive, file\_number, 
      control, 0, 0)) \{
1197         \textcolor{keywordflow}{if} (control == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaabfc83d4371d6ffa4b02ada9796608d25}{FILECONTROL\_KILL}) \{
1198             ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE};
1199 
1200             \textcolor{keywordflow}{if} (send\_receive == 0) \{
1201                 --m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ac4dcaccdfc6f354a321622e84b27b856}{num\_sending\_files};
1202             \}
1203         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (control == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaaa3341676bedcc9c05d1b3e371b1d124a}{FILECONTROL\_PAUSE}) \{
1204             ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} |= \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa31d756cd773da3e3e09c2de2c345c8b7}{FILE\_PAUSE\_US};
1205         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (control == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaab3e2718f2b69cc09dbfa5ae95cb9c95f}{FILECONTROL\_ACCEPT}) \{
1206             ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING};
1207 
1208             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} & \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa31d756cd773da3e3e09c2de2c345c8b7}{FILE\_PAUSE\_US}) \{
1209                 ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} ^=  \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa31d756cd773da3e3e09c2de2c345c8b7}{FILE\_PAUSE\_US};
1210             \}
1211         \}
1212     \} \textcolor{keywordflow}{else} \{
1213         \textcolor{keywordflow}{return} -8;
1214     \}
1215 
1216     \textcolor{keywordflow}{return} 0;
1217 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a903e700229aa9c1e9bc85286c0cc538e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a903e700229aa9c1e9bc85286c0cc538e_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4}{\index{Messenger.\+c@{Messenger.\+c}!file\+\_\+data@{file\+\_\+data}}
\index{file\+\_\+data@{file\+\_\+data}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{file\+\_\+data}]{\setlength{\rightskip}{0pt plus 5cm}int file\+\_\+data (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{filenumber, }
\item[{uint64\+\_\+t}]{position, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4}


Definition at line 1318 of file Messenger.\+c.



References crypto\+\_\+num\+\_\+free\+\_\+sendqueue\+\_\+slots(), Friend\+::file\+\_\+sending, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+F\+I\+N\+I\+S\+H\+E\+D, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+T\+R\+A\+N\+S\+F\+E\+R\+R\+I\+N\+G, Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, File\+\_\+\+Transfers\+::last\+\_\+packet\+\_\+number, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, M\+I\+N\+\_\+\+S\+L\+O\+T\+S\+\_\+\+F\+R\+E\+E, Messenger\+::net\+\_\+crypto, File\+\_\+\+Transfers\+::requested, send\+\_\+file\+\_\+data\+\_\+packet(), File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::slots\+\_\+allocated, File\+\_\+\+Transfers\+::status, Friend\+::status, and File\+\_\+\+Transfers\+::transferred.



Referenced by do\+\_\+reqchunk\+\_\+filecb(), handle\+\_\+packet(), and tox\+\_\+file\+\_\+send\+\_\+chunk().


\begin{DoxyCode}
1320 \{
1321     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1322         \textcolor{keywordflow}{return} -1;
1323 
1324     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
1325         \textcolor{keywordflow}{return} -2;
1326 
1327     \textcolor{keywordflow}{if} (filenumber >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
1328         \textcolor{keywordflow}{return} -3;
1329 
1330     \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[filenumber];
1331 
1332     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING})
1333         \textcolor{keywordflow}{return} -4;
1334 
1335     \textcolor{keywordflow}{if} (length > \hyperlink{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{MAX\_FILE\_DATA\_SIZE})
1336         \textcolor{keywordflow}{return} -5;
1337 
1338     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} - ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} < length) \{
1339         \textcolor{keywordflow}{return} -5;
1340     \}
1341 
1342     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} != UINT64\_MAX && length != \hyperlink{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{MAX\_FILE\_DATA\_SIZE} && (ft->
      \hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} + length) != ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size}) \{
1343         \textcolor{keywordflow}{return} -5;
1344     \}
1345 
1346     \textcolor{keywordflow}{if} (position != ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} || (ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested} <= position && ft->
      \hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} != 0)) \{
1347         \textcolor{keywordflow}{return} -7;
1348     \}
1349 
1350     \textcolor{comment}{/* Prevent file sending from filling up the entire buffer preventing messages from being sent. TODO:
       remove */}
1351     \textcolor{keywordflow}{if} (\hyperlink{net__crypto_8c_a4680603c9714e8742ad580b74ff1d891}{crypto\_num\_free\_sendqueue\_slots}(m->
      \hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
1352                                         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id})) < \hyperlink{_messenger_8c_a752ad5152ba85410624aa9f3434c320c}{MIN\_SLOTS\_FREE})
1353         \textcolor{keywordflow}{return} -6;
1354 
1355     int64\_t ret = \hyperlink{_messenger_8c_a2daa1e5d6fa9bc3c7c92d3cd46b11fb7}{send\_file\_data\_packet}(m, friendnumber, filenumber, 
      \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
1356 
1357     \textcolor{keywordflow}{if} (ret != -1) \{
1358         \textcolor{comment}{//TODO record packet ids to check if other received complete file.}
1359         ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} += length;
1360 
1361         \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ae5c1661a0e1ed999ed054d837989556b}{slots\_allocated}) \{
1362             --ft->\hyperlink{struct_file___transfers_ae5c1661a0e1ed999ed054d837989556b}{slots\_allocated};
1363         \}
1364 
1365         \textcolor{keywordflow}{if} (length != \hyperlink{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{MAX\_FILE\_DATA\_SIZE} || ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} == ft->
      \hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred}) \{
1366             ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea3390080edc54d4bd98c5dc83f5b546ef}{FILESTATUS\_FINISHED};
1367             ft->\hyperlink{struct_file___transfers_a14f807289cc5523a0081c7f87aed647e}{last\_packet\_number} = ret;
1368         \}
1369 
1370         \textcolor{keywordflow}{return} 0;
1371     \}
1372 
1373     \textcolor{keywordflow}{return} -6;
1374 
1375 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a5d437aa0730d3c59af535b242a64c5ef}{\index{Messenger.\+c@{Messenger.\+c}!file\+\_\+dataremaining@{file\+\_\+dataremaining}}
\index{file\+\_\+dataremaining@{file\+\_\+dataremaining}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{file\+\_\+dataremaining}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t file\+\_\+dataremaining (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{filenumber, }
\item[{uint8\+\_\+t}]{send\+\_\+receive}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a5d437aa0730d3c59af535b242a64c5ef}


Definition at line 1384 of file Messenger.\+c.



References Friend\+::file\+\_\+receiving, Friend\+::file\+\_\+sending, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::status, and File\+\_\+\+Transfers\+::transferred.


\begin{DoxyCode}
1385 \{
1386     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1387         \textcolor{keywordflow}{return} 0;
1388 
1389     \textcolor{keywordflow}{if} (send\_receive == 0) \{
1390         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[filenumber].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1391             \textcolor{keywordflow}{return} 0;
1392 
1393         \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[filenumber].
      \hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} -
1394                m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[filenumber].
      \hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred};
1395     \} \textcolor{keywordflow}{else} \{
1396         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[filenumber].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1397             \textcolor{keywordflow}{return} 0;
1398 
1399         \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[filenumber].
      \hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} -
1400                m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[filenumber].
      \hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred};
1401     \}
1402 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{d8/d8d/_messenger_8c_a5d437aa0730d3c59af535b242a64c5ef_cgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a974c036e51abc5ad1e409f685f8667d3}{\index{Messenger.\+c@{Messenger.\+c}!file\+\_\+get\+\_\+id@{file\+\_\+get\+\_\+id}}
\index{file\+\_\+get\+\_\+id@{file\+\_\+get\+\_\+id}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{file\+\_\+get\+\_\+id}]{\setlength{\rightskip}{0pt plus 5cm}int file\+\_\+get\+\_\+id (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{filenumber, }
\item[{uint8\+\_\+t $\ast$}]{file\+\_\+id}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a974c036e51abc5ad1e409f685f8667d3}


Definition at line 993 of file Messenger.\+c.



References F\+I\+L\+E\+\_\+\+I\+D\+\_\+\+L\+E\+N\+G\+T\+H, Friend\+::file\+\_\+receiving, Friend\+::file\+\_\+sending, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Messenger\+::friendlist, File\+\_\+\+Transfers\+::id, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, File\+\_\+\+Transfers\+::status, and Friend\+::status.



Referenced by tox\+\_\+file\+\_\+get\+\_\+file\+\_\+id().


\begin{DoxyCode}
994 \{
995     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
996         \textcolor{keywordflow}{return} -1;
997 
998     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
999         \textcolor{keywordflow}{return} -2;
1000 
1001     uint32\_t temp\_filenum;
1002     uint8\_t send\_receive, file\_number;
1003 
1004     \textcolor{keywordflow}{if} (filenumber >= (1 << 16)) \{
1005         send\_receive = 1;
1006         temp\_filenum = (filenumber >> 16) - 1;
1007     \} \textcolor{keywordflow}{else} \{
1008         send\_receive = 0;
1009         temp\_filenum = filenumber;
1010     \}
1011 
1012     \textcolor{keywordflow}{if} (temp\_filenum >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
1013         \textcolor{keywordflow}{return} -2;
1014 
1015     file\_number = temp\_filenum;
1016 
1017     \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft;
1018 
1019     \textcolor{keywordflow}{if} (send\_receive) \{
1020         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[file\_number];
1021     \} \textcolor{keywordflow}{else} \{
1022         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[file\_number];
1023     \}
1024 
1025     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1026         \textcolor{keywordflow}{return} -2;
1027 
1028     memcpy(file\_id, ft->\hyperlink{struct_file___transfers_aa32dbb3439461c6ccc1a52ff15bcb22e}{id}, \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH});
1029     \textcolor{keywordflow}{return} 0;
1030 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{d8/d8d/_messenger_8c_a974c036e51abc5ad1e409f685f8667d3_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a974c036e51abc5ad1e409f685f8667d3_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_afb102dea48881485a6ea82b43468b327}{\index{Messenger.\+c@{Messenger.\+c}!file\+\_\+seek@{file\+\_\+seek}}
\index{file\+\_\+seek@{file\+\_\+seek}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{file\+\_\+seek}]{\setlength{\rightskip}{0pt plus 5cm}int file\+\_\+seek (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{filenumber, }
\item[{uint64\+\_\+t}]{position}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_afb102dea48881485a6ea82b43468b327}


Definition at line 1230 of file Messenger.\+c.



References Friend\+::file\+\_\+receiving, Friend\+::file\+\_\+sending, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+S\+E\+E\+K, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+T\+\_\+\+A\+C\+C\+E\+P\+T\+E\+D, friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Messenger\+::friendlist, host\+\_\+to\+\_\+net(), M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, send\+\_\+file\+\_\+control\+\_\+packet(), sending\+\_\+pos, File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::status, Friend\+::status, and File\+\_\+\+Transfers\+::transferred.



Referenced by tox\+\_\+file\+\_\+seek().


\begin{DoxyCode}
1231 \{
1232     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1233         \textcolor{keywordflow}{return} -1;
1234 
1235     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
1236         \textcolor{keywordflow}{return} -2;
1237 
1238     uint32\_t temp\_filenum;
1239     uint8\_t send\_receive, file\_number;
1240 
1241     \textcolor{keywordflow}{if} (filenumber >= (1 << 16)) \{
1242         send\_receive = 1;
1243         temp\_filenum = (filenumber >> 16) - 1;
1244     \} \textcolor{keywordflow}{else} \{
1245         \textcolor{keywordflow}{return} -4;
1246     \}
1247 
1248     \textcolor{keywordflow}{if} (temp\_filenum >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
1249         \textcolor{keywordflow}{return} -3;
1250 
1251     file\_number = temp\_filenum;
1252 
1253     \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft;
1254 
1255     \textcolor{keywordflow}{if} (send\_receive) \{
1256         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[file\_number];
1257     \} \textcolor{keywordflow}{else} \{
1258         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[file\_number];
1259     \}
1260 
1261     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1262         \textcolor{keywordflow}{return} -3;
1263 
1264     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1c5e323395e3d4810670c26aac40a0fd}{FILESTATUS\_NOT\_ACCEPTED})
1265         \textcolor{keywordflow}{return} -5;
1266 
1267     \textcolor{keywordflow}{if} (position > ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size}) \{
1268         \textcolor{keywordflow}{return} -6;
1269     \}
1270 
1271     uint64\_t \hyperlink{tox__test_8c_a401389fbbf95a81d03e3bf176869efb5}{sending\_pos} = position;
1272     \hyperlink{util_8c_aa199044077924fcae89d59d2a5af5629}{host\_to\_net}((uint8\_t *)&sending\_pos, \textcolor{keyword}{sizeof}(sending\_pos));
1273 
1274     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df}{send\_file\_control\_packet}(m, friendnumber, send\_receive, file\_number, 
      \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaaaad9c35433f2d88ad2c34332ed6b9ba6}{FILECONTROL\_SEEK}, (uint8\_t *)&sending\_pos,
1275                                  \textcolor{keyword}{sizeof}(sending\_pos))) \{
1276         ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} = position;
1277     \} \textcolor{keywordflow}{else} \{
1278         \textcolor{keywordflow}{return} -8;
1279     \}
1280 
1281     \textcolor{keywordflow}{return} 0;
1282 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_afb102dea48881485a6ea82b43468b327_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_afb102dea48881485a6ea82b43468b327_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_af0e440a0c993bf8a9adbf85b37753337}{\index{Messenger.\+c@{Messenger.\+c}!file\+\_\+sendrequest@{file\+\_\+sendrequest}}
\index{file\+\_\+sendrequest@{file\+\_\+sendrequest}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{file\+\_\+sendrequest}]{\setlength{\rightskip}{0pt plus 5cm}static int file\+\_\+sendrequest (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{filenumber, }
\item[{uint32\+\_\+t}]{file\+\_\+type, }
\item[{uint64\+\_\+t}]{filesize, }
\item[{const uint8\+\_\+t $\ast$}]{file\+\_\+id, }
\item[{const uint8\+\_\+t $\ast$}]{filename, }
\item[{uint16\+\_\+t}]{filename\+\_\+length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_af0e440a0c993bf8a9adbf85b37753337}


Definition at line 1037 of file Messenger.\+c.



References F\+I\+L\+E\+\_\+\+I\+D\+\_\+\+L\+E\+N\+G\+T\+H, friend\+\_\+not\+\_\+valid(), host\+\_\+to\+\_\+net(), M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+I\+L\+E\+\_\+\+S\+E\+N\+D\+R\+E\+Q\+U\+E\+S\+T, and write\+\_\+cryptpacket\+\_\+id().



Referenced by new\+\_\+filesender().


\begin{DoxyCode}
1039 \{
1040     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1041         \textcolor{keywordflow}{return} 0;
1042 
1043     \textcolor{keywordflow}{if} (filename\_length > \hyperlink{_messenger_8c_a6773b93f3093658c3dcb569de3b4bdb2}{MAX\_FILENAME\_LENGTH})
1044         \textcolor{keywordflow}{return} 0;
1045 
1046     uint8\_t packet[1 + \textcolor{keyword}{sizeof}(file\_type) + \textcolor{keyword}{sizeof}(filesize) + \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH} + 
      filename\_length];
1047     packet[0] = filenumber;
1048     file\_type = htonl(file\_type);
1049     memcpy(packet + 1, &file\_type, \textcolor{keyword}{sizeof}(file\_type));
1050     \hyperlink{util_8c_aa199044077924fcae89d59d2a5af5629}{host\_to\_net}((uint8\_t *)&filesize, \textcolor{keyword}{sizeof}(filesize));
1051     memcpy(packet + 1 + \textcolor{keyword}{sizeof}(file\_type), &filesize, \textcolor{keyword}{sizeof}(filesize));
1052     memcpy(packet + 1 + \textcolor{keyword}{sizeof}(file\_type) + \textcolor{keyword}{sizeof}(filesize), file\_id, 
      \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH});
1053 
1054     \textcolor{keywordflow}{if} (filename\_length) \{
1055         memcpy(packet + 1 + \textcolor{keyword}{sizeof}(file\_type) + \textcolor{keyword}{sizeof}(filesize) + 
      \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH}, filename, filename\_length);
1056     \}
1057 
1058     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_a8c622dcdbc701fe3bb19b3b3c9c5d1d0}{PACKET\_ID\_FILE\_SENDREQUEST}, packet, \textcolor{keyword}{sizeof}(packet), 0);
1059 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af0e440a0c993bf8a9adbf85b37753337_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af0e440a0c993bf8a9adbf85b37753337_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a7e298e314b0ad2a4e789728379ceeab2}{\index{Messenger.\+c@{Messenger.\+c}!friend\+\_\+already\+\_\+added@{friend\+\_\+already\+\_\+added}}
\index{friend\+\_\+already\+\_\+added@{friend\+\_\+already\+\_\+added}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{friend\+\_\+already\+\_\+added}]{\setlength{\rightskip}{0pt plus 5cm}static int friend\+\_\+already\+\_\+added (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$}]{real\+\_\+pk, }
\item[{void $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a7e298e314b0ad2a4e789728379ceeab2}


Definition at line 1740 of file Messenger.\+c.



References make-\/funny-\/savefile\+::data, and getfriend\+\_\+id().



Referenced by new\+\_\+messenger().


\begin{DoxyCode}
1741 \{
1742     \textcolor{keyword}{const} \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data};
1743 
1744     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc}{getfriend\_id}(m, real\_pk) == -1)
1745         \textcolor{keywordflow}{return} 0;
1746 
1747     \textcolor{keywordflow}{return} -1;
1748 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a7e298e314b0ad2a4e789728379ceeab2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a7e298e314b0ad2a4e789728379ceeab2_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{\index{Messenger.\+c@{Messenger.\+c}!friend\+\_\+not\+\_\+valid@{friend\+\_\+not\+\_\+valid}}
\index{friend\+\_\+not\+\_\+valid@{friend\+\_\+not\+\_\+valid}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{friend\+\_\+not\+\_\+valid}]{\setlength{\rightskip}{0pt plus 5cm}static uint8\+\_\+t friend\+\_\+not\+\_\+valid (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}


Definition at line 44 of file Messenger.\+c.



References Messenger\+::friendlist, and Friend\+::status.



Referenced by add\+\_\+receipt(), clear\+\_\+receipts(), do\+\_\+receipts(), file\+\_\+control(), file\+\_\+data(), file\+\_\+dataremaining(), file\+\_\+get\+\_\+id(), file\+\_\+seek(), file\+\_\+sendrequest(), friend\+\_\+received\+\_\+packet(), get\+\_\+real\+\_\+pk(), getfriendcon\+\_\+id(), getname(), handle\+\_\+custom\+\_\+lossless\+\_\+packet(), handle\+\_\+custom\+\_\+lossy\+\_\+packet(), m\+\_\+callback\+\_\+rtp\+\_\+packet(), m\+\_\+copy\+\_\+statusmessage(), m\+\_\+delfriend(), m\+\_\+friend\+\_\+exists(), m\+\_\+get\+\_\+friend\+\_\+connectionstatus(), m\+\_\+get\+\_\+istyping(), m\+\_\+get\+\_\+last\+\_\+online(), m\+\_\+get\+\_\+name\+\_\+size(), m\+\_\+get\+\_\+statusmessage\+\_\+size(), m\+\_\+get\+\_\+userstatus(), m\+\_\+send\+\_\+message\+\_\+generic(), m\+\_\+set\+\_\+usertyping(), new\+\_\+filesender(), send\+\_\+custom\+\_\+lossless\+\_\+packet(), send\+\_\+custom\+\_\+lossy\+\_\+packet(), send\+\_\+file\+\_\+data\+\_\+packet(), send\+\_\+online\+\_\+packet(), set\+\_\+friend\+\_\+statusmessage(), setfriendname(), and write\+\_\+cryptpacket\+\_\+id().


\begin{DoxyCode}
45 \{
46     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})friendnumber < m->numfriends) \{
47         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != 0) \{
48             \textcolor{keywordflow}{return} 0;
49         \}
50     \}
51 
52     \textcolor{keywordflow}{return} 1;
53 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d8/d8d/_messenger_8c_a36587bd583123730d702e5a4cb894e5f_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a27839390fa4224c2474ad304ee6a199c}{\index{Messenger.\+c@{Messenger.\+c}!friend\+\_\+received\+\_\+packet@{friend\+\_\+received\+\_\+packet}}
\index{friend\+\_\+received\+\_\+packet@{friend\+\_\+received\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{friend\+\_\+received\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int friend\+\_\+received\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a27839390fa4224c2474ad304ee6a199c}


Definition at line 338 of file Messenger.\+c.



References cryptpacket\+\_\+received(), Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, and Messenger\+::net\+\_\+crypto.



Referenced by do\+\_\+receipts(), and do\+\_\+reqchunk\+\_\+filecb().


\begin{DoxyCode}
339 \{
340     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
341         \textcolor{keywordflow}{return} -1;
342 
343     \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_a8ced352d973b7f835224854ef97f4407}{cryptpacket\_received}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
344                                 m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), number);
345 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a27839390fa4224c2474ad304ee6a199c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a27839390fa4224c2474ad304ee6a199c_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ad971e0d0877b61a160884d59527d39d9}{\index{Messenger.\+c@{Messenger.\+c}!friends\+\_\+list\+\_\+load@{friends\+\_\+list\+\_\+load}}
\index{friends\+\_\+list\+\_\+load@{friends\+\_\+list\+\_\+load}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{friends\+\_\+list\+\_\+load}]{\setlength{\rightskip}{0pt plus 5cm}static int friends\+\_\+list\+\_\+load (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_ad971e0d0877b61a160884d59527d39d9}


Definition at line 2499 of file Messenger.\+c.



References address\+\_\+checksum(), F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+R\+E\+S\+S\+\_\+\+S\+I\+Z\+E, Messenger\+::friendlist, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::friendrequest\+\_\+nospam, i, id\+\_\+copy(), S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::info, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::info\+\_\+size, Friend\+::last\+\_\+seen\+\_\+time, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::last\+\_\+seen\+\_\+time, m\+\_\+addfriend(), m\+\_\+addfriend\+\_\+norequest(), S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::name, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::name\+\_\+length, net\+\_\+to\+\_\+host, num, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::real\+\_\+pk, set\+\_\+friend\+\_\+statusmessage(), set\+\_\+friend\+\_\+userstatus(), setfriendname(), S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::status, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::statusmessage, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::statusmessage\+\_\+length, and S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::userstatus.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback().


\begin{DoxyCode}
2500 \{
2501     \textcolor{keywordflow}{if} (length % \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND}) != 0) \{
2502         \textcolor{keywordflow}{return} -1;
2503     \}
2504 
2505     uint32\_t \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} = length / \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND});
2506     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2507 
2508     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
2509         \textcolor{keyword}{struct }\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND} temp;
2510         memcpy(&temp, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} + i * \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND}), \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND}));
2511 
2512         \textcolor{keywordflow}{if} (temp.status >= 3) \{
2513             \textcolor{keywordtype}{int} fnum = \hyperlink{_messenger_8c_a2f7aa06733a25e8c0edc8f31a22a78dc}{m\_addfriend\_norequest}(m, temp.real\_pk);
2514 
2515             \textcolor{keywordflow}{if} (fnum < 0)
2516                 \textcolor{keywordflow}{continue};
2517 
2518             \hyperlink{_messenger_8c_a732b3e72ea8d98d4e038f7ed83fbe5be}{setfriendname}(m, fnum, temp.\hyperlink{struct_messenger_a11b8cc6595eea79e65c978209278e683}{name}, ntohs(temp.name\_length));
2519             \hyperlink{_messenger_8c_ad317d62e3ddf9894af11093d30cae31b}{set\_friend\_statusmessage}(m, fnum, temp.
      \hyperlink{struct_messenger_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, ntohs(temp.statusmessage\_length));
2520             \hyperlink{_messenger_8c_a57a114bf07876ef46d27c7cfee31137f}{set\_friend\_userstatus}(m, fnum, temp.\hyperlink{struct_messenger_adde524f5a15465585cbc2543cd0b2710}{userstatus});
2521             uint8\_t \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}[\textcolor{keyword}{sizeof}(uint64\_t)];
2522             memcpy(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, &temp.last\_seen\_time, \textcolor{keyword}{sizeof}(uint64\_t));
2523             \hyperlink{util_8h_a997aabaef0c91865b7db6f52da01c65b}{net\_to\_host}(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, \textcolor{keyword}{sizeof}(uint64\_t));
2524             memcpy(&m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[fnum].\hyperlink{struct_friend_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, 
      \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, \textcolor{keyword}{sizeof}(uint64\_t));
2525         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (temp.status != 0) \{
2526             \textcolor{comment}{/* TODO: This is not a good way to do this. */}
2527             uint8\_t address[\hyperlink{_messenger_8h_a22c0e97a4b45902742a86bba24cc5d5d}{FRIEND\_ADDRESS\_SIZE}];
2528             \hyperlink{util_8c_aa30049b8c1d82c280d6d872feea3353b}{id\_copy}(address, temp.real\_pk);
2529             memcpy(address + crypto\_box\_PUBLICKEYBYTES, &(temp.friendrequest\_nospam), \textcolor{keyword}{sizeof}(uint32\_t));
2530             uint16\_t checksum = \hyperlink{_messenger_8c_a31c1f385ae903fdf82773998b54009fc}{address\_checksum}(address, 
      \hyperlink{_messenger_8h_a22c0e97a4b45902742a86bba24cc5d5d}{FRIEND\_ADDRESS\_SIZE} - \textcolor{keyword}{sizeof}(checksum));
2531             memcpy(address + crypto\_box\_PUBLICKEYBYTES + \textcolor{keyword}{sizeof}(uint32\_t), &checksum, \textcolor{keyword}{sizeof}(checksum));
2532             \hyperlink{_messenger_8c_ac77431b1ab0b12af003657e11057bd9c}{m\_addfriend}(m, address, temp.info, ntohs(temp.info\_size));
2533         \}
2534     \}
2535 
2536     \textcolor{keywordflow}{return} \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num};
2537 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ad971e0d0877b61a160884d59527d39d9_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ad971e0d0877b61a160884d59527d39d9_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a25018a4f99e9bba64b138fbc5fe35eea}{\index{Messenger.\+c@{Messenger.\+c}!friends\+\_\+list\+\_\+save@{friends\+\_\+list\+\_\+save}}
\index{friends\+\_\+list\+\_\+save@{friends\+\_\+list\+\_\+save}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{friends\+\_\+list\+\_\+save}]{\setlength{\rightskip}{0pt plus 5cm}static uint32\+\_\+t friends\+\_\+list\+\_\+save (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{uint8\+\_\+t $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a25018a4f99e9bba64b138fbc5fe35eea}


Definition at line 2457 of file Messenger.\+c.



References Messenger\+::friendlist, Friend\+::friendrequest\+\_\+nospam, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::friendrequest\+\_\+nospam, host\+\_\+to\+\_\+net(), i, Friend\+::info, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::info, Friend\+::info\+\_\+size, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::info\+\_\+size, Friend\+::last\+\_\+seen\+\_\+time, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::last\+\_\+seen\+\_\+time, Friend\+::name, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::name, Friend\+::name\+\_\+length, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::name\+\_\+length, num, Messenger\+::numfriends, Friend\+::real\+\_\+pk, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::real\+\_\+pk, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+S\+I\+Z\+E, Friend\+::status, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::status, Friend\+::statusmessage, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::statusmessage, Friend\+::statusmessage\+\_\+length, S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::statusmessage\+\_\+length, Friend\+::userstatus, and S\+A\+V\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+::userstatus.



Referenced by messenger\+\_\+save().


\begin{DoxyCode}
2458 \{
2459     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
2460     uint32\_t \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} = 0;
2461 
2462     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; i++) \{
2463         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} > 0) \{
2464             \textcolor{keyword}{struct }\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND} temp;
2465             memset(&temp, 0, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND}));
2466             temp.status = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status};
2467             memcpy(temp.real\_pk, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}, crypto\_box\_PUBLICKEYBYTES);
2468 
2469             \textcolor{keywordflow}{if} (temp.status < 3) \{
2470                 \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ac0ae002db55ef8f8366de10ec005b65a}{info\_size} > 
      \hyperlink{_messenger_8c_a5546558d2255f81d24707b447cb5bb94}{SAVED\_FRIEND\_REQUEST\_SIZE}) \{
2471                     memcpy(temp.info, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ae1a1264e17ce4eedae67c283a09236e6}{info}, 
      \hyperlink{_messenger_8c_a5546558d2255f81d24707b447cb5bb94}{SAVED\_FRIEND\_REQUEST\_SIZE});
2472                 \} \textcolor{keywordflow}{else} \{
2473                     memcpy(temp.info, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ae1a1264e17ce4eedae67c283a09236e6}{info}, m->
      \hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ac0ae002db55ef8f8366de10ec005b65a}{info\_size});
2474                 \}
2475 
2476                 temp.info\_size = htons(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ac0ae002db55ef8f8366de10ec005b65a}{info\_size});
2477                 temp.friendrequest\_nospam = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].
      \hyperlink{struct_friend_a0fae9801a4789a368f90125119e31f3f}{friendrequest\_nospam};
2478             \} \textcolor{keywordflow}{else} \{
2479                 memcpy(temp.name, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_a11b8cc6595eea79e65c978209278e683}{name}, m->
      \hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length});
2480                 temp.name\_length = htons(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length});
2481                 memcpy(temp.statusmessage, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length});
2482                 temp.statusmessage\_length = htons(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length});
2483                 temp.userstatus = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_adde524f5a15465585cbc2543cd0b2710}{userstatus};
2484 
2485                 uint8\_t \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}[\textcolor{keyword}{sizeof}(uint64\_t)];
2486                 memcpy(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, \textcolor{keyword}{sizeof}(uint64\_t));
2487                 \hyperlink{util_8c_aa199044077924fcae89d59d2a5af5629}{host\_to\_net}(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, \textcolor{keyword}{sizeof}(uint64\_t));
2488                 memcpy(&temp.last\_seen\_time, \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time}, \textcolor{keyword}{sizeof}(uint64\_t));
2489             \}
2490 
2491             memcpy(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} + num * \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND}), &temp, \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} 
      \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND}));
2492             num++;
2493         \}
2494     \}
2495 
2496     \textcolor{keywordflow}{return} num * \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND});
2497 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{d8/d8d/_messenger_8c_a25018a4f99e9bba64b138fbc5fe35eea_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a25018a4f99e9bba64b138fbc5fe35eea_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a8348df936215ea10b7c3ca129100f5ce}{\index{Messenger.\+c@{Messenger.\+c}!get\+\_\+real\+\_\+pk@{get\+\_\+real\+\_\+pk}}
\index{get\+\_\+real\+\_\+pk@{get\+\_\+real\+\_\+pk}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{get\+\_\+real\+\_\+pk}]{\setlength{\rightskip}{0pt plus 5cm}int get\+\_\+real\+\_\+pk (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t $\ast$}]{real\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a8348df936215ea10b7c3ca129100f5ce}


Definition at line 98 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, and Friend\+::real\+\_\+pk.



Referenced by tox\+\_\+friend\+\_\+get\+\_\+public\+\_\+key().


\begin{DoxyCode}
99 \{
100     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
101         \textcolor{keywordflow}{return} -1;
102 
103     memcpy(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}, crypto\_box\_PUBLICKEYBYTES)
      ;
104     \textcolor{keywordflow}{return} 0;
105 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{d8/d8d/_messenger_8c_a8348df936215ea10b7c3ca129100f5ce_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a8348df936215ea10b7c3ca129100f5ce_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a50d7f1102c25158f02b2943dcfe253c8}{\index{Messenger.\+c@{Messenger.\+c}!getaddress@{getaddress}}
\index{getaddress@{getaddress}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{getaddress}]{\setlength{\rightskip}{0pt plus 5cm}void getaddress (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{uint8\+\_\+t $\ast$}]{address}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a50d7f1102c25158f02b2943dcfe253c8}


Definition at line 138 of file Messenger.\+c.



References address\+\_\+checksum(), Messenger\+::fr, F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+R\+E\+S\+S\+\_\+\+S\+I\+Z\+E, get\+\_\+nospam(), id\+\_\+copy(), Messenger\+::net\+\_\+crypto, make-\/funny-\/savefile\+::nospam, and Net\+\_\+\+Crypto\+::self\+\_\+public\+\_\+key.



Referenced by main(), and tox\+\_\+self\+\_\+get\+\_\+address().


\begin{DoxyCode}
139 \{
140     \hyperlink{util_8c_aa30049b8c1d82c280d6d872feea3353b}{id\_copy}(address, m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}->\hyperlink{struct_net___crypto_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key});
141     uint32\_t \hyperlink{namespacemake-funny-savefile_a2581b35f119a2bbce475223789ed742c}{nospam} = \hyperlink{friend__requests_8c_a1e61ffb4aba6cf8815238ccc2d18c794}{get\_nospam}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}));
142     memcpy(address + crypto\_box\_PUBLICKEYBYTES, &nospam, \textcolor{keyword}{sizeof}(nospam));
143     uint16\_t checksum = \hyperlink{_messenger_8c_a31c1f385ae903fdf82773998b54009fc}{address\_checksum}(address, 
      \hyperlink{_messenger_8h_a22c0e97a4b45902742a86bba24cc5d5d}{FRIEND\_ADDRESS\_SIZE} - \textcolor{keyword}{sizeof}(checksum));
144     memcpy(address + crypto\_box\_PUBLICKEYBYTES + \textcolor{keyword}{sizeof}(nospam), &checksum, \textcolor{keyword}{sizeof}(checksum));
145 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{d8/d8d/_messenger_8c_a50d7f1102c25158f02b2943dcfe253c8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a50d7f1102c25158f02b2943dcfe253c8_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc}{\index{Messenger.\+c@{Messenger.\+c}!getfriend\+\_\+id@{getfriend\+\_\+id}}
\index{getfriend\+\_\+id@{getfriend\+\_\+id}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{getfriend\+\_\+id}]{\setlength{\rightskip}{0pt plus 5cm}int32\+\_\+t getfriend\+\_\+id (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{real\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc}


Definition at line 79 of file Messenger.\+c.



References Messenger\+::friendlist, i, id\+\_\+equal(), Messenger\+::numfriends, Friend\+::real\+\_\+pk, and Friend\+::status.



Referenced by friend\+\_\+already\+\_\+added(), m\+\_\+addfriend(), m\+\_\+addfriend\+\_\+norequest(), main(), and tox\+\_\+friend\+\_\+by\+\_\+public\+\_\+key().


\begin{DoxyCode}
80 \{
81     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
82 
83     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
84         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} > 0)
85             \textcolor{keywordflow}{if} (\hyperlink{util_8c_ada3d44b4f530d3c8c9cb69b732be94b1}{id\_equal}(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].
      \hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}))
86                 \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
87     \}
88 
89     \textcolor{keywordflow}{return} -1;
90 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{d8/d8d/_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_adde4551a2e1898aab1de8e0b7f7c9792}{\index{Messenger.\+c@{Messenger.\+c}!getfriendcon\+\_\+id@{getfriendcon\+\_\+id}}
\index{getfriendcon\+\_\+id@{getfriendcon\+\_\+id}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{getfriendcon\+\_\+id}]{\setlength{\rightskip}{0pt plus 5cm}int getfriendcon\+\_\+id (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_adde4551a2e1898aab1de8e0b7f7c9792}


Definition at line 110 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Friend\+::friendcon\+\_\+id, and Messenger\+::friendlist.



Referenced by handle\+\_\+friend\+\_\+invite\+\_\+packet(), and join\+\_\+groupchat().


\begin{DoxyCode}
111 \{
112     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
113         \textcolor{keywordflow}{return} -1;
114 
115     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id};
116 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=284pt]{d8/d8d/_messenger_8c_adde4551a2e1898aab1de8e0b7f7c9792_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_adde4551a2e1898aab1de8e0b7f7c9792_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a59c33c3a3b0e1dd9f86267f59c380bee}{\index{Messenger.\+c@{Messenger.\+c}!getname@{getname}}
\index{getname@{getname}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{getname}]{\setlength{\rightskip}{0pt plus 5cm}int getname (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a59c33c3a3b0e1dd9f86267f59c380bee}


Definition at line 570 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Friend\+::name, and Friend\+::name\+\_\+length.



Referenced by main(), messenger\+\_\+suite(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+friend\+\_\+get\+\_\+name().


\begin{DoxyCode}
571 \{
572     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
573         \textcolor{keywordflow}{return} -1;
574 
575     memcpy(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a11b8cc6595eea79e65c978209278e683}{name}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a11b8cc6595eea79e65c978209278e683}{name}, m->
      \hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length});
576     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length};
577 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=255pt]{d8/d8d/_messenger_8c_a59c33c3a3b0e1dd9f86267f59c380bee_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a59c33c3a3b0e1dd9f86267f59c380bee_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a6d4bfd8f9f8ecfff61c2619988fd3bb9}{\index{Messenger.\+c@{Messenger.\+c}!getself\+\_\+name@{getself\+\_\+name}}
\index{getself\+\_\+name@{getself\+\_\+name}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{getself\+\_\+name}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t getself\+\_\+name (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{uint8\+\_\+t $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a6d4bfd8f9f8ecfff61c2619988fd3bb9}


Definition at line 553 of file Messenger.\+c.



References Messenger\+::name, and Messenger\+::name\+\_\+length.



Referenced by messenger\+\_\+suite(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+self\+\_\+get\+\_\+name().


\begin{DoxyCode}
554 \{
555     \textcolor{keywordflow}{if} (\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a11b8cc6595eea79e65c978209278e683}{name} == NULL) \{
556         \textcolor{keywordflow}{return} 0;
557     \}
558 
559     memcpy(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a11b8cc6595eea79e65c978209278e683}{name}, m->\hyperlink{struct_messenger_a11b8cc6595eea79e65c978209278e683}{name}, m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length});
560 
561     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length};
562 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a6d4bfd8f9f8ecfff61c2619988fd3bb9_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a4816c8b0bbf3b241f07654a2b6593fee}{\index{Messenger.\+c@{Messenger.\+c}!handle\+\_\+custom\+\_\+lossless\+\_\+packet@{handle\+\_\+custom\+\_\+lossless\+\_\+packet}}
\index{handle\+\_\+custom\+\_\+lossless\+\_\+packet@{handle\+\_\+custom\+\_\+lossless\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{handle\+\_\+custom\+\_\+lossless\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int handle\+\_\+custom\+\_\+lossless\+\_\+packet (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{int}]{friend\+\_\+num, }
\item[{const uint8\+\_\+t $\ast$}]{packet, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a4816c8b0bbf3b241f07654a2b6593fee}


Definition at line 1688 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::lossless\+\_\+packethandler, Messenger\+::lossless\+\_\+packethandler\+\_\+userdata, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+L\+E\+S\+S\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+I\+Z\+E, and P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+L\+E\+S\+S\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+T\+A\+R\+T.



Referenced by handle\+\_\+packet().


\begin{DoxyCode}
1689 \{
1690     \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = object;
1691 
1692     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friend\_num))
1693         \textcolor{keywordflow}{return} -1;
1694 
1695     \textcolor{keywordflow}{if} (packet[0] < \hyperlink{_messenger_8h_ac297bd3de6eaa53acdcc0ede5892cee7}{PACKET\_ID\_LOSSLESS\_RANGE\_START})
1696         \textcolor{keywordflow}{return} -1;
1697 
1698     \textcolor{keywordflow}{if} (packet[0] >= (\hyperlink{_messenger_8h_ac297bd3de6eaa53acdcc0ede5892cee7}{PACKET\_ID\_LOSSLESS\_RANGE\_START} + 
      \hyperlink{_messenger_8h_ad9c466b6913d23d38622cbaf651b7fba}{PACKET\_ID\_LOSSLESS\_RANGE\_SIZE}))
1699         \textcolor{keywordflow}{return} -1;
1700 
1701     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_ade523661676bfd811bd8676c29600900}{lossless\_packethandler})
1702         m->\hyperlink{struct_messenger_ade523661676bfd811bd8676c29600900}{lossless\_packethandler}(m, friend\_num, packet, length, m->
      \hyperlink{struct_messenger_aa46ae2a29721e8b27e0d4aac8b64b195}{lossless\_packethandler\_userdata});
1703 
1704     \textcolor{keywordflow}{return} 1;
1705 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{d8/d8d/_messenger_8c_a4816c8b0bbf3b241f07654a2b6593fee_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4816c8b0bbf3b241f07654a2b6593fee_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a24c5719d515558a6e9d768a861d6dc22}{\index{Messenger.\+c@{Messenger.\+c}!handle\+\_\+custom\+\_\+lossy\+\_\+packet@{handle\+\_\+custom\+\_\+lossy\+\_\+packet}}
\index{handle\+\_\+custom\+\_\+lossy\+\_\+packet@{handle\+\_\+custom\+\_\+lossy\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{handle\+\_\+custom\+\_\+lossy\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int handle\+\_\+custom\+\_\+lossy\+\_\+packet (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{int}]{friend\+\_\+num, }
\item[{const uint8\+\_\+t $\ast$}]{packet, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a24c5719d515558a6e9d768a861d6dc22}


Definition at line 1615 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Friend\+::function, Messenger\+::lossy\+\_\+packethandler, Messenger\+::lossy\+\_\+packethandler\+\_\+userdata, Friend\+::lossy\+\_\+rtp\+\_\+packethandlers, Friend\+::object, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+Y\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+T\+A\+R\+T, and P\+A\+C\+K\+E\+T\+\_\+\+L\+O\+S\+S\+Y\+\_\+\+A\+V\+\_\+\+R\+E\+S\+E\+R\+V\+E\+D.



Referenced by init\+\_\+new\+\_\+friend().


\begin{DoxyCode}
1616 \{
1617     \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = object;
1618 
1619     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friend\_num))
1620         \textcolor{keywordflow}{return} 1;
1621 
1622     \textcolor{keywordflow}{if} (packet[0] < (\hyperlink{net__crypto_8h_a02481d2cc931289c2d5ee21d2a633316}{PACKET\_ID\_LOSSY\_RANGE\_START} + 
      \hyperlink{_messenger_8h_a9e9b181fad5abaed171e4b4481490d1e}{PACKET\_LOSSY\_AV\_RESERVED})) \{
1623         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friend\_num].\hyperlink{struct_friend_af8c513c69f17fc044615b18ec03f9911}{lossy\_rtp\_packethandlers}[packet[0] 
      % \hyperlink{_messenger_8h_a9e9b181fad5abaed171e4b4481490d1e}{PACKET\_LOSSY\_AV\_RESERVED}].\hyperlink{struct_friend_a726a4dcb820b33fd434494d56f532867}{function})
1624             \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friend\_num].\hyperlink{struct_friend_af8c513c69f17fc044615b18ec03f9911}{lossy\_rtp\_packethandlers}[
      packet[0] % \hyperlink{_messenger_8h_a9e9b181fad5abaed171e4b4481490d1e}{PACKET\_LOSSY\_AV\_RESERVED}].\hyperlink{struct_friend_a726a4dcb820b33fd434494d56f532867}{function}(
1625                        m, friend\_num, packet, length, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friend\_num].
      \hyperlink{struct_friend_af8c513c69f17fc044615b18ec03f9911}{lossy\_rtp\_packethandlers}[packet[0] %
1626                                PACKET\_LOSSY\_AV\_RESERVED].\hyperlink{struct_friend_a077376d12464f945e2414d5499c79b3f}{object});
1627 
1628         \textcolor{keywordflow}{return} 1;
1629     \}
1630 
1631     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_afba23a025d7275ca11e8f7d56386d3d1}{lossy\_packethandler})
1632         m->\hyperlink{struct_messenger_afba23a025d7275ca11e8f7d56386d3d1}{lossy\_packethandler}(m, friend\_num, packet, length, m->
      \hyperlink{struct_messenger_a2b87de1f33a502c6dd105cd69a905c35}{lossy\_packethandler\_userdata});
1633 
1634     \textcolor{keywordflow}{return} 1;
1635 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{d8/d8d/_messenger_8c_a24c5719d515558a6e9d768a861d6dc22_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a24c5719d515558a6e9d768a861d6dc22_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a56b6a138fb4522b859fda806c8ca4c20}{\index{Messenger.\+c@{Messenger.\+c}!handle\+\_\+filecontrol@{handle\+\_\+filecontrol}}
\index{handle\+\_\+filecontrol@{handle\+\_\+filecontrol}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{handle\+\_\+filecontrol}]{\setlength{\rightskip}{0pt plus 5cm}static int handle\+\_\+filecontrol (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{receive\+\_\+send, }
\item[{uint8\+\_\+t}]{filenumber, }
\item[{uint8\+\_\+t}]{control\+\_\+type, }
\item[{uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a56b6a138fb4522b859fda806c8ca4c20}


Definition at line 1506 of file Messenger.\+c.



References Messenger\+::file\+\_\+filecontrol, Messenger\+::file\+\_\+filecontrol\+\_\+userdata, F\+I\+L\+E\+\_\+\+P\+A\+U\+S\+E\+\_\+\+O\+T\+H\+E\+R, Friend\+::file\+\_\+receiving, Friend\+::file\+\_\+sending, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+A\+C\+C\+E\+P\+T, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+K\+I\+L\+L, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+P\+A\+U\+S\+E, F\+I\+L\+E\+C\+O\+N\+T\+R\+O\+L\+\_\+\+S\+E\+E\+K, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+T\+\_\+\+A\+C\+C\+E\+P\+T\+E\+D, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+T\+R\+A\+N\+S\+F\+E\+R\+R\+I\+N\+G, Messenger\+::friendlist, net\+\_\+to\+\_\+host, Friend\+::num\+\_\+sending\+\_\+files, File\+\_\+\+Transfers\+::paused, File\+\_\+\+Transfers\+::requested, send\+\_\+file\+\_\+control\+\_\+packet(), File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::status, and File\+\_\+\+Transfers\+::transferred.



Referenced by handle\+\_\+packet().


\begin{DoxyCode}
1508 \{
1509     \textcolor{keywordflow}{if} (receive\_send > 1)
1510         \textcolor{keywordflow}{return} -1;
1511 
1512     \textcolor{keywordflow}{if} (control\_type > \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaaaad9c35433f2d88ad2c34332ed6b9ba6}{FILECONTROL\_SEEK})
1513         \textcolor{keywordflow}{return} -1;
1514 
1515     uint32\_t real\_filenumber = filenumber;
1516     \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft;
1517 
1518     \textcolor{keywordflow}{if} (receive\_send == 0) \{
1519         real\_filenumber += 1;
1520         real\_filenumber <<= 16;
1521         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[filenumber];
1522     \} \textcolor{keywordflow}{else} \{
1523         ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[filenumber];
1524     \}
1525 
1526     \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE}) \{
1527         \textcolor{comment}{/* File transfer doesn't exist, tell the other to kill it. */}
1528         \hyperlink{_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df}{send\_file\_control\_packet}(m, friendnumber, !receive\_send, filenumber, 
      \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaabfc83d4371d6ffa4b02ada9796608d25}{FILECONTROL\_KILL}, 0, 0);
1529         \textcolor{keywordflow}{return} -1;
1530     \}
1531 
1532     \textcolor{keywordflow}{if} (control\_type == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaab3e2718f2b69cc09dbfa5ae95cb9c95f}{FILECONTROL\_ACCEPT}) \{
1533         \textcolor{keywordflow}{if} (receive\_send && ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1c5e323395e3d4810670c26aac40a0fd}{FILESTATUS\_NOT\_ACCEPTED}) \{
1534             ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING};
1535         \} \textcolor{keywordflow}{else} \{
1536             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} & \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa6476b02aafc1383b3d5a1582426c8dd4}{FILE\_PAUSE\_OTHER}) \{
1537                 ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} ^= \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa6476b02aafc1383b3d5a1582426c8dd4}{FILE\_PAUSE\_OTHER};
1538             \} \textcolor{keywordflow}{else} \{
1539                 \textcolor{keywordflow}{return} -1;
1540             \}
1541         \}
1542 
1543         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol})
1544             (*m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol})(m, friendnumber, real\_filenumber, control\_type, m->
      \hyperlink{struct_messenger_a34ba46a8cf11b02a23f7a7d219608c3b}{file\_filecontrol\_userdata});
1545     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (control\_type == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaaa3341676bedcc9c05d1b3e371b1d124a}{FILECONTROL\_PAUSE}) \{
1546         \textcolor{keywordflow}{if} ((ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} & \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa6476b02aafc1383b3d5a1582426c8dd4}{FILE\_PAUSE\_OTHER}) || ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != 
      \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING}) \{
1547             \textcolor{keywordflow}{return} -1;
1548         \}
1549 
1550         ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} |= \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaa6476b02aafc1383b3d5a1582426c8dd4}{FILE\_PAUSE\_OTHER};
1551 
1552         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol})
1553             (*m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol})(m, friendnumber, real\_filenumber, control\_type, m->
      \hyperlink{struct_messenger_a34ba46a8cf11b02a23f7a7d219608c3b}{file\_filecontrol\_userdata});
1554     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (control\_type == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaabfc83d4371d6ffa4b02ada9796608d25}{FILECONTROL\_KILL}) \{
1555 
1556         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol})
1557             (*m->\hyperlink{struct_messenger_a1e3990148af844c986e09a946650f7f3}{file\_filecontrol})(m, friendnumber, real\_filenumber, control\_type, m->
      \hyperlink{struct_messenger_a34ba46a8cf11b02a23f7a7d219608c3b}{file\_filecontrol\_userdata});
1558 
1559         ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE};
1560 
1561         \textcolor{keywordflow}{if} (receive\_send) \{
1562             --m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ac4dcaccdfc6f354a321622e84b27b856}{num\_sending\_files};
1563         \}
1564 
1565     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (control\_type == \hyperlink{_messenger_8h_a6b7b47dd702d9e331586d485013fd1eaaaad9c35433f2d88ad2c34332ed6b9ba6}{FILECONTROL\_SEEK}) \{
1566         uint64\_t position;
1567 
1568         \textcolor{keywordflow}{if} (length != \textcolor{keyword}{sizeof}(position)) \{
1569             \textcolor{keywordflow}{return} -1;
1570         \}
1571 
1572         \textcolor{comment}{/* seek can only be sent by the receiver to seek before resuming broken tranfers. */}
1573         \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1c5e323395e3d4810670c26aac40a0fd}{FILESTATUS\_NOT\_ACCEPTED} || !receive\_send) \{
1574             \textcolor{keywordflow}{return} -1;
1575         \}
1576 
1577         memcpy(&position, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, \textcolor{keyword}{sizeof}(position));
1578         \hyperlink{util_8h_a997aabaef0c91865b7db6f52da01c65b}{net\_to\_host}((uint8\_t *) &position, \textcolor{keyword}{sizeof}(position));
1579 
1580         \textcolor{keywordflow}{if} (position > ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size}) \{
1581             \textcolor{keywordflow}{return} -1;
1582         \}
1583 
1584         ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} = ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested} = position;
1585     \} \textcolor{keywordflow}{else} \{
1586         \textcolor{keywordflow}{return} -1;
1587     \}
1588 
1589     \textcolor{keywordflow}{return} 0;
1590 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a56b6a138fb4522b859fda806c8ca4c20_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a56b6a138fb4522b859fda806c8ca4c20_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a8fce9b8564a3a552ff2b77a9f81914ad}{\index{Messenger.\+c@{Messenger.\+c}!handle\+\_\+packet@{handle\+\_\+packet}}
\index{handle\+\_\+packet@{handle\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{handle\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int handle\+\_\+packet (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{int}]{i, }
\item[{uint8\+\_\+t $\ast$}]{temp, }
\item[{uint16\+\_\+t}]{len}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a8fce9b8564a3a552ff2b77a9f81914ad}


Definition at line 1908 of file Messenger.\+c.



References make-\/funny-\/savefile\+::data, file\+\_\+data(), Messenger\+::file\+\_\+filedata, Messenger\+::file\+\_\+filedata\+\_\+userdata, F\+I\+L\+E\+\_\+\+I\+D\+\_\+\+L\+E\+N\+G\+T\+H, F\+I\+L\+E\+\_\+\+P\+A\+U\+S\+E\+\_\+\+N\+O\+T, Friend\+::file\+\_\+receiving, Messenger\+::file\+\_\+sendrequest, Messenger\+::file\+\_\+sendrequest\+\_\+userdata, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+T\+\_\+\+A\+C\+C\+E\+P\+T\+E\+D, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+T\+R\+A\+N\+S\+F\+E\+R\+R\+I\+N\+G, F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+F\+I\+R\+M\+E\+D, Messenger\+::friend\+\_\+message, Messenger\+::friend\+\_\+message\+\_\+userdata, Messenger\+::friend\+\_\+namechange, Messenger\+::friend\+\_\+namechange\+\_\+userdata, F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Messenger\+::friend\+\_\+statusmessagechange, Messenger\+::friend\+\_\+statusmessagechange\+\_\+userdata, Messenger\+::friend\+\_\+typingchange, Messenger\+::friend\+\_\+typingchange\+\_\+userdata, Messenger\+::friend\+\_\+userstatuschange, Messenger\+::friend\+\_\+userstatuschange\+\_\+userdata, Messenger\+::friendlist, Messenger\+::group\+\_\+invite, handle\+\_\+custom\+\_\+lossless\+\_\+packet(), handle\+\_\+filecontrol(), i, File\+\_\+\+Transfers\+::id, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, M\+A\+X\+\_\+\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, M\+A\+X\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+T\+H, Messenger\+::msi\+\_\+packet, Messenger\+::msi\+\_\+packet\+\_\+userdata, Friend\+::name, Friend\+::name\+\_\+length, net\+\_\+to\+\_\+host, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+C\+T\+I\+O\+N, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+I\+L\+E\+\_\+\+C\+O\+N\+T\+R\+O\+L, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+I\+L\+E\+\_\+\+S\+E\+N\+D\+R\+E\+Q\+U\+E\+S\+T, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+I\+N\+V\+I\+T\+E\+\_\+\+G\+R\+O\+U\+P\+C\+H\+A\+T, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+M\+E\+S\+S\+A\+G\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+M\+S\+I, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+N\+I\+C\+K\+N\+A\+M\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+O\+F\+F\+L\+I\+N\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+O\+N\+L\+I\+N\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+T\+Y\+P\+I\+N\+G, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+U\+S\+E\+R\+S\+T\+A\+T\+U\+S, File\+\_\+\+Transfers\+::paused, send\+\_\+online\+\_\+packet(), set\+\_\+friend\+\_\+status(), set\+\_\+friend\+\_\+statusmessage(), set\+\_\+friend\+\_\+typing(), set\+\_\+friend\+\_\+userstatus(), File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::status, Friend\+::status, File\+\_\+\+Transfers\+::transferred, and U\+S\+E\+R\+S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D.



Referenced by init\+\_\+new\+\_\+friend().


\begin{DoxyCode}
1909 \{
1910     \textcolor{keywordflow}{if} (len == 0)
1911         \textcolor{keywordflow}{return} -1;
1912 
1913     \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = object;
1914     uint8\_t packet\_id = temp[0];
1915     uint8\_t *\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = temp + 1;
1916     uint32\_t data\_length = len - 1;
1917 
1918     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE}) \{
1919         \textcolor{keywordflow}{if} (packet\_id == \hyperlink{_messenger_8h_a0df7f46f5ef595ad83917f225fd222b0}{PACKET\_ID\_ONLINE} && len == 1) \{
1920             \hyperlink{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{set\_friend\_status}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE});
1921             \hyperlink{_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b}{send\_online\_packet}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i});
1922         \} \textcolor{keywordflow}{else} \{
1923             \textcolor{keywordflow}{return} -1;
1924         \}
1925     \}
1926 
1927     \textcolor{keywordflow}{switch} (packet\_id) \{
1928         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a8b5392597c367f9c61bb1ef603276ab6}{PACKET\_ID\_OFFLINE}: \{
1929             \textcolor{keywordflow}{if} (data\_length != 0)
1930                 \textcolor{keywordflow}{break};
1931 
1932             \hyperlink{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{set\_friend\_status}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea96745ef6bf5398e7e4488c21492f57a8}{FRIEND\_CONFIRMED});
1933             \textcolor{keywordflow}{break};
1934         \}
1935 
1936         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_af5ddb51310b68c24012cd07ccb612b6b}{PACKET\_ID\_NICKNAME}: \{
1937             \textcolor{keywordflow}{if} (data\_length > \hyperlink{_messenger_8h_a0c397a708cec89c74029582574516b30}{MAX\_NAME\_LENGTH})
1938                 \textcolor{keywordflow}{break};
1939 
1940             \textcolor{comment}{/* Make sure the NULL terminator is present. */}
1941             uint8\_t data\_terminated[data\_length + 1];
1942             memcpy(data\_terminated, data, data\_length);
1943             data\_terminated[data\_length] = 0;
1944 
1945             \textcolor{comment}{/* inform of namechange before we overwrite the old name */}
1946             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a108f796a6b45966363b7bd8a64f366f8}{friend\_namechange})
1947                 m->\hyperlink{struct_messenger_a108f796a6b45966363b7bd8a64f366f8}{friend\_namechange}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, data\_terminated, data\_length, m->
      \hyperlink{struct_messenger_a0a5f95c8ffcd6a9a0dafd21c34be2e0a}{friend\_namechange\_userdata});
1948 
1949             memcpy(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a11b8cc6595eea79e65c978209278e683}{name}, data\_terminated, data\_length);
1950             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length} = data\_length;
1951 
1952             \textcolor{keywordflow}{break};
1953         \}
1954 
1955         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_acf7096588409684fc93f1fe0aca9bbac}{PACKET\_ID\_STATUSMESSAGE}: \{
1956             \textcolor{keywordflow}{if} (data\_length > \hyperlink{_messenger_8h_a0d1a4b91dd43b4cb07dfefab7fc6bee1}{MAX\_STATUSMESSAGE\_LENGTH})
1957                 \textcolor{keywordflow}{break};
1958 
1959             \textcolor{comment}{/* Make sure the NULL terminator is present. */}
1960             uint8\_t data\_terminated[data\_length + 1];
1961             memcpy(data\_terminated, data, data\_length);
1962             data\_terminated[data\_length] = 0;
1963 
1964             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a5badb1433338f70899baee5abcf5f0a5}{friend\_statusmessagechange})
1965                 m->\hyperlink{struct_messenger_a5badb1433338f70899baee5abcf5f0a5}{friend\_statusmessagechange}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, data\_terminated, data\_length
      ,
1966                                               m->
      \hyperlink{struct_messenger_adeec8efd452cd609070c2eee12826fb9}{friend\_statusmessagechange\_userdata});
1967 
1968             \hyperlink{_messenger_8c_ad317d62e3ddf9894af11093d30cae31b}{set\_friend\_statusmessage}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, data\_terminated, data\_length);
1969             \textcolor{keywordflow}{break};
1970         \}
1971 
1972         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a85557f8710f545b0c73afaa32f09bf8c}{PACKET\_ID\_USERSTATUS}: \{
1973             \textcolor{keywordflow}{if} (data\_length != 1)
1974                 \textcolor{keywordflow}{break};
1975 
1976             \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986c}{USERSTATUS} \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = data[0];
1977 
1978             \textcolor{keywordflow}{if} (status >= \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986ca6d8bb6c720be91f8ebecd51c9db139bb}{USERSTATUS\_INVALID})
1979                 \textcolor{keywordflow}{break};
1980 
1981             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a61d62ee2f1f496b742acdcdf2c02f388}{friend\_userstatuschange})
1982                 m->\hyperlink{struct_messenger_a61d62ee2f1f496b742acdcdf2c02f388}{friend\_userstatuschange}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, status, m->
      \hyperlink{struct_messenger_a1007bf7131bf75ddd1980ed1b610e6f7}{friend\_userstatuschange\_userdata});
1983 
1984             \hyperlink{_messenger_8c_a57a114bf07876ef46d27c7cfee31137f}{set\_friend\_userstatus}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, status);
1985             \textcolor{keywordflow}{break};
1986         \}
1987 
1988         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a4aad3ced6e9fd2200962b1cbbfd625f9}{PACKET\_ID\_TYPING}: \{
1989             \textcolor{keywordflow}{if} (data\_length != 1)
1990                 \textcolor{keywordflow}{break};
1991 
1992             \_Bool typing = !!data[0];
1993 
1994             \hyperlink{_messenger_8c_abed35de4c690ded50f67fdaf5e96324c}{set\_friend\_typing}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, typing);
1995 
1996             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a2d1cf25845a2a7d1b1f90916679fb4fe}{friend\_typingchange})
1997                 m->\hyperlink{struct_messenger_a2d1cf25845a2a7d1b1f90916679fb4fe}{friend\_typingchange}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, typing, m->
      \hyperlink{struct_messenger_a597c89e529b39b6f08251d586c1379e7}{friend\_typingchange\_userdata});
1998 
1999             \textcolor{keywordflow}{break};
2000         \}
2001 
2002         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a254356a92e0c8c90a8e5ff6f828efc4c}{PACKET\_ID\_MESSAGE}:
2003         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a2fa8ad5a6eee88e35345e9d9fc04a98c}{PACKET\_ID\_ACTION}: \{
2004             \textcolor{keywordflow}{if} (data\_length == 0)
2005                 \textcolor{keywordflow}{break};
2006 
2007             \textcolor{keyword}{const} uint8\_t *message = \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data};
2008             uint16\_t message\_length = data\_length;
2009 
2010             \textcolor{comment}{/* Make sure the NULL terminator is present. */}
2011             uint8\_t message\_terminated[message\_length + 1];
2012             memcpy(message\_terminated, message, message\_length);
2013             message\_terminated[message\_length] = 0;
2014             uint8\_t type = packet\_id - \hyperlink{_messenger_8h_a254356a92e0c8c90a8e5ff6f828efc4c}{PACKET\_ID\_MESSAGE};
2015 
2016             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a85d35646398022de4e435174f990ce18}{friend\_message})
2017                 (*m->\hyperlink{struct_messenger_a85d35646398022de4e435174f990ce18}{friend\_message})(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, type, message\_terminated, message\_length, m->
      \hyperlink{struct_messenger_a2b0701803305a0b99a2d3f016300b900}{friend\_message\_userdata});
2018 
2019             \textcolor{keywordflow}{break};
2020         \}
2021 
2022         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a74eb7ec4c6662276c2673fa0728062c0}{PACKET\_ID\_INVITE\_GROUPCHAT}: \{
2023             \textcolor{keywordflow}{if} (data\_length == 0)
2024                 \textcolor{keywordflow}{break};
2025 
2026             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a60eaca4be38363ad7bc9d454fee814f4}{group\_invite})
2027                 (*m->\hyperlink{struct_messenger_a60eaca4be38363ad7bc9d454fee814f4}{group\_invite})(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, data, data\_length);
2028 
2029             \textcolor{keywordflow}{break};
2030         \}
2031 
2032         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a8c622dcdbc701fe3bb19b3b3c9c5d1d0}{PACKET\_ID\_FILE\_SENDREQUEST}: \{
2033             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} head\_length = 1 + \textcolor{keyword}{sizeof}(uint32\_t) + \textcolor{keyword}{sizeof}(uint64\_t) + 
      \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH};
2034 
2035             \textcolor{keywordflow}{if} (data\_length < head\_length)
2036                 \textcolor{keywordflow}{break};
2037 
2038             uint8\_t filenumber = data[0];
2039 
2040             \textcolor{keywordflow}{if} (filenumber >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
2041                 \textcolor{keywordflow}{break};
2042 
2043             uint64\_t filesize;
2044             uint32\_t file\_type;
2045             uint16\_t filename\_length = data\_length - head\_length;
2046 
2047             \textcolor{keywordflow}{if} (filename\_length > \hyperlink{_messenger_8c_a6773b93f3093658c3dcb569de3b4bdb2}{MAX\_FILENAME\_LENGTH})
2048                 \textcolor{keywordflow}{break};
2049 
2050             memcpy(&file\_type, data + 1, \textcolor{keyword}{sizeof}(file\_type));
2051             file\_type = ntohl(file\_type);
2052 
2053             memcpy(&filesize, data + 1 + \textcolor{keyword}{sizeof}(uint32\_t), \textcolor{keyword}{sizeof}(filesize));
2054             \hyperlink{util_8h_a997aabaef0c91865b7db6f52da01c65b}{net\_to\_host}((uint8\_t *) &filesize, \textcolor{keyword}{sizeof}(filesize));
2055             \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].
      \hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[filenumber];
2056 
2057             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
2058                 \textcolor{keywordflow}{break};
2059 
2060             ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1c5e323395e3d4810670c26aac40a0fd}{FILESTATUS\_NOT\_ACCEPTED};
2061             ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} = filesize;
2062             ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} = 0;
2063             ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} = \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaabdbd52b891cdbc93735f408af784cac8}{FILE\_PAUSE\_NOT};
2064             memcpy(ft->\hyperlink{struct_file___transfers_aa32dbb3439461c6ccc1a52ff15bcb22e}{id}, data + 1 + \textcolor{keyword}{sizeof}(uint32\_t) + \textcolor{keyword}{sizeof}(uint64\_t), 
      \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH});
2065 
2066             uint8\_t filename\_terminated[filename\_length + 1];
2067             uint8\_t *filename = NULL;
2068 
2069             \textcolor{keywordflow}{if} (filename\_length) \{
2070                 \textcolor{comment}{/* Force NULL terminate file name. */}
2071                 memcpy(filename\_terminated, data + head\_length, filename\_length);
2072                 filename\_terminated[filename\_length] = 0;
2073                 filename = filename\_terminated;
2074             \}
2075 
2076             uint32\_t real\_filenumber = filenumber;
2077             real\_filenumber += 1;
2078             real\_filenumber <<= 16;
2079 
2080             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a1d83804ee0bfe9249fda05cdd755a37f}{file\_sendrequest})
2081                 (*m->\hyperlink{struct_messenger_a1d83804ee0bfe9249fda05cdd755a37f}{file\_sendrequest})(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, real\_filenumber, file\_type, filesize, 
      filename, filename\_length,
2082                                        m->\hyperlink{struct_messenger_a26be37effc113183fae96f3a7279ebb0}{file\_sendrequest\_userdata});
2083 
2084             \textcolor{keywordflow}{break};
2085         \}
2086 
2087         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_ace1e961bc82c23e5ba065b4cd74da54a}{PACKET\_ID\_FILE\_CONTROL}: \{
2088             \textcolor{keywordflow}{if} (data\_length < 3)
2089                 \textcolor{keywordflow}{break};
2090 
2091             uint8\_t send\_receive = data[0];
2092             uint8\_t filenumber = data[1];
2093             uint8\_t control\_type = data[2];
2094 
2095             \textcolor{keywordflow}{if} (filenumber >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
2096                 \textcolor{keywordflow}{break};
2097 
2098             \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a56b6a138fb4522b859fda806c8ca4c20}{handle\_filecontrol}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, send\_receive, filenumber, control\_type, data + 
      3, data\_length - 3) == -1)
2099                 \textcolor{keywordflow}{break};
2100 
2101             \textcolor{keywordflow}{break};
2102         \}
2103 
2104         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_a167c75e0bc70d1f8e96c4e9f553573fd}{PACKET\_ID\_FILE\_DATA}: \{
2105             \textcolor{keywordflow}{if} (data\_length < 1)
2106                 \textcolor{keywordflow}{break};
2107 
2108             uint8\_t filenumber = data[0];
2109 
2110             \textcolor{keywordflow}{if} (filenumber >= \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES})
2111                 \textcolor{keywordflow}{break};
2112 
2113             \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].
      \hyperlink{struct_friend_ab14e1c3452717012d0bbb0dad068e9f6}{file\_receiving}[filenumber];
2114 
2115             \textcolor{keywordflow}{if} (ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea0ec6ff3092cd75fbeb42547a0d33ce63}{FILESTATUS\_TRANSFERRING})
2116                 \textcolor{keywordflow}{break};
2117 
2118             uint64\_t position = ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred};
2119             uint32\_t real\_filenumber = filenumber;
2120             real\_filenumber += 1;
2121             real\_filenumber <<= 16;
2122             uint16\_t file\_data\_length = (data\_length - 1);
2123             uint8\_t *\hyperlink{_messenger_8c_a2d94ca52e2129848ab7b137edb049eb4}{file\_data};
2124 
2125             \textcolor{keywordflow}{if} (file\_data\_length == 0) \{
2126                 file\_data = NULL;
2127             \} \textcolor{keywordflow}{else} \{
2128                 file\_data = data + 1;
2129             \}
2130 
2131             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a2f2875b7bf0dda7ed90908d4e1139493}{file\_filedata})
2132                 (*m->\hyperlink{struct_messenger_a2f2875b7bf0dda7ed90908d4e1139493}{file\_filedata})(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, real\_filenumber, position, file\_data, 
      file\_data\_length, m->\hyperlink{struct_messenger_a69c2b7ef494a50568b37c4ade72fdb62}{file\_filedata\_userdata});
2133 
2134             ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} += file\_data\_length;
2135 
2136             \textcolor{keywordflow}{if} (file\_data\_length && (ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} >= ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} || file\_data\_length != 
      \hyperlink{_messenger_8c_a1d30d67cd95fc07b4e99e074bd9d2328}{MAX\_FILE\_DATA\_SIZE})) \{
2137                 file\_data\_length = 0;
2138                 file\_data = NULL;
2139                 position = ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred};
2140 
2141                 \textcolor{comment}{/* Full file received. */}
2142                 \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a2f2875b7bf0dda7ed90908d4e1139493}{file\_filedata})
2143                     (*m->\hyperlink{struct_messenger_a2f2875b7bf0dda7ed90908d4e1139493}{file\_filedata})(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, real\_filenumber, position, file\_data, 
      file\_data\_length, m->\hyperlink{struct_messenger_a69c2b7ef494a50568b37c4ade72fdb62}{file\_filedata\_userdata});
2144             \}
2145 
2146             \textcolor{comment}{/* Data is zero, filetransfer is over. */}
2147             \textcolor{keywordflow}{if} (file\_data\_length == 0) \{
2148                 ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE};
2149             \}
2150 
2151             \textcolor{keywordflow}{break};
2152         \}
2153 
2154         \textcolor{keywordflow}{case} \hyperlink{_messenger_8h_aa9ec6f58cbee9d52d6e2700dff8d0b25}{PACKET\_ID\_MSI}: \{
2155             \textcolor{keywordflow}{if} (data\_length == 0)
2156                 \textcolor{keywordflow}{break};
2157 
2158             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a94a1e6432d69be20e4da5e919f4c61e5}{msi\_packet})
2159                 (*m->\hyperlink{struct_messenger_a94a1e6432d69be20e4da5e919f4c61e5}{msi\_packet})(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, data, data\_length, m->
      \hyperlink{struct_messenger_a1b0f16a3c32591e1bc33406459dfac29}{msi\_packet\_userdata});
2160 
2161             \textcolor{keywordflow}{break};
2162         \}
2163 
2164         \textcolor{keywordflow}{default}: \{
2165             \hyperlink{_messenger_8c_a4816c8b0bbf3b241f07654a2b6593fee}{handle\_custom\_lossless\_packet}(\textcolor{keywordtype}{object}, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, temp, len);
2166             \textcolor{keywordflow}{break};
2167         \}
2168     \}
2169 
2170     \textcolor{keywordflow}{return} 0;
2171 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a8fce9b8564a3a552ff2b77a9f81914ad_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a8fce9b8564a3a552ff2b77a9f81914ad_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2be56d7329b8b89d95918eba9b692c71}{\index{Messenger.\+c@{Messenger.\+c}!handle\+\_\+status@{handle\+\_\+status}}
\index{handle\+\_\+status@{handle\+\_\+status}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{handle\+\_\+status}]{\setlength{\rightskip}{0pt plus 5cm}static int handle\+\_\+status (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{int}]{i, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a2be56d7329b8b89d95918eba9b692c71}


Definition at line 1893 of file Messenger.\+c.



References F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+F\+I\+R\+M\+E\+D, F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Messenger\+::friendlist, send\+\_\+online\+\_\+packet(), set\+\_\+friend\+\_\+status(), and Friend\+::status.



Referenced by init\+\_\+new\+\_\+friend().


\begin{DoxyCode}
1894 \{
1895     \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = object;
1896 
1897     \textcolor{keywordflow}{if} (\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status}) \{ \textcolor{comment}{/* Went online. */}
1898         \hyperlink{_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b}{send\_online\_packet}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i});
1899     \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* Went offline. */}
1900         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE}) \{
1901             \hyperlink{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{set\_friend\_status}(m, \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea96745ef6bf5398e7e4488c21492f57a8}{FRIEND\_CONFIRMED});
1902         \}
1903     \}
1904 
1905     \textcolor{keywordflow}{return} 0;
1906 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2be56d7329b8b89d95918eba9b692c71_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2be56d7329b8b89d95918eba9b692c71_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f}{\index{Messenger.\+c@{Messenger.\+c}!init\+\_\+new\+\_\+friend@{init\+\_\+new\+\_\+friend}}
\index{init\+\_\+new\+\_\+friend@{init\+\_\+new\+\_\+friend}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{init\+\_\+new\+\_\+friend}]{\setlength{\rightskip}{0pt plus 5cm}static int32\+\_\+t init\+\_\+new\+\_\+friend (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{real\+\_\+pk, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f}


Definition at line 168 of file Messenger.\+c.



References F\+A\+E\+R\+R\+\_\+\+N\+O\+M\+E\+M, Messenger\+::fr\+\_\+c, friend\+\_\+con\+\_\+connected(), friend\+\_\+connection\+\_\+callbacks(), Friend\+::friendcon\+\_\+id, F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, Messenger\+::friendlist, Friend\+::friendrequest\+\_\+lastsent, handle\+\_\+custom\+\_\+lossy\+\_\+packet(), handle\+\_\+packet(), handle\+\_\+status(), i, id\+\_\+copy(), Friend\+::is\+\_\+typing, Friend\+::message\+\_\+id, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X, new\+\_\+friend\+\_\+connection(), N\+O\+F\+R\+I\+E\+N\+D, Messenger\+::numfriends, Friend\+::real\+\_\+pk, realloc\+\_\+friendlist(), send\+\_\+online\+\_\+packet(), Friend\+::status, Friend\+::statusmessage\+\_\+length, Friend\+::userstatus, and U\+S\+E\+R\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E.



Referenced by m\+\_\+addfriend(), and m\+\_\+addfriend\+\_\+norequest().


\begin{DoxyCode}
169 \{
170     \textcolor{comment}{/* Resize the friend list if necessary. */}
171     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_ade10ae2516f68845c8b2e0c5eb95bd41}{realloc\_friendlist}(m, m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends} + 1) != 0)
172         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4dacd7ea42e2d9e39408188fb8126c36896}{FAERR\_NOMEM};
173 
174     memset(&(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}]), 0, \textcolor{keyword}{sizeof}(\hyperlink{struct_friend}{Friend}));
175 
176     \textcolor{keywordtype}{int} friendcon\_id = \hyperlink{friend__connection_8c_a613a80a004fccd616de2a67d84a25d3c}{new\_friend\_connection}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, real\_pk);
177 
178     \textcolor{keywordflow}{if} (friendcon\_id == -1)
179         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4dacd7ea42e2d9e39408188fb8126c36896}{FAERR\_NOMEM};
180 
181     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
182 
183     \textcolor{keywordflow}{for} (i = 0; i <= m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
184         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ead051772af60ca4a39271bab1829fc61c}{NOFRIEND}) \{
185             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status};
186             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id} = friendcon\_id;
187             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a1cea2470caaf4282313efe944e95bf35}{friendrequest\_lastsent} = 0;
188             \hyperlink{util_8c_aa30049b8c1d82c280d6d872feea3353b}{id\_copy}(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk}, real\_pk);
189             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length} = 0;
190             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_adde524f5a15465585cbc2543cd0b2710}{userstatus} = \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986ca8eb0ac68c5c7d0e6084d707c87191dcd}{USERSTATUS\_NONE};
191             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_a4eb96aff01799d54246cc48854a47175}{is\_typing} = 0;
192             m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_friend_aa4420a99dd00b4884b23150e4226b2ea}{message\_id} = 0;
193             \hyperlink{friend__connection_8c_a15c404d517b4a4fb3976f4d85bfbaef0}{friend\_connection\_callbacks}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, friendcon\_id, 
      \hyperlink{friend__connection_8h_aa42482d7e48a639e42ba46c923edabfd}{MESSENGER\_CALLBACK\_INDEX}, &\hyperlink{_messenger_8c_a2be56d7329b8b89d95918eba9b692c71}{handle\_status}, &
      \hyperlink{_messenger_8c_a8fce9b8564a3a552ff2b77a9f81914ad}{handle\_packet},
194                                         &\hyperlink{_messenger_8c_a24c5719d515558a6e9d768a861d6dc22}{handle\_custom\_lossy\_packet}, m, i);
195 
196             \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends} == i)
197                 ++m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends};
198 
199             \textcolor{keywordflow}{if} (\hyperlink{friend__connection_8c_ae5c94f8543c84506c85faac6d2b3a9dd}{friend\_con\_connected}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, friendcon\_id) == 
      \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{FRIENDCONN\_STATUS\_CONNECTED}) \{
200                 \hyperlink{_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b}{send\_online\_packet}(m, i);
201             \}
202 
203             \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
204         \}
205     \}
206 
207     \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4dacd7ea42e2d9e39408188fb8126c36896}{FAERR\_NOMEM};
208 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a771c65c3057d870b0653c2fdf0a12fb7}{\index{Messenger.\+c@{Messenger.\+c}!kill\+\_\+messenger@{kill\+\_\+messenger}}
\index{kill\+\_\+messenger@{kill\+\_\+messenger}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{kill\+\_\+messenger}]{\setlength{\rightskip}{0pt plus 5cm}void kill\+\_\+messenger (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a771c65c3057d870b0653c2fdf0a12fb7}


Definition at line 1848 of file Messenger.\+c.



References clear\+\_\+receipts(), Messenger\+::dht, Messenger\+::fr\+\_\+c, Messenger\+::friendlist, i, kill\+\_\+\+D\+H\+T(), kill\+\_\+friend\+\_\+connections(), kill\+\_\+net\+\_\+crypto(), kill\+\_\+networking(), kill\+\_\+onion(), kill\+\_\+onion\+\_\+announce(), kill\+\_\+onion\+\_\+client(), kill\+\_\+\+T\+C\+P\+\_\+server(), Messenger\+::net, Messenger\+::net\+\_\+crypto, Messenger\+::numfriends, Messenger\+::onion, Messenger\+::onion\+\_\+a, Messenger\+::onion\+\_\+c, and Messenger\+::tcp\+\_\+server.



Referenced by main(), tox\+\_\+kill(), and tox\+\_\+new().


\begin{DoxyCode}
1849 \{
1850     \textcolor{keywordflow}{if} (!m)
1851         \textcolor{keywordflow}{return};
1852 
1853     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1854 
1855     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server}) \{
1856         \hyperlink{_t_c_p__server_8c_af6df6382ad309456dcf5b7b350313714}{kill\_TCP\_server}(m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server});
1857     \}
1858 
1859     \hyperlink{friend__connection_8c_a2ef8cdbd93f21f11ff0333a9527c2c02}{kill\_friend\_connections}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c});
1860     \hyperlink{onion_8c_a301c5cb9db2604dc1ea885c3a2cf8408}{kill\_onion}(m->\hyperlink{struct_messenger_a66fb4bf67c711a5ed3e7bbecec7fde30}{onion});
1861     \hyperlink{onion__announce_8c_ad21ecb14ae7a2a0d11a1d0523a459146}{kill\_onion\_announce}(m->\hyperlink{struct_messenger_a3a345721fb6be385f4b4519679a4609f}{onion\_a});
1862     \hyperlink{onion__client_8c_a591041f85e43cf886ab4c72fb3b8d468}{kill\_onion\_client}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c});
1863     \hyperlink{net__crypto_8c_abb3546495adde3f08c0474f31c5d3a37}{kill\_net\_crypto}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto});
1864     \hyperlink{_d_h_t_8c_a816851e4f0f454c52b93d65544a2b2bb}{kill\_DHT}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
1865     \hyperlink{network_8c_a8a36a1ed29a0d5dfe1f0095823039627}{kill\_networking}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
1866 
1867     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1868         \hyperlink{_messenger_8c_a3206124b119b06401ce65affb690976d}{clear\_receipts}(m, i);
1869     \}
1870 
1871     free(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist});
1872     free(m);
1873 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a771c65c3057d870b0653c2fdf0a12fb7_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a771c65c3057d870b0653c2fdf0a12fb7_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ac77431b1ab0b12af003657e11057bd9c}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+addfriend@{m\+\_\+addfriend}}
\index{m\+\_\+addfriend@{m\+\_\+addfriend}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+addfriend}]{\setlength{\rightskip}{0pt plus 5cm}int32\+\_\+t m\+\_\+addfriend (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{address, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ac77431b1ab0b12af003657e11057bd9c}


Definition at line 226 of file Messenger.\+c.



References address\+\_\+checksum(), F\+A\+E\+R\+R\+\_\+\+A\+L\+R\+E\+A\+D\+Y\+S\+E\+N\+T, F\+A\+E\+R\+R\+\_\+\+B\+A\+D\+C\+H\+E\+C\+K\+S\+U\+M, F\+A\+E\+R\+R\+\_\+\+N\+O\+M\+E\+S\+S\+A\+G\+E, F\+A\+E\+R\+R\+\_\+\+O\+W\+N\+K\+E\+Y, F\+A\+E\+R\+R\+\_\+\+S\+E\+T\+N\+E\+W\+N\+O\+S\+P\+A\+M, F\+A\+E\+R\+R\+\_\+\+T\+O\+O\+L\+O\+N\+G, F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+E\+D, F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+R\+E\+S\+S\+\_\+\+S\+I\+Z\+E, F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+F\+I\+R\+M\+E\+D, friend\+\_\+id, Messenger\+::friendlist, Friend\+::friendrequest\+\_\+nospam, F\+R\+I\+E\+N\+D\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T, Friend\+::friendrequest\+\_\+timeout, getfriend\+\_\+id(), id\+\_\+copy(), id\+\_\+equal(), Friend\+::info, Friend\+::info\+\_\+size, init\+\_\+new\+\_\+friend(), M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, Messenger\+::net\+\_\+crypto, make-\/funny-\/savefile\+::nospam, public\+\_\+key\+\_\+valid(), Net\+\_\+\+Crypto\+::self\+\_\+public\+\_\+key, and Friend\+::status.



Referenced by friends\+\_\+list\+\_\+load(), main(), parent\+\_\+friend\+\_\+request(), and tox\+\_\+friend\+\_\+add().


\begin{DoxyCode}
227 \{
228     \textcolor{keywordflow}{if} (length > \hyperlink{friend__requests_8h_a89b7e8b76560d3513fd3b054de738553}{MAX\_FRIEND\_REQUEST\_DATA\_SIZE})
229         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da9807ee1ff697871b9d1d0da3e9fced4a}{FAERR\_TOOLONG};
230 
231     uint8\_t real\_pk[crypto\_box\_PUBLICKEYBYTES];
232     \hyperlink{util_8c_aa30049b8c1d82c280d6d872feea3353b}{id\_copy}(real\_pk, address);
233 
234     \textcolor{keywordflow}{if} (!\hyperlink{crypto__core_8c_ab4a996d3466879a493cc6496acb6cd7e}{public\_key\_valid}(real\_pk))
235         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da794d7918a100c52d46347237e35a7cbb}{FAERR\_BADCHECKSUM};
236 
237     uint16\_t check, checksum = \hyperlink{_messenger_8c_a31c1f385ae903fdf82773998b54009fc}{address\_checksum}(address, 
      \hyperlink{_messenger_8h_a22c0e97a4b45902742a86bba24cc5d5d}{FRIEND\_ADDRESS\_SIZE} - \textcolor{keyword}{sizeof}(checksum));
238     memcpy(&check, address + crypto\_box\_PUBLICKEYBYTES + \textcolor{keyword}{sizeof}(uint32\_t), \textcolor{keyword}{sizeof}(check));
239 
240     \textcolor{keywordflow}{if} (check != checksum)
241         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da794d7918a100c52d46347237e35a7cbb}{FAERR\_BADCHECKSUM};
242 
243     \textcolor{keywordflow}{if} (length < 1)
244         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da53e514ff6ba8bd6b1593c761dda7da70}{FAERR\_NOMESSAGE};
245 
246     \textcolor{keywordflow}{if} (\hyperlink{util_8c_ada3d44b4f530d3c8c9cb69b732be94b1}{id\_equal}(real\_pk, m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}->\hyperlink{struct_net___crypto_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key}))
247         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da9e4a251967c2b72fa04e24c3a79a6ab5}{FAERR\_OWNKEY};
248 
249     int32\_t \hyperlink{messenger__test_8c_a5d7925718457bca84bda0952f9463a3c}{friend\_id} = \hyperlink{_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc}{getfriend\_id}(m, real\_pk);
250 
251     \textcolor{keywordflow}{if} (friend\_id != -1) \{
252         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friend\_id].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} >= \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea96745ef6bf5398e7e4488c21492f57a8}{FRIEND\_CONFIRMED})
253             \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da02646d940c6ad0b2e7cccf1bee898f05}{FAERR\_ALREADYSENT};
254 
255         uint32\_t \hyperlink{namespacemake-funny-savefile_a2581b35f119a2bbce475223789ed742c}{nospam};
256         memcpy(&nospam, address + crypto\_box\_PUBLICKEYBYTES, \textcolor{keyword}{sizeof}(nospam));
257 
258         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friend\_id].\hyperlink{struct_friend_a0fae9801a4789a368f90125119e31f3f}{friendrequest\_nospam} == nospam)
259             \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da02646d940c6ad0b2e7cccf1bee898f05}{FAERR\_ALREADYSENT};
260 
261         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[\hyperlink{messenger__test_8c_a5d7925718457bca84bda0952f9463a3c}{friend\_id}].\hyperlink{struct_friend_a0fae9801a4789a368f90125119e31f3f}{friendrequest\_nospam} = 
      \hyperlink{namespacemake-funny-savefile_a2581b35f119a2bbce475223789ed742c}{nospam};
262         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4dabdfe171fd44c38502152f4f245a53465}{FAERR\_SETNEWNOSPAM};
263     \}
264 
265     int32\_t ret = \hyperlink{_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f}{init\_new\_friend}(m, real\_pk, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea931f0d7c482a759d79e5ba50d9c03503}{FRIEND\_ADDED});
266 
267     \textcolor{keywordflow}{if} (ret < 0) \{
268         \textcolor{keywordflow}{return} ret;
269     \}
270 
271     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[ret].\hyperlink{struct_friend_a671d1f4ab926cb9dc297c3f2743560d4}{friendrequest\_timeout} = 
      \hyperlink{_messenger_8h_ab635a2a95d031057dc5b7793eae87dfa}{FRIENDREQUEST\_TIMEOUT};
272     memcpy(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[ret].\hyperlink{struct_friend_ae1a1264e17ce4eedae67c283a09236e6}{info}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
273     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[ret].\hyperlink{struct_friend_ac0ae002db55ef8f8366de10ec005b65a}{info\_size} = length;
274     memcpy(&(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[ret].\hyperlink{struct_friend_a0fae9801a4789a368f90125119e31f3f}{friendrequest\_nospam}), address + 
      crypto\_box\_PUBLICKEYBYTES, \textcolor{keyword}{sizeof}(uint32\_t));
275 
276     \textcolor{keywordflow}{return} ret;
277 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac77431b1ab0b12af003657e11057bd9c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac77431b1ab0b12af003657e11057bd9c_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2f7aa06733a25e8c0edc8f31a22a78dc}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+addfriend\+\_\+norequest@{m\+\_\+addfriend\+\_\+norequest}}
\index{m\+\_\+addfriend\+\_\+norequest@{m\+\_\+addfriend\+\_\+norequest}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+addfriend\+\_\+norequest}]{\setlength{\rightskip}{0pt plus 5cm}int32\+\_\+t m\+\_\+addfriend\+\_\+norequest (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{real\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a2f7aa06733a25e8c0edc8f31a22a78dc}


Definition at line 279 of file Messenger.\+c.



References F\+A\+E\+R\+R\+\_\+\+A\+L\+R\+E\+A\+D\+Y\+S\+E\+N\+T, F\+A\+E\+R\+R\+\_\+\+B\+A\+D\+C\+H\+E\+C\+K\+S\+U\+M, F\+A\+E\+R\+R\+\_\+\+O\+W\+N\+K\+E\+Y, F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+F\+I\+R\+M\+E\+D, getfriend\+\_\+id(), id\+\_\+equal(), init\+\_\+new\+\_\+friend(), Messenger\+::net\+\_\+crypto, public\+\_\+key\+\_\+valid(), and Net\+\_\+\+Crypto\+::self\+\_\+public\+\_\+key.



Referenced by child\+\_\+got\+\_\+request(), friends\+\_\+list\+\_\+load(), main(), print\+\_\+request(), and tox\+\_\+friend\+\_\+add\+\_\+norequest().


\begin{DoxyCode}
280 \{
281     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a32203f86be17e650ef0f7e5b7eff66bc}{getfriend\_id}(m, real\_pk) != -1)
282         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da02646d940c6ad0b2e7cccf1bee898f05}{FAERR\_ALREADYSENT};
283 
284     \textcolor{keywordflow}{if} (!\hyperlink{crypto__core_8c_ab4a996d3466879a493cc6496acb6cd7e}{public\_key\_valid}(real\_pk))
285         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da794d7918a100c52d46347237e35a7cbb}{FAERR\_BADCHECKSUM};
286 
287     \textcolor{keywordflow}{if} (\hyperlink{util_8c_ada3d44b4f530d3c8c9cb69b732be94b1}{id\_equal}(real\_pk, m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}->\hyperlink{struct_net___crypto_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key}))
288         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4da9e4a251967c2b72fa04e24c3a79a6ab5}{FAERR\_OWNKEY};
289 
290     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_aa3be5ad998d2b0ced07aceab765eaa2f}{init\_new\_friend}(m, real\_pk, \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea96745ef6bf5398e7e4488c21492f57a8}{FRIEND\_CONFIRMED});
291 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2f7aa06733a25e8c0edc8f31a22a78dc_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2f7aa06733a25e8c0edc8f31a22a78dc_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a7afea43fa4a1f455c381dc93711ed68e}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+connectionstatus@{m\+\_\+callback\+\_\+connectionstatus}}
\index{m\+\_\+callback\+\_\+connectionstatus@{m\+\_\+callback\+\_\+connectionstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+connectionstatus}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+connectionstatus (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, unsigned int, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a7afea43fa4a1f455c381dc93711ed68e}


Definition at line 812 of file Messenger.\+c.



References Messenger\+::friend\+\_\+connectionstatuschange, and Messenger\+::friend\+\_\+connectionstatuschange\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+connection\+\_\+status().


\begin{DoxyCode}
814 \{
815     m->\hyperlink{struct_messenger_afb2bb77a40eb1445cc3e67cccc20a6ac}{friend\_connectionstatuschange} = \textcolor{keyword}{function};
816     m->\hyperlink{struct_messenger_a69af1b3dc5153b752781cf61ff660b89}{friend\_connectionstatuschange\_userdata} = userdata;
817 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a7afea43fa4a1f455c381dc93711ed68e_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a306c3602085500d8d23adbd52ac59006}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av@{m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av}}
\index{m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av@{m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+connectionstatus\+\_\+internal\+\_\+av (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, uint8\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a306c3602085500d8d23adbd52ac59006}


Definition at line 825 of file Messenger.\+c.



References Messenger\+::friend\+\_\+connectionstatuschange\+\_\+internal, and Messenger\+::friend\+\_\+connectionstatuschange\+\_\+internal\+\_\+userdata.



Referenced by msi\+\_\+new().


\begin{DoxyCode}
827 \{
828     m->\hyperlink{struct_messenger_abfd5a34f887ae1fda52d86f4b01ea572}{friend\_connectionstatuschange\_internal} = \textcolor{keyword}{function};
829     m->\hyperlink{struct_messenger_af915663b78a533e88c4f56cacbeeefdc}{friend\_connectionstatuschange\_internal\_userdata} = 
      userdata;
830 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a306c3602085500d8d23adbd52ac59006_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2320c0c6f211341e8757e062d3c1ca67}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+core\+\_\+connection@{m\+\_\+callback\+\_\+core\+\_\+connection}}
\index{m\+\_\+callback\+\_\+core\+\_\+connection@{m\+\_\+callback\+\_\+core\+\_\+connection}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+core\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+core\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, unsigned int, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a2320c0c6f211341e8757e062d3c1ca67}


Definition at line 819 of file Messenger.\+c.



References Messenger\+::core\+\_\+connection\+\_\+change, and Messenger\+::core\+\_\+connection\+\_\+change\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+self\+\_\+connection\+\_\+status().


\begin{DoxyCode}
820 \{
821     m->\hyperlink{struct_messenger_a04d6d710a221e33282b2305ec4158ac4}{core\_connection\_change} = \textcolor{keyword}{function};
822     m->\hyperlink{struct_messenger_a55d1d5f05bdf28588035d0bffd52ac3a}{core\_connection\_change\_userdata} = userdata;
823 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2320c0c6f211341e8757e062d3c1ca67_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a5bf6f3f6a919d32a34dbd8150f26ec1e}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+friendmessage@{m\+\_\+callback\+\_\+friendmessage}}
\index{m\+\_\+callback\+\_\+friendmessage@{m\+\_\+callback\+\_\+friendmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+friendmessage}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+friendmessage (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, unsigned int, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a5bf6f3f6a919d32a34dbd8150f26ec1e}


Definition at line 773 of file Messenger.\+c.



References Messenger\+::friend\+\_\+message, and Messenger\+::friend\+\_\+message\+\_\+userdata.



Referenced by main(), and tox\+\_\+callback\+\_\+friend\+\_\+message().


\begin{DoxyCode}
775 \{
776     m->\hyperlink{struct_messenger_a85d35646398022de4e435174f990ce18}{friend\_message} = \textcolor{keyword}{function};
777     m->\hyperlink{struct_messenger_a2b0701803305a0b99a2d3f016300b900}{friend\_message\_userdata} = userdata;
778 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5bf6f3f6a919d32a34dbd8150f26ec1e_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ac913636e02281cae396b1b7494cd760a}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+friendrequest@{m\+\_\+callback\+\_\+friendrequest}}
\index{m\+\_\+callback\+\_\+friendrequest@{m\+\_\+callback\+\_\+friendrequest}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+friendrequest}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+friendrequest (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, const uint8\+\_\+t $\ast$, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ac913636e02281cae396b1b7494cd760a}


Definition at line 765 of file Messenger.\+c.



References callback\+\_\+friendrequest(), and Messenger\+::fr.



Referenced by main(), and tox\+\_\+callback\+\_\+friend\+\_\+request().


\begin{DoxyCode}
767 \{
768     void (*handle\_friendrequest)(\textcolor{keywordtype}{void} *, \textcolor{keyword}{const} uint8\_t *, \textcolor{keyword}{const} uint8\_t *, size\_t, \textcolor{keywordtype}{void} *) = (\textcolor{keywordtype}{void} *)\textcolor{keyword}{
      function};
769     \hyperlink{friend__requests_8c_a86c8bb45c7dd4f0ef5e3be01cb646339}{callback\_friendrequest}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}), handle\_friendrequest, m, userdata);
770 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac913636e02281cae396b1b7494cd760a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac913636e02281cae396b1b7494cd760a_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a8f44fb569e74f4612c53da8264d16aac}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+group\+\_\+invite@{m\+\_\+callback\+\_\+group\+\_\+invite}}
\index{m\+\_\+callback\+\_\+group\+\_\+invite@{m\+\_\+callback\+\_\+group\+\_\+invite}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+group\+\_\+invite}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+group\+\_\+invite (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, uint16\+\_\+t)}]{function}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a8f44fb569e74f4612c53da8264d16aac}


Definition at line 919 of file Messenger.\+c.



References Messenger\+::group\+\_\+invite.



Referenced by kill\+\_\+groupchats(), and new\+\_\+groupchats().


\begin{DoxyCode}
920 \{
921     m->\hyperlink{struct_messenger_a60eaca4be38363ad7bc9d454fee814f4}{group\_invite} = \textcolor{keyword}{function};
922 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a8f44fb569e74f4612c53da8264d16aac_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a6f1431ef7ea09d3bac1b93f4dfa75764}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+msi\+\_\+packet@{m\+\_\+callback\+\_\+msi\+\_\+packet}}
\index{m\+\_\+callback\+\_\+msi\+\_\+packet@{m\+\_\+callback\+\_\+msi\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+msi\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+msi\+\_\+packet (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, uint16\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a6f1431ef7ea09d3bac1b93f4dfa75764}


Definition at line 1598 of file Messenger.\+c.



References Messenger\+::msi\+\_\+packet, and Messenger\+::msi\+\_\+packet\+\_\+userdata.



Referenced by msi\+\_\+kill(), and msi\+\_\+new().


\begin{DoxyCode}
1600 \{
1601     m->\hyperlink{struct_messenger_a94a1e6432d69be20e4da5e919f4c61e5}{msi\_packet} = \textcolor{keyword}{function};
1602     m->\hyperlink{struct_messenger_a1b0f16a3c32591e1bc33406459dfac29}{msi\_packet\_userdata} = userdata;
1603 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a6f1431ef7ea09d3bac1b93f4dfa75764_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_aa23b0f583cef231f792cde932d14ee28}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+namechange@{m\+\_\+callback\+\_\+namechange}}
\index{m\+\_\+callback\+\_\+namechange@{m\+\_\+callback\+\_\+namechange}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+namechange}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+namechange (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_aa23b0f583cef231f792cde932d14ee28}


Definition at line 780 of file Messenger.\+c.



References Messenger\+::friend\+\_\+namechange, and Messenger\+::friend\+\_\+namechange\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+name().


\begin{DoxyCode}
782 \{
783     m->\hyperlink{struct_messenger_a108f796a6b45966363b7bd8a64f366f8}{friend\_namechange} = \textcolor{keyword}{function};
784     m->\hyperlink{struct_messenger_a0a5f95c8ffcd6a9a0dafd21c34be2e0a}{friend\_namechange\_userdata} = userdata;
785 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aa23b0f583cef231f792cde932d14ee28_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a7af72369c1fa00ab940aefa25b6794f8}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+read\+\_\+receipt@{m\+\_\+callback\+\_\+read\+\_\+receipt}}
\index{m\+\_\+callback\+\_\+read\+\_\+receipt@{m\+\_\+callback\+\_\+read\+\_\+receipt}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+read\+\_\+receipt}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+read\+\_\+receipt (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, uint32\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a7af72369c1fa00ab940aefa25b6794f8}


Definition at line 806 of file Messenger.\+c.



References Messenger\+::read\+\_\+receipt, and Messenger\+::read\+\_\+receipt\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+read\+\_\+receipt().


\begin{DoxyCode}
807 \{
808     m->\hyperlink{struct_messenger_aa90ada8f04c210bdf2a6da03422ef96b}{read\_receipt} = \textcolor{keyword}{function};
809     m->\hyperlink{struct_messenger_a82edcd1ba67ee440c38eb01b3003b900}{read\_receipt\_userdata} = userdata;
810 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{d8/d8d/_messenger_8c_a7af72369c1fa00ab940aefa25b6794f8_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a536d47dbfa35fb02c78068e1d11a1d2a}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+rtp\+\_\+packet@{m\+\_\+callback\+\_\+rtp\+\_\+packet}}
\index{m\+\_\+callback\+\_\+rtp\+\_\+packet@{m\+\_\+callback\+\_\+rtp\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+rtp\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+callback\+\_\+rtp\+\_\+packet (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{byte, }
\item[{int($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t friendnumber, const uint8\+\_\+t $\ast$data, uint16\+\_\+t len, void $\ast$object)}]{packet\+\_\+handler\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a536d47dbfa35fb02c78068e1d11a1d2a}


Definition at line 1644 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Friend\+::function, Friend\+::lossy\+\_\+rtp\+\_\+packethandlers, Friend\+::object, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+Y\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+T\+A\+R\+T, and P\+A\+C\+K\+E\+T\+\_\+\+L\+O\+S\+S\+Y\+\_\+\+A\+V\+\_\+\+R\+E\+S\+E\+R\+V\+E\+D.



Referenced by rtp\+\_\+kill(), and rtp\+\_\+new().


\begin{DoxyCode}
1646 \{
1647     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1648         \textcolor{keywordflow}{return} -1;
1649 
1650     \textcolor{keywordflow}{if} (byte < \hyperlink{net__crypto_8h_a02481d2cc931289c2d5ee21d2a633316}{PACKET\_ID\_LOSSY\_RANGE\_START})
1651         \textcolor{keywordflow}{return} -1;
1652 
1653     \textcolor{keywordflow}{if} (byte >= (\hyperlink{net__crypto_8h_a02481d2cc931289c2d5ee21d2a633316}{PACKET\_ID\_LOSSY\_RANGE\_START} + 
      \hyperlink{_messenger_8h_a9e9b181fad5abaed171e4b4481490d1e}{PACKET\_LOSSY\_AV\_RESERVED}))
1654         \textcolor{keywordflow}{return} -1;
1655 
1656     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_af8c513c69f17fc044615b18ec03f9911}{lossy\_rtp\_packethandlers}[byte % 
      \hyperlink{_messenger_8h_a9e9b181fad5abaed171e4b4481490d1e}{PACKET\_LOSSY\_AV\_RESERVED}].\hyperlink{struct_friend_a726a4dcb820b33fd434494d56f532867}{function} =
1657         \hyperlink{network_8h_a01fb3f0e3fd19ed8eefe335b64934156}{packet\_handler\_callback};
1658     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_af8c513c69f17fc044615b18ec03f9911}{lossy\_rtp\_packethandlers}[byte % 
      \hyperlink{_messenger_8h_a9e9b181fad5abaed171e4b4481490d1e}{PACKET\_LOSSY\_AV\_RESERVED}].\hyperlink{struct_friend_a077376d12464f945e2414d5499c79b3f}{object} = object;
1659     \textcolor{keywordflow}{return} 0;
1660 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{d8/d8d/_messenger_8c_a536d47dbfa35fb02c78068e1d11a1d2a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a536d47dbfa35fb02c78068e1d11a1d2a_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ac4c378ad47edf48aa2d17c0b78395eb4}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+statusmessage@{m\+\_\+callback\+\_\+statusmessage}}
\index{m\+\_\+callback\+\_\+statusmessage@{m\+\_\+callback\+\_\+statusmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+statusmessage}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+statusmessage (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, const uint8\+\_\+t $\ast$, size\+\_\+t, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ac4c378ad47edf48aa2d17c0b78395eb4}


Definition at line 787 of file Messenger.\+c.



References Messenger\+::friend\+\_\+statusmessagechange, and Messenger\+::friend\+\_\+statusmessagechange\+\_\+userdata.



Referenced by main(), and tox\+\_\+callback\+\_\+friend\+\_\+status\+\_\+message().


\begin{DoxyCode}
789 \{
790     m->\hyperlink{struct_messenger_a5badb1433338f70899baee5abcf5f0a5}{friend\_statusmessagechange} = \textcolor{keyword}{function};
791     m->\hyperlink{struct_messenger_adeec8efd452cd609070c2eee12826fb9}{friend\_statusmessagechange\_userdata} = userdata;
792 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac4c378ad47edf48aa2d17c0b78395eb4_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ada19c886734fb0ed3c66d0235cd6fefe}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+typingchange@{m\+\_\+callback\+\_\+typingchange}}
\index{m\+\_\+callback\+\_\+typingchange@{m\+\_\+callback\+\_\+typingchange}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+typingchange}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+typingchange (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, \+\_\+\+Bool, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ada19c886734fb0ed3c66d0235cd6fefe}


Definition at line 800 of file Messenger.\+c.



References Messenger\+::friend\+\_\+typingchange, and Messenger\+::friend\+\_\+typingchange\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+typing().


\begin{DoxyCode}
801 \{
802     m->\hyperlink{struct_messenger_a2d1cf25845a2a7d1b1f90916679fb4fe}{friend\_typingchange} = \textcolor{keyword}{function};
803     m->\hyperlink{struct_messenger_a597c89e529b39b6f08251d586c1379e7}{friend\_typingchange\_userdata} = userdata;
804 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ada19c886734fb0ed3c66d0235cd6fefe_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a3106958c3c2bcee8eb40a39bcc12959b}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+callback\+\_\+userstatus@{m\+\_\+callback\+\_\+userstatus}}
\index{m\+\_\+callback\+\_\+userstatus@{m\+\_\+callback\+\_\+userstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+callback\+\_\+userstatus}]{\setlength{\rightskip}{0pt plus 5cm}void m\+\_\+callback\+\_\+userstatus (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{void($\ast$)({\bf Messenger} $\ast${\bf m}, uint32\+\_\+t, unsigned int, void $\ast$)}]{function, }
\item[{void $\ast$}]{userdata}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a3106958c3c2bcee8eb40a39bcc12959b}


Definition at line 794 of file Messenger.\+c.



References Messenger\+::friend\+\_\+userstatuschange, and Messenger\+::friend\+\_\+userstatuschange\+\_\+userdata.



Referenced by tox\+\_\+callback\+\_\+friend\+\_\+status().


\begin{DoxyCode}
795 \{
796     m->\hyperlink{struct_messenger_a61d62ee2f1f496b742acdcdf2c02f388}{friend\_userstatuschange} = \textcolor{keyword}{function};
797     m->\hyperlink{struct_messenger_a1007bf7131bf75ddd1980ed1b610e6f7}{friend\_userstatuschange\_userdata} = userdata;
798 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{d8/d8d/_messenger_8c_a3106958c3c2bcee8eb40a39bcc12959b_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ad8ece651ed3e70433480141c77f36402}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+copy\+\_\+self\+\_\+statusmessage@{m\+\_\+copy\+\_\+self\+\_\+statusmessage}}
\index{m\+\_\+copy\+\_\+self\+\_\+statusmessage@{m\+\_\+copy\+\_\+self\+\_\+statusmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+copy\+\_\+self\+\_\+statusmessage}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+copy\+\_\+self\+\_\+statusmessage (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{uint8\+\_\+t $\ast$}]{buf}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ad8ece651ed3e70433480141c77f36402}


Definition at line 664 of file Messenger.\+c.



References Messenger\+::statusmessage, and Messenger\+::statusmessage\+\_\+length.



Referenced by tox\+\_\+self\+\_\+get\+\_\+status\+\_\+message().


\begin{DoxyCode}
665 \{
666     memcpy(buf, m->\hyperlink{struct_messenger_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length});
667     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length};
668 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ad8ece651ed3e70433480141c77f36402_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a0cb2504665138d987877e8521619810f}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+copy\+\_\+statusmessage@{m\+\_\+copy\+\_\+statusmessage}}
\index{m\+\_\+copy\+\_\+statusmessage@{m\+\_\+copy\+\_\+statusmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+copy\+\_\+statusmessage}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+copy\+\_\+statusmessage (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t $\ast$}]{buf, }
\item[{uint32\+\_\+t}]{maxlen}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a0cb2504665138d987877e8521619810f}


Definition at line 644 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, M\+I\+N, Friend\+::statusmessage, and Friend\+::statusmessage\+\_\+length.



Referenced by tox\+\_\+friend\+\_\+get\+\_\+status\+\_\+message().


\begin{DoxyCode}
645 \{
646     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
647         \textcolor{keywordflow}{return} -1;
648 
649     \textcolor{keywordtype}{int} msglen = \hyperlink{util_8h_a3acffbd305ee72dcd4593c0d8af64a4f}{MIN}(maxlen, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length});
650 
651     memcpy(buf, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, msglen);
652     memset(buf + msglen, 0, maxlen - msglen);
653     \textcolor{keywordflow}{return} msglen;
654 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{d8/d8d/_messenger_8c_a0cb2504665138d987877e8521619810f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a0cb2504665138d987877e8521619810f_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a7a7b52e12232948dfe96d8e7dea50610}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+delfriend@{m\+\_\+delfriend}}
\index{m\+\_\+delfriend@{m\+\_\+delfriend}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+delfriend}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+delfriend (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a7a7b52e12232948dfe96d8e7dea50610}


Definition at line 379 of file Messenger.\+c.



References clear\+\_\+receipts(), F\+A\+E\+R\+R\+\_\+\+N\+O\+M\+E\+M, Messenger\+::fr, Messenger\+::fr\+\_\+c, friend\+\_\+con\+\_\+connected(), friend\+\_\+connection\+\_\+callbacks(), Messenger\+::friend\+\_\+connectionstatuschange\+\_\+internal, Messenger\+::friend\+\_\+connectionstatuschange\+\_\+internal\+\_\+userdata, friend\+\_\+not\+\_\+valid(), Friend\+::friendcon\+\_\+id, F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, Messenger\+::friendlist, i, kill\+\_\+friend\+\_\+connection(), M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X, N\+O\+F\+R\+I\+E\+N\+D, Messenger\+::numfriends, Friend\+::real\+\_\+pk, realloc\+\_\+friendlist(), remove\+\_\+request\+\_\+received(), send\+\_\+offline\+\_\+packet(), and Friend\+::status.



Referenced by messenger\+\_\+suite(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+friend\+\_\+delete().


\begin{DoxyCode}
380 \{
381     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
382         \textcolor{keywordflow}{return} -1;
383 
384     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_abfd5a34f887ae1fda52d86f4b01ea572}{friend\_connectionstatuschange\_internal})
385         m->\hyperlink{struct_messenger_abfd5a34f887ae1fda52d86f4b01ea572}{friend\_connectionstatuschange\_internal}(m, friendnumber, 0,
       m->\hyperlink{struct_messenger_af915663b78a533e88c4f56cacbeeefdc}{friend\_connectionstatuschange\_internal\_userdata});
386 
387     \hyperlink{_messenger_8c_a3206124b119b06401ce65affb690976d}{clear\_receipts}(m, friendnumber);
388     \hyperlink{friend__requests_8c_a0fb6e21408ca434aa785b5da0c25baec}{remove\_request\_received}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}), m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_ab42b4c90d81ac99b968c3edd1e21d706}{real\_pk});
389     \hyperlink{friend__connection_8c_a15c404d517b4a4fb3976f4d85bfbaef0}{friend\_connection\_callbacks}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, m->
      \hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}, 
      \hyperlink{friend__connection_8h_aa42482d7e48a639e42ba46c923edabfd}{MESSENGER\_CALLBACK\_INDEX}, 0, 0, 0, 0, 0);
390 
391     \textcolor{keywordflow}{if} (\hyperlink{friend__connection_8c_ae5c94f8543c84506c85faac6d2b3a9dd}{friend\_con\_connected}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}) == \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{FRIENDCONN\_STATUS\_CONNECTED}) \{
392         \hyperlink{_messenger_8c_ab4bf3c92ac721d93b6c8a014cd6ddfea}{send\_offline\_packet}(m, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id});
393     \}
394 
395     \hyperlink{friend__connection_8c_a5f311791c0ec4ecd8fdf5359cf7fb95a}{kill\_friend\_connection}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id});
396     memset(&(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber]), 0, \textcolor{keyword}{sizeof}(\hyperlink{struct_friend}{Friend}));
397     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
398 
399     \textcolor{keywordflow}{for} (i = m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; i != 0; --i) \{
400         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i - 1].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ead051772af60ca4a39271bab1829fc61c}{NOFRIEND})
401             \textcolor{keywordflow}{break};
402     \}
403 
404     m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends} = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
405 
406     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_ade10ae2516f68845c8b2e0c5eb95bd41}{realloc\_friendlist}(m, m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}) != 0)
407         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_a16af7b253440dadd46a80a4b9fddba4dacd7ea42e2d9e39408188fb8126c36896}{FAERR\_NOMEM};
408 
409     \textcolor{keywordflow}{return} 0;
410 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a7a7b52e12232948dfe96d8e7dea50610_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a7a7b52e12232948dfe96d8e7dea50610_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ac652e6df9a2c7024fae6700bb7927c61}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+friend\+\_\+exists@{m\+\_\+friend\+\_\+exists}}
\index{m\+\_\+friend\+\_\+exists@{m\+\_\+friend\+\_\+exists}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+friend\+\_\+exists}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+friend\+\_\+exists (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ac652e6df9a2c7024fae6700bb7927c61}


Definition at line 437 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid().



Referenced by messenger\+\_\+suite(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+friend\+\_\+exists().


\begin{DoxyCode}
438 \{
439     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
440         \textcolor{keywordflow}{return} 0;
441 
442     \textcolor{keywordflow}{return} 1;
443 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=287pt]{d8/d8d/_messenger_8c_ac652e6df9a2c7024fae6700bb7927c61_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ac652e6df9a2c7024fae6700bb7927c61_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a4b1f7ee3f635e7a80c8f3cbe98588e4d}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+friend\+\_\+connectionstatus@{m\+\_\+get\+\_\+friend\+\_\+connectionstatus}}
\index{m\+\_\+get\+\_\+friend\+\_\+connectionstatus@{m\+\_\+get\+\_\+friend\+\_\+connectionstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+friend\+\_\+connectionstatus}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+get\+\_\+friend\+\_\+connectionstatus (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a4b1f7ee3f635e7a80c8f3cbe98588e4d}


Definition at line 412 of file Messenger.\+c.



References C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+N\+O\+N\+E, C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+C\+P, C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+U\+D\+P, C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+U\+N\+K\+N\+O\+W\+N, crypto\+\_\+connection\+\_\+status(), Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, Messenger\+::net\+\_\+crypto, and Friend\+::status.



Referenced by check\+\_\+friend\+\_\+tcp\+\_\+udp(), messenger\+\_\+suite(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+friend\+\_\+get\+\_\+connection\+\_\+status().


\begin{DoxyCode}
413 \{
414     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
415         \textcolor{keywordflow}{return} -1;
416 
417     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE}) \{
418         \_Bool direct\_connected = 0;
419         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} num\_online\_relays = 0;
420         \hyperlink{net__crypto_8c_afb5c59e6df7f38fe0bdf9e0f6c459869}{crypto\_connection\_status}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
421                                  m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), &direct\_connected, &num\_online\_relays);
422 
423         \textcolor{keywordflow}{if} (direct\_connected) \{
424             \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25aaa6bcb092cadcf56c3637f282fac13c6}{CONNECTION\_UDP};
425         \} \textcolor{keywordflow}{else} \{
426             \textcolor{keywordflow}{if} (num\_online\_relays) \{
427                 \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25aa393b364b51a891ecf2ef9292ff5192c}{CONNECTION\_TCP};
428             \} \textcolor{keywordflow}{else} \{
429                 \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25aaa98c30b12cac8536b62c99df201f423}{CONNECTION\_UNKNOWN};
430             \}
431         \}
432     \} \textcolor{keywordflow}{else} \{
433         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_aba01db17f4a2bfbc3db60dc172972a25a8ad3970838c849405136a8d52bec70e1}{CONNECTION\_NONE};
434     \}
435 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4b1f7ee3f635e7a80c8f3cbe98588e4d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4b1f7ee3f635e7a80c8f3cbe98588e4d_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_aa3cd2055220195e3bd840d8f1f36281c}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+istyping@{m\+\_\+get\+\_\+istyping}}
\index{m\+\_\+get\+\_\+istyping@{m\+\_\+get\+\_\+istyping}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+istyping}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+get\+\_\+istyping (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_aa3cd2055220195e3bd840d8f1f36281c}


Definition at line 715 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, and Friend\+::is\+\_\+typing.



Referenced by tox\+\_\+friend\+\_\+get\+\_\+typing().


\begin{DoxyCode}
716 \{
717     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
718         \textcolor{keywordflow}{return} -1;
719 
720     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a4eb96aff01799d54246cc48854a47175}{is\_typing};
721 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=284pt]{d8/d8d/_messenger_8c_aa3cd2055220195e3bd840d8f1f36281c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aa3cd2055220195e3bd840d8f1f36281c_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_aa8a02cf70f67a4b6ea2888fffa5c16b1}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+last\+\_\+online@{m\+\_\+get\+\_\+last\+\_\+online}}
\index{m\+\_\+get\+\_\+last\+\_\+online@{m\+\_\+get\+\_\+last\+\_\+online}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+last\+\_\+online}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t m\+\_\+get\+\_\+last\+\_\+online (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_aa8a02cf70f67a4b6ea2888fffa5c16b1}


Definition at line 689 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, and Friend\+::last\+\_\+seen\+\_\+time.



Referenced by tox\+\_\+friend\+\_\+get\+\_\+last\+\_\+online().


\begin{DoxyCode}
690 \{
691     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
692         \textcolor{keywordflow}{return} UINT64\_MAX;
693 
694     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a8f99c48eb6b3ea472806495135ab6792}{last\_seen\_time};
695 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{d8/d8d/_messenger_8c_aa8a02cf70f67a4b6ea2888fffa5c16b1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{d8/d8d/_messenger_8c_aa8a02cf70f67a4b6ea2888fffa5c16b1_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_aadf7f2cd48886fe7b9a38e6c63b2ff9d}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+name\+\_\+size@{m\+\_\+get\+\_\+name\+\_\+size}}
\index{m\+\_\+get\+\_\+name\+\_\+size@{m\+\_\+get\+\_\+name\+\_\+size}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+name\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+get\+\_\+name\+\_\+size (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_aadf7f2cd48886fe7b9a38e6c63b2ff9d}


Definition at line 579 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, and Friend\+::name\+\_\+length.



Referenced by tox\+\_\+friend\+\_\+get\+\_\+name\+\_\+size().


\begin{DoxyCode}
580 \{
581     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
582         \textcolor{keywordflow}{return} -1;
583 
584     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length};
585 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{d8/d8d/_messenger_8c_aadf7f2cd48886fe7b9a38e6c63b2ff9d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aadf7f2cd48886fe7b9a38e6c63b2ff9d_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2a734fe4ba57e01e77ed5b7e315134eb}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+self\+\_\+name\+\_\+size@{m\+\_\+get\+\_\+self\+\_\+name\+\_\+size}}
\index{m\+\_\+get\+\_\+self\+\_\+name\+\_\+size@{m\+\_\+get\+\_\+self\+\_\+name\+\_\+size}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+self\+\_\+name\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+get\+\_\+self\+\_\+name\+\_\+size (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a2a734fe4ba57e01e77ed5b7e315134eb}


Definition at line 587 of file Messenger.\+c.



References Messenger\+::name\+\_\+length.



Referenced by tox\+\_\+self\+\_\+get\+\_\+name\+\_\+size().


\begin{DoxyCode}
588 \{
589     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length};
590 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2a734fe4ba57e01e77ed5b7e315134eb_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a58e1ad3598173e54d41cb6d01e958409}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size@{m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size}}
\index{m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size@{m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+get\+\_\+self\+\_\+statusmessage\+\_\+size (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a58e1ad3598173e54d41cb6d01e958409}


Definition at line 659 of file Messenger.\+c.



References Messenger\+::statusmessage\+\_\+length.



Referenced by tox\+\_\+self\+\_\+get\+\_\+status\+\_\+message\+\_\+size().


\begin{DoxyCode}
660 \{
661     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length};
662 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a58e1ad3598173e54d41cb6d01e958409_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a13b0520deb579b74ec832dcfd1a94daf}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+self\+\_\+userstatus@{m\+\_\+get\+\_\+self\+\_\+userstatus}}
\index{m\+\_\+get\+\_\+self\+\_\+userstatus@{m\+\_\+get\+\_\+self\+\_\+userstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+self\+\_\+userstatus}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t m\+\_\+get\+\_\+self\+\_\+userstatus (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a13b0520deb579b74ec832dcfd1a94daf}


Definition at line 684 of file Messenger.\+c.



References Messenger\+::userstatus.



Referenced by tox\+\_\+self\+\_\+get\+\_\+status().


\begin{DoxyCode}
685 \{
686     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_adde524f5a15465585cbc2543cd0b2710}{userstatus};
687 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{d8/d8d/_messenger_8c_a13b0520deb579b74ec832dcfd1a94daf_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a84d0c0e28a2c64f66e114a69619414aa}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+statusmessage\+\_\+size@{m\+\_\+get\+\_\+statusmessage\+\_\+size}}
\index{m\+\_\+get\+\_\+statusmessage\+\_\+size@{m\+\_\+get\+\_\+statusmessage\+\_\+size}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+statusmessage\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+get\+\_\+statusmessage\+\_\+size (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a84d0c0e28a2c64f66e114a69619414aa}


Definition at line 633 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, and Friend\+::statusmessage\+\_\+length.



Referenced by S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), tox\+\_\+friend\+\_\+get\+\_\+status\+\_\+message(), and tox\+\_\+friend\+\_\+get\+\_\+status\+\_\+message\+\_\+size().


\begin{DoxyCode}
634 \{
635     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
636         \textcolor{keywordflow}{return} -1;
637 
638     \textcolor{keywordflow}{return} m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length};
639 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=340pt]{d8/d8d/_messenger_8c_a84d0c0e28a2c64f66e114a69619414aa_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a84d0c0e28a2c64f66e114a69619414aa_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a6c699e7ecf369c5647813d60eace4099}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+get\+\_\+userstatus@{m\+\_\+get\+\_\+userstatus}}
\index{m\+\_\+get\+\_\+userstatus@{m\+\_\+get\+\_\+userstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+get\+\_\+userstatus}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t m\+\_\+get\+\_\+userstatus (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a6c699e7ecf369c5647813d60eace4099}


Definition at line 670 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Friend\+::userstatus, U\+S\+E\+R\+S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D, and U\+S\+E\+R\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E.



Referenced by tox\+\_\+friend\+\_\+get\+\_\+status().


\begin{DoxyCode}
671 \{
672     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
673         \textcolor{keywordflow}{return} \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986ca6d8bb6c720be91f8ebecd51c9db139bb}{USERSTATUS\_INVALID};
674 
675     uint8\_t \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_adde524f5a15465585cbc2543cd0b2710}{userstatus};
676 
677     \textcolor{keywordflow}{if} (status >= \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986ca6d8bb6c720be91f8ebecd51c9db139bb}{USERSTATUS\_INVALID}) \{
678         status = \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986ca8eb0ac68c5c7d0e6084d707c87191dcd}{USERSTATUS\_NONE};
679     \}
680 
681     \textcolor{keywordflow}{return} \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status};
682 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{d8/d8d/_messenger_8c_a6c699e7ecf369c5647813d60eace4099_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{d8/d8d/_messenger_8c_a6c699e7ecf369c5647813d60eace4099_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2374f56c7aeb5fa6d1a3f1a29bb5016b}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+msi\+\_\+packet@{m\+\_\+msi\+\_\+packet}}
\index{m\+\_\+msi\+\_\+packet@{m\+\_\+msi\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+msi\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+msi\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a2374f56c7aeb5fa6d1a3f1a29bb5016b}


Definition at line 1610 of file Messenger.\+c.



References P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+M\+S\+I, and write\+\_\+cryptpacket\+\_\+id().



Referenced by send\+\_\+message().


\begin{DoxyCode}
1611 \{
1612     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_aa9ec6f58cbee9d52d6e2700dff8d0b25}{PACKET\_ID\_MSI}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length, 0);
1613 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2374f56c7aeb5fa6d1a3f1a29bb5016b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2374f56c7aeb5fa6d1a3f1a29bb5016b_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a23c8b52187d4ab113cce5497a19ac997}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+send\+\_\+message\+\_\+generic@{m\+\_\+send\+\_\+message\+\_\+generic}}
\index{m\+\_\+send\+\_\+message\+\_\+generic@{m\+\_\+send\+\_\+message\+\_\+generic}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+send\+\_\+message\+\_\+generic}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+send\+\_\+message\+\_\+generic (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{type, }
\item[{const uint8\+\_\+t $\ast$}]{message, }
\item[{uint32\+\_\+t}]{length, }
\item[{uint32\+\_\+t $\ast$}]{message\+\_\+id}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a23c8b52187d4ab113cce5497a19ac997}


Definition at line 454 of file Messenger.\+c.



References add\+\_\+receipt(), Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, M\+E\+S\+S\+A\+G\+E\+\_\+\+A\+C\+T\+I\+O\+N, Friend\+::message\+\_\+id, Receipts\+::msg\+\_\+id, Messenger\+::net\+\_\+crypto, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+M\+E\+S\+S\+A\+G\+E, Receipts\+::packet\+\_\+num, Friend\+::status, and write\+\_\+cryptpacket().



Referenced by main(), print\+\_\+message(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+friend\+\_\+send\+\_\+message().


\begin{DoxyCode}
456 \{
457     \textcolor{keywordflow}{if} (type > \hyperlink{_messenger_8h_ac36f475ca5b446f4fde4c9b90bec77c8aab269ba44425a5e505734ffd116ded7d}{MESSAGE\_ACTION})
458         \textcolor{keywordflow}{return} -5;
459 
460     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
461         \textcolor{keywordflow}{return} -1;
462 
463     \textcolor{keywordflow}{if} (length >= \hyperlink{net__crypto_8h_a1b6e5122f9fdc5ef548ccf920f0c246e}{MAX\_CRYPTO\_DATA\_SIZE})
464         \textcolor{keywordflow}{return} -2;
465 
466     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
467         \textcolor{keywordflow}{return} -3;
468 
469     uint8\_t packet[length + 1];
470     packet[0] = type + \hyperlink{_messenger_8h_a254356a92e0c8c90a8e5ff6f828efc4c}{PACKET\_ID\_MESSAGE};
471 
472     \textcolor{keywordflow}{if} (length != 0)
473         memcpy(packet + 1, message, length);
474 
475     int64\_t packet\_num = \hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
476                                            m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), packet, length + 1, 0);
477 
478     \textcolor{keywordflow}{if} (packet\_num == -1)
479         \textcolor{keywordflow}{return} -4;
480 
481     uint32\_t msg\_id = ++m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aa4420a99dd00b4884b23150e4226b2ea}{message\_id};
482 
483     \hyperlink{_messenger_8c_a669d4111f5309184034fcbbe4ee1372c}{add\_receipt}(m, friendnumber, packet\_num, msg\_id);
484 
485     \textcolor{keywordflow}{if} (message\_id)
486         *message\_id = msg\_id;
487 
488     \textcolor{keywordflow}{return} 0;
489 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a23c8b52187d4ab113cce5497a19ac997_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a23c8b52187d4ab113cce5497a19ac997_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a5328e9c55aff292c735e70c1953d49d4}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+sendname@{m\+\_\+sendname}}
\index{m\+\_\+sendname@{m\+\_\+sendname}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+sendname}]{\setlength{\rightskip}{0pt plus 5cm}static int m\+\_\+sendname (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{name, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a5328e9c55aff292c735e70c1953d49d4}


Definition at line 494 of file Messenger.\+c.



References M\+A\+X\+\_\+\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+N\+I\+C\+K\+N\+A\+M\+E, and write\+\_\+cryptpacket\+\_\+id().



Referenced by do\+\_\+friends().


\begin{DoxyCode}
495 \{
496     \textcolor{keywordflow}{if} (length > \hyperlink{_messenger_8h_a0c397a708cec89c74029582574516b30}{MAX\_NAME\_LENGTH})
497         \textcolor{keywordflow}{return} 0;
498 
499     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_af5ddb51310b68c24012cd07ccb612b6b}{PACKET\_ID\_NICKNAME}, name, length, 0);
500 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5328e9c55aff292c735e70c1953d49d4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5328e9c55aff292c735e70c1953d49d4_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ae826ef8eb56b45f67f3d37be99df7270}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+set\+\_\+statusmessage@{m\+\_\+set\+\_\+statusmessage}}
\index{m\+\_\+set\+\_\+statusmessage@{m\+\_\+set\+\_\+statusmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+set\+\_\+statusmessage}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+set\+\_\+statusmessage (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{status, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ae826ef8eb56b45f67f3d37be99df7270}


Definition at line 592 of file Messenger.\+c.



References Messenger\+::friendlist, i, M\+A\+X\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+T\+H, Messenger\+::numfriends, Messenger\+::statusmessage, Messenger\+::statusmessage\+\_\+length, and Friend\+::statusmessage\+\_\+sent.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+self\+\_\+set\+\_\+status\+\_\+message().


\begin{DoxyCode}
593 \{
594     \textcolor{keywordflow}{if} (length > \hyperlink{_messenger_8h_a0d1a4b91dd43b4cb07dfefab7fc6bee1}{MAX\_STATUSMESSAGE\_LENGTH})
595         \textcolor{keywordflow}{return} -1;
596 
597     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length} == length && (length == 0 || memcmp(m->
      \hyperlink{struct_messenger_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status}, length) == 0))
598         \textcolor{keywordflow}{return} 0;
599 
600     \textcolor{keywordflow}{if} (length)
601         memcpy(m->\hyperlink{struct_messenger_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status}, length);
602 
603     m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length} = length;
604 
605     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
606 
607     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i})
608         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_ad39189cd22b356c314e4d980b55db259}{statusmessage\_sent} = 0;
609 
610     \textcolor{keywordflow}{return} 0;
611 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ae826ef8eb56b45f67f3d37be99df7270_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ab4a416ae0bb471de245dcbd790367420}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+set\+\_\+userstatus@{m\+\_\+set\+\_\+userstatus}}
\index{m\+\_\+set\+\_\+userstatus@{m\+\_\+set\+\_\+userstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+set\+\_\+userstatus}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+set\+\_\+userstatus (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ab4a416ae0bb471de245dcbd790367420}


Definition at line 613 of file Messenger.\+c.



References Messenger\+::friendlist, i, Messenger\+::numfriends, Messenger\+::userstatus, U\+S\+E\+R\+S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D, and Friend\+::userstatus\+\_\+sent.



Referenced by messenger\+\_\+load\+\_\+state\+\_\+callback(), messenger\+\_\+suite(), and tox\+\_\+self\+\_\+set\+\_\+status().


\begin{DoxyCode}
614 \{
615     \textcolor{keywordflow}{if} (\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} >= \hyperlink{_messenger_8h_aa55a7166581c83a07f49f9392447986ca6d8bb6c720be91f8ebecd51c9db139bb}{USERSTATUS\_INVALID})
616         \textcolor{keywordflow}{return} -1;
617 
618     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_adde524f5a15465585cbc2543cd0b2710}{userstatus} == \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status})
619         \textcolor{keywordflow}{return} 0;
620 
621     m->\hyperlink{struct_messenger_adde524f5a15465585cbc2543cd0b2710}{userstatus} = \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status};
622     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
623 
624     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i})
625         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_af7c74fd36acb972c3a8641fb0781e37e}{userstatus\_sent} = 0;
626 
627     \textcolor{keywordflow}{return} 0;
628 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ab4a416ae0bb471de245dcbd790367420_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ab6577e36e916635816dd0de10c06150e}{\index{Messenger.\+c@{Messenger.\+c}!m\+\_\+set\+\_\+usertyping@{m\+\_\+set\+\_\+usertyping}}
\index{m\+\_\+set\+\_\+usertyping@{m\+\_\+set\+\_\+usertyping}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{m\+\_\+set\+\_\+usertyping}]{\setlength{\rightskip}{0pt plus 5cm}int m\+\_\+set\+\_\+usertyping (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{is\+\_\+typing}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ab6577e36e916635816dd0de10c06150e}


Definition at line 697 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, Friend\+::user\+\_\+istyping, and Friend\+::user\+\_\+istyping\+\_\+sent.



Referenced by tox\+\_\+self\+\_\+set\+\_\+typing().


\begin{DoxyCode}
699 \{
700     \textcolor{keywordflow}{if} (is\_typing != 0 && is\_typing != 1)
701         \textcolor{keywordflow}{return} -1;
702 
703     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
704         \textcolor{keywordflow}{return} -1;
705 
706     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a68e945edd5a63c22371edf481c788d88}{user\_istyping} == is\_typing)
707         \textcolor{keywordflow}{return} 0;
708 
709     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a68e945edd5a63c22371edf481c788d88}{user\_istyping} = is\_typing;
710     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a8d9e9aef86444e0cde8ec0314f60907e}{user\_istyping\_sent} = 0;
711 
712     \textcolor{keywordflow}{return} 0;
713 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=295pt]{d8/d8d/_messenger_8c_ab6577e36e916635816dd0de10c06150e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ab6577e36e916635816dd0de10c06150e_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a4871cd41d2a53b07ee4b2467a844e17e}{\index{Messenger.\+c@{Messenger.\+c}!messenger\+\_\+load@{messenger\+\_\+load}}
\index{messenger\+\_\+load@{messenger\+\_\+load}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{messenger\+\_\+load}]{\setlength{\rightskip}{0pt plus 5cm}int messenger\+\_\+load (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a4871cd41d2a53b07ee4b2467a844e17e}


Definition at line 2744 of file Messenger.\+c.



References lendian\+\_\+to\+\_\+host32(), load\+\_\+state(), messenger\+\_\+load\+\_\+state\+\_\+callback(), M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L, and M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E.



Referenced by main(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+new().


\begin{DoxyCode}
2745 \{
2746     uint32\_t data32[2];
2747     uint32\_t cookie\_len = \textcolor{keyword}{sizeof}(data32);
2748 
2749     \textcolor{keywordflow}{if} (length < cookie\_len)
2750         \textcolor{keywordflow}{return} -1;
2751 
2752     memcpy(data32, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, \textcolor{keyword}{sizeof}(uint32\_t));
2753     \hyperlink{util_8c_a4a7b1a2d62e6d6842bc0fefece837ad2}{lendian\_to\_host32}(data32 + 1, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} + \textcolor{keyword}{sizeof}(uint32\_t));
2754 
2755     \textcolor{keywordflow}{if} (!data32[0] && (data32[1] == \hyperlink{_messenger_8c_a3e84561adca7ef2861635cd81ed71914}{MESSENGER\_STATE\_COOKIE\_GLOBAL}))
2756         \textcolor{keywordflow}{return} \hyperlink{util_8c_a779943554d12b56f6e35e8f5ba2cf7f5}{load\_state}(\hyperlink{_messenger_8c_a122e94907e1063fdff78f54ee4b0852b}{messenger\_load\_state\_callback}, m, 
      \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} + cookie\_len,
2757                           length - cookie\_len, \hyperlink{_messenger_8c_a2d38314cc90c702f4cde6cfd6f7760db}{MESSENGER\_STATE\_COOKIE\_TYPE});
2758     \textcolor{keywordflow}{else}
2759         \textcolor{keywordflow}{return} -1;
2760 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4871cd41d2a53b07ee4b2467a844e17e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4871cd41d2a53b07ee4b2467a844e17e_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a122e94907e1063fdff78f54ee4b0852b}{\index{Messenger.\+c@{Messenger.\+c}!messenger\+\_\+load\+\_\+state\+\_\+callback@{messenger\+\_\+load\+\_\+state\+\_\+callback}}
\index{messenger\+\_\+load\+\_\+state\+\_\+callback@{messenger\+\_\+load\+\_\+state\+\_\+callback}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{messenger\+\_\+load\+\_\+state\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}static int messenger\+\_\+load\+\_\+state\+\_\+callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{outer, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{length, }
\item[{uint16\+\_\+t}]{type}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a122e94907e1063fdff78f54ee4b0852b}


Definition at line 2648 of file Messenger.\+c.



References Messenger\+::dht, D\+H\+T\+\_\+load(), Messenger\+::fr, friends\+\_\+list\+\_\+load(), Messenger\+::has\+\_\+added\+\_\+relays, i, Node\+\_\+format\+::ip\+\_\+port, load\+\_\+secret\+\_\+key(), Messenger\+::loaded\+\_\+relays, m\+\_\+set\+\_\+statusmessage(), m\+\_\+set\+\_\+userstatus(), M\+A\+X\+\_\+\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, M\+A\+X\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+T\+H, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y, Messenger\+::net\+\_\+crypto, num, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S, onion\+\_\+add\+\_\+bs\+\_\+path\+\_\+node(), Messenger\+::onion\+\_\+c, Node\+\_\+format\+::public\+\_\+key, Net\+\_\+\+Crypto\+::self\+\_\+public\+\_\+key, set\+\_\+nospam(), setname(), and unpack\+\_\+nodes().



Referenced by messenger\+\_\+load().


\begin{DoxyCode}
2649 \{
2650     \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = outer;
2651 
2652     \textcolor{keywordflow}{switch} (type) \{
2653         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_af7c141a97170e9f2f3e6cf961e23c947}{MESSENGER\_STATE\_TYPE\_NOSPAMKEYS}:
2654             \textcolor{keywordflow}{if} (length == crypto\_box\_PUBLICKEYBYTES + crypto\_box\_SECRETKEYBYTES + \textcolor{keyword}{sizeof}(uint32\_t)) \{
2655                 \hyperlink{friend__requests_8c_a8c1b80998bba387611ca16715462abaa}{set\_nospam}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}), *(uint32\_t *)\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data});
2656                 \hyperlink{net__crypto_8c_ac8131842eafef1819a6e6da5404e3234}{load\_secret\_key}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, (&\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[\textcolor{keyword}{sizeof}(uint32\_t)]) + 
      crypto\_box\_PUBLICKEYBYTES);
2657 
2658                 \textcolor{keywordflow}{if} (memcmp((&\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[\textcolor{keyword}{sizeof}(uint32\_t)]), m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}->
      \hyperlink{struct_net___crypto_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key}, crypto\_box\_PUBLICKEYBYTES) != 0) \{
2659                     \textcolor{keywordflow}{return} -1;
2660                 \}
2661             \} \textcolor{keywordflow}{else}
2662                 \textcolor{keywordflow}{return} -1;    \textcolor{comment}{/* critical */}
2663 
2664             \textcolor{keywordflow}{break};
2665 
2666         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_ae6c05fc174cd87a755972ef8f7679981}{MESSENGER\_STATE\_TYPE\_DHT}:
2667             \hyperlink{_d_h_t_8c_a36e42ad71b293cd0ada8a7b6de9ad86b}{DHT\_load}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
2668             \textcolor{keywordflow}{break};
2669 
2670         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_a4d8769af27d9fbce16ca1e130853bde5}{MESSENGER\_STATE\_TYPE\_FRIENDS}:
2671             \hyperlink{_messenger_8c_ad971e0d0877b61a160884d59527d39d9}{friends\_list\_load}(m, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
2672             \textcolor{keywordflow}{break};
2673 
2674         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_afd99074ae265873e4fdff404d37394d4}{MESSENGER\_STATE\_TYPE\_NAME}:
2675             \textcolor{keywordflow}{if} ((length > 0) && (length <= \hyperlink{_messenger_8h_a0c397a708cec89c74029582574516b30}{MAX\_NAME\_LENGTH})) \{
2676                 \hyperlink{_messenger_8c_a74824e98cf3b2607cb8624d46cd2e227}{setname}(m, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
2677             \}
2678 
2679             \textcolor{keywordflow}{break};
2680 
2681         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_a43f7448cfa20d85c9b793cbde6715ffc}{MESSENGER\_STATE\_TYPE\_STATUSMESSAGE}:
2682             \textcolor{keywordflow}{if} ((length > 0) && (length < \hyperlink{_messenger_8h_a0d1a4b91dd43b4cb07dfefab7fc6bee1}{MAX\_STATUSMESSAGE\_LENGTH})) \{
2683                 \hyperlink{_messenger_8c_ae826ef8eb56b45f67f3d37be99df7270}{m\_set\_statusmessage}(m, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
2684             \}
2685 
2686             \textcolor{keywordflow}{break};
2687 
2688         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_a51d08227e8515e67d7969289cd18f4cd}{MESSENGER\_STATE\_TYPE\_STATUS}:
2689             \textcolor{keywordflow}{if} (length == 1) \{
2690                 \hyperlink{_messenger_8c_ab4a416ae0bb471de245dcbd790367420}{m\_set\_userstatus}(m, *\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data});
2691             \}
2692 
2693             \textcolor{keywordflow}{break};
2694 
2695         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_a64f45a4a72c35453d48355edcc2fdea7}{MESSENGER\_STATE\_TYPE\_TCP\_RELAY}: \{
2696             \textcolor{keywordflow}{if} (length == 0) \{
2697                 \textcolor{keywordflow}{break};
2698             \}
2699 
2700             \hyperlink{_d_h_t_8c_a45b33af842c0289c78c70f81e854ed62}{unpack\_nodes}(m->\hyperlink{struct_messenger_a75d4e8cfc84896f1684dd7c62c1be397}{loaded\_relays}, 
      \hyperlink{_messenger_8h_a7b9306b33798fe1ba98b6f04de976866}{NUM\_SAVED\_TCP\_RELAYS}, 0, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length, 1);
2701             m->\hyperlink{struct_messenger_af97bc78d4a1b6b87167a479a1cb9920c}{has\_added\_relays} = 0;
2702 
2703             \textcolor{keywordflow}{break};
2704         \}
2705 
2706         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_ac7f0d1335af95f7bd8fae885c1bfcfc9}{MESSENGER\_STATE\_TYPE\_PATH\_NODE}: \{
2707             \hyperlink{struct_node__format}{Node\_format} nodes[\hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{NUM\_SAVED\_PATH\_NODES}];
2708 
2709             \textcolor{keywordflow}{if} (length == 0) \{
2710                 \textcolor{keywordflow}{break};
2711             \}
2712 
2713             \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} = \hyperlink{_d_h_t_8c_a45b33af842c0289c78c70f81e854ed62}{unpack\_nodes}(nodes, 
      \hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{NUM\_SAVED\_PATH\_NODES}, 0, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length, 0);
2714 
2715             \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
2716                 \hyperlink{onion__client_8c_accbc9c20b5933ea088d718ea09abd6b8}{onion\_add\_bs\_path\_node}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, nodes[i].
      \hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}, nodes[i].\hyperlink{struct_node__format_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key});
2717             \}
2718 
2719             \textcolor{keywordflow}{break};
2720         \}
2721 
2722         \textcolor{keywordflow}{case} \hyperlink{_messenger_8c_ad1aedc06debd945aca3bd7cb5b6dd46f}{MESSENGER\_STATE\_TYPE\_END}: \{
2723             \textcolor{keywordflow}{if} (length != 0) \{
2724                 \textcolor{keywordflow}{return} -1;
2725             \}
2726 
2727             \textcolor{keywordflow}{return} -2;
2728             \textcolor{keywordflow}{break};
2729         \}
2730 
2731 \textcolor{preprocessor}{#ifdef DEBUG}
2732 
2733         \textcolor{keywordflow}{default}:
2734             fprintf(stderr, \textcolor{stringliteral}{"Load state: contains unrecognized part (len %u, type %u)\(\backslash\)n"},
2735                     length, type);
2736             \textcolor{keywordflow}{break};
2737 \textcolor{preprocessor}{#endif}
2738     \}
2739 
2740     \textcolor{keywordflow}{return} 0;
2741 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a122e94907e1063fdff78f54ee4b0852b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a122e94907e1063fdff78f54ee4b0852b_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ae99fff78f4ac1f79f1faa817d31c7dfe}{\index{Messenger.\+c@{Messenger.\+c}!messenger\+\_\+run\+\_\+interval@{messenger\+\_\+run\+\_\+interval}}
\index{messenger\+\_\+run\+\_\+interval@{messenger\+\_\+run\+\_\+interval}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{messenger\+\_\+run\+\_\+interval}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t messenger\+\_\+run\+\_\+interval (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ae99fff78f4ac1f79f1faa817d31c7dfe}


Definition at line 2268 of file Messenger.\+c.



References crypto\+\_\+run\+\_\+interval(), M\+I\+N\+\_\+\+R\+U\+N\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L, and Messenger\+::net\+\_\+crypto.



Referenced by tox\+\_\+iteration\+\_\+interval().


\begin{DoxyCode}
2269 \{
2270     uint32\_t crypto\_interval = \hyperlink{net__crypto_8c_af0fcda7ce07347179ae4f327489c7643}{crypto\_run\_interval}(m->
      \hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto});
2271 
2272     \textcolor{keywordflow}{if} (crypto\_interval > \hyperlink{_messenger_8c_a5e98fb56f9865b4041b3ac9f3ff1fbd7}{MIN\_RUN\_INTERVAL}) \{
2273         \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_a5e98fb56f9865b4041b3ac9f3ff1fbd7}{MIN\_RUN\_INTERVAL};
2274     \} \textcolor{keywordflow}{else} \{
2275         \textcolor{keywordflow}{return} crypto\_interval;
2276     \}
2277 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{d8/d8d/_messenger_8c_ae99fff78f4ac1f79f1faa817d31c7dfe_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ae99fff78f4ac1f79f1faa817d31c7dfe_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_af0dfac679b1b57a0036f6511e12fe777}{\index{Messenger.\+c@{Messenger.\+c}!messenger\+\_\+save@{messenger\+\_\+save}}
\index{messenger\+\_\+save@{messenger\+\_\+save}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{messenger\+\_\+save}]{\setlength{\rightskip}{0pt plus 5cm}void messenger\+\_\+save (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{uint8\+\_\+t $\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_af0dfac679b1b57a0036f6511e12fe777}


Definition at line 2565 of file Messenger.\+c.



References copy\+\_\+connected\+\_\+tcp\+\_\+relays(), make-\/funny-\/savefile\+::data, Messenger\+::dht, D\+H\+T\+\_\+save(), D\+H\+T\+\_\+size(), Messenger\+::fr, friends\+\_\+list\+\_\+save(), get\+\_\+nospam(), host\+\_\+to\+\_\+lendian32(), messenger\+\_\+size(), M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+G\+L\+O\+B\+A\+L, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+D\+H\+T, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+N\+D, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+F\+R\+I\+E\+N\+D\+S, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+A\+M\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+N\+O\+S\+P\+A\+M\+K\+E\+Y\+S, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+T\+Y\+P\+E\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y, Messenger\+::name, Messenger\+::name\+\_\+length, Messenger\+::net\+\_\+crypto, num, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S, onion\+\_\+backup\+\_\+nodes(), Messenger\+::onion\+\_\+c, pack\+\_\+nodes(), packed\+\_\+node\+\_\+size(), save\+\_\+keys(), saved\+\_\+friendslist\+\_\+size(), Messenger\+::statusmessage, Messenger\+::statusmessage\+\_\+length, T\+C\+P\+\_\+\+I\+N\+E\+T6, Messenger\+::userstatus, and z\+\_\+state\+\_\+save\+\_\+subheader().



Referenced by main(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+get\+\_\+savedata().


\begin{DoxyCode}
2566 \{
2567     memset(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, 0, \hyperlink{_messenger_8c_a4ae119dad636f15f1a5d628a13b107d8}{messenger\_size}(m));
2568 
2569     uint32\_t len;
2570     uint16\_t type;
2571     uint32\_t size32 = \textcolor{keyword}{sizeof}(uint32\_t);
2572 
2573     memset(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, 0, size32);
2574     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += size32;
2575     \hyperlink{util_8c_aebd439a002cb183420a08996f7ffdbef}{host\_to\_lendian32}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, \hyperlink{_messenger_8c_a3e84561adca7ef2861635cd81ed71914}{MESSENGER\_STATE\_COOKIE\_GLOBAL}
      );
2576     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += size32;
2577 
2578 \textcolor{preprocessor}{#ifdef DEBUG}
2579     assert(\textcolor{keyword}{sizeof}(\hyperlink{friend__requests_8c_a1e61ffb4aba6cf8815238ccc2d18c794}{get\_nospam}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}))) == \textcolor{keyword}{sizeof}(uint32\_t));
2580 \textcolor{preprocessor}{#endif}
2581     len = size32 + crypto\_box\_PUBLICKEYBYTES + crypto\_box\_SECRETKEYBYTES;
2582     type = \hyperlink{_messenger_8c_af7c141a97170e9f2f3e6cf961e23c947}{MESSENGER\_STATE\_TYPE\_NOSPAMKEYS};
2583     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len, type);
2584     *(uint32\_t *)\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{friend__requests_8c_a1e61ffb4aba6cf8815238ccc2d18c794}{get\_nospam}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}));
2585     \hyperlink{net__crypto_8c_ae2f39ed236b85952fa913fdac1785671}{save\_keys}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} + size32);
2586     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2587 
2588     len = \hyperlink{_messenger_8c_ad436fa7850d7bf55222df42ff527c375}{saved\_friendslist\_size}(m);
2589     type = \hyperlink{_messenger_8c_a4d8769af27d9fbce16ca1e130853bde5}{MESSENGER\_STATE\_TYPE\_FRIENDS};
2590     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len, type);
2591     \hyperlink{_messenger_8c_a25018a4f99e9bba64b138fbc5fe35eea}{friends\_list\_save}(m, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data});
2592     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2593 
2594     len = m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length};
2595     type = \hyperlink{_messenger_8c_afd99074ae265873e4fdff404d37394d4}{MESSENGER\_STATE\_TYPE\_NAME};
2596     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len, type);
2597     memcpy(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, m->\hyperlink{struct_messenger_a11b8cc6595eea79e65c978209278e683}{name}, len);
2598     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2599 
2600     len = m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length};
2601     type = \hyperlink{_messenger_8c_a43f7448cfa20d85c9b793cbde6715ffc}{MESSENGER\_STATE\_TYPE\_STATUSMESSAGE};
2602     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len, type);
2603     memcpy(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, m->\hyperlink{struct_messenger_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, len);
2604     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2605 
2606     len = 1;
2607     type = \hyperlink{_messenger_8c_a51d08227e8515e67d7969289cd18f4cd}{MESSENGER\_STATE\_TYPE\_STATUS};
2608     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len, type);
2609     *\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = m->\hyperlink{struct_messenger_adde524f5a15465585cbc2543cd0b2710}{userstatus};
2610     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2611 
2612     len = \hyperlink{_d_h_t_8c_a55d92a2419bf9384e3cbfe0ec5a8f4d6}{DHT\_size}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
2613     type = \hyperlink{_messenger_8c_ae6c05fc174cd87a755972ef8f7679981}{MESSENGER\_STATE\_TYPE\_DHT};
2614     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len, type);
2615     \hyperlink{_d_h_t_8c_a7510a9fdbacfffb5987590c4e193c40a}{DHT\_save}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data});
2616     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2617 
2618     \hyperlink{struct_node__format}{Node\_format} relays[\hyperlink{_messenger_8h_a7b9306b33798fe1ba98b6f04de976866}{NUM\_SAVED\_TCP\_RELAYS}];
2619     type = \hyperlink{_messenger_8c_a64f45a4a72c35453d48355edcc2fdea7}{MESSENGER\_STATE\_TYPE\_TCP\_RELAY};
2620     uint8\_t *temp\_data = \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data};
2621     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(temp\_data, 0, type);
2622     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} = \hyperlink{net__crypto_8c_ac398e442ae77ace2af0156b9ce7f604c}{copy\_connected\_tcp\_relays}(m->
      \hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, relays, \hyperlink{_messenger_8h_a7b9306b33798fe1ba98b6f04de976866}{NUM\_SAVED\_TCP\_RELAYS});
2623     \textcolor{keywordtype}{int} l = \hyperlink{_d_h_t_8c_a1d6f2fcb008c989f333ae89e840f94b4}{pack\_nodes}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, \hyperlink{_messenger_8h_a7b9306b33798fe1ba98b6f04de976866}{NUM\_SAVED\_TCP\_RELAYS} * 
      \hyperlink{_d_h_t_8c_aa980937ac320a4389b726e04da26cb44}{packed\_node\_size}(\hyperlink{network_8h_a7cd884776d628ca50049592d963c10cc}{TCP\_INET6}), relays, num);
2624 
2625     \textcolor{keywordflow}{if} (l > 0) \{
2626         len = l;
2627         \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(temp\_data, len, type);
2628         \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2629     \}
2630 
2631     \hyperlink{struct_node__format}{Node\_format} nodes[\hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{NUM\_SAVED\_PATH\_NODES}];
2632     type = \hyperlink{_messenger_8c_ac7f0d1335af95f7bd8fae885c1bfcfc9}{MESSENGER\_STATE\_TYPE\_PATH\_NODE};
2633     temp\_data = \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data};
2634     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, 0, type);
2635     memset(nodes, 0, \textcolor{keyword}{sizeof}(nodes));
2636     num = \hyperlink{onion__client_8c_ad93584ad916d224037dd7a6e5caeebcf}{onion\_backup\_nodes}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, nodes, 
      \hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{NUM\_SAVED\_PATH\_NODES});
2637     l = \hyperlink{_d_h_t_8c_a1d6f2fcb008c989f333ae89e840f94b4}{pack\_nodes}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, \hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{NUM\_SAVED\_PATH\_NODES} * 
      \hyperlink{_d_h_t_8c_aa980937ac320a4389b726e04da26cb44}{packed\_node\_size}(\hyperlink{network_8h_a7cd884776d628ca50049592d963c10cc}{TCP\_INET6}), nodes, num);
2638 
2639     \textcolor{keywordflow}{if} (l > 0) \{
2640         len = l;
2641         \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} = \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(temp\_data, len, type);
2642         \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += len;
2643     \}
2644 
2645     \hyperlink{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{z\_state\_save\_subheader}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, 0, 
      \hyperlink{_messenger_8c_ad1aedc06debd945aca3bd7cb5b6dd46f}{MESSENGER\_STATE\_TYPE\_END});
2646 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af0dfac679b1b57a0036f6511e12fe777_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af0dfac679b1b57a0036f6511e12fe777_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a4ae119dad636f15f1a5d628a13b107d8}{\index{Messenger.\+c@{Messenger.\+c}!messenger\+\_\+size@{messenger\+\_\+size}}
\index{messenger\+\_\+size@{messenger\+\_\+size}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{messenger\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t messenger\+\_\+size (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a4ae119dad636f15f1a5d628a13b107d8}


Definition at line 2540 of file Messenger.\+c.



References Messenger\+::dht, D\+H\+T\+\_\+size(), Messenger\+::name\+\_\+length, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+P\+A\+T\+H\+\_\+\+N\+O\+D\+E\+S, N\+U\+M\+\_\+\+S\+A\+V\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S, packed\+\_\+node\+\_\+size(), saved\+\_\+friendslist\+\_\+size(), Messenger\+::statusmessage\+\_\+length, and T\+C\+P\+\_\+\+I\+N\+E\+T6.



Referenced by main(), messenger\+\_\+save(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+get\+\_\+savedata\+\_\+size().


\begin{DoxyCode}
2541 \{
2542     uint32\_t size32 = \textcolor{keyword}{sizeof}(uint32\_t), sizesubhead = size32 * 2;
2543     \textcolor{keywordflow}{return}   size32 * 2                                      \textcolor{comment}{// global cookie}
2544              + sizesubhead + \textcolor{keyword}{sizeof}(uint32\_t) + crypto\_box\_PUBLICKEYBYTES + crypto\_box\_SECRETKEYBYTES
2545              + sizesubhead + \hyperlink{_d_h_t_8c_a55d92a2419bf9384e3cbfe0ec5a8f4d6}{DHT\_size}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht})                  \textcolor{comment}{// DHT}
2546              + sizesubhead + \hyperlink{_messenger_8c_ad436fa7850d7bf55222df42ff527c375}{saved\_friendslist\_size}(m)         \textcolor{comment}{// Friendlist itself.}
2547              + sizesubhead + m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length}                    \textcolor{comment}{// Own nickname.}
2548              + sizesubhead + m->\hyperlink{struct_messenger_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length}           \textcolor{comment}{// status message}
2549              + sizesubhead + 1                                 \textcolor{comment}{// status}
2550              + sizesubhead + \hyperlink{_messenger_8h_a7b9306b33798fe1ba98b6f04de976866}{NUM\_SAVED\_TCP\_RELAYS} * 
      \hyperlink{_d_h_t_8c_aa980937ac320a4389b726e04da26cb44}{packed\_node\_size}(\hyperlink{network_8h_a7cd884776d628ca50049592d963c10cc}{TCP\_INET6}) \textcolor{comment}{//TCP relays}
2551              + sizesubhead + \hyperlink{_messenger_8c_acb84bd11c63cb33a58fb5c7f007b3eff}{NUM\_SAVED\_PATH\_NODES} * 
      \hyperlink{_d_h_t_8c_aa980937ac320a4389b726e04da26cb44}{packed\_node\_size}(\hyperlink{network_8h_a7cd884776d628ca50049592d963c10cc}{TCP\_INET6}) \textcolor{comment}{//saved path nodes}
2552              + sizesubhead;
2553 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4ae119dad636f15f1a5d628a13b107d8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a4ae119dad636f15f1a5d628a13b107d8_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a9390d980f0320f6c53c932c7244fa504}{\index{Messenger.\+c@{Messenger.\+c}!new\+\_\+filesender@{new\+\_\+filesender}}
\index{new\+\_\+filesender@{new\+\_\+filesender}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{new\+\_\+filesender}]{\setlength{\rightskip}{0pt plus 5cm}long int new\+\_\+filesender (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint32\+\_\+t}]{file\+\_\+type, }
\item[{uint64\+\_\+t}]{filesize, }
\item[{const uint8\+\_\+t $\ast$}]{file\+\_\+id, }
\item[{const uint8\+\_\+t $\ast$}]{filename, }
\item[{uint16\+\_\+t}]{filename\+\_\+length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a9390d980f0320f6c53c932c7244fa504}


Definition at line 1070 of file Messenger.\+c.



References F\+I\+L\+E\+\_\+\+I\+D\+\_\+\+L\+E\+N\+G\+T\+H, F\+I\+L\+E\+\_\+\+P\+A\+U\+S\+E\+\_\+\+N\+O\+T, Friend\+::file\+\_\+sending, file\+\_\+sendrequest(), F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, F\+I\+L\+E\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+T\+\_\+\+A\+C\+C\+E\+P\+T\+E\+D, friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, i, File\+\_\+\+Transfers\+::id, M\+A\+X\+\_\+\+C\+O\+N\+C\+U\+R\+R\+E\+N\+T\+\_\+\+F\+I\+L\+E\+\_\+\+P\+I\+P\+E\+S, M\+A\+X\+\_\+\+F\+I\+L\+E\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, Friend\+::num\+\_\+sending\+\_\+files, File\+\_\+\+Transfers\+::paused, File\+\_\+\+Transfers\+::requested, File\+\_\+\+Transfers\+::size, File\+\_\+\+Transfers\+::slots\+\_\+allocated, File\+\_\+\+Transfers\+::status, and File\+\_\+\+Transfers\+::transferred.



Referenced by tox\+\_\+file\+\_\+send().


\begin{DoxyCode}
1072 \{
1073     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1074         \textcolor{keywordflow}{return} -1;
1075 
1076     \textcolor{keywordflow}{if} (filename\_length > \hyperlink{_messenger_8c_a6773b93f3093658c3dcb569de3b4bdb2}{MAX\_FILENAME\_LENGTH})
1077         \textcolor{keywordflow}{return} -2;
1078 
1079     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1080 
1081     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_messenger_8h_a5e5c08c689138cd56d6c1a16d3eea793}{MAX\_CONCURRENT\_FILE\_PIPES}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1082         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[i].
      \hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1e2478ff0d28507c8e71c6e8d1c7b3fc}{FILESTATUS\_NONE})
1083             \textcolor{keywordflow}{break};
1084     \}
1085 
1086     \textcolor{keywordflow}{if} (i == MAX\_CONCURRENT\_FILE\_PIPES)
1087         \textcolor{keywordflow}{return} -3;
1088 
1089     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_af0e440a0c993bf8a9adbf85b37753337}{file\_sendrequest}(m, friendnumber, i, file\_type, filesize, file\_id, filename, 
      filename\_length) == 0)
1090         \textcolor{keywordflow}{return} -4;
1091 
1092     \textcolor{keyword}{struct }\hyperlink{struct_file___transfers}{File\_Transfers} *ft = &m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_a51d0849a59878ad9e4b67123a1c87037}{file\_sending}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}];
1093     ft->\hyperlink{struct_file___transfers_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_messenger_8h_aaf105ae5beaca1dee30ae54530691fcea1c5e323395e3d4810670c26aac40a0fd}{FILESTATUS\_NOT\_ACCEPTED};
1094     ft->\hyperlink{struct_file___transfers_af931a8871310b4dad23f0f0b0f623560}{size} = filesize;
1095     ft->\hyperlink{struct_file___transfers_ae0a9ddd27f7c6669cb964f6245b2550d}{transferred} = 0;
1096     ft->\hyperlink{struct_file___transfers_a23cc26eca74ddec84f975c0be5496457}{requested} = 0;
1097     ft->\hyperlink{struct_file___transfers_ae5c1661a0e1ed999ed054d837989556b}{slots\_allocated} = 0;
1098     ft->\hyperlink{struct_file___transfers_a84bd3ab7c2cbad7fb0b6233504515973}{paused} = \hyperlink{_messenger_8h_a80155586fa275b28773c9b203f52cabaabdbd52b891cdbc93735f408af784cac8}{FILE\_PAUSE\_NOT};
1099     memcpy(ft->\hyperlink{struct_file___transfers_aa32dbb3439461c6ccc1a52ff15bcb22e}{id}, file\_id, \hyperlink{_messenger_8h_a2f1a1efe7944eb3e268659d28b5db7d3}{FILE\_ID\_LENGTH});
1100 
1101     ++m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ac4dcaccdfc6f354a321622e84b27b856}{num\_sending\_files};
1102 
1103     \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1104 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a9390d980f0320f6c53c932c7244fa504_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a9390d980f0320f6c53c932c7244fa504_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_af015ea2e74c58196e0564719a6c6a112}{\index{Messenger.\+c@{Messenger.\+c}!new\+\_\+messenger@{new\+\_\+messenger}}
\index{new\+\_\+messenger@{new\+\_\+messenger}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{new\+\_\+messenger}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Messenger}$\ast$ new\+\_\+messenger (
\begin{DoxyParamCaption}
\item[{{\bf Messenger\+\_\+\+Options} $\ast$}]{options, }
\item[{unsigned int $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_af015ea2e74c58196e0564719a6c6a112}


Definition at line 1751 of file Messenger.\+c.



References Messenger\+::dht, Messenger\+::fr, Messenger\+::fr\+\_\+c, friend\+\_\+already\+\_\+added(), friendreq\+\_\+init(), ip, ip\+\_\+init(), Messenger\+\_\+\+Options\+::ipv6enabled, kill\+\_\+\+D\+H\+T(), kill\+\_\+friend\+\_\+connections(), kill\+\_\+net\+\_\+crypto(), kill\+\_\+networking(), kill\+\_\+onion(), kill\+\_\+onion\+\_\+announce(), kill\+\_\+onion\+\_\+client(), m, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+E\+R\+R\+O\+R\+\_\+\+N\+O\+N\+E, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+E\+R\+R\+O\+R\+\_\+\+O\+T\+H\+E\+R, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+E\+R\+R\+O\+R\+\_\+\+P\+O\+R\+T, M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+E\+R\+R\+O\+R\+\_\+\+T\+C\+P\+\_\+\+S\+E\+R\+V\+E\+R, Messenger\+::net, Messenger\+::net\+\_\+crypto, new\+\_\+\+D\+H\+T(), new\+\_\+friend\+\_\+connections(), new\+\_\+net\+\_\+crypto(), new\+\_\+networking\+\_\+ex(), new\+\_\+onion(), new\+\_\+onion\+\_\+announce(), new\+\_\+onion\+\_\+client(), new\+\_\+\+T\+C\+P\+\_\+server(), Messenger\+::onion, Messenger\+::onion\+\_\+a, Messenger\+::onion\+\_\+c, Messenger\+::options, Messenger\+\_\+\+Options\+::port\+\_\+range, Messenger\+\_\+\+Options\+::proxy\+\_\+info, random\+\_\+int(), D\+H\+T\+::self\+\_\+secret\+\_\+key, set\+\_\+filter\+\_\+function(), set\+\_\+nospam(), Messenger\+::tcp\+\_\+server, Messenger\+\_\+\+Options\+::tcp\+\_\+server\+\_\+port, and Messenger\+\_\+\+Options\+::udp\+\_\+disabled.



Referenced by main(), and tox\+\_\+new().


\begin{DoxyCode}
1752 \{
1753     \hyperlink{struct_messenger}{Messenger} *\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = calloc(1, \textcolor{keyword}{sizeof}(\hyperlink{struct_messenger}{Messenger}));
1754 
1755     \textcolor{keywordflow}{if} (\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error})
1756         *\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error} = \hyperlink{_messenger_8h_adb49720dc49f7d4e4cf9adbf2948e409a93747dcc33e251f799912c5e9c229d22}{MESSENGER\_ERROR\_OTHER};
1757 
1758     \textcolor{keywordflow}{if} ( ! m )
1759         \textcolor{keywordflow}{return} NULL;
1760 
1761     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} net\_err = 0;
1762 
1763     \textcolor{keywordflow}{if} (options->\hyperlink{struct_messenger___options_a1510f9751065ec1a6d485c4b3072b9d7}{udp\_disabled}) \{
1764         \textcolor{comment}{/* this is the easiest way to completely disable UDP without changing too much code. */}
1765         m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net} = calloc(1, \textcolor{keyword}{sizeof}(\hyperlink{struct_networking___core}{Networking\_Core}));
1766     \} \textcolor{keywordflow}{else} \{
1767         \hyperlink{struct_i_p}{IP} \hyperlink{irc__syncbot_8c_ae81515e082f9bc33e8968181945586da}{ip};
1768         \hyperlink{network_8c_a6aa0dce9c25e370af93bf4a14f79c709}{ip\_init}(&ip, options->\hyperlink{struct_messenger___options_abf85a84f394474115b9f45f037ad3378}{ipv6enabled});
1769         m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net} = \hyperlink{network_8c_a899cb8f62b49e71ba9f9f7a50254655c}{new\_networking\_ex}(ip, options->\hyperlink{struct_messenger___options_a6a840950904ae4d13e6726cf5f341fc0}{port\_range}[0], options->
      \hyperlink{struct_messenger___options_a6a840950904ae4d13e6726cf5f341fc0}{port\_range}[1], &net\_err);
1770     \}
1771 
1772     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net} == NULL) \{
1773         free(m);
1774 
1775         \textcolor{keywordflow}{if} (\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error} && net\_err == 1) \{
1776             *\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error} = \hyperlink{_messenger_8h_adb49720dc49f7d4e4cf9adbf2948e409aaf50a4ddc0b883aa1d70bab03f72bbbb}{MESSENGER\_ERROR\_PORT};
1777         \}
1778 
1779         \textcolor{keywordflow}{return} NULL;
1780     \}
1781 
1782     m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht} = \hyperlink{_d_h_t_8c_adad04fa897751b06948a172044bf1c58}{new\_DHT}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
1783 
1784     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht} == NULL) \{
1785         \hyperlink{network_8c_a8a36a1ed29a0d5dfe1f0095823039627}{kill\_networking}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
1786         free(m);
1787         \textcolor{keywordflow}{return} NULL;
1788     \}
1789 
1790     m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto} = \hyperlink{net__crypto_8c_a5e46c6f42e93e2aa968f8f63de90a53c}{new\_net\_crypto}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}, &options->
      \hyperlink{struct_messenger___options_aa737023350cf47e63993e3b4dc9a7472}{proxy\_info});
1791 
1792     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto} == NULL) \{
1793         \hyperlink{network_8c_a8a36a1ed29a0d5dfe1f0095823039627}{kill\_networking}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
1794         \hyperlink{_d_h_t_8c_a816851e4f0f454c52b93d65544a2b2bb}{kill\_DHT}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
1795         free(m);
1796         \textcolor{keywordflow}{return} NULL;
1797     \}
1798 
1799     m->\hyperlink{struct_messenger_a66fb4bf67c711a5ed3e7bbecec7fde30}{onion} = \hyperlink{onion_8c_a71877ec5931feec418ed1ae10b0963d8}{new\_onion}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
1800     m->\hyperlink{struct_messenger_a3a345721fb6be385f4b4519679a4609f}{onion\_a} = \hyperlink{onion__announce_8c_a1807a1d99b93e29c2a27648afe3e6c2c}{new\_onion\_announce}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
1801     m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c} =  \hyperlink{onion__client_8c_a9a6ae3a9c70a5221a65bd1c9be751a2e}{new\_onion\_client}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto});
1802     m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c} = \hyperlink{friend__connection_8c_a319bec2419cf5fc5525af4fae03b86ef}{new\_friend\_connections}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c});
1803 
1804     \textcolor{keywordflow}{if} (!(m->\hyperlink{struct_messenger_a66fb4bf67c711a5ed3e7bbecec7fde30}{onion} && m->\hyperlink{struct_messenger_a3a345721fb6be385f4b4519679a4609f}{onion\_a} && m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c})) \{
1805         \hyperlink{friend__connection_8c_a2ef8cdbd93f21f11ff0333a9527c2c02}{kill\_friend\_connections}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c});
1806         \hyperlink{onion_8c_a301c5cb9db2604dc1ea885c3a2cf8408}{kill\_onion}(m->\hyperlink{struct_messenger_a66fb4bf67c711a5ed3e7bbecec7fde30}{onion});
1807         \hyperlink{onion__announce_8c_ad21ecb14ae7a2a0d11a1d0523a459146}{kill\_onion\_announce}(m->\hyperlink{struct_messenger_a3a345721fb6be385f4b4519679a4609f}{onion\_a});
1808         \hyperlink{onion__client_8c_a591041f85e43cf886ab4c72fb3b8d468}{kill\_onion\_client}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c});
1809         \hyperlink{net__crypto_8c_abb3546495adde3f08c0474f31c5d3a37}{kill\_net\_crypto}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto});
1810         \hyperlink{_d_h_t_8c_a816851e4f0f454c52b93d65544a2b2bb}{kill\_DHT}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
1811         \hyperlink{network_8c_a8a36a1ed29a0d5dfe1f0095823039627}{kill\_networking}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
1812         free(m);
1813         \textcolor{keywordflow}{return} NULL;
1814     \}
1815 
1816     \textcolor{keywordflow}{if} (options->\hyperlink{struct_messenger___options_a9f404f426cc09060b42b9a61523cc573}{tcp\_server\_port}) \{
1817         m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server} = \hyperlink{_t_c_p__server_8c_a148e632f4c51645cbc1b414bc3584b60}{new\_TCP\_server}(options->
      \hyperlink{struct_messenger___options_abf85a84f394474115b9f45f037ad3378}{ipv6enabled}, 1, &options->\hyperlink{struct_messenger___options_a9f404f426cc09060b42b9a61523cc573}{tcp\_server\_port}, m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht}->
      \hyperlink{struct_d_h_t_aa05050f86513ff53fe9da81f73c72267}{self\_secret\_key}, m->\hyperlink{struct_messenger_a66fb4bf67c711a5ed3e7bbecec7fde30}{onion});
1818 
1819         \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_afc53e878009e340983270593e62cadef}{tcp\_server} == NULL) \{
1820             \hyperlink{friend__connection_8c_a2ef8cdbd93f21f11ff0333a9527c2c02}{kill\_friend\_connections}(m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c});
1821             \hyperlink{onion_8c_a301c5cb9db2604dc1ea885c3a2cf8408}{kill\_onion}(m->\hyperlink{struct_messenger_a66fb4bf67c711a5ed3e7bbecec7fde30}{onion});
1822             \hyperlink{onion__announce_8c_ad21ecb14ae7a2a0d11a1d0523a459146}{kill\_onion\_announce}(m->\hyperlink{struct_messenger_a3a345721fb6be385f4b4519679a4609f}{onion\_a});
1823             \hyperlink{onion__client_8c_a591041f85e43cf886ab4c72fb3b8d468}{kill\_onion\_client}(m->\hyperlink{struct_messenger_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c});
1824             \hyperlink{net__crypto_8c_abb3546495adde3f08c0474f31c5d3a37}{kill\_net\_crypto}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto});
1825             \hyperlink{_d_h_t_8c_a816851e4f0f454c52b93d65544a2b2bb}{kill\_DHT}(m->\hyperlink{struct_messenger_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
1826             \hyperlink{network_8c_a8a36a1ed29a0d5dfe1f0095823039627}{kill\_networking}(m->\hyperlink{struct_messenger_aa14ea2f67950f57fe4235d7375a2216c}{net});
1827             free(m);
1828 
1829             \textcolor{keywordflow}{if} (\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error})
1830                 *\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error} = \hyperlink{_messenger_8h_adb49720dc49f7d4e4cf9adbf2948e409ae2e9ed6eca4581ab57b2e8245b22cdb2}{MESSENGER\_ERROR\_TCP\_SERVER};
1831 
1832             \textcolor{keywordflow}{return} NULL;
1833         \}
1834     \}
1835 
1836     m->\hyperlink{struct_messenger_a180dba994d1fff627e19da4179148669}{options} = *options;
1837     \hyperlink{friend__requests_8c_a1996f1d1e0e18f0d7cd2d2ca218da012}{friendreq\_init}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}), m->\hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c});
1838     \hyperlink{friend__requests_8c_a8c1b80998bba387611ca16715462abaa}{set\_nospam}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}), \hyperlink{crypto__core_8c_a5f13cbe4c46d8801e2c7467068f87306}{random\_int}());
1839     \hyperlink{friend__requests_8c_aa0d865ddeb54ef314b86d7b561ef8e8d}{set\_filter\_function}(&(m->\hyperlink{struct_messenger_ae46787dbb8f8dce47f8fdc6192cf788d}{fr}), &\hyperlink{_messenger_8c_a7e298e314b0ad2a4e789728379ceeab2}{friend\_already\_added}, m);
1840 
1841     \textcolor{keywordflow}{if} (\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error})
1842         *\hyperlink{msi_8c_a7251f9a01631fc788dd7c8eff23a422ead606e435413ea0944dd00d49e901e4ed}{error} = \hyperlink{_messenger_8h_adb49720dc49f7d4e4cf9adbf2948e409a3fe14ccf7eeae3d56efc7f0d934152ec}{MESSENGER\_ERROR\_NONE};
1843 
1844     \textcolor{keywordflow}{return} \hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m};
1845 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d8/d8d/_messenger_8c_af015ea2e74c58196e0564719a6c6a112_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af015ea2e74c58196e0564719a6c6a112_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ade10ae2516f68845c8b2e0c5eb95bd41}{\index{Messenger.\+c@{Messenger.\+c}!realloc\+\_\+friendlist@{realloc\+\_\+friendlist}}
\index{realloc\+\_\+friendlist@{realloc\+\_\+friendlist}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{realloc\+\_\+friendlist}]{\setlength{\rightskip}{0pt plus 5cm}int realloc\+\_\+friendlist (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{uint32\+\_\+t}]{num}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_ade10ae2516f68845c8b2e0c5eb95bd41}


Definition at line 59 of file Messenger.\+c.



References Messenger\+::friendlist.



Referenced by init\+\_\+new\+\_\+friend(), and m\+\_\+delfriend().


\begin{DoxyCode}
60 \{
61     \textcolor{keywordflow}{if} (\hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} == 0) \{
62         free(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist});
63         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist} = NULL;
64         \textcolor{keywordflow}{return} 0;
65     \}
66 
67     \hyperlink{struct_friend}{Friend} *newfriendlist = realloc(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}, \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} * \textcolor{keyword}{sizeof}(
      \hyperlink{struct_friend}{Friend}));
68 
69     \textcolor{keywordflow}{if} (newfriendlist == NULL)
70         \textcolor{keywordflow}{return} -1;
71 
72     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist} = newfriendlist;
73     \textcolor{keywordflow}{return} 0;
74 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ade10ae2516f68845c8b2e0c5eb95bd41_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ad436fa7850d7bf55222df42ff527c375}{\index{Messenger.\+c@{Messenger.\+c}!saved\+\_\+friendslist\+\_\+size@{saved\+\_\+friendslist\+\_\+size}}
\index{saved\+\_\+friendslist\+\_\+size@{saved\+\_\+friendslist\+\_\+size}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{saved\+\_\+friendslist\+\_\+size}]{\setlength{\rightskip}{0pt plus 5cm}static uint32\+\_\+t saved\+\_\+friendslist\+\_\+size (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_ad436fa7850d7bf55222df42ff527c375}


Definition at line 2452 of file Messenger.\+c.



References count\+\_\+friendlist().



Referenced by messenger\+\_\+save(), and messenger\+\_\+size().


\begin{DoxyCode}
2453 \{
2454     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_ab3db39cd14385440de61a378e25f03f1}{count\_friendlist}(m) * \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d}{SAVED\_FRIEND});
2455 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{d8/d8d/_messenger_8c_ad436fa7850d7bf55222df42ff527c375_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ad436fa7850d7bf55222df42ff527c375_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a14ab15b529cd99d1f87ecf21c75456e1}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+custom\+\_\+lossless\+\_\+packet@{send\+\_\+custom\+\_\+lossless\+\_\+packet}}
\index{send\+\_\+custom\+\_\+lossless\+\_\+packet@{send\+\_\+custom\+\_\+lossless\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+custom\+\_\+lossless\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int send\+\_\+custom\+\_\+lossless\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a14ab15b529cd99d1f87ecf21c75456e1}


Definition at line 1714 of file Messenger.\+c.



References Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, Messenger\+::net\+\_\+crypto, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+L\+E\+S\+S\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+I\+Z\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+L\+E\+S\+S\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+T\+A\+R\+T, Friend\+::status, and write\+\_\+cryptpacket().



Referenced by tox\+\_\+friend\+\_\+send\+\_\+lossless\+\_\+packet().


\begin{DoxyCode}
1715 \{
1716     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1717         \textcolor{keywordflow}{return} -1;
1718 
1719     \textcolor{keywordflow}{if} (length == 0 || length > \hyperlink{net__crypto_8h_a1b6e5122f9fdc5ef548ccf920f0c246e}{MAX\_CRYPTO\_DATA\_SIZE})
1720         \textcolor{keywordflow}{return} -2;
1721 
1722     \textcolor{keywordflow}{if} (\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[0] < \hyperlink{_messenger_8h_ac297bd3de6eaa53acdcc0ede5892cee7}{PACKET\_ID\_LOSSLESS\_RANGE\_START})
1723         \textcolor{keywordflow}{return} -3;
1724 
1725     \textcolor{keywordflow}{if} (\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[0] >= (\hyperlink{_messenger_8h_ac297bd3de6eaa53acdcc0ede5892cee7}{PACKET\_ID\_LOSSLESS\_RANGE\_START} + 
      \hyperlink{_messenger_8h_ad9c466b6913d23d38622cbaf651b7fba}{PACKET\_ID\_LOSSLESS\_RANGE\_SIZE}))
1726         \textcolor{keywordflow}{return} -3;
1727 
1728     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
1729         \textcolor{keywordflow}{return} -4;
1730 
1731     \textcolor{keywordflow}{if} (\hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
1732                           m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), 
      \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length, 1) == -1) \{
1733         \textcolor{keywordflow}{return} -5;
1734     \} \textcolor{keywordflow}{else} \{
1735         \textcolor{keywordflow}{return} 0;
1736     \}
1737 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a14ab15b529cd99d1f87ecf21c75456e1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a14ab15b529cd99d1f87ecf21c75456e1_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2ebb5527b47fb87384093c4aa3c384c0}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+custom\+\_\+lossy\+\_\+packet@{send\+\_\+custom\+\_\+lossy\+\_\+packet}}
\index{send\+\_\+custom\+\_\+lossy\+\_\+packet@{send\+\_\+custom\+\_\+lossy\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+custom\+\_\+lossy\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int send\+\_\+custom\+\_\+lossy\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a2ebb5527b47fb87384093c4aa3c384c0}


Definition at line 1663 of file Messenger.\+c.



References Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, Messenger\+::net\+\_\+crypto, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+Y\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+I\+Z\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+L\+O\+S\+S\+Y\+\_\+\+R\+A\+N\+G\+E\+\_\+\+S\+T\+A\+R\+T, send\+\_\+lossy\+\_\+cryptpacket(), and Friend\+::status.



Referenced by rtp\+\_\+send\+\_\+msg(), and tox\+\_\+friend\+\_\+send\+\_\+lossy\+\_\+packet().


\begin{DoxyCode}
1664 \{
1665     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1666         \textcolor{keywordflow}{return} -1;
1667 
1668     \textcolor{keywordflow}{if} (length == 0 || length > \hyperlink{net__crypto_8h_a1b6e5122f9fdc5ef548ccf920f0c246e}{MAX\_CRYPTO\_DATA\_SIZE})
1669         \textcolor{keywordflow}{return} -2;
1670 
1671     \textcolor{keywordflow}{if} (\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[0] < \hyperlink{net__crypto_8h_a02481d2cc931289c2d5ee21d2a633316}{PACKET\_ID\_LOSSY\_RANGE\_START})
1672         \textcolor{keywordflow}{return} -3;
1673 
1674     \textcolor{keywordflow}{if} (\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[0] >= (\hyperlink{net__crypto_8h_a02481d2cc931289c2d5ee21d2a633316}{PACKET\_ID\_LOSSY\_RANGE\_START} + 
      \hyperlink{net__crypto_8h_a97668dde651012b4dffe599cd0df333b}{PACKET\_ID\_LOSSY\_RANGE\_SIZE}))
1675         \textcolor{keywordflow}{return} -3;
1676 
1677     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
1678         \textcolor{keywordflow}{return} -4;
1679 
1680     \textcolor{keywordflow}{if} (\hyperlink{net__crypto_8c_a7fcdf763c4a1b4b71e0de620b12f074c}{send\_lossy\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
1681                                m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length) == -1) \{
1682         \textcolor{keywordflow}{return} -5;
1683     \} \textcolor{keywordflow}{else} \{
1684         \textcolor{keywordflow}{return} 0;
1685     \}
1686 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2ebb5527b47fb87384093c4aa3c384c0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2ebb5527b47fb87384093c4aa3c384c0_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+file\+\_\+control\+\_\+packet@{send\+\_\+file\+\_\+control\+\_\+packet}}
\index{send\+\_\+file\+\_\+control\+\_\+packet@{send\+\_\+file\+\_\+control\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+file\+\_\+control\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int send\+\_\+file\+\_\+control\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{send\+\_\+receive, }
\item[{uint8\+\_\+t}]{filenumber, }
\item[{uint8\+\_\+t}]{control\+\_\+type, }
\item[{uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{data\+\_\+length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df}


Definition at line 1106 of file Messenger.\+c.



References M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+I\+L\+E\+\_\+\+C\+O\+N\+T\+R\+O\+L, and write\+\_\+cryptpacket\+\_\+id().



Referenced by file\+\_\+control(), file\+\_\+seek(), and handle\+\_\+filecontrol().


\begin{DoxyCode}
1108 \{
1109     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})(1 + 3 + data\_length) > \hyperlink{net__crypto_8h_a1b6e5122f9fdc5ef548ccf920f0c246e}{MAX\_CRYPTO\_DATA\_SIZE})
1110         \textcolor{keywordflow}{return} -1;
1111 
1112     uint8\_t packet[3 + data\_length];
1113 
1114     packet[0] = send\_receive;
1115     packet[1] = filenumber;
1116     packet[2] = control\_type;
1117 
1118     \textcolor{keywordflow}{if} (data\_length) \{
1119         memcpy(packet + 3, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, data\_length);
1120     \}
1121 
1122     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_ace1e961bc82c23e5ba065b4cd74da54a}{PACKET\_ID\_FILE\_CONTROL}, packet, \textcolor{keyword}{sizeof}(packet), 0);
1123 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a573ae5677a4dc9958bcec9bd3c9af6df_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2daa1e5d6fa9bc3c7c92d3cd46b11fb7}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+file\+\_\+data\+\_\+packet@{send\+\_\+file\+\_\+data\+\_\+packet}}
\index{send\+\_\+file\+\_\+data\+\_\+packet@{send\+\_\+file\+\_\+data\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+file\+\_\+data\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int64\+\_\+t send\+\_\+file\+\_\+data\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{filenumber, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a2daa1e5d6fa9bc3c7c92d3cd46b11fb7}


Definition at line 1287 of file Messenger.\+c.



References Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, Messenger\+::net\+\_\+crypto, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+I\+L\+E\+\_\+\+D\+A\+T\+A, and write\+\_\+cryptpacket().



Referenced by file\+\_\+data().


\begin{DoxyCode}
1289 \{
1290     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
1291         \textcolor{keywordflow}{return} -1;
1292 
1293     uint8\_t packet[2 + length];
1294     packet[0] = \hyperlink{_messenger_8h_a167c75e0bc70d1f8e96c4e9f553573fd}{PACKET\_ID\_FILE\_DATA};
1295     packet[1] = filenumber;
1296 
1297     \textcolor{keywordflow}{if} (length) \{
1298         memcpy(packet + 2, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
1299     \}
1300 
1301     \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
1302                              m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), packet, \textcolor{keyword}{
      sizeof}(packet), 1);
1303 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2daa1e5d6fa9bc3c7c92d3cd46b11fb7_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2daa1e5d6fa9bc3c7c92d3cd46b11fb7_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a64b0347daadcf7ef303ab013481b1eb2}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+group\+\_\+invite\+\_\+packet@{send\+\_\+group\+\_\+invite\+\_\+packet}}
\index{send\+\_\+group\+\_\+invite\+\_\+packet@{send\+\_\+group\+\_\+invite\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+group\+\_\+invite\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int send\+\_\+group\+\_\+invite\+\_\+packet (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a64b0347daadcf7ef303ab013481b1eb2}


Definition at line 930 of file Messenger.\+c.



References P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+I\+N\+V\+I\+T\+E\+\_\+\+G\+R\+O\+U\+P\+C\+H\+A\+T, and write\+\_\+cryptpacket\+\_\+id().



Referenced by invite\+\_\+friend(), and join\+\_\+groupchat().


\begin{DoxyCode}
931 \{
932     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_a74eb7ec4c6662276c2673fa0728062c0}{PACKET\_ID\_INVITE\_GROUPCHAT}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length, 0);
933 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a64b0347daadcf7ef303ab013481b1eb2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a64b0347daadcf7ef303ab013481b1eb2_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ab4bf3c92ac721d93b6c8a014cd6ddfea}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+offline\+\_\+packet@{send\+\_\+offline\+\_\+packet}}
\index{send\+\_\+offline\+\_\+packet@{send\+\_\+offline\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+offline\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int send\+\_\+offline\+\_\+packet (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int}]{friendcon\+\_\+id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_ab4bf3c92ac721d93b6c8a014cd6ddfea}


Definition at line 157 of file Messenger.\+c.



References Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), Messenger\+::net\+\_\+crypto, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+O\+F\+F\+L\+I\+N\+E, and write\+\_\+cryptpacket().



Referenced by m\+\_\+delfriend().


\begin{DoxyCode}
158 \{
159     uint8\_t packet = \hyperlink{_messenger_8h_a8b5392597c367f9c61bb1ef603276ab6}{PACKET\_ID\_OFFLINE};
160     \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c}, friendcon\_id), &packet,
161                              \textcolor{keyword}{sizeof}(packet), 0) != -1;
162 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ab4bf3c92ac721d93b6c8a014cd6ddfea_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ab4bf3c92ac721d93b6c8a014cd6ddfea_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+online\+\_\+packet@{send\+\_\+online\+\_\+packet}}
\index{send\+\_\+online\+\_\+packet@{send\+\_\+online\+\_\+packet}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+online\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}static int send\+\_\+online\+\_\+packet (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b}


Definition at line 147 of file Messenger.\+c.



References Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, Messenger\+::net\+\_\+crypto, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+O\+N\+L\+I\+N\+E, and write\+\_\+cryptpacket().



Referenced by handle\+\_\+packet(), handle\+\_\+status(), and init\+\_\+new\+\_\+friend().


\begin{DoxyCode}
148 \{
149     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
150         \textcolor{keywordflow}{return} 0;
151 
152     uint8\_t packet = \hyperlink{_messenger_8h_a0df7f46f5ef595ad83917f225fd222b0}{PACKET\_ID\_ONLINE};
153     \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
154                              m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), &packet, \textcolor{keyword}{
      sizeof}(packet), 0) != -1;
155 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a3bf115e8b97c037d1d40faa946905b3b_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a5ad1d3522f42e05278a777c9b5c70f66}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+statusmessage@{send\+\_\+statusmessage}}
\index{send\+\_\+statusmessage@{send\+\_\+statusmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+statusmessage}]{\setlength{\rightskip}{0pt plus 5cm}static int send\+\_\+statusmessage (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{status, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a5ad1d3522f42e05278a777c9b5c70f66}


Definition at line 723 of file Messenger.\+c.



References P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E, and write\+\_\+cryptpacket\+\_\+id().



Referenced by do\+\_\+friends().


\begin{DoxyCode}
724 \{
725     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_acf7096588409684fc93f1fe0aca9bbac}{PACKET\_ID\_STATUSMESSAGE}, \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status}, length, 0);
726 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5ad1d3522f42e05278a777c9b5c70f66_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a5ad1d3522f42e05278a777c9b5c70f66_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a9cc7b7b8bc1c2acd9b63bbcc64d570df}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+user\+\_\+istyping@{send\+\_\+user\+\_\+istyping}}
\index{send\+\_\+user\+\_\+istyping@{send\+\_\+user\+\_\+istyping}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+user\+\_\+istyping}]{\setlength{\rightskip}{0pt plus 5cm}static int send\+\_\+user\+\_\+istyping (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{is\+\_\+typing}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a9cc7b7b8bc1c2acd9b63bbcc64d570df}


Definition at line 733 of file Messenger.\+c.



References P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+T\+Y\+P\+I\+N\+G, and write\+\_\+cryptpacket\+\_\+id().



Referenced by do\+\_\+friends().


\begin{DoxyCode}
734 \{
735     uint8\_t typing = is\_typing;
736     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_a4aad3ced6e9fd2200962b1cbbfd625f9}{PACKET\_ID\_TYPING}, &typing, \textcolor{keyword}{sizeof}(typing), 0);
737 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a9cc7b7b8bc1c2acd9b63bbcc64d570df_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a9cc7b7b8bc1c2acd9b63bbcc64d570df_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_aa43271679d82439481418e3251f5db4a}{\index{Messenger.\+c@{Messenger.\+c}!send\+\_\+userstatus@{send\+\_\+userstatus}}
\index{send\+\_\+userstatus@{send\+\_\+userstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{send\+\_\+userstatus}]{\setlength{\rightskip}{0pt plus 5cm}static int send\+\_\+userstatus (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_aa43271679d82439481418e3251f5db4a}


Definition at line 728 of file Messenger.\+c.



References P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+U\+S\+E\+R\+S\+T\+A\+T\+U\+S, and write\+\_\+cryptpacket\+\_\+id().



Referenced by do\+\_\+friends().


\begin{DoxyCode}
729 \{
730     \textcolor{keywordflow}{return} \hyperlink{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{write\_cryptpacket\_id}(m, friendnumber, 
      \hyperlink{_messenger_8h_a85557f8710f545b0c73afaa32f09bf8c}{PACKET\_ID\_USERSTATUS}, &\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status}, \textcolor{keyword}{sizeof}(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status}), 0);
731 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aa43271679d82439481418e3251f5db4a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_aa43271679d82439481418e3251f5db4a_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a2e422bac86f120965227703f1930c8e6}{\index{Messenger.\+c@{Messenger.\+c}!set\+\_\+friend\+\_\+status@{set\+\_\+friend\+\_\+status}}
\index{set\+\_\+friend\+\_\+status@{set\+\_\+friend\+\_\+status}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{set\+\_\+friend\+\_\+status}]{\setlength{\rightskip}{0pt plus 5cm}void set\+\_\+friend\+\_\+status (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a2e422bac86f120965227703f1930c8e6}


Definition at line 887 of file Messenger.\+c.



References check\+\_\+friend\+\_\+connectionstatus(), Messenger\+::friendlist, and Friend\+::status.



Referenced by check\+\_\+friend\+\_\+request\+\_\+timed\+\_\+out(), do\+\_\+friends(), handle\+\_\+packet(), and handle\+\_\+status().


\begin{DoxyCode}
888 \{
889     \hyperlink{_messenger_8c_a961f02c4cb668e9932894d0f8969dbb1}{check\_friend\_connectionstatus}(m, friendnumber, 
      \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status});
890     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status};
891 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2e422bac86f120965227703f1930c8e6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a2e422bac86f120965227703f1930c8e6_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_ad317d62e3ddf9894af11093d30cae31b}{\index{Messenger.\+c@{Messenger.\+c}!set\+\_\+friend\+\_\+statusmessage@{set\+\_\+friend\+\_\+statusmessage}}
\index{set\+\_\+friend\+\_\+statusmessage@{set\+\_\+friend\+\_\+statusmessage}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{set\+\_\+friend\+\_\+statusmessage}]{\setlength{\rightskip}{0pt plus 5cm}static int set\+\_\+friend\+\_\+statusmessage (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{status, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_ad317d62e3ddf9894af11093d30cae31b}


Definition at line 739 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, M\+A\+X\+\_\+\+S\+T\+A\+T\+U\+S\+M\+E\+S\+S\+A\+G\+E\+\_\+\+L\+E\+N\+G\+T\+H, Friend\+::statusmessage, and Friend\+::statusmessage\+\_\+length.



Referenced by friends\+\_\+list\+\_\+load(), and handle\+\_\+packet().


\begin{DoxyCode}
740 \{
741     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
742         \textcolor{keywordflow}{return} -1;
743 
744     \textcolor{keywordflow}{if} (length > \hyperlink{_messenger_8h_a0d1a4b91dd43b4cb07dfefab7fc6bee1}{MAX\_STATUSMESSAGE\_LENGTH})
745         \textcolor{keywordflow}{return} -1;
746 
747     \textcolor{keywordflow}{if} (length)
748         memcpy(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a8f12612ac1191135a1a5b1cbcbc82852}{statusmessage}, 
      \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status}, length);
749 
750     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a43fe9dde52dc12e90933150eca91c0c3}{statusmessage\_length} = length;
751     \textcolor{keywordflow}{return} 0;
752 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{d8/d8d/_messenger_8c_ad317d62e3ddf9894af11093d30cae31b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_ad317d62e3ddf9894af11093d30cae31b_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_abed35de4c690ded50f67fdaf5e96324c}{\index{Messenger.\+c@{Messenger.\+c}!set\+\_\+friend\+\_\+typing@{set\+\_\+friend\+\_\+typing}}
\index{set\+\_\+friend\+\_\+typing@{set\+\_\+friend\+\_\+typing}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{set\+\_\+friend\+\_\+typing}]{\setlength{\rightskip}{0pt plus 5cm}static void set\+\_\+friend\+\_\+typing (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{is\+\_\+typing}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_abed35de4c690ded50f67fdaf5e96324c}


Definition at line 759 of file Messenger.\+c.



References Messenger\+::friendlist, and Friend\+::is\+\_\+typing.



Referenced by handle\+\_\+packet().


\begin{DoxyCode}
760 \{
761     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a4eb96aff01799d54246cc48854a47175}{is\_typing} = is\_typing;
762 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_abed35de4c690ded50f67fdaf5e96324c_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a57a114bf07876ef46d27c7cfee31137f}{\index{Messenger.\+c@{Messenger.\+c}!set\+\_\+friend\+\_\+userstatus@{set\+\_\+friend\+\_\+userstatus}}
\index{set\+\_\+friend\+\_\+userstatus@{set\+\_\+friend\+\_\+userstatus}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{set\+\_\+friend\+\_\+userstatus}]{\setlength{\rightskip}{0pt plus 5cm}static void set\+\_\+friend\+\_\+userstatus (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a57a114bf07876ef46d27c7cfee31137f}


Definition at line 754 of file Messenger.\+c.



References Messenger\+::friendlist, and Friend\+::userstatus.



Referenced by friends\+\_\+list\+\_\+load(), and handle\+\_\+packet().


\begin{DoxyCode}
755 \{
756     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_adde524f5a15465585cbc2543cd0b2710}{userstatus} = \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_ade818037fd6c985038ff29656089758d}{status};
757 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a57a114bf07876ef46d27c7cfee31137f_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a732b3e72ea8d98d4e038f7ed83fbe5be}{\index{Messenger.\+c@{Messenger.\+c}!setfriendname@{setfriendname}}
\index{setfriendname@{setfriendname}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{setfriendname}]{\setlength{\rightskip}{0pt plus 5cm}int setfriendname (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{const uint8\+\_\+t $\ast$}]{name, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a732b3e72ea8d98d4e038f7ed83fbe5be}


Definition at line 507 of file Messenger.\+c.



References friend\+\_\+not\+\_\+valid(), Messenger\+::friendlist, M\+A\+X\+\_\+\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, Friend\+::name, and Friend\+::name\+\_\+length.



Referenced by friends\+\_\+list\+\_\+load().


\begin{DoxyCode}
508 \{
509     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
510         \textcolor{keywordflow}{return} -1;
511 
512     \textcolor{keywordflow}{if} (length > \hyperlink{_messenger_8h_a0c397a708cec89c74029582574516b30}{MAX\_NAME\_LENGTH} || length == 0)
513         \textcolor{keywordflow}{return} -1;
514 
515     m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a3573d7a906b26e9999cd74f2c4066601}{name\_length} = length;
516     memcpy(m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_a11b8cc6595eea79e65c978209278e683}{name}, \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a11b8cc6595eea79e65c978209278e683}{name}, length);
517     \textcolor{keywordflow}{return} 0;
518 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=279pt]{d8/d8d/_messenger_8c_a732b3e72ea8d98d4e038f7ed83fbe5be_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a732b3e72ea8d98d4e038f7ed83fbe5be_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a74824e98cf3b2607cb8624d46cd2e227}{\index{Messenger.\+c@{Messenger.\+c}!setname@{setname}}
\index{setname@{setname}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{setname}]{\setlength{\rightskip}{0pt plus 5cm}int setname (
\begin{DoxyParamCaption}
\item[{{\bf Messenger} $\ast$}]{m, }
\item[{const uint8\+\_\+t $\ast$}]{name, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_messenger_8c_a74824e98cf3b2607cb8624d46cd2e227}


Definition at line 528 of file Messenger.\+c.



References Messenger\+::friendlist, i, M\+A\+X\+\_\+\+N\+A\+M\+E\+\_\+\+L\+E\+N\+G\+T\+H, Messenger\+::name, Messenger\+::name\+\_\+length, Friend\+::name\+\_\+sent, and Messenger\+::numfriends.



Referenced by main(), messenger\+\_\+load\+\_\+state\+\_\+callback(), messenger\+\_\+suite(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tox\+\_\+self\+\_\+set\+\_\+name().


\begin{DoxyCode}
529 \{
530     \textcolor{keywordflow}{if} (length > \hyperlink{_messenger_8h_a0c397a708cec89c74029582574516b30}{MAX\_NAME\_LENGTH})
531         \textcolor{keywordflow}{return} -1;
532 
533     \textcolor{keywordflow}{if} (m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length} == length && (length == 0 || memcmp(\hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a11b8cc6595eea79e65c978209278e683}{name}, m->
      \hyperlink{struct_messenger_a11b8cc6595eea79e65c978209278e683}{name}, length) == 0))
534         \textcolor{keywordflow}{return} 0;
535 
536     \textcolor{keywordflow}{if} (length)
537         memcpy(m->\hyperlink{struct_messenger_a11b8cc6595eea79e65c978209278e683}{name}, \hyperlink{struct_s_a_v_e_d___f_r_i_e_n_d_a11b8cc6595eea79e65c978209278e683}{name}, length);
538 
539     m->\hyperlink{struct_messenger_a3573d7a906b26e9999cd74f2c4066601}{name\_length} = length;
540     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
541 
542     \textcolor{keywordflow}{for} (i = 0; i < m->\hyperlink{struct_messenger_a476f4b36bd078632dd434e76df29d922}{numfriends}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i})
543         m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[i].\hyperlink{struct_friend_acc966be04e3e27e15dfd493c3e9cff89}{name\_sent} = 0;
544 
545     \textcolor{keywordflow}{return} 0;
546 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a74824e98cf3b2607cb8624d46cd2e227_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}{\index{Messenger.\+c@{Messenger.\+c}!write\+\_\+cryptpacket\+\_\+id@{write\+\_\+cryptpacket\+\_\+id}}
\index{write\+\_\+cryptpacket\+\_\+id@{write\+\_\+cryptpacket\+\_\+id}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{write\+\_\+cryptpacket\+\_\+id}]{\setlength{\rightskip}{0pt plus 5cm}static int write\+\_\+cryptpacket\+\_\+id (
\begin{DoxyParamCaption}
\item[{const {\bf Messenger} $\ast$}]{m, }
\item[{int32\+\_\+t}]{friendnumber, }
\item[{uint8\+\_\+t}]{packet\+\_\+id, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{length, }
\item[{uint8\+\_\+t}]{congestion\+\_\+control}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_af2b983c0aba45068c878e24e155f1ed2}


Definition at line 893 of file Messenger.\+c.



References Messenger\+::fr\+\_\+c, friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id(), friend\+\_\+not\+\_\+valid(), F\+R\+I\+E\+N\+D\+\_\+\+O\+N\+L\+I\+N\+E, Friend\+::friendcon\+\_\+id, Messenger\+::friendlist, M\+A\+X\+\_\+\+C\+R\+Y\+P\+T\+O\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, Messenger\+::net\+\_\+crypto, Friend\+::status, and write\+\_\+cryptpacket().



Referenced by file\+\_\+sendrequest(), m\+\_\+msi\+\_\+packet(), m\+\_\+sendname(), send\+\_\+file\+\_\+control\+\_\+packet(), send\+\_\+group\+\_\+invite\+\_\+packet(), send\+\_\+statusmessage(), send\+\_\+user\+\_\+istyping(), and send\+\_\+userstatus().


\begin{DoxyCode}
895 \{
896     \textcolor{keywordflow}{if} (\hyperlink{_messenger_8c_a36587bd583123730d702e5a4cb894e5f}{friend\_not\_valid}(m, friendnumber))
897         \textcolor{keywordflow}{return} 0;
898 
899     \textcolor{keywordflow}{if} (length >= \hyperlink{net__crypto_8h_a1b6e5122f9fdc5ef548ccf920f0c246e}{MAX\_CRYPTO\_DATA\_SIZE} || m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].
      \hyperlink{struct_friend_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_messenger_8h_a05589fbab0657f08285ebdfe93f5ec9ea203bccef891dbbf575e4c76373f0f19d}{FRIEND\_ONLINE})
900         \textcolor{keywordflow}{return} 0;
901 
902     uint8\_t packet[length + 1];
903     packet[0] = packet\_id;
904 
905     \textcolor{keywordflow}{if} (length != 0)
906         memcpy(packet + 1, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
907 
908     \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(m->\hyperlink{struct_messenger_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, 
      \hyperlink{friend__connection_8c_a8586e3dfb2047821c4214adf8d06a877}{friend\_connection\_crypt\_connection\_id}(m->
      \hyperlink{struct_messenger_ae26eb43a606fff20fe70209d051c40f9}{fr\_c},
909                              m->\hyperlink{struct_messenger_a42c185c16c5df7707ba4d70bb6ee75e7}{friendlist}[friendnumber].\hyperlink{struct_friend_aed1c0bb5aeba492059252d0084c8ae9b}{friendcon\_id}), packet, 
      length + 1, congestion\_control) != -1;
910 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af2b983c0aba45068c878e24e155f1ed2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_af2b983c0aba45068c878e24e155f1ed2_icgraph}
\end{center}
\end{figure}


\hypertarget{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}{\index{Messenger.\+c@{Messenger.\+c}!z\+\_\+state\+\_\+save\+\_\+subheader@{z\+\_\+state\+\_\+save\+\_\+subheader}}
\index{z\+\_\+state\+\_\+save\+\_\+subheader@{z\+\_\+state\+\_\+save\+\_\+subheader}!Messenger.\+c@{Messenger.\+c}}
\subsubsection[{z\+\_\+state\+\_\+save\+\_\+subheader}]{\setlength{\rightskip}{0pt plus 5cm}static uint8\+\_\+t$\ast$ z\+\_\+state\+\_\+save\+\_\+subheader (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{len, }
\item[{uint16\+\_\+t}]{type}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99}


Definition at line 2555 of file Messenger.\+c.



References make-\/funny-\/savefile\+::data, host\+\_\+to\+\_\+lendian32(), host\+\_\+tolendian16, and M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+S\+T\+A\+T\+E\+\_\+\+C\+O\+O\+K\+I\+E\+\_\+\+T\+Y\+P\+E.



Referenced by messenger\+\_\+save().


\begin{DoxyCode}
2556 \{
2557     \hyperlink{util_8c_aebd439a002cb183420a08996f7ffdbef}{host\_to\_lendian32}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, len);
2558     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += \textcolor{keyword}{sizeof}(uint32\_t);
2559     \hyperlink{util_8c_aebd439a002cb183420a08996f7ffdbef}{host\_to\_lendian32}(\hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, (\hyperlink{util_8h_afa26187eb0886240d742e14fc39ec70f}{host\_tolendian16}(
      \hyperlink{_messenger_8c_a2d38314cc90c702f4cde6cfd6f7760db}{MESSENGER\_STATE\_COOKIE\_TYPE}) << 16) | 
      \hyperlink{util_8h_afa26187eb0886240d742e14fc39ec70f}{host\_tolendian16}(type));
2560     \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data} += \textcolor{keyword}{sizeof}(uint32\_t);
2561     \textcolor{keywordflow}{return} \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data};
2562 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{d8/d8d/_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d8d/_messenger_8c_a910e4555ff14d9974e6f1dd227d8dd99_icgraph}
\end{center}
\end{figure}


