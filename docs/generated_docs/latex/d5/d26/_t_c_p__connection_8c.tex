\hypertarget{_t_c_p__connection_8c}{\section{toxcore/\+T\+C\+P\+\_\+connection.c File Reference}
\label{_t_c_p__connection_8c}\index{toxcore/\+T\+C\+P\+\_\+connection.\+c@{toxcore/\+T\+C\+P\+\_\+connection.\+c}}
}
{\ttfamily \#include \char`\"{}T\+C\+P\+\_\+connection.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}util.\+h\char`\"{}}\\*
Include dependency graph for T\+C\+P\+\_\+connection.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/daf/_t_c_p__connection_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}{realloc\+\_\+tox\+\_\+array}(array, element\+\_\+size, \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num}, temp\+\_\+pointer)~(\hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} ? (temp\+\_\+pointer = realloc(array, ((\hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num}) $\ast$ (element\+\_\+size))), temp\+\_\+pointer ? (array = temp\+\_\+pointer, 0) \+: (-\/1) ) \+: (free(array), array = N\+U\+L\+L, 0))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \+\_\+\+Bool \hyperlink{_t_c_p__connection_8c_aafa7b2a7f56b8f6bb0c1e44b9aec7262}{connections\+\_\+number\+\_\+not\+\_\+valid} (const \hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number)
\item 
static \+\_\+\+Bool \hyperlink{_t_c_p__connection_8c_ae8f5b59977d8d4221ff8da3922d257a5}{tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid} (const \hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a62b7fc88f48b373ae0b957244fe9db8e}{create\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\item 
static int \hyperlink{_t_c_p__connection_8c_a2cd69ef2e2153135f588193ef36acf3e}{create\+\_\+tcp\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\item 
static int \hyperlink{_t_c_p__connection_8c_a10a5b3ddc6f1bfa7785301f33c369695}{wipe\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_add1161d338a19eca0bb42f242b543036}{wipe\+\_\+tcp\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static \hyperlink{struct_t_c_p___connection__to}{T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$ \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\+\_\+connection} (const \hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number)
\item 
static \hyperlink{struct_t_c_p__con}{T\+C\+P\+\_\+con} $\ast$ \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\+\_\+tcp\+\_\+connection} (const \hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
int \hyperlink{_t_c_p__connection_8c_a455e955e01d34ff3db0b22b8f6d49d98}{send\+\_\+packet\+\_\+tcp\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number, const uint8\+\_\+t $\ast$packet, uint16\+\_\+t length)
\item 
int \hyperlink{_t_c_p__connection_8c_a84992bb55c148bb9f7a1b442d255865f}{get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\item 
int \hyperlink{_t_c_p__connection_8c_afb1a507e5f1af925b01666f1b9b4960a}{tcp\+\_\+send\+\_\+onion\+\_\+request} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, unsigned int tcp\+\_\+connections\+\_\+number, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
int \hyperlink{_t_c_p__connection_8c_a5effabd83d700cccf9bcc51174f041f1}{tcp\+\_\+send\+\_\+oob\+\_\+packet} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, unsigned int tcp\+\_\+connections\+\_\+number, const uint8\+\_\+t $\ast$public\+\_\+key, const uint8\+\_\+t $\ast$packet, uint16\+\_\+t length)
\item 
void \hyperlink{_t_c_p__connection_8c_afdea860d77b12c79ee24c3ade58d4ac6}{set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int($\ast$\hyperlink{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}{tcp\+\_\+data\+\_\+callback})(void $\ast$object, int id, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length), void $\ast$object)
\item 
void \hyperlink{_t_c_p__connection_8c_a13df5ebd6110288f192070b8c1c28328}{set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int($\ast$\hyperlink{_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed}{tcp\+\_\+oob\+\_\+callback})(void $\ast$object, const uint8\+\_\+t $\ast$public\+\_\+key, unsigned int tcp\+\_\+connections\+\_\+number, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length), void $\ast$object)
\item 
void \hyperlink{_t_c_p__connection_8c_a9c229dba32e28baa8cd90ae74429d803}{set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int($\ast$\hyperlink{_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9}{tcp\+\_\+onion\+\_\+callback})(void $\ast$object, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length), void $\ast$object)
\item 
static int \hyperlink{_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6}{find\+\_\+tcp\+\_\+connection\+\_\+to} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, const uint8\+\_\+t $\ast$public\+\_\+key)
\item 
static int \hyperlink{_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4}{find\+\_\+tcp\+\_\+connection\+\_\+relay} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, const uint8\+\_\+t $\ast$relay\+\_\+pk)
\item 
int \hyperlink{_t_c_p__connection_8c_a22c797c7e0ef3ad66e171f05b1cb52bd}{new\+\_\+tcp\+\_\+connection\+\_\+to} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, const uint8\+\_\+t $\ast$public\+\_\+key, int id)
\item 
int \hyperlink{_t_c_p__connection_8c_a2369688a49bef46cb2029b3bb680e11d}{kill\+\_\+tcp\+\_\+connection\+\_\+to} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number)
\item 
int \hyperlink{_t_c_p__connection_8c_a0c7079221df3e2f827e6ec1aaac597e6}{set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number, \+\_\+\+Bool status)
\item 
static \+\_\+\+Bool \hyperlink{_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096}{tcp\+\_\+connection\+\_\+in\+\_\+conn} (\hyperlink{struct_t_c_p___connection__to}{T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$con\+\_\+to, unsigned int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0}{add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn} (\hyperlink{struct_t_c_p___connection__to}{T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$con\+\_\+to, unsigned int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a8143d81d0cb65f668ecbd79884ef78e5}{rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn} (\hyperlink{struct_t_c_p___connection__to}{T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$con\+\_\+to, unsigned int tcp\+\_\+connections\+\_\+number)
\item 
static unsigned int \hyperlink{_t_c_p__connection_8c_a255916e82a74ad6c617216af786ec335}{online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn} (\hyperlink{struct_t_c_p___connection__to}{T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$con\+\_\+to)
\item 
static int \hyperlink{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{set\+\_\+tcp\+\_\+connection\+\_\+status} (\hyperlink{struct_t_c_p___connection__to}{T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$con\+\_\+to, unsigned int tcp\+\_\+connections\+\_\+number, unsigned int status, uint8\+\_\+t connection\+\_\+id)
\item 
static int \hyperlink{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}{kill\+\_\+tcp\+\_\+relay\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a81963b2aeca3eb88b3fea76869b19fad}{reconnect\+\_\+tcp\+\_\+relay\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_ac91d3707f1b16a4a9e0f6d4d70cdee14}{sleep\+\_\+tcp\+\_\+relay\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a359cec296ed123fc92b9b149266b30a4}{unsleep\+\_\+tcp\+\_\+relay\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432}{send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number, uint8\+\_\+t $\ast$public\+\_\+key)
\item 
static int \hyperlink{_t_c_p__connection_8c_aaba8f94fbd0f1a94198e3054b1d660b8}{tcp\+\_\+response\+\_\+callback} (void $\ast$object, uint8\+\_\+t connection\+\_\+id, const uint8\+\_\+t $\ast$public\+\_\+key)
\item 
static int \hyperlink{_t_c_p__connection_8c_aa6d25d98f798099f4a7dd86ab93763ce}{tcp\+\_\+status\+\_\+callback} (void $\ast$object, uint32\+\_\+t number, uint8\+\_\+t connection\+\_\+id, uint8\+\_\+t status)
\item 
static int \hyperlink{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}{tcp\+\_\+data\+\_\+callback} (void $\ast$object, uint32\+\_\+t number, uint8\+\_\+t connection\+\_\+id, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
static int \hyperlink{_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed}{tcp\+\_\+oob\+\_\+callback} (void $\ast$object, const uint8\+\_\+t $\ast$public\+\_\+key, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
static int \hyperlink{_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9}{tcp\+\_\+onion\+\_\+callback} (void $\ast$object, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
static int \hyperlink{_t_c_p__connection_8c_a0a27482d704ef5925a4434a0577c647f}{tcp\+\_\+relay\+\_\+set\+\_\+callbacks} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_a52486c51f2c9e789893e71611dc2a188}{tcp\+\_\+relay\+\_\+on\+\_\+online} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int tcp\+\_\+connections\+\_\+number)
\item 
static int \hyperlink{_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd}{add\+\_\+tcp\+\_\+relay\+\_\+instance} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, \hyperlink{struct_i_p___port}{I\+P\+\_\+\+Port} ip\+\_\+port, const uint8\+\_\+t $\ast$relay\+\_\+pk)
\item 
int \hyperlink{_t_c_p__connection_8c_a5ee1dbaa28ff59e0f452eda3c97418e3}{add\+\_\+tcp\+\_\+relay\+\_\+global} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, \hyperlink{struct_i_p___port}{I\+P\+\_\+\+Port} ip\+\_\+port, const uint8\+\_\+t $\ast$relay\+\_\+pk)
\item 
int \hyperlink{_t_c_p__connection_8c_af7a3111a46b9cb6947452393a2cbea31}{add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number, unsigned int tcp\+\_\+connections\+\_\+number)
\item 
int \hyperlink{_t_c_p__connection_8c_a26901882c0b134822660515493683132}{add\+\_\+tcp\+\_\+relay\+\_\+connection} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number, \hyperlink{struct_i_p___port}{I\+P\+\_\+\+Port} ip\+\_\+port, const uint8\+\_\+t $\ast$relay\+\_\+pk)
\item 
unsigned int \hyperlink{_t_c_p__connection_8c_ae843b0b4c8041f08bf9c18f68cae8a61}{tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, int connections\+\_\+number)
\item 
unsigned int \hyperlink{_t_c_p__connection_8c_ac2e62c717ccebd2379e32ca9b330812c}{tcp\+\_\+copy\+\_\+connected\+\_\+relays} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, \hyperlink{struct_node__format}{Node\+\_\+format} $\ast$tcp\+\_\+relays, uint16\+\_\+t max\+\_\+num)
\item 
int \hyperlink{_t_c_p__connection_8c_a4ee7de722248f32b3bfedb25bdb59994}{set\+\_\+tcp\+\_\+onion\+\_\+status} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c, \+\_\+\+Bool status)
\item 
\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$ \hyperlink{_t_c_p__connection_8c_a3526d187a2a8f91d672f0bde2dff4633}{new\+\_\+tcp\+\_\+connections} (const uint8\+\_\+t $\ast$secret\+\_\+key, \hyperlink{struct_t_c_p___proxy___info}{T\+C\+P\+\_\+\+Proxy\+\_\+\+Info} $\ast$proxy\+\_\+info)
\item 
static void \hyperlink{_t_c_p__connection_8c_a6377f0f3d60ba706c5b014a9439696b7}{do\+\_\+tcp\+\_\+conns} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\item 
static void \hyperlink{_t_c_p__connection_8c_a49dd47efa4f43cd5ba37a4836c6e55ff}{kill\+\_\+nonused\+\_\+tcp} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\item 
void \hyperlink{_t_c_p__connection_8c_a30c1a9c57a8d07cc2327c0505d6619a4}{do\+\_\+tcp\+\_\+connections} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\item 
void \hyperlink{_t_c_p__connection_8c_a6938788005ebe33a896755ac2b9f501a}{kill\+\_\+tcp\+\_\+connections} (\hyperlink{struct_t_c_p___connections}{T\+C\+P\+\_\+\+Connections} $\ast$tcp\+\_\+c)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!realloc\+\_\+tox\+\_\+array@{realloc\+\_\+tox\+\_\+array}}
\index{realloc\+\_\+tox\+\_\+array@{realloc\+\_\+tox\+\_\+array}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{realloc\+\_\+tox\+\_\+array}]{\setlength{\rightskip}{0pt plus 5cm}\#define realloc\+\_\+tox\+\_\+array(
\begin{DoxyParamCaption}
\item[{}]{array, }
\item[{}]{element\+\_\+size, }
\item[{}]{{\bf num}, }
\item[{}]{temp\+\_\+pointer}
\end{DoxyParamCaption}
)~({\bf num} ? (temp\+\_\+pointer = realloc(array, (({\bf num}) $\ast$ (element\+\_\+size))), temp\+\_\+pointer ? (array = temp\+\_\+pointer, 0) \+: (-\/1) ) \+: (free(array), array = N\+U\+L\+L, 0))}}\label{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}


Definition at line 36 of file T\+C\+P\+\_\+connection.\+c.



Referenced by create\+\_\+connection(), create\+\_\+tcp\+\_\+connection(), wipe\+\_\+connection(), and wipe\+\_\+tcp\+\_\+connection().



\subsection{Function Documentation}
\hypertarget{_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn@{add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn}}
\index{add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn@{add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn}]{\setlength{\rightskip}{0pt plus 5cm}static int add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$}]{con\+\_\+to, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0}


Definition at line 571 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connection\+\_\+to\+::connection\+\_\+id, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection, tcp\+\_\+connection\+\_\+in\+\_\+conn(), and T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E.



Referenced by add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection(), and add\+\_\+tcp\+\_\+relay\+\_\+connection().


\begin{DoxyCode}
572 \{
573     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
574 
575     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096}{tcp\_connection\_in\_conn}(con\_to, tcp\_connections\_number))
576         \textcolor{keywordflow}{return} -1;
577 
578     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
579         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} == 0) \{
580             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} = tcp\_connections\_number + 1;
581             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} = 
      \hyperlink{_t_c_p__connection_8h_affacad255b45e30644ec8d14158c9246}{TCP\_CONNECTIONS\_STATUS\_NONE};
582             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ababc90484b0c796e004410411e723f5e}{connection\_id} = 0;
583             \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
584         \}
585     \}
586 
587     \textcolor{keywordflow}{return} -1;
588 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{d5/d26/_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_af7a3111a46b9cb6947452393a2cbea31}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection@{add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection}}
\index{add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection@{add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}int add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_af7a3111a46b9cb6947452393a2cbea31}


Definition at line 1064 of file T\+C\+P\+\_\+connection.\+c.



References add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn(), T\+C\+P\+\_\+con\+::connected\+\_\+time, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), T\+C\+P\+\_\+\+Connection\+\_\+to\+::public\+\_\+key, send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request(), T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, unix\+\_\+time(), and T\+C\+P\+\_\+con\+::unsleep.



Referenced by add\+\_\+tcp\+\_\+relay\+\_\+connection(), and crypto\+\_\+connection\+\_\+add\+\_\+source().


\begin{DoxyCode}
1065 \{
1066     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
1067 
1068     \textcolor{keywordflow}{if} (!con\_to)
1069         \textcolor{keywordflow}{return} -1;
1070 
1071     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
1072 
1073     \textcolor{keywordflow}{if} (!tcp\_con)
1074         \textcolor{keywordflow}{return} -1;
1075 
1076     \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING} && tcp\_con->
      \hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
1077         tcp\_con->\hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep} = 1;
1078     \}
1079 
1080     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0}{add\_tcp\_connection\_to\_conn}(con\_to, tcp\_connections\_number) == -1)
1081         \textcolor{keywordflow}{return} -1;
1082 
1083     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
1084         \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432}{send\_tcp\_relay\_routing\_request}(tcp\_c, tcp\_connections\_number, 
      con\_to->\hyperlink{struct_t_c_p___connection__to_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}) == 0) \{
1085             tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time} = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
1086         \}
1087     \}
1088 
1089     \textcolor{keywordflow}{return} 0;
1090 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_af7a3111a46b9cb6947452393a2cbea31_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_af7a3111a46b9cb6947452393a2cbea31_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a26901882c0b134822660515493683132}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!add\+\_\+tcp\+\_\+relay\+\_\+connection@{add\+\_\+tcp\+\_\+relay\+\_\+connection}}
\index{add\+\_\+tcp\+\_\+relay\+\_\+connection@{add\+\_\+tcp\+\_\+relay\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{add\+\_\+tcp\+\_\+relay\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}int add\+\_\+tcp\+\_\+relay\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number, }
\item[{{\bf I\+P\+\_\+\+Port}}]{ip\+\_\+port, }
\item[{const uint8\+\_\+t $\ast$}]{relay\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a26901882c0b134822660515493683132}


Definition at line 1099 of file T\+C\+P\+\_\+connection.\+c.



References add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn(), add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection(), add\+\_\+tcp\+\_\+relay\+\_\+instance(), find\+\_\+tcp\+\_\+connection\+\_\+relay(), get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn(), and R\+E\+C\+O\+M\+M\+E\+N\+D\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S.



Referenced by add\+\_\+tcp\+\_\+relay\+\_\+peer(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
1100 \{
1101     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
1102 
1103     \textcolor{keywordflow}{if} (!con\_to)
1104         \textcolor{keywordflow}{return} -1;
1105 
1106     \textcolor{keywordtype}{int} tcp\_connections\_number = \hyperlink{_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4}{find\_tcp\_connection\_relay}(tcp\_c, relay\_pk);
1107 
1108     \textcolor{keywordflow}{if} (tcp\_connections\_number != -1) \{
1109         \textcolor{keywordflow}{return} \hyperlink{_t_c_p__connection_8c_af7a3111a46b9cb6947452393a2cbea31}{add\_tcp\_number\_relay\_connection}(tcp\_c, connections\_number, 
      tcp\_connections\_number);
1110     \} \textcolor{keywordflow}{else} \{
1111         \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a255916e82a74ad6c617216af786ec335}{online\_tcp\_connection\_from\_conn}(con\_to) >= 
      \hyperlink{_t_c_p__connection_8h_a56e5080b902e3fd06f9c0bfa74af34c5}{RECOMMENDED\_FRIEND\_TCP\_CONNECTIONS}) \{
1112             \textcolor{keywordflow}{return} -1;
1113         \}
1114 
1115         \textcolor{keywordtype}{int} tcp\_connections\_number = \hyperlink{_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd}{add\_tcp\_relay\_instance}(tcp\_c, ip\_port, relay\_pk)
      ;
1116 
1117         \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
1118 
1119         \textcolor{keywordflow}{if} (!tcp\_con)
1120             \textcolor{keywordflow}{return} -1;
1121 
1122         \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a00d2fc46939eaff0106abe890760bee0}{add\_tcp\_connection\_to\_conn}(con\_to, tcp\_connections\_number) == -1) \{
1123             \textcolor{keywordflow}{return} -1;
1124         \}
1125 
1126         \textcolor{keywordflow}{return} 0;
1127     \}
1128 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a26901882c0b134822660515493683132_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a26901882c0b134822660515493683132_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a5ee1dbaa28ff59e0f452eda3c97418e3}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!add\+\_\+tcp\+\_\+relay\+\_\+global@{add\+\_\+tcp\+\_\+relay\+\_\+global}}
\index{add\+\_\+tcp\+\_\+relay\+\_\+global@{add\+\_\+tcp\+\_\+relay\+\_\+global}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{add\+\_\+tcp\+\_\+relay\+\_\+global}]{\setlength{\rightskip}{0pt plus 5cm}int add\+\_\+tcp\+\_\+relay\+\_\+global (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{{\bf I\+P\+\_\+\+Port}}]{ip\+\_\+port, }
\item[{const uint8\+\_\+t $\ast$}]{relay\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a5ee1dbaa28ff59e0f452eda3c97418e3}


Definition at line 1046 of file T\+C\+P\+\_\+connection.\+c.



References add\+\_\+tcp\+\_\+relay\+\_\+instance(), and find\+\_\+tcp\+\_\+connection\+\_\+relay().



Referenced by add\+\_\+tcp\+\_\+relay(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
1047 \{
1048     \textcolor{keywordtype}{int} tcp\_connections\_number = \hyperlink{_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4}{find\_tcp\_connection\_relay}(tcp\_c, relay\_pk);
1049 
1050     \textcolor{keywordflow}{if} (tcp\_connections\_number != -1)
1051         \textcolor{keywordflow}{return} -1;
1052 
1053     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd}{add\_tcp\_relay\_instance}(tcp\_c, ip\_port, relay\_pk) == -1)
1054         \textcolor{keywordflow}{return} -1;
1055 
1056     \textcolor{keywordflow}{return} 0;
1057 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a5ee1dbaa28ff59e0f452eda3c97418e3_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a5ee1dbaa28ff59e0f452eda3c97418e3_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!add\+\_\+tcp\+\_\+relay\+\_\+instance@{add\+\_\+tcp\+\_\+relay\+\_\+instance}}
\index{add\+\_\+tcp\+\_\+relay\+\_\+instance@{add\+\_\+tcp\+\_\+relay\+\_\+instance}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{add\+\_\+tcp\+\_\+relay\+\_\+instance}]{\setlength{\rightskip}{0pt plus 5cm}static int add\+\_\+tcp\+\_\+relay\+\_\+instance (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{{\bf I\+P\+\_\+\+Port}}]{ip\+\_\+port, }
\item[{const uint8\+\_\+t $\ast$}]{relay\+\_\+pk}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd}


Definition at line 1011 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, create\+\_\+tcp\+\_\+connection(), I\+P\+::family, I\+P\+\_\+\+Port\+::ip, new\+\_\+\+T\+C\+P\+\_\+connection(), T\+C\+P\+\_\+\+Connections\+::proxy\+\_\+info, T\+C\+P\+\_\+\+Connections\+::self\+\_\+public\+\_\+key, T\+C\+P\+\_\+\+Connections\+::self\+\_\+secret\+\_\+key, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+V\+A\+L\+I\+D, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, T\+C\+P\+\_\+\+I\+N\+E\+T, and T\+C\+P\+\_\+\+I\+N\+E\+T6.



Referenced by add\+\_\+tcp\+\_\+relay\+\_\+connection(), and add\+\_\+tcp\+\_\+relay\+\_\+global().


\begin{DoxyCode}
1012 \{
1013     \textcolor{keywordflow}{if} (ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} == \hyperlink{network_8h_a38cdd2f189180d6790d5b181f55ca047}{TCP\_INET}) \{
1014         ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} = AF\_INET;
1015     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} == \hyperlink{network_8h_a7cd884776d628ca50049592d963c10cc}{TCP\_INET6}) \{
1016         ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} = AF\_INET6;
1017     \}
1018 
1019     \textcolor{keywordflow}{if} (ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} != AF\_INET && ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} != AF\_INET6)
1020         \textcolor{keywordflow}{return} -1;
1021 
1022     \textcolor{keywordtype}{int} tcp\_connections\_number = \hyperlink{_t_c_p__connection_8c_a2cd69ef2e2153135f588193ef36acf3e}{create\_tcp\_connection}(tcp\_c);
1023 
1024     \textcolor{keywordflow}{if} (tcp\_connections\_number == -1)
1025         \textcolor{keywordflow}{return} -1;
1026 
1027     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = &tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[tcp\_connections\_number];
1028 
1029 
1030     tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection} = \hyperlink{_t_c_p__client_8c_aedb0d5c54ac7754bb342517247ac632d}{new\_TCP\_connection}(ip\_port, relay\_pk, tcp\_c->
      \hyperlink{struct_t_c_p___connections_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key}, tcp\_c->\hyperlink{struct_t_c_p___connections_aa05050f86513ff53fe9da81f73c72267}{self\_secret\_key},
1031                           &tcp\_c->\hyperlink{struct_t_c_p___connections_aa737023350cf47e63993e3b4dc9a7472}{proxy\_info});
1032 
1033     \textcolor{keywordflow}{if} (!tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection})
1034         \textcolor{keywordflow}{return} -1;
1035 
1036     tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID};
1037 
1038     \textcolor{keywordflow}{return} tcp\_connections\_number;
1039 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_af221264f649b29407becf0e4ca352cbd_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_aafa7b2a7f56b8f6bb0c1e44b9aec7262}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!connections\+\_\+number\+\_\+not\+\_\+valid@{connections\+\_\+number\+\_\+not\+\_\+valid}}
\index{connections\+\_\+number\+\_\+not\+\_\+valid@{connections\+\_\+number\+\_\+not\+\_\+valid}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{connections\+\_\+number\+\_\+not\+\_\+valid}]{\setlength{\rightskip}{0pt plus 5cm}static \+\_\+\+Bool connections\+\_\+number\+\_\+not\+\_\+valid (
\begin{DoxyParamCaption}
\item[{const {\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_aafa7b2a7f56b8f6bb0c1e44b9aec7262}


Definition at line 42 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::connections, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, and T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+N\+O\+N\+E.



Referenced by get\+\_\+connection(), and wipe\+\_\+connection().


\begin{DoxyCode}
43 \{
44     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})connections\_number >= tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length})
45         \textcolor{keywordflow}{return} 1;
46 
47     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections} == NULL)
48         \textcolor{keywordflow}{return} 1;
49 
50     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[connections\_number].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_ac0d2accad7ab0ed0ededf15e127d6f56}{TCP\_CONN\_NONE})
51         \textcolor{keywordflow}{return} 1;
52 
53     \textcolor{keywordflow}{return} 0;
54 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aafa7b2a7f56b8f6bb0c1e44b9aec7262_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a62b7fc88f48b373ae0b957244fe9db8e}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!create\+\_\+connection@{create\+\_\+connection}}
\index{create\+\_\+connection@{create\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{create\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int create\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a62b7fc88f48b373ae0b957244fe9db8e}


Definition at line 78 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::connections, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, i, realloc\+\_\+tox\+\_\+array, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, and T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+N\+O\+N\+E.



Referenced by new\+\_\+tcp\+\_\+connection\+\_\+to().


\begin{DoxyCode}
79 \{
80     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
81 
82     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
83         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[i].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ac0d2accad7ab0ed0ededf15e127d6f56}{TCP\_CONN\_NONE})
84             \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
85     \}
86 
87     \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = -1;
88 
89     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *temp\_pointer;
90 
91     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}{realloc\_tox\_array}(tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}, \textcolor{keyword}{sizeof}(
      \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to}), tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length} + 1,
92                           temp\_pointer) == 0) \{
93         \textcolor{keywordtype}{id} = tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length};
94         ++tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length};
95         memset(&(tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[\textcolor{keywordtype}{id}]), 0, \textcolor{keyword}{sizeof}(\hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to}));
96     \}
97 
98     \textcolor{keywordflow}{return} id;
99 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a62b7fc88f48b373ae0b957244fe9db8e_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a2cd69ef2e2153135f588193ef36acf3e}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!create\+\_\+tcp\+\_\+connection@{create\+\_\+tcp\+\_\+connection}}
\index{create\+\_\+tcp\+\_\+connection@{create\+\_\+tcp\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{create\+\_\+tcp\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int create\+\_\+tcp\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a2cd69ef2e2153135f588193ef36acf3e}


Definition at line 106 of file T\+C\+P\+\_\+connection.\+c.



References i, realloc\+\_\+tox\+\_\+array, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+N\+O\+N\+E, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by add\+\_\+tcp\+\_\+relay\+\_\+instance().


\begin{DoxyCode}
107 \{
108     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
109 
110     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
111         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[i].\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_ac0d2accad7ab0ed0ededf15e127d6f56}{TCP\_CONN\_NONE})
112             \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
113     \}
114 
115     \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = -1;
116 
117     \hyperlink{struct_t_c_p__con}{TCP\_con} *temp\_pointer;
118 
119     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}{realloc\_tox\_array}(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}, \textcolor{keyword}{sizeof}(
      \hyperlink{struct_t_c_p__con}{TCP\_con}), tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length} + 1, temp\_pointer) == 0) \{
120         \textcolor{keywordtype}{id} = tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length};
121         ++tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length};
122         memset(&(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[\textcolor{keywordtype}{id}]), 0, \textcolor{keyword}{sizeof}(\hyperlink{struct_t_c_p__con}{TCP\_con}));
123     \}
124 
125     \textcolor{keywordflow}{return} id;
126 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a2cd69ef2e2153135f588193ef36acf3e_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a30c1a9c57a8d07cc2327c0505d6619a4}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!do\+\_\+tcp\+\_\+connections@{do\+\_\+tcp\+\_\+connections}}
\index{do\+\_\+tcp\+\_\+connections@{do\+\_\+tcp\+\_\+connections}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{do\+\_\+tcp\+\_\+connections}]{\setlength{\rightskip}{0pt plus 5cm}void do\+\_\+tcp\+\_\+connections (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a30c1a9c57a8d07cc2327c0505d6619a4}


Definition at line 1346 of file T\+C\+P\+\_\+connection.\+c.



References do\+\_\+tcp\+\_\+conns(), and kill\+\_\+nonused\+\_\+tcp().



Referenced by do\+\_\+tcp(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
1347 \{
1348     \hyperlink{_t_c_p__connection_8c_a6377f0f3d60ba706c5b014a9439696b7}{do\_tcp\_conns}(tcp\_c);
1349     \hyperlink{_t_c_p__connection_8c_a49dd47efa4f43cd5ba37a4836c6e55ff}{kill\_nonused\_tcp}(tcp\_c);
1350 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a30c1a9c57a8d07cc2327c0505d6619a4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a30c1a9c57a8d07cc2327c0505d6619a4_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a6377f0f3d60ba706c5b014a9439696b7}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!do\+\_\+tcp\+\_\+conns@{do\+\_\+tcp\+\_\+conns}}
\index{do\+\_\+tcp\+\_\+conns@{do\+\_\+tcp\+\_\+conns}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{do\+\_\+tcp\+\_\+conns}]{\setlength{\rightskip}{0pt plus 5cm}static void do\+\_\+tcp\+\_\+conns (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a6377f0f3d60ba706c5b014a9439696b7}


Definition at line 1268 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connected\+\_\+time, T\+C\+P\+\_\+con\+::connection, do\+\_\+\+T\+C\+P\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, is\+\_\+timeout(), kill\+\_\+tcp\+\_\+relay\+\_\+connection(), T\+C\+P\+\_\+con\+::lock\+\_\+count, T\+C\+P\+\_\+con\+::onion, reconnect\+\_\+tcp\+\_\+relay\+\_\+connection(), T\+C\+P\+\_\+con\+::sleep\+\_\+count, sleep\+\_\+tcp\+\_\+relay\+\_\+connection(), T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::status, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+C\+O\+N\+F\+I\+R\+M\+E\+D, T\+C\+P\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+V\+A\+L\+I\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+A\+N\+N\+O\+U\+N\+C\+E\+\_\+\+T\+I\+M\+E\+O\+U\+T, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length, tcp\+\_\+relay\+\_\+on\+\_\+online(), T\+C\+P\+\_\+con\+::unsleep, and unsleep\+\_\+tcp\+\_\+relay\+\_\+connection().



Referenced by do\+\_\+tcp\+\_\+connections().


\begin{DoxyCode}
1269 \{
1270     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1271 
1272     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1273         \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
1274 
1275         \textcolor{keywordflow}{if} (tcp\_con) \{
1276             \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
1277                 \hyperlink{_t_c_p__client_8c_a3333858c51935f9f546cf923b07ed845}{do\_TCP\_connection}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection});
1278 
1279                 \textcolor{comment}{/* callbacks can change TCP connection address. */}
1280                 tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
1281 
1282                 \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__client_8h_ae4d5251432e1a9e6803c0240cc492e18a066a0f8bc9d1c9b8e46e6eba719e703c}{TCP\_CLIENT\_DISCONNECTED}) \{
1283                     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
1284                         \hyperlink{_t_c_p__connection_8c_a81963b2aeca3eb88b3fea76869b19fad}{reconnect\_tcp\_relay\_connection}(tcp\_c, i);
1285                     \} \textcolor{keywordflow}{else} \{
1286                         \hyperlink{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}{kill\_tcp\_relay\_connection}(tcp\_c, i);
1287                     \}
1288 
1289                     \textcolor{keywordflow}{continue};
1290                 \}
1291 
1292                 \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID} && tcp\_con->
      \hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__client_8h_ae4d5251432e1a9e6803c0240cc492e18a5751b9ce4d04cb2496f4eeec142ddaf1}{TCP\_CLIENT\_CONFIRMED}) \{
1293                     \hyperlink{_t_c_p__connection_8c_a52486c51f2c9e789893e71611dc2a188}{tcp\_relay\_on\_online}(tcp\_c, i);
1294                 \}
1295 
1296                 \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED} && !tcp\_con->
      \hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} && tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count}
1297                         && tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count} == tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count}
1298                         && \hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time}, 
      \hyperlink{_t_c_p__connection_8h_a4de3db7de09d5d11588b0ef2b50ec639}{TCP\_CONNECTION\_ANNOUNCE\_TIMEOUT})) \{
1299                     \hyperlink{_t_c_p__connection_8c_ac91d3707f1b16a4a9e0f6d4d70cdee14}{sleep\_tcp\_relay\_connection}(tcp\_c, i);
1300                 \}
1301             \}
1302 
1303             \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING} && tcp\_con->
      \hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep}) \{
1304                 \hyperlink{_t_c_p__connection_8c_a359cec296ed123fc92b9b149266b30a4}{unsleep\_tcp\_relay\_connection}(tcp\_c, i);
1305             \}
1306         \}
1307     \}
1308 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a6377f0f3d60ba706c5b014a9439696b7_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a6377f0f3d60ba706c5b014a9439696b7_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!find\+\_\+tcp\+\_\+connection\+\_\+relay@{find\+\_\+tcp\+\_\+connection\+\_\+relay}}
\index{find\+\_\+tcp\+\_\+connection\+\_\+relay@{find\+\_\+tcp\+\_\+connection\+\_\+relay}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{find\+\_\+tcp\+\_\+connection\+\_\+relay}]{\setlength{\rightskip}{0pt plus 5cm}static int find\+\_\+tcp\+\_\+connection\+\_\+relay (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{const uint8\+\_\+t $\ast$}]{relay\+\_\+pk}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4}


Definition at line 401 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, get\+\_\+tcp\+\_\+connection(), i, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::public\+\_\+key, T\+C\+P\+\_\+con\+::relay\+\_\+pk, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by add\+\_\+tcp\+\_\+relay\+\_\+connection(), and add\+\_\+tcp\+\_\+relay\+\_\+global().


\begin{DoxyCode}
402 \{
403     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
404 
405     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
406         \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
407 
408         \textcolor{keywordflow}{if} (tcp\_con) \{
409             \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
410                 \textcolor{keywordflow}{if} (memcmp(tcp\_con->\hyperlink{struct_t_c_p__con_afd26506e572bfd335a3e7b498acd2902}{relay\_pk}, relay\_pk, crypto\_box\_PUBLICKEYBYTES) == 0) \{
411                     \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
412                 \}
413             \} \textcolor{keywordflow}{else} \{
414                 \textcolor{keywordflow}{if} (memcmp(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, relay\_pk, 
      crypto\_box\_PUBLICKEYBYTES) == 0) \{
415                     \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
416                 \}
417             \}
418         \}
419     \}
420 
421     \textcolor{keywordflow}{return} -1;
422 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a6146372f26967550f1260e7f72589fa4_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!find\+\_\+tcp\+\_\+connection\+\_\+to@{find\+\_\+tcp\+\_\+connection\+\_\+to}}
\index{find\+\_\+tcp\+\_\+connection\+\_\+to@{find\+\_\+tcp\+\_\+connection\+\_\+to}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{find\+\_\+tcp\+\_\+connection\+\_\+to}]{\setlength{\rightskip}{0pt plus 5cm}static int find\+\_\+tcp\+\_\+connection\+\_\+to (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6}


Definition at line 379 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, get\+\_\+connection(), i, and T\+C\+P\+\_\+\+Connection\+\_\+to\+::public\+\_\+key.



Referenced by new\+\_\+tcp\+\_\+connection\+\_\+to(), tcp\+\_\+oob\+\_\+callback(), and tcp\+\_\+response\+\_\+callback().


\begin{DoxyCode}
380 \{
381     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
382 
383     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
384         \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, i);
385 
386         \textcolor{keywordflow}{if} (con\_to) \{
387             \textcolor{keywordflow}{if} (memcmp(con\_to->\hyperlink{struct_t_c_p___connection__to_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, crypto\_box\_PUBLICKEYBYTES) == 0)
       \{
388                 \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
389             \}
390         \}
391     \}
392 
393     \textcolor{keywordflow}{return} -1;
394 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!get\+\_\+connection@{get\+\_\+connection}}
\index{get\+\_\+connection@{get\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{get\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf T\+C\+P\+\_\+\+Connection\+\_\+to}$\ast$ get\+\_\+connection (
\begin{DoxyParamCaption}
\item[{const {\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}


Definition at line 182 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::connections, and connections\+\_\+number\+\_\+not\+\_\+valid().



Referenced by add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection(), add\+\_\+tcp\+\_\+relay\+\_\+connection(), find\+\_\+tcp\+\_\+connection\+\_\+to(), kill\+\_\+tcp\+\_\+connection\+\_\+to(), kill\+\_\+tcp\+\_\+relay\+\_\+connection(), reconnect\+\_\+tcp\+\_\+relay\+\_\+connection(), send\+\_\+packet\+\_\+tcp\+\_\+connection(), set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status(), sleep\+\_\+tcp\+\_\+relay\+\_\+connection(), tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays(), tcp\+\_\+data\+\_\+callback(), tcp\+\_\+oob\+\_\+callback(), tcp\+\_\+relay\+\_\+on\+\_\+online(), tcp\+\_\+response\+\_\+callback(), and tcp\+\_\+status\+\_\+callback().


\begin{DoxyCode}
183 \{
184     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_aafa7b2a7f56b8f6bb0c1e44b9aec7262}{connections\_number\_not\_valid}(tcp\_c, connections\_number))
185         \textcolor{keywordflow}{return} 0;
186 
187     \textcolor{keywordflow}{return} &tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[connections\_number];
188 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{d5/d26/_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a84992bb55c148bb9f7a1b442d255865f}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number@{get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number}}
\index{get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number@{get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number}]{\setlength{\rightskip}{0pt plus 5cm}int get\+\_\+random\+\_\+tcp\+\_\+onion\+\_\+conn\+\_\+number (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a84992bb55c148bb9f7a1b442d255865f}


Definition at line 285 of file T\+C\+P\+\_\+connection.\+c.



References i, T\+C\+P\+\_\+con\+::onion, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by do\+\_\+onion\+\_\+client(), and get\+\_\+random\+\_\+tcp\+\_\+con\+\_\+number().


\begin{DoxyCode}
286 \{
287     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, r = rand();
288 
289     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
290         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index = ((i + r) % tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length});
291 
292         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[index].\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} && tcp\_c->
      \hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[index].\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
293             \textcolor{keywordflow}{return} index;
294         \}
295     \}
296 
297     \textcolor{keywordflow}{return} -1;
298 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a84992bb55c148bb9f7a1b442d255865f_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!get\+\_\+tcp\+\_\+connection@{get\+\_\+tcp\+\_\+connection}}
\index{get\+\_\+tcp\+\_\+connection@{get\+\_\+tcp\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{get\+\_\+tcp\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf T\+C\+P\+\_\+con}$\ast$ get\+\_\+tcp\+\_\+connection (
\begin{DoxyParamCaption}
\item[{const {\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}


Definition at line 190 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, and tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid().



Referenced by add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection(), add\+\_\+tcp\+\_\+relay\+\_\+connection(), do\+\_\+tcp\+\_\+conns(), find\+\_\+tcp\+\_\+connection\+\_\+relay(), kill\+\_\+nonused\+\_\+tcp(), kill\+\_\+tcp\+\_\+connection\+\_\+to(), kill\+\_\+tcp\+\_\+relay\+\_\+connection(), reconnect\+\_\+tcp\+\_\+relay\+\_\+connection(), send\+\_\+packet\+\_\+tcp\+\_\+connection(), send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request(), set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status(), set\+\_\+tcp\+\_\+onion\+\_\+status(), sleep\+\_\+tcp\+\_\+relay\+\_\+connection(), tcp\+\_\+copy\+\_\+connected\+\_\+relays(), tcp\+\_\+data\+\_\+callback(), tcp\+\_\+oob\+\_\+callback(), tcp\+\_\+relay\+\_\+on\+\_\+online(), tcp\+\_\+relay\+\_\+set\+\_\+callbacks(), tcp\+\_\+response\+\_\+callback(), tcp\+\_\+send\+\_\+oob\+\_\+packet(), tcp\+\_\+status\+\_\+callback(), and unsleep\+\_\+tcp\+\_\+relay\+\_\+connection().


\begin{DoxyCode}
191 \{
192     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_ae8f5b59977d8d4221ff8da3922d257a5}{tcp\_connections\_number\_not\_valid}(tcp\_c, tcp\_connections\_number))
193         \textcolor{keywordflow}{return} 0;
194 
195     \textcolor{keywordflow}{return} &tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[tcp\_connections\_number];
196 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{d5/d26/_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a49dd47efa4f43cd5ba37a4836c6e55ff}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!kill\+\_\+nonused\+\_\+tcp@{kill\+\_\+nonused\+\_\+tcp}}
\index{kill\+\_\+nonused\+\_\+tcp@{kill\+\_\+nonused\+\_\+tcp}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{kill\+\_\+nonused\+\_\+tcp}]{\setlength{\rightskip}{0pt plus 5cm}static void kill\+\_\+nonused\+\_\+tcp (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a49dd47efa4f43cd5ba37a4836c6e55ff}


Definition at line 1310 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connected\+\_\+time, get\+\_\+tcp\+\_\+connection(), i, is\+\_\+timeout(), kill\+\_\+tcp\+\_\+relay\+\_\+connection(), T\+C\+P\+\_\+con\+::lock\+\_\+count, T\+C\+P\+\_\+con\+::onion, R\+E\+C\+O\+M\+M\+E\+N\+D\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+A\+N\+N\+O\+U\+N\+C\+E\+\_\+\+T\+I\+M\+E\+O\+U\+T, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by do\+\_\+tcp\+\_\+connections().


\begin{DoxyCode}
1311 \{
1312     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length} == 0)
1313         \textcolor{keywordflow}{return};
1314 
1315     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, num\_online = 0, num\_kill = 0, to\_kill[tcp\_c->
      \hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}];
1316 
1317     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1318         \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
1319 
1320         \textcolor{keywordflow}{if} (tcp\_con) \{
1321             \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
1322                 \textcolor{keywordflow}{if} (!tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} && !tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count} && 
      \hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time}, 
      \hyperlink{_t_c_p__connection_8h_a4de3db7de09d5d11588b0ef2b50ec639}{TCP\_CONNECTION\_ANNOUNCE\_TIMEOUT})) \{
1323                     to\_kill[num\_kill] = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1324                     ++num\_kill;
1325                 \}
1326 
1327                 ++num\_online;
1328             \}
1329         \}
1330     \}
1331 
1332     \textcolor{keywordflow}{if} (num\_online <= \hyperlink{_t_c_p__connection_8h_a56e5080b902e3fd06f9c0bfa74af34c5}{RECOMMENDED\_FRIEND\_TCP\_CONNECTIONS}) \{
1333         \textcolor{keywordflow}{return};
1334     \} \textcolor{keywordflow}{else} \{
1335         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n = num\_online - \hyperlink{_t_c_p__connection_8h_a56e5080b902e3fd06f9c0bfa74af34c5}{RECOMMENDED\_FRIEND\_TCP\_CONNECTIONS};
1336 
1337         \textcolor{keywordflow}{if} (n < num\_kill)
1338             num\_kill = n;
1339     \}
1340 
1341     \textcolor{keywordflow}{for} (i = 0; i < num\_kill; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1342         \hyperlink{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}{kill\_tcp\_relay\_connection}(tcp\_c, to\_kill[i]);
1343     \}
1344 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a49dd47efa4f43cd5ba37a4836c6e55ff_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a49dd47efa4f43cd5ba37a4836c6e55ff_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a2369688a49bef46cb2029b3bb680e11d}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!kill\+\_\+tcp\+\_\+connection\+\_\+to@{kill\+\_\+tcp\+\_\+connection\+\_\+to}}
\index{kill\+\_\+tcp\+\_\+connection\+\_\+to@{kill\+\_\+tcp\+\_\+connection\+\_\+to}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{kill\+\_\+tcp\+\_\+connection\+\_\+to}]{\setlength{\rightskip}{0pt plus 5cm}int kill\+\_\+tcp\+\_\+connection\+\_\+to (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a2369688a49bef46cb2029b3bb680e11d}


Definition at line 455 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connection\+\_\+id, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, T\+C\+P\+\_\+con\+::lock\+\_\+count, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, send\+\_\+disconnect\+\_\+request(), T\+C\+P\+\_\+con\+::sleep\+\_\+count, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+O\+N\+L\+I\+N\+E, and wipe\+\_\+connection().



Referenced by accept\+\_\+crypto\+\_\+connection(), crypto\+\_\+kill(), new\+\_\+crypto\+\_\+connection(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
456 \{
457     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
458 
459     \textcolor{keywordflow}{if} (!con\_to)
460         \textcolor{keywordflow}{return} -1;
461 
462     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
463 
464     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
465         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection}) \{
466             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} - 1;
467             \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
468 
469             \textcolor{keywordflow}{if} (!tcp\_con)
470                 \textcolor{keywordflow}{continue};
471 
472             \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
473                 \hyperlink{_t_c_p__client_8c_af83d9fac2256a46428ad95bf337c05b7}{send\_disconnect\_request}(tcp\_con->
      \hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_ababc90484b0c796e004410411e723f5e}{connection\_id});
474             \}
475 
476             \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_a2cf312d6bf16e319e47793e92a5a68e7}{TCP\_CONNECTIONS\_STATUS\_ONLINE}) \{
477                 --tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count};
478 
479                 \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
480                     --tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count};
481                 \}
482             \}
483         \}
484     \}
485 
486     \textcolor{keywordflow}{return} \hyperlink{_t_c_p__connection_8c_a10a5b3ddc6f1bfa7785301f33c369695}{wipe\_connection}(tcp\_c, connections\_number);
487 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a2369688a49bef46cb2029b3bb680e11d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a2369688a49bef46cb2029b3bb680e11d_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a6938788005ebe33a896755ac2b9f501a}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!kill\+\_\+tcp\+\_\+connections@{kill\+\_\+tcp\+\_\+connections}}
\index{kill\+\_\+tcp\+\_\+connections@{kill\+\_\+tcp\+\_\+connections}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{kill\+\_\+tcp\+\_\+connections}]{\setlength{\rightskip}{0pt plus 5cm}void kill\+\_\+tcp\+\_\+connections (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a6938788005ebe33a896755ac2b9f501a}


Definition at line 1352 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Connections\+::connections, i, kill\+\_\+\+T\+C\+P\+\_\+connection(), T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by kill\+\_\+net\+\_\+crypto(), new\+\_\+net\+\_\+crypto(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
1353 \{
1354     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1355 
1356     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1357         \hyperlink{_t_c_p__client_8c_a437ba55ccf24fb881acf298f3e225a63}{kill\_TCP\_connection}(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[i].
      \hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection});
1358     \}
1359 
1360     free(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections});
1361     free(tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections});
1362     free(tcp\_c);
1363 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a6938788005ebe33a896755ac2b9f501a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a6938788005ebe33a896755ac2b9f501a_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!kill\+\_\+tcp\+\_\+relay\+\_\+connection@{kill\+\_\+tcp\+\_\+relay\+\_\+connection}}
\index{kill\+\_\+tcp\+\_\+relay\+\_\+connection@{kill\+\_\+tcp\+\_\+relay\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{kill\+\_\+tcp\+\_\+relay\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int kill\+\_\+tcp\+\_\+relay\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}


Definition at line 656 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, kill\+\_\+\+T\+C\+P\+\_\+connection(), T\+C\+P\+\_\+con\+::onion, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+num\+\_\+conns, rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn(), and wipe\+\_\+tcp\+\_\+connection().



Referenced by do\+\_\+tcp\+\_\+conns(), kill\+\_\+nonused\+\_\+tcp(), reconnect\+\_\+tcp\+\_\+relay\+\_\+connection(), and unsleep\+\_\+tcp\+\_\+relay\+\_\+connection().


\begin{DoxyCode}
657 \{
658     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
659 
660     \textcolor{keywordflow}{if} (!tcp\_con)
661         \textcolor{keywordflow}{return} -1;
662 
663     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
664 
665     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
666         \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, i);
667 
668         \textcolor{keywordflow}{if} (con\_to) \{
669             \hyperlink{_t_c_p__connection_8c_a8143d81d0cb65f668ecbd79884ef78e5}{rm\_tcp\_connection\_from\_conn}(con\_to, tcp\_connections\_number);
670         \}
671     \}
672 
673     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion}) \{
674         --tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
675     \}
676 
677     \hyperlink{_t_c_p__client_8c_a437ba55ccf24fb881acf298f3e225a63}{kill\_TCP\_connection}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection});
678 
679     \textcolor{keywordflow}{return} \hyperlink{_t_c_p__connection_8c_add1161d338a19eca0bb42f242b543036}{wipe\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
680 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a22c797c7e0ef3ad66e171f05b1cb52bd}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!new\+\_\+tcp\+\_\+connection\+\_\+to@{new\+\_\+tcp\+\_\+connection\+\_\+to}}
\index{new\+\_\+tcp\+\_\+connection\+\_\+to@{new\+\_\+tcp\+\_\+connection\+\_\+to}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{new\+\_\+tcp\+\_\+connection\+\_\+to}]{\setlength{\rightskip}{0pt plus 5cm}int new\+\_\+tcp\+\_\+connection\+\_\+to (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+key, }
\item[{int}]{id}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a22c797c7e0ef3ad66e171f05b1cb52bd}


Definition at line 433 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::connections, create\+\_\+connection(), find\+\_\+tcp\+\_\+connection\+\_\+to(), T\+C\+P\+\_\+\+Connection\+\_\+to\+::id, T\+C\+P\+\_\+\+Connection\+\_\+to\+::public\+\_\+key, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, and T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+V\+A\+L\+I\+D.



Referenced by accept\+\_\+crypto\+\_\+connection(), new\+\_\+crypto\+\_\+connection(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
434 \{
435     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6}{find\_tcp\_connection\_to}(tcp\_c, \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}) != -1)
436         \textcolor{keywordflow}{return} -1;
437 
438     \textcolor{keywordtype}{int} connections\_number = \hyperlink{_t_c_p__connection_8c_a62b7fc88f48b373ae0b957244fe9db8e}{create\_connection}(tcp\_c);
439 
440     \textcolor{keywordflow}{if} (connections\_number == -1)
441         \textcolor{keywordflow}{return} -1;
442 
443     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = &tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[connections\_number];
444 
445     con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID};
446     memcpy(con\_to->\hyperlink{struct_t_c_p___connection__to_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, crypto\_box\_PUBLICKEYBYTES);
447     con\_to->\hyperlink{struct_t_c_p___connection__to_a7441ef0865bcb3db9b8064dd7375c1ea}{id} = id;
448 
449     \textcolor{keywordflow}{return} connections\_number;
450 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a22c797c7e0ef3ad66e171f05b1cb52bd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a22c797c7e0ef3ad66e171f05b1cb52bd_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a3526d187a2a8f91d672f0bde2dff4633}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!new\+\_\+tcp\+\_\+connections@{new\+\_\+tcp\+\_\+connections}}
\index{new\+\_\+tcp\+\_\+connections@{new\+\_\+tcp\+\_\+connections}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{new\+\_\+tcp\+\_\+connections}]{\setlength{\rightskip}{0pt plus 5cm}{\bf T\+C\+P\+\_\+\+Connections}$\ast$ new\+\_\+tcp\+\_\+connections (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$}]{secret\+\_\+key, }
\item[{{\bf T\+C\+P\+\_\+\+Proxy\+\_\+\+Info} $\ast$}]{proxy\+\_\+info}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a3526d187a2a8f91d672f0bde2dff4633}


Definition at line 1251 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::proxy\+\_\+info, T\+C\+P\+\_\+\+Connections\+::self\+\_\+public\+\_\+key, and T\+C\+P\+\_\+\+Connections\+::self\+\_\+secret\+\_\+key.



Referenced by new\+\_\+net\+\_\+crypto(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
1252 \{
1253     \textcolor{keywordflow}{if} (secret\_key == NULL)
1254         \textcolor{keywordflow}{return} NULL;
1255 
1256     \hyperlink{struct_t_c_p___connections}{TCP\_Connections} *temp = calloc(1, \textcolor{keyword}{sizeof}(\hyperlink{struct_t_c_p___connections}{TCP\_Connections}));
1257 
1258     \textcolor{keywordflow}{if} (temp == NULL)
1259         \textcolor{keywordflow}{return} NULL;
1260 
1261     memcpy(temp->\hyperlink{struct_t_c_p___connections_aa05050f86513ff53fe9da81f73c72267}{self\_secret\_key}, secret\_key, crypto\_box\_SECRETKEYBYTES);
1262     crypto\_scalarmult\_curve25519\_base(temp->\hyperlink{struct_t_c_p___connections_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key}, temp->
      \hyperlink{struct_t_c_p___connections_aa05050f86513ff53fe9da81f73c72267}{self\_secret\_key});
1263     temp->\hyperlink{struct_t_c_p___connections_aa737023350cf47e63993e3b4dc9a7472}{proxy\_info} = *proxy\_info;
1264 
1265     \textcolor{keywordflow}{return} temp;
1266 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a3526d187a2a8f91d672f0bde2dff4633_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a255916e82a74ad6c617216af786ec335}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn@{online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn}}
\index{online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn@{online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn}]{\setlength{\rightskip}{0pt plus 5cm}static unsigned int online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$}]{con\+\_\+to}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a255916e82a74ad6c617216af786ec335}


Definition at line 612 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection, and T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+O\+N\+L\+I\+N\+E.



Referenced by add\+\_\+tcp\+\_\+relay\+\_\+connection(), and tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays().


\begin{DoxyCode}
613 \{
614     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, count = 0;
615 
616     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
617         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection}) \{
618             \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_a2cf312d6bf16e319e47793e92a5a68e7}{TCP\_CONNECTIONS\_STATUS\_ONLINE}) \{
619                 ++count;
620             \}
621         \}
622     \}
623 
624     \textcolor{keywordflow}{return} count;
625 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a255916e82a74ad6c617216af786ec335_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a81963b2aeca3eb88b3fea76869b19fad}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!reconnect\+\_\+tcp\+\_\+relay\+\_\+connection@{reconnect\+\_\+tcp\+\_\+relay\+\_\+connection}}
\index{reconnect\+\_\+tcp\+\_\+relay\+\_\+connection@{reconnect\+\_\+tcp\+\_\+relay\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{reconnect\+\_\+tcp\+\_\+relay\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int reconnect\+\_\+tcp\+\_\+relay\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a81963b2aeca3eb88b3fea76869b19fad}


Definition at line 682 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connected\+\_\+time, T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::ip\+\_\+port, kill\+\_\+\+T\+C\+P\+\_\+connection(), kill\+\_\+tcp\+\_\+relay\+\_\+connection(), T\+C\+P\+\_\+con\+::lock\+\_\+count, new\+\_\+\+T\+C\+P\+\_\+connection(), T\+C\+P\+\_\+con\+::onion, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+num\+\_\+conns, T\+C\+P\+\_\+\+Connections\+::proxy\+\_\+info, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::public\+\_\+key, T\+C\+P\+\_\+\+Connections\+::self\+\_\+public\+\_\+key, T\+C\+P\+\_\+\+Connections\+::self\+\_\+secret\+\_\+key, set\+\_\+tcp\+\_\+connection\+\_\+status(), T\+C\+P\+\_\+con\+::sleep\+\_\+count, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+V\+A\+L\+I\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, and T\+C\+P\+\_\+con\+::unsleep.



Referenced by do\+\_\+tcp\+\_\+conns().


\begin{DoxyCode}
683 \{
684     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
685 
686     \textcolor{keywordflow}{if} (!tcp\_con)
687         \textcolor{keywordflow}{return} -1;
688 
689     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING})
690         \textcolor{keywordflow}{return} -1;
691 
692     \hyperlink{struct_i_p___port}{IP\_Port} ip\_port = tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port};
693     uint8\_t relay\_pk[crypto\_box\_PUBLICKEYBYTES];
694     memcpy(relay\_pk, tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, crypto\_box\_PUBLICKEYBYTES);
695     \hyperlink{_t_c_p__client_8c_a437ba55ccf24fb881acf298f3e225a63}{kill\_TCP\_connection}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection});
696     tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection} = \hyperlink{_t_c_p__client_8c_aedb0d5c54ac7754bb342517247ac632d}{new\_TCP\_connection}(ip\_port, relay\_pk, tcp\_c->
      \hyperlink{struct_t_c_p___connections_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key}, tcp\_c->\hyperlink{struct_t_c_p___connections_aa05050f86513ff53fe9da81f73c72267}{self\_secret\_key},
697                           &tcp\_c->\hyperlink{struct_t_c_p___connections_aa737023350cf47e63993e3b4dc9a7472}{proxy\_info});
698 
699     \textcolor{keywordflow}{if} (!tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}) \{
700         \hyperlink{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}{kill\_tcp\_relay\_connection}(tcp\_c, tcp\_connections\_number);
701         \textcolor{keywordflow}{return} -1;
702     \}
703 
704     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
705 
706     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
707         \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, i);
708 
709         \textcolor{keywordflow}{if} (con\_to) \{
710             \hyperlink{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{set\_tcp\_connection\_status}(con\_to, tcp\_connections\_number, 
      \hyperlink{_t_c_p__connection_8h_affacad255b45e30644ec8d14158c9246}{TCP\_CONNECTIONS\_STATUS\_NONE}, 0);
711         \}
712     \}
713 
714     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion}) \{
715         --tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
716         tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} = 0;
717     \}
718 
719     tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count} = 0;
720     tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count} = 0;
721     tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time} = 0;
722     tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID};
723     tcp\_con->\hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep} = 0;
724 
725     \textcolor{keywordflow}{return} 0;
726 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a81963b2aeca3eb88b3fea76869b19fad_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a81963b2aeca3eb88b3fea76869b19fad_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a8143d81d0cb65f668ecbd79884ef78e5}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn@{rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn}}
\index{rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn@{rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn}]{\setlength{\rightskip}{0pt plus 5cm}static int rm\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$}]{con\+\_\+to, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a8143d81d0cb65f668ecbd79884ef78e5}


Definition at line 593 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connection\+\_\+to\+::connection\+\_\+id, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection, and T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E.



Referenced by kill\+\_\+tcp\+\_\+relay\+\_\+connection().


\begin{DoxyCode}
594 \{
595     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
596 
597     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
598         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} == (tcp\_connections\_number + 1))
       \{
599             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} = 0;
600             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} = 
      \hyperlink{_t_c_p__connection_8h_affacad255b45e30644ec8d14158c9246}{TCP\_CONNECTIONS\_STATUS\_NONE};
601             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ababc90484b0c796e004410411e723f5e}{connection\_id} = 0;
602             \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
603         \}
604     \}
605 
606     \textcolor{keywordflow}{return} -1;
607 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a8143d81d0cb65f668ecbd79884ef78e5_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a455e955e01d34ff3db0b22b8f6d49d98}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!send\+\_\+packet\+\_\+tcp\+\_\+connection@{send\+\_\+packet\+\_\+tcp\+\_\+connection}}
\index{send\+\_\+packet\+\_\+tcp\+\_\+connection@{send\+\_\+packet\+\_\+tcp\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{send\+\_\+packet\+\_\+tcp\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}int send\+\_\+packet\+\_\+tcp\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number, }
\item[{const uint8\+\_\+t $\ast$}]{packet, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a455e955e01d34ff3db0b22b8f6d49d98}


Definition at line 203 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connection\+\_\+id, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+\+Connection\+\_\+to\+::public\+\_\+key, send\+\_\+data(), send\+\_\+oob\+\_\+packet(), T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+O\+N\+L\+I\+N\+E, and T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+R\+E\+G\+I\+S\+T\+E\+R\+E\+D.



Referenced by send\+\_\+packet\+\_\+to(), S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T(), and tcp\+\_\+handle\+\_\+cookie\+\_\+request().


\begin{DoxyCode}
204 \{
205     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
206 
207     \textcolor{keywordflow}{if} (!con\_to) \{
208         \textcolor{keywordflow}{return} -1;
209     \}
210 
211     \textcolor{comment}{//TODO: detect and kill bad relays.}
212     \textcolor{comment}{//TODO: thread safety?}
213     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
214     \textcolor{keywordtype}{int} ret = -1;
215 
216     \_Bool limit\_reached = 0;
217 
218     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
219         uint32\_t tcp\_con\_num = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection};
220         uint8\_t status = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status};
221         uint8\_t connection\_id = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ababc90484b0c796e004410411e723f5e}{connection\_id};
222 
223         \textcolor{keywordflow}{if} (tcp\_con\_num && status == \hyperlink{_t_c_p__connection_8h_a2cf312d6bf16e319e47793e92a5a68e7}{TCP\_CONNECTIONS\_STATUS\_ONLINE}) \{
224             tcp\_con\_num -= 1;
225             \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_con\_num);
226 
227             \textcolor{keywordflow}{if} (!tcp\_con) \{
228                 \textcolor{keywordflow}{continue};
229             \}
230 
231             ret = \hyperlink{_t_c_p__client_8c_aea842652030d00bd8302e3c0201f95b9}{send\_data}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, connection\_id, packet, length);
232 
233             \textcolor{keywordflow}{if} (ret == 0) \{
234                 limit\_reached = 1;
235             \}
236 
237             \textcolor{keywordflow}{if} (ret == 1) \{
238                 \textcolor{keywordflow}{break};
239             \}
240         \}
241     \}
242 
243     \textcolor{keywordflow}{if} (ret == 1) \{
244         \textcolor{keywordflow}{return} 0;
245     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!limit\_reached) \{
246         ret = 0;
247 
248         \textcolor{comment}{/* Send oob packets to all relays tied to the connection. */}
249         \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
250             uint32\_t tcp\_con\_num = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].
      \hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection};
251             uint8\_t status = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status};
252 
253             \textcolor{keywordflow}{if} (tcp\_con\_num && status == \hyperlink{_t_c_p__connection_8h_a02a1b8bb2ba492d94965efa057f8efcf}{TCP\_CONNECTIONS\_STATUS\_REGISTERED}
      ) \{
254                 tcp\_con\_num -= 1;
255                 \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_con\_num);
256 
257                 \textcolor{keywordflow}{if} (!tcp\_con) \{
258                     \textcolor{keywordflow}{continue};
259                 \}
260 
261                 \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__client_8c_a7818a314434c2bb01c3ea406744f076b}{send\_oob\_packet}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, con\_to->
      \hyperlink{struct_t_c_p___connection__to_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, packet, length) == 1) \{
262                     ret += 1;
263                 \}
264             \}
265         \}
266 
267         \textcolor{keywordflow}{if} (ret >= 1) \{
268             \textcolor{keywordflow}{return} 0;
269         \} \textcolor{keywordflow}{else} \{
270             \textcolor{keywordflow}{return} -1;
271         \}
272     \} \textcolor{keywordflow}{else} \{
273         \textcolor{keywordflow}{return} -1;
274     \}
275 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a455e955e01d34ff3db0b22b8f6d49d98_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a455e955e01d34ff3db0b22b8f6d49d98_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request@{send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request}}
\index{send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request@{send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request}]{\setlength{\rightskip}{0pt plus 5cm}static int send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number, }
\item[{uint8\+\_\+t $\ast$}]{public\+\_\+key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432}


Definition at line 802 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, get\+\_\+tcp\+\_\+connection(), send\+\_\+routing\+\_\+request(), T\+C\+P\+\_\+con\+::status, and T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G.



Referenced by add\+\_\+tcp\+\_\+number\+\_\+relay\+\_\+connection(), and tcp\+\_\+relay\+\_\+on\+\_\+online().


\begin{DoxyCode}
803 \{
804     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
805 
806     \textcolor{keywordflow}{if} (!tcp\_con)
807         \textcolor{keywordflow}{return} -1;
808 
809     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING})
810         \textcolor{keywordflow}{return} -1;
811 
812     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__client_8c_a0dc7de6475c22a0a31722bbf7ebb8dc5}{send\_routing\_request}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}) != 1)
813         \textcolor{keywordflow}{return} -1;
814 
815     \textcolor{keywordflow}{return} 0;
816 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a9c229dba32e28baa8cd90ae74429d803}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback@{set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}}
\index{set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback@{set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}void set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int($\ast$)(void $\ast$object, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)}]{tcp\+\_\+onion\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a9c229dba32e28baa8cd90ae74429d803}


Definition at line 366 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+onion\+\_\+callback, tcp\+\_\+onion\+\_\+callback(), and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+onion\+\_\+callback\+\_\+object.



Referenced by kill\+\_\+onion\+\_\+client(), and new\+\_\+onion\+\_\+client().


\begin{DoxyCode}
368 \{
369     tcp\_c->\hyperlink{struct_t_c_p___connections_ad92f3faa26e9b50df859c26416692b01}{tcp\_onion\_callback} = \hyperlink{_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9}{tcp\_onion\_callback};
370     tcp\_c->\hyperlink{struct_t_c_p___connections_a16e85b0c2c930afee6a25f7229c7116e}{tcp\_onion\_callback\_object} = object;
371 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{d5/d26/_t_c_p__connection_8c_a9c229dba32e28baa8cd90ae74429d803_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a9c229dba32e28baa8cd90ae74429d803_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a13df5ebd6110288f192070b8c1c28328}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback@{set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}}
\index{set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback@{set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}void set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int($\ast$)(void $\ast$object, const uint8\+\_\+t $\ast$public\+\_\+key, unsigned int tcp\+\_\+connections\+\_\+number, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)}]{tcp\+\_\+oob\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a13df5ebd6110288f192070b8c1c28328}


Definition at line 357 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+oob\+\_\+callback, tcp\+\_\+oob\+\_\+callback(), and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+oob\+\_\+callback\+\_\+object.



Referenced by new\+\_\+net\+\_\+crypto(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
359 \{
360     tcp\_c->\hyperlink{struct_t_c_p___connections_a758941f7bcf27ba64ae59503bef4ee06}{tcp\_oob\_callback} = \hyperlink{_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed}{tcp\_oob\_callback};
361     tcp\_c->\hyperlink{struct_t_c_p___connections_aa008021141b9c1d9861a06d12b495f55}{tcp\_oob\_callback\_object} = object;
362 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a13df5ebd6110288f192070b8c1c28328_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a13df5ebd6110288f192070b8c1c28328_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_afdea860d77b12c79ee24c3ade58d4ac6}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback@{set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}}
\index{set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback@{set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}void set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int($\ast$)(void $\ast$object, int id, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)}]{tcp\+\_\+data\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_afdea860d77b12c79ee24c3ade58d4ac6}


Definition at line 348 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+data\+\_\+callback, tcp\+\_\+data\+\_\+callback(), and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+data\+\_\+callback\+\_\+object.



Referenced by new\+\_\+net\+\_\+crypto(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
350 \{
351     tcp\_c->\hyperlink{struct_t_c_p___connections_a925f83cd475679a15e0510ad5b02a581}{tcp\_data\_callback} = \hyperlink{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}{tcp\_data\_callback};
352     tcp\_c->\hyperlink{struct_t_c_p___connections_a7374235c800f886578e032a878618568}{tcp\_data\_callback\_object} = object;
353 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_afdea860d77b12c79ee24c3ade58d4ac6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_afdea860d77b12c79ee24c3ade58d4ac6_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!set\+\_\+tcp\+\_\+connection\+\_\+status@{set\+\_\+tcp\+\_\+connection\+\_\+status}}
\index{set\+\_\+tcp\+\_\+connection\+\_\+status@{set\+\_\+tcp\+\_\+connection\+\_\+status}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{set\+\_\+tcp\+\_\+connection\+\_\+status}]{\setlength{\rightskip}{0pt plus 5cm}static int set\+\_\+tcp\+\_\+connection\+\_\+status (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$}]{con\+\_\+to, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number, }
\item[{unsigned int}]{status, }
\item[{uint8\+\_\+t}]{connection\+\_\+id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}


Definition at line 630 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connection\+\_\+to\+::connection\+\_\+id, T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, and T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection.



Referenced by reconnect\+\_\+tcp\+\_\+relay\+\_\+connection(), sleep\+\_\+tcp\+\_\+relay\+\_\+connection(), tcp\+\_\+response\+\_\+callback(), and tcp\+\_\+status\+\_\+callback().


\begin{DoxyCode}
632 \{
633     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
634 
635     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
636         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} == (tcp\_connections\_number + 1))
       \{
637 
638             \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == status) \{
639                 \textcolor{keywordflow}{return} -1;
640             \}
641 
642             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} = status;
643             con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_ababc90484b0c796e004410411e723f5e}{connection\_id} = connection\_id;
644             \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
645         \}
646     \}
647 
648     \textcolor{keywordflow}{return} -1;
649 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a0c7079221df3e2f827e6ec1aaac597e6}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status@{set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status}}
\index{set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status@{set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status}]{\setlength{\rightskip}{0pt plus 5cm}int set\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+status (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number, }
\item[{\+\_\+\+Bool}]{status}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a0c7079221df3e2f827e6ec1aaac597e6}


Definition at line 499 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+con\+::sleep\+\_\+count, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+V\+A\+L\+I\+D, T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+O\+N\+L\+I\+N\+E, and T\+C\+P\+\_\+con\+::unsleep.



Referenced by do\+\_\+tcp().


\begin{DoxyCode}
500 \{
501     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
502 
503     \textcolor{keywordflow}{if} (!con\_to)
504         \textcolor{keywordflow}{return} -1;
505 
506     \textcolor{keywordflow}{if} (status) \{
507         \textcolor{comment}{/* Conection is unsleeping. */}
508         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING})
509             \textcolor{keywordflow}{return} -1;
510 
511         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
512 
513         \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
514             \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection}) \{
515                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} - 1;
516                 \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, 
      tcp\_connections\_number);
517 
518                 \textcolor{keywordflow}{if} (!tcp\_con)
519                     \textcolor{keywordflow}{continue};
520 
521                 \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
522                     tcp\_con->\hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep} = 1;
523                 \}
524             \}
525         \}
526 
527         con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID};
528         \textcolor{keywordflow}{return} 0;
529     \} \textcolor{keywordflow}{else} \{
530         \textcolor{comment}{/* Conection is going to sleep. */}
531         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID})
532             \textcolor{keywordflow}{return} -1;
533 
534         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
535 
536         \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
537             \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection}) \{
538                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} - 1;
539                 \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, 
      tcp\_connections\_number);
540 
541                 \textcolor{keywordflow}{if} (!tcp\_con)
542                     \textcolor{keywordflow}{continue};
543 
544                 \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_a2cf312d6bf16e319e47793e92a5a68e7}{TCP\_CONNECTIONS\_STATUS\_ONLINE}) \{
545                     ++tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count};
546                 \}
547             \}
548         \}
549 
550         con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING};
551         \textcolor{keywordflow}{return} 0;
552     \}
553 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a0c7079221df3e2f827e6ec1aaac597e6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a0c7079221df3e2f827e6ec1aaac597e6_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a4ee7de722248f32b3bfedb25bdb59994}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!set\+\_\+tcp\+\_\+onion\+\_\+status@{set\+\_\+tcp\+\_\+onion\+\_\+status}}
\index{set\+\_\+tcp\+\_\+onion\+\_\+status@{set\+\_\+tcp\+\_\+onion\+\_\+status}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{set\+\_\+tcp\+\_\+onion\+\_\+status}]{\setlength{\rightskip}{0pt plus 5cm}int set\+\_\+tcp\+\_\+onion\+\_\+status (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{\+\_\+\+Bool}]{status}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a4ee7de722248f32b3bfedb25bdb59994}


Definition at line 1184 of file T\+C\+P\+\_\+connection.\+c.



References get\+\_\+tcp\+\_\+connection(), i, N\+U\+M\+\_\+\+O\+N\+I\+O\+N\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+con\+::onion, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+num\+\_\+conns, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+status, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length, and T\+C\+P\+\_\+con\+::unsleep.



Referenced by do\+\_\+onion\+\_\+client().


\begin{DoxyCode}
1185 \{
1186     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a4eead70704aaec336687c7a248a22522}{onion\_status} == status)
1187         \textcolor{keywordflow}{return} -1;
1188 
1189     \textcolor{keywordflow}{if} (status) \{
1190         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1191 
1192         \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1193             \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
1194 
1195             \textcolor{keywordflow}{if} (tcp\_con) \{
1196                 \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED} && !tcp\_con->
      \hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion}) \{
1197                     ++tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
1198                     tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} = 1;
1199                 \}
1200             \}
1201 
1202             \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns} >= 
      \hyperlink{_t_c_p__connection_8h_a51b7b74ad9613f50cf1efb2b52415133}{NUM\_ONION\_TCP\_CONNECTIONS})
1203                 \textcolor{keywordflow}{break};
1204         \}
1205 
1206         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns} < \hyperlink{_t_c_p__connection_8h_a51b7b74ad9613f50cf1efb2b52415133}{NUM\_ONION\_TCP\_CONNECTIONS}) \{
1207             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} wakeup = \hyperlink{_t_c_p__connection_8h_a51b7b74ad9613f50cf1efb2b52415133}{NUM\_ONION\_TCP\_CONNECTIONS} - tcp\_c->
      \hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
1208 
1209             \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1210                 \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
1211 
1212                 \textcolor{keywordflow}{if} (tcp\_con) \{
1213                     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
1214                         tcp\_con->\hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep} = 1;
1215                     \}
1216                 \}
1217 
1218                 \textcolor{keywordflow}{if} (!wakeup)
1219                     \textcolor{keywordflow}{break};
1220             \}
1221         \}
1222 
1223         tcp\_c->\hyperlink{struct_t_c_p___connections_a4eead70704aaec336687c7a248a22522}{onion\_status} = 1;
1224     \} \textcolor{keywordflow}{else} \{
1225         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
1226 
1227         \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1228             \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, i);
1229 
1230             \textcolor{keywordflow}{if} (tcp\_con) \{
1231                 \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion}) \{
1232                     --tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
1233                     tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} = 0;
1234                 \}
1235             \}
1236         \}
1237 
1238         tcp\_c->\hyperlink{struct_t_c_p___connections_a4eead70704aaec336687c7a248a22522}{onion\_status} = 0;
1239     \}
1240 
1241     \textcolor{keywordflow}{return} 0;
1242 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a4ee7de722248f32b3bfedb25bdb59994_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a4ee7de722248f32b3bfedb25bdb59994_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_ac91d3707f1b16a4a9e0f6d4d70cdee14}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!sleep\+\_\+tcp\+\_\+relay\+\_\+connection@{sleep\+\_\+tcp\+\_\+relay\+\_\+connection}}
\index{sleep\+\_\+tcp\+\_\+relay\+\_\+connection@{sleep\+\_\+tcp\+\_\+relay\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{sleep\+\_\+tcp\+\_\+relay\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int sleep\+\_\+tcp\+\_\+relay\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_ac91d3707f1b16a4a9e0f6d4d70cdee14}


Definition at line 728 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connected\+\_\+time, T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::ip\+\_\+port, T\+C\+P\+\_\+con\+::ip\+\_\+port, kill\+\_\+\+T\+C\+P\+\_\+connection(), T\+C\+P\+\_\+con\+::lock\+\_\+count, T\+C\+P\+\_\+con\+::onion, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+num\+\_\+conns, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::public\+\_\+key, T\+C\+P\+\_\+con\+::relay\+\_\+pk, set\+\_\+tcp\+\_\+connection\+\_\+status(), T\+C\+P\+\_\+con\+::sleep\+\_\+count, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E, and T\+C\+P\+\_\+con\+::unsleep.



Referenced by do\+\_\+tcp\+\_\+conns().


\begin{DoxyCode}
729 \{
730     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
731 
732     \textcolor{keywordflow}{if} (!tcp\_con)
733         \textcolor{keywordflow}{return} -1;
734 
735     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED})
736         \textcolor{keywordflow}{return} -1;
737 
738     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count} != tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count})
739         \textcolor{keywordflow}{return} -1;
740 
741     tcp\_con->\hyperlink{struct_t_c_p__con_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port} = tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port};
742     memcpy(tcp\_con->\hyperlink{struct_t_c_p__con_afd26506e572bfd335a3e7b498acd2902}{relay\_pk}, tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->\hyperlink{struct_t_c_p___client___connection_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, 
      crypto\_box\_PUBLICKEYBYTES);
743 
744     \hyperlink{_t_c_p__client_8c_a437ba55ccf24fb881acf298f3e225a63}{kill\_TCP\_connection}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection});
745     tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection} = NULL;
746 
747     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
748 
749     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
750         \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, i);
751 
752         \textcolor{keywordflow}{if} (con\_to) \{
753             \hyperlink{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{set\_tcp\_connection\_status}(con\_to, tcp\_connections\_number, 
      \hyperlink{_t_c_p__connection_8h_affacad255b45e30644ec8d14158c9246}{TCP\_CONNECTIONS\_STATUS\_NONE}, 0);
754         \}
755     \}
756 
757     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion}) \{
758         --tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
759         tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} = 0;
760     \}
761 
762     tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count} = 0;
763     tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count} = 0;
764     tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time} = 0;
765     tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING};
766     tcp\_con->\hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep} = 0;
767 
768     \textcolor{keywordflow}{return} 0;
769 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ac91d3707f1b16a4a9e0f6d4d70cdee14_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ac91d3707f1b16a4a9e0f6d4d70cdee14_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+connection\+\_\+in\+\_\+conn@{tcp\+\_\+connection\+\_\+in\+\_\+conn}}
\index{tcp\+\_\+connection\+\_\+in\+\_\+conn@{tcp\+\_\+connection\+\_\+in\+\_\+conn}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+connection\+\_\+in\+\_\+conn}]{\setlength{\rightskip}{0pt plus 5cm}static \+\_\+\+Bool tcp\+\_\+connection\+\_\+in\+\_\+conn (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connection\+\_\+to} $\ast$}]{con\+\_\+to, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096}


Definition at line 555 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connection\+\_\+to\+::connections, i, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, and T\+C\+P\+\_\+\+Connection\+\_\+to\+::tcp\+\_\+connection.



Referenced by add\+\_\+tcp\+\_\+connection\+\_\+to\+\_\+conn(), tcp\+\_\+oob\+\_\+callback(), and tcp\+\_\+relay\+\_\+on\+\_\+online().


\begin{DoxyCode}
556 \{
557     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
558 
559     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
560         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_a18a4dcc3680af788c1caa33edf6d893f}{connections}[i].\hyperlink{struct_t_c_p___connection__to_a36999f2346dd09dd7c3135fe135404ae}{tcp\_connection} == (tcp\_connections\_number + 1))
       \{
561             \textcolor{keywordflow}{return} 1;
562         \}
563     \}
564 
565     \textcolor{keywordflow}{return} 0;
566 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_ae843b0b4c8041f08bf9c18f68cae8a61}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays@{tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays}}
\index{tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays@{tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int tcp\+\_\+connection\+\_\+to\+\_\+online\+\_\+tcp\+\_\+relays (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_ae843b0b4c8041f08bf9c18f68cae8a61}


Definition at line 1133 of file T\+C\+P\+\_\+connection.\+c.



References get\+\_\+connection(), and online\+\_\+tcp\+\_\+connection\+\_\+from\+\_\+conn().



Referenced by crypto\+\_\+connection\+\_\+status(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
1134 \{
1135     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
1136 
1137     \textcolor{keywordflow}{if} (!con\_to)
1138         \textcolor{keywordflow}{return} 0;
1139 
1140     \textcolor{keywordflow}{return} \hyperlink{_t_c_p__connection_8c_a255916e82a74ad6c617216af786ec335}{online\_tcp\_connection\_from\_conn}(con\_to);
1141 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ae843b0b4c8041f08bf9c18f68cae8a61_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ae843b0b4c8041f08bf9c18f68cae8a61_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_ae8f5b59977d8d4221ff8da3922d257a5}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid@{tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid}}
\index{tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid@{tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid}]{\setlength{\rightskip}{0pt plus 5cm}static \+\_\+\+Bool tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid (
\begin{DoxyParamCaption}
\item[{const {\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_ae8f5b59977d8d4221ff8da3922d257a5}


Definition at line 59 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+N\+O\+N\+E, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by get\+\_\+tcp\+\_\+connection(), and wipe\+\_\+tcp\+\_\+connection().


\begin{DoxyCode}
60 \{
61     \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})tcp\_connections\_number >= tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length})
62         \textcolor{keywordflow}{return} 1;
63 
64     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections} == NULL)
65         \textcolor{keywordflow}{return} 1;
66 
67     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[tcp\_connections\_number].\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_ac0d2accad7ab0ed0ededf15e127d6f56}{TCP\_CONN\_NONE})
68         \textcolor{keywordflow}{return} 1;
69 
70     \textcolor{keywordflow}{return} 0;
71 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ae8f5b59977d8d4221ff8da3922d257a5_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_ac2e62c717ccebd2379e32ca9b330812c}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+copy\+\_\+connected\+\_\+relays@{tcp\+\_\+copy\+\_\+connected\+\_\+relays}}
\index{tcp\+\_\+copy\+\_\+connected\+\_\+relays@{tcp\+\_\+copy\+\_\+connected\+\_\+relays}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+copy\+\_\+connected\+\_\+relays}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int tcp\+\_\+copy\+\_\+connected\+\_\+relays (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{{\bf Node\+\_\+format} $\ast$}]{tcp\+\_\+relays, }
\item[{uint16\+\_\+t}]{max\+\_\+num}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_ac2e62c717ccebd2379e32ca9b330812c}


Definition at line 1149 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, I\+P\+::family, get\+\_\+tcp\+\_\+connection(), i, I\+P\+\_\+\+Port\+::ip, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::ip\+\_\+port, Node\+\_\+format\+::ip\+\_\+port, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::public\+\_\+key, make-\/funny-\/savefile\+::public\+\_\+key, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length, T\+C\+P\+\_\+\+I\+N\+E\+T, and T\+C\+P\+\_\+\+I\+N\+E\+T6.



Referenced by copy\+\_\+connected\+\_\+tcp\+\_\+relays().


\begin{DoxyCode}
1150 \{
1151     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, copied = 0, r = rand();
1152 
1153     \textcolor{keywordflow}{for} (i = 0; (i < tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}) && (copied < max\_num); ++
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
1154         \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, (i + r) % tcp\_c->
      \hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length});
1155 
1156         \textcolor{keywordflow}{if} (!tcp\_con) \{
1157             \textcolor{keywordflow}{continue};
1158         \}
1159 
1160         \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
1161             memcpy(tcp\_relays[copied].\hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->
      \hyperlink{struct_t_c_p___client___connection_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, crypto\_box\_PUBLICKEYBYTES);
1162             tcp\_relays[copied].\hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port} = tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}->
      \hyperlink{struct_t_c_p___client___connection_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port};
1163 
1164             \textcolor{keywordflow}{if} (tcp\_relays[copied].ip\_port.ip.family == AF\_INET) \{
1165                 tcp\_relays[copied].\hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} = \hyperlink{network_8h_a38cdd2f189180d6790d5b181f55ca047}{TCP\_INET};
1166             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tcp\_relays[copied].ip\_port.ip.family == AF\_INET6) \{
1167                 tcp\_relays[copied].\hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} = \hyperlink{network_8h_a7cd884776d628ca50049592d963c10cc}{TCP\_INET6};
1168             \}
1169 
1170             ++copied;
1171         \}
1172     \}
1173 
1174     \textcolor{keywordflow}{return} copied;
1175 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ac2e62c717ccebd2379e32ca9b330812c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ac2e62c717ccebd2379e32ca9b330812c_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+data\+\_\+callback@{tcp\+\_\+data\+\_\+callback}}
\index{tcp\+\_\+data\+\_\+callback@{tcp\+\_\+data\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+data\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+data\+\_\+callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{uint32\+\_\+t}]{number, }
\item[{uint8\+\_\+t}]{connection\+\_\+id, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}


Definition at line 882 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+object, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+uint, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), T\+C\+P\+\_\+\+Connection\+\_\+to\+::id, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+data\+\_\+callback, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+data\+\_\+callback\+\_\+object.



Referenced by set\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback(), tcp\+\_\+oob\+\_\+callback(), and tcp\+\_\+relay\+\_\+set\+\_\+callbacks().


\begin{DoxyCode}
883 \{
884 
885     \textcolor{keywordflow}{if} (length == 0)
886         \textcolor{keywordflow}{return} -1;
887 
888     \hyperlink{struct_t_c_p___client___connection}{TCP\_Client\_Connection} *TCP\_client\_con = object;
889     \hyperlink{struct_t_c_p___connections}{TCP\_Connections} *tcp\_c = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a5166a2d34403f1dafd1f23602df6c759}{custom\_object};
890 
891     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a1f84a5213a1e59db55448dd696113bfc}{custom\_uint};
892     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
893 
894     \textcolor{keywordflow}{if} (!tcp\_con)
895         \textcolor{keywordflow}{return} -1;
896 
897     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, number);
898 
899     \textcolor{keywordflow}{if} (!con\_to)
900         \textcolor{keywordflow}{return} -1;
901 
902     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a925f83cd475679a15e0510ad5b02a581}{tcp\_data\_callback})
903         tcp\_c->\hyperlink{struct_t_c_p___connections_a925f83cd475679a15e0510ad5b02a581}{tcp\_data\_callback}(tcp\_c->
      \hyperlink{struct_t_c_p___connections_a7374235c800f886578e032a878618568}{tcp\_data\_callback\_object}, con\_to->\hyperlink{struct_t_c_p___connection__to_a7441ef0865bcb3db9b8064dd7375c1ea}{id}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
904 
905     \textcolor{keywordflow}{return} 0;
906 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+onion\+\_\+callback@{tcp\+\_\+onion\+\_\+callback}}
\index{tcp\+\_\+onion\+\_\+callback@{tcp\+\_\+onion\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+onion\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+onion\+\_\+callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9}


Definition at line 937 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+onion\+\_\+callback, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+onion\+\_\+callback\+\_\+object.



Referenced by set\+\_\+onion\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback(), and tcp\+\_\+relay\+\_\+set\+\_\+callbacks().


\begin{DoxyCode}
938 \{
939     \hyperlink{struct_t_c_p___connections}{TCP\_Connections} *tcp\_c = object;
940 
941     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_ad92f3faa26e9b50df859c26416692b01}{tcp\_onion\_callback})
942         tcp\_c->\hyperlink{struct_t_c_p___connections_ad92f3faa26e9b50df859c26416692b01}{tcp\_onion\_callback}(tcp\_c->
      \hyperlink{struct_t_c_p___connections_a16e85b0c2c930afee6a25f7229c7116e}{tcp\_onion\_callback\_object}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
943 
944     \textcolor{keywordflow}{return} 0;
945 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+oob\+\_\+callback@{tcp\+\_\+oob\+\_\+callback}}
\index{tcp\+\_\+oob\+\_\+callback@{tcp\+\_\+oob\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+oob\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+oob\+\_\+callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+key, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed}


Definition at line 908 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+object, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+uint, find\+\_\+tcp\+\_\+connection\+\_\+to(), get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), tcp\+\_\+connection\+\_\+in\+\_\+conn(), tcp\+\_\+data\+\_\+callback(), T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+oob\+\_\+callback, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+oob\+\_\+callback\+\_\+object.



Referenced by set\+\_\+oob\+\_\+packet\+\_\+tcp\+\_\+connection\+\_\+callback(), and tcp\+\_\+relay\+\_\+set\+\_\+callbacks().


\begin{DoxyCode}
909 \{
910     \textcolor{keywordflow}{if} (length == 0)
911         \textcolor{keywordflow}{return} -1;
912 
913     \hyperlink{struct_t_c_p___client___connection}{TCP\_Client\_Connection} *TCP\_client\_con = object;
914     \hyperlink{struct_t_c_p___connections}{TCP\_Connections} *tcp\_c = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a5166a2d34403f1dafd1f23602df6c759}{custom\_object};
915 
916     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a1f84a5213a1e59db55448dd696113bfc}{custom\_uint};
917     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
918 
919     \textcolor{keywordflow}{if} (!tcp\_con)
920         \textcolor{keywordflow}{return} -1;
921 
922     \textcolor{comment}{/* TODO: optimize */}
923     \textcolor{keywordtype}{int} connections\_number = \hyperlink{_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6}{find\_tcp\_connection\_to}(tcp\_c, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key});
924 
925     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
926 
927     \textcolor{keywordflow}{if} (con\_to && \hyperlink{_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096}{tcp\_connection\_in\_conn}(con\_to, tcp\_connections\_number)) \{
928         \textcolor{keywordflow}{return} \hyperlink{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}{tcp\_data\_callback}(\textcolor{keywordtype}{object}, connections\_number, 0, 
      \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
929     \} \textcolor{keywordflow}{else} \{
930         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a758941f7bcf27ba64ae59503bef4ee06}{tcp\_oob\_callback})
931             tcp\_c->\hyperlink{struct_t_c_p___connections_a758941f7bcf27ba64ae59503bef4ee06}{tcp\_oob\_callback}(tcp\_c->
      \hyperlink{struct_t_c_p___connections_aa008021141b9c1d9861a06d12b495f55}{tcp\_oob\_callback\_object}, \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, tcp\_connections\_number, 
      \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
932     \}
933 
934     \textcolor{keywordflow}{return} 0;
935 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a52486c51f2c9e789893e71611dc2a188}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+relay\+\_\+on\+\_\+online@{tcp\+\_\+relay\+\_\+on\+\_\+online}}
\index{tcp\+\_\+relay\+\_\+on\+\_\+online@{tcp\+\_\+relay\+\_\+on\+\_\+online}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+relay\+\_\+on\+\_\+online}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+relay\+\_\+on\+\_\+online (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a52486c51f2c9e789893e71611dc2a188}


Definition at line 972 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connected\+\_\+time, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), i, N\+U\+M\+\_\+\+O\+N\+I\+O\+N\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, T\+C\+P\+\_\+con\+::onion, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+num\+\_\+conns, T\+C\+P\+\_\+\+Connections\+::onion\+\_\+status, T\+C\+P\+\_\+\+Connection\+\_\+to\+::public\+\_\+key, send\+\_\+tcp\+\_\+relay\+\_\+routing\+\_\+request(), T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, tcp\+\_\+connection\+\_\+in\+\_\+conn(), tcp\+\_\+relay\+\_\+set\+\_\+callbacks(), and unix\+\_\+time().



Referenced by do\+\_\+tcp\+\_\+conns().


\begin{DoxyCode}
973 \{
974     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
975 
976     \textcolor{keywordflow}{if} (!tcp\_con)
977         \textcolor{keywordflow}{return} -1;
978 
979     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, sent = 0;
980 
981     \textcolor{keywordflow}{for} (i = 0; i < tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
982         \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, i);
983 
984         \textcolor{keywordflow}{if} (con\_to) \{
985             \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a452c51915aabeb4300da3591a7d14096}{tcp\_connection\_in\_conn}(con\_to, tcp\_connections\_number)) \{
986                 \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_a739c051ae50acb8bb1d84ff30ea96432}{send\_tcp\_relay\_routing\_request}(tcp\_c, 
      tcp\_connections\_number, con\_to->\hyperlink{struct_t_c_p___connection__to_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}) == 0) \{
987                     ++sent;
988                 \}
989             \}
990         \}
991     \}
992 
993     \hyperlink{_t_c_p__connection_8c_a0a27482d704ef5925a4434a0577c647f}{tcp\_relay\_set\_callbacks}(tcp\_c, tcp\_connections\_number);
994     tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED};
995 
996     \textcolor{comment}{/* If this connection isn't used by any connection, we don't need to wait for them to come online. */}
997     \textcolor{keywordflow}{if} (sent) \{
998         tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time} = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
999     \} \textcolor{keywordflow}{else} \{
1000         tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time} = 0;
1001     \}
1002 
1003     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a4eead70704aaec336687c7a248a22522}{onion\_status} && tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns} < 
      \hyperlink{_t_c_p__connection_8h_a51b7b74ad9613f50cf1efb2b52415133}{NUM\_ONION\_TCP\_CONNECTIONS}) \{
1004         tcp\_con->\hyperlink{struct_t_c_p__con_a4f1449619f7a2b76af07277f10bd0f93}{onion} = 1;
1005         ++tcp\_c->\hyperlink{struct_t_c_p___connections_a6e6576b39dc12d06b344fae03ba2d772}{onion\_num\_conns};
1006     \}
1007 
1008     \textcolor{keywordflow}{return} 0;
1009 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a52486c51f2c9e789893e71611dc2a188_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a52486c51f2c9e789893e71611dc2a188_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a0a27482d704ef5925a4434a0577c647f}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+relay\+\_\+set\+\_\+callbacks@{tcp\+\_\+relay\+\_\+set\+\_\+callbacks}}
\index{tcp\+\_\+relay\+\_\+set\+\_\+callbacks@{tcp\+\_\+relay\+\_\+set\+\_\+callbacks}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+relay\+\_\+set\+\_\+callbacks}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+relay\+\_\+set\+\_\+callbacks (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a0a27482d704ef5925a4434a0577c647f}


Definition at line 952 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+object, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+uint, get\+\_\+tcp\+\_\+connection(), onion\+\_\+response\+\_\+handler(), oob\+\_\+data\+\_\+handler(), routing\+\_\+data\+\_\+handler(), routing\+\_\+response\+\_\+handler(), routing\+\_\+status\+\_\+handler(), tcp\+\_\+data\+\_\+callback(), tcp\+\_\+onion\+\_\+callback(), tcp\+\_\+oob\+\_\+callback(), tcp\+\_\+response\+\_\+callback(), and tcp\+\_\+status\+\_\+callback().



Referenced by tcp\+\_\+relay\+\_\+on\+\_\+online().


\begin{DoxyCode}
953 \{
954     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
955 
956     \textcolor{keywordflow}{if} (!tcp\_con)
957         \textcolor{keywordflow}{return} -1;
958 
959     \hyperlink{struct_t_c_p___client___connection}{TCP\_Client\_Connection} *con = tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection};
960 
961     con->\hyperlink{struct_t_c_p___client___connection_a5166a2d34403f1dafd1f23602df6c759}{custom\_object} = tcp\_c;
962     con->\hyperlink{struct_t_c_p___client___connection_a1f84a5213a1e59db55448dd696113bfc}{custom\_uint} = tcp\_connections\_number;
963     \hyperlink{_t_c_p__client_8c_ac71909171dbe8b0bdd4b349a9995634f}{onion\_response\_handler}(con, &\hyperlink{_t_c_p__connection_8c_ace5ecc2f60ab4dad731e31147ea788e9}{tcp\_onion\_callback}, tcp\_c);
964     \hyperlink{_t_c_p__client_8c_ac795068d9a0ba7b00db3db7bb5e217a7}{routing\_response\_handler}(con, &\hyperlink{_t_c_p__connection_8c_aaba8f94fbd0f1a94198e3054b1d660b8}{tcp\_response\_callback}, con)
      ;
965     \hyperlink{_t_c_p__client_8c_a263bc470c2cc015cbb0f975ab5632eb8}{routing\_status\_handler}(con, &\hyperlink{_t_c_p__connection_8c_aa6d25d98f798099f4a7dd86ab93763ce}{tcp\_status\_callback}, con);
966     \hyperlink{_t_c_p__client_8c_ab913946e478e2ead06cb9eccb7b7249b}{routing\_data\_handler}(con, &\hyperlink{_t_c_p__connection_8c_a3a74ceace0b841b9a50fa0fc8ed57613}{tcp\_data\_callback}, con);
967     \hyperlink{_t_c_p__client_8c_a34d78d05e93ac72b24092da391b05aa8}{oob\_data\_handler}(con, &\hyperlink{_t_c_p__connection_8c_a0639171aa059dd205b410f7ed01faaed}{tcp\_oob\_callback}, con);
968 
969     \textcolor{keywordflow}{return} 0;
970 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a0a27482d704ef5925a4434a0577c647f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a0a27482d704ef5925a4434a0577c647f_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_aaba8f94fbd0f1a94198e3054b1d660b8}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+response\+\_\+callback@{tcp\+\_\+response\+\_\+callback}}
\index{tcp\+\_\+response\+\_\+callback@{tcp\+\_\+response\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+response\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+response\+\_\+callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{uint8\+\_\+t}]{connection\+\_\+id, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_aaba8f94fbd0f1a94198e3054b1d660b8}


Definition at line 818 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+object, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+uint, find\+\_\+tcp\+\_\+connection\+\_\+to(), get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), set\+\_\+tcp\+\_\+connection\+\_\+number(), set\+\_\+tcp\+\_\+connection\+\_\+status(), and T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+R\+E\+G\+I\+S\+T\+E\+R\+E\+D.



Referenced by tcp\+\_\+relay\+\_\+set\+\_\+callbacks().


\begin{DoxyCode}
819 \{
820     \hyperlink{struct_t_c_p___client___connection}{TCP\_Client\_Connection} *TCP\_client\_con = object;
821     \hyperlink{struct_t_c_p___connections}{TCP\_Connections} *tcp\_c = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a5166a2d34403f1dafd1f23602df6c759}{custom\_object};
822 
823     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a1f84a5213a1e59db55448dd696113bfc}{custom\_uint};
824     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
825 
826     \textcolor{keywordflow}{if} (!tcp\_con)
827         \textcolor{keywordflow}{return} -1;
828 
829     \textcolor{keywordtype}{int} connections\_number = \hyperlink{_t_c_p__connection_8c_adc455181d7c862328a677fb5394885c6}{find\_tcp\_connection\_to}(tcp\_c, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key});
830 
831     \textcolor{keywordflow}{if} (connections\_number == -1)
832         \textcolor{keywordflow}{return} -1;
833 
834     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, connections\_number);
835 
836     \textcolor{keywordflow}{if} (con\_to == NULL)
837         \textcolor{keywordflow}{return} -1;
838 
839     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{set\_tcp\_connection\_status}(con\_to, tcp\_connections\_number, 
      \hyperlink{_t_c_p__connection_8h_a02a1b8bb2ba492d94965efa057f8efcf}{TCP\_CONNECTIONS\_STATUS\_REGISTERED}, connection\_id) == -1)
840         \textcolor{keywordflow}{return} -1;
841 
842     \hyperlink{_t_c_p__client_8c_a52921fadd1366f32c75e66d9c4340ed2}{set\_tcp\_connection\_number}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, connection\_id, 
      connections\_number);
843 
844     \textcolor{keywordflow}{return} 0;
845 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aaba8f94fbd0f1a94198e3054b1d660b8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aaba8f94fbd0f1a94198e3054b1d660b8_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_afb1a507e5f1af925b01666f1b9b4960a}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+send\+\_\+onion\+\_\+request@{tcp\+\_\+send\+\_\+onion\+\_\+request}}
\index{tcp\+\_\+send\+\_\+onion\+\_\+request@{tcp\+\_\+send\+\_\+onion\+\_\+request}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+send\+\_\+onion\+\_\+request}]{\setlength{\rightskip}{0pt plus 5cm}int tcp\+\_\+send\+\_\+onion\+\_\+request (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_afb1a507e5f1af925b01666f1b9b4960a}


Definition at line 305 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, send\+\_\+onion\+\_\+request(), T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, and T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length.



Referenced by send\+\_\+tcp\+\_\+onion\+\_\+request().


\begin{DoxyCode}
307 \{
308     \textcolor{keywordflow}{if} (tcp\_connections\_number >= tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}) \{
309         \textcolor{keywordflow}{return} -1;
310     \}
311 
312     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[tcp\_connections\_number].\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} == 
      \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED}) \{
313         \textcolor{keywordtype}{int} ret = \hyperlink{_t_c_p__client_8c_a236ad67f85cc718a03fda2da3ade0787}{send\_onion\_request}(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[
      tcp\_connections\_number].\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
314 
315         \textcolor{keywordflow}{if} (ret == 1)
316             \textcolor{keywordflow}{return} 0;
317     \}
318 
319     \textcolor{keywordflow}{return} -1;
320 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_afb1a507e5f1af925b01666f1b9b4960a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_afb1a507e5f1af925b01666f1b9b4960a_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a5effabd83d700cccf9bcc51174f041f1}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+send\+\_\+oob\+\_\+packet@{tcp\+\_\+send\+\_\+oob\+\_\+packet}}
\index{tcp\+\_\+send\+\_\+oob\+\_\+packet@{tcp\+\_\+send\+\_\+oob\+\_\+packet}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+send\+\_\+oob\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int tcp\+\_\+send\+\_\+oob\+\_\+packet (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{unsigned int}]{tcp\+\_\+connections\+\_\+number, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+key, }
\item[{const uint8\+\_\+t $\ast$}]{packet, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{_t_c_p__connection_8c_a5effabd83d700cccf9bcc51174f041f1}


Definition at line 327 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connection, get\+\_\+tcp\+\_\+connection(), send\+\_\+oob\+\_\+packet(), T\+C\+P\+\_\+con\+::status, and T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D.



Referenced by tcp\+\_\+oob\+\_\+handle\+\_\+cookie\+\_\+request(), and tcp\+\_\+oobdata\+\_\+callback().


\begin{DoxyCode}
329 \{
330     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
331 
332     \textcolor{keywordflow}{if} (!tcp\_con)
333         \textcolor{keywordflow}{return} -1;
334 
335     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_ad03f35be6e73069ff02e6147cac6ce53}{TCP\_CONN\_CONNECTED})
336         \textcolor{keywordflow}{return} -1;
337 
338     \textcolor{keywordtype}{int} ret = \hyperlink{_t_c_p__client_8c_a7818a314434c2bb01c3ea406744f076b}{send\_oob\_packet}(tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, packet, length);
339 
340     \textcolor{keywordflow}{if} (ret == 1)
341         \textcolor{keywordflow}{return} 0;
342 
343     \textcolor{keywordflow}{return} -1;
344 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a5effabd83d700cccf9bcc51174f041f1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a5effabd83d700cccf9bcc51174f041f1_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_aa6d25d98f798099f4a7dd86ab93763ce}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!tcp\+\_\+status\+\_\+callback@{tcp\+\_\+status\+\_\+callback}}
\index{tcp\+\_\+status\+\_\+callback@{tcp\+\_\+status\+\_\+callback}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{tcp\+\_\+status\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}static int tcp\+\_\+status\+\_\+callback (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{object, }
\item[{uint32\+\_\+t}]{number, }
\item[{uint8\+\_\+t}]{connection\+\_\+id, }
\item[{uint8\+\_\+t}]{status}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_aa6d25d98f798099f4a7dd86ab93763ce}


Definition at line 847 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+object, T\+C\+P\+\_\+\+Client\+\_\+\+Connection\+::custom\+\_\+uint, get\+\_\+connection(), get\+\_\+tcp\+\_\+connection(), T\+C\+P\+\_\+con\+::lock\+\_\+count, set\+\_\+tcp\+\_\+connection\+\_\+status(), T\+C\+P\+\_\+con\+::sleep\+\_\+count, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+O\+N\+L\+I\+N\+E, and T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+R\+E\+G\+I\+S\+T\+E\+R\+E\+D.



Referenced by tcp\+\_\+relay\+\_\+set\+\_\+callbacks().


\begin{DoxyCode}
848 \{
849     \hyperlink{struct_t_c_p___client___connection}{TCP\_Client\_Connection} *TCP\_client\_con = object;
850     \hyperlink{struct_t_c_p___connections}{TCP\_Connections} *tcp\_c = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a5166a2d34403f1dafd1f23602df6c759}{custom\_object};
851 
852     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} tcp\_connections\_number = TCP\_client\_con->\hyperlink{struct_t_c_p___client___connection_a1f84a5213a1e59db55448dd696113bfc}{custom\_uint};
853     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
854     \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *con\_to = \hyperlink{_t_c_p__connection_8c_a95c3e01ee87339f2dc2e87646f464b51}{get\_connection}(tcp\_c, number);
855 
856     \textcolor{keywordflow}{if} (!con\_to || !tcp\_con)
857         \textcolor{keywordflow}{return} -1;
858 
859     \textcolor{keywordflow}{if} (status == 1) \{
860         \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{set\_tcp\_connection\_status}(con\_to, tcp\_connections\_number, 
      \hyperlink{_t_c_p__connection_8h_a02a1b8bb2ba492d94965efa057f8efcf}{TCP\_CONNECTIONS\_STATUS\_REGISTERED}, connection\_id) == -1)
861             \textcolor{keywordflow}{return} -1;
862 
863         --tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count};
864 
865         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
866             --tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count};
867         \}
868     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (status == 2) \{
869         \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_abadd381d40d2a16a44b9018cde55f51d}{set\_tcp\_connection\_status}(con\_to, tcp\_connections\_number, 
      \hyperlink{_t_c_p__connection_8h_a2cf312d6bf16e319e47793e92a5a68e7}{TCP\_CONNECTIONS\_STATUS\_ONLINE}, connection\_id) == -1)
870             \textcolor{keywordflow}{return} -1;
871 
872         ++tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count};
873 
874         \textcolor{keywordflow}{if} (con\_to->\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING}) \{
875             ++tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count};
876         \}
877     \}
878 
879     \textcolor{keywordflow}{return} 0;
880 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aa6d25d98f798099f4a7dd86ab93763ce_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_aa6d25d98f798099f4a7dd86ab93763ce_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a359cec296ed123fc92b9b149266b30a4}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!unsleep\+\_\+tcp\+\_\+relay\+\_\+connection@{unsleep\+\_\+tcp\+\_\+relay\+\_\+connection}}
\index{unsleep\+\_\+tcp\+\_\+relay\+\_\+connection@{unsleep\+\_\+tcp\+\_\+relay\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{unsleep\+\_\+tcp\+\_\+relay\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int unsleep\+\_\+tcp\+\_\+relay\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a359cec296ed123fc92b9b149266b30a4}


Definition at line 771 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+con\+::connected\+\_\+time, T\+C\+P\+\_\+con\+::connection, get\+\_\+tcp\+\_\+connection(), T\+C\+P\+\_\+con\+::ip\+\_\+port, kill\+\_\+tcp\+\_\+relay\+\_\+connection(), T\+C\+P\+\_\+con\+::lock\+\_\+count, new\+\_\+\+T\+C\+P\+\_\+connection(), T\+C\+P\+\_\+\+Connections\+::proxy\+\_\+info, T\+C\+P\+\_\+con\+::relay\+\_\+pk, T\+C\+P\+\_\+\+Connections\+::self\+\_\+public\+\_\+key, T\+C\+P\+\_\+\+Connections\+::self\+\_\+secret\+\_\+key, T\+C\+P\+\_\+con\+::sleep\+\_\+count, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+S\+L\+E\+E\+P\+I\+N\+G, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+V\+A\+L\+I\+D, and T\+C\+P\+\_\+con\+::unsleep.



Referenced by do\+\_\+tcp\+\_\+conns().


\begin{DoxyCode}
772 \{
773     \hyperlink{struct_t_c_p__con}{TCP\_con} *tcp\_con = \hyperlink{_t_c_p__connection_8c_ab051b2158958b954824dbed361ec588a}{get\_tcp\_connection}(tcp\_c, tcp\_connections\_number);
774 
775     \textcolor{keywordflow}{if} (!tcp\_con)
776         \textcolor{keywordflow}{return} -1;
777 
778     \textcolor{keywordflow}{if} (tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_a8a15453f40fe42efeff04f566e6082b0}{TCP\_CONN\_SLEEPING})
779         \textcolor{keywordflow}{return} -1;
780 
781     tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection} = \hyperlink{_t_c_p__client_8c_aedb0d5c54ac7754bb342517247ac632d}{new\_TCP\_connection}(tcp\_con->
      \hyperlink{struct_t_c_p__con_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}, tcp\_con->\hyperlink{struct_t_c_p__con_afd26506e572bfd335a3e7b498acd2902}{relay\_pk}, tcp\_c->\hyperlink{struct_t_c_p___connections_ae726df8bdc26380e5a6c3187a00d6881}{self\_public\_key},
782                           tcp\_c->\hyperlink{struct_t_c_p___connections_aa05050f86513ff53fe9da81f73c72267}{self\_secret\_key}, &tcp\_c->
      \hyperlink{struct_t_c_p___connections_aa737023350cf47e63993e3b4dc9a7472}{proxy\_info});
783 
784     \textcolor{keywordflow}{if} (!tcp\_con->\hyperlink{struct_t_c_p__con_a8ef08da0aa71c2a8a8d8bec587521844}{connection}) \{
785         \hyperlink{_t_c_p__connection_8c_aa2768924d23efbf6770245379d89da4c}{kill\_tcp\_relay\_connection}(tcp\_c, tcp\_connections\_number);
786         \textcolor{keywordflow}{return} -1;
787     \}
788 
789     tcp\_con->\hyperlink{struct_t_c_p__con_af2d7f68891e20ea9070cfc2d412867e1}{lock\_count} = 0;
790     tcp\_con->\hyperlink{struct_t_c_p__con_aa67ab512ed25830e7b9ea3c7069a9555}{sleep\_count} = 0;
791     tcp\_con->\hyperlink{struct_t_c_p__con_ae8be4bcb970c4f212e92c8f1598a1c41}{connected\_time} = 0;
792     tcp\_con->\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{_t_c_p__connection_8h_a447ebcd3dc85521248588470cb8d5c2c}{TCP\_CONN\_VALID};
793     tcp\_con->\hyperlink{struct_t_c_p__con_a32a5683291c18bbe710881445071d607}{unsleep} = 0;
794     \textcolor{keywordflow}{return} 0;
795 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a359cec296ed123fc92b9b149266b30a4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a359cec296ed123fc92b9b149266b30a4_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_a10a5b3ddc6f1bfa7785301f33c369695}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!wipe\+\_\+connection@{wipe\+\_\+connection}}
\index{wipe\+\_\+connection@{wipe\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{wipe\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int wipe\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_a10a5b3ddc6f1bfa7785301f33c369695}


Definition at line 133 of file T\+C\+P\+\_\+connection.\+c.



References T\+C\+P\+\_\+\+Connections\+::connections, T\+C\+P\+\_\+\+Connections\+::connections\+\_\+length, connections\+\_\+number\+\_\+not\+\_\+valid(), i, realloc\+\_\+tox\+\_\+array, T\+C\+P\+\_\+\+Connection\+\_\+to\+::status, and T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+N\+O\+N\+E.



Referenced by kill\+\_\+tcp\+\_\+connection\+\_\+to().


\begin{DoxyCode}
134 \{
135     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_aafa7b2a7f56b8f6bb0c1e44b9aec7262}{connections\_number\_not\_valid}(tcp\_c, connections\_number))
136         \textcolor{keywordflow}{return} -1;
137 
138     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
139     memset(&(tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[connections\_number]), 0 , \textcolor{keyword}{sizeof}(
      \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to}));
140 
141     \textcolor{keywordflow}{for} (i = tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}; i != 0; --i) \{
142         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}[i - 1].\hyperlink{struct_t_c_p___connection__to_ade818037fd6c985038ff29656089758d}{status} != \hyperlink{_t_c_p__connection_8h_ac0d2accad7ab0ed0ededf15e127d6f56}{TCP\_CONN\_NONE})
143             \textcolor{keywordflow}{break};
144     \}
145 
146     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length} != i) \{
147         tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length} = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
148         \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to} *temp\_pointer;
149         \hyperlink{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}{realloc\_tox\_array}(tcp\_c->\hyperlink{struct_t_c_p___connections_a191cfbdd509a2705455744965ccfd724}{connections}, \textcolor{keyword}{sizeof}(
      \hyperlink{struct_t_c_p___connection__to}{TCP\_Connection\_to}), tcp\_c->\hyperlink{struct_t_c_p___connections_a6c469b329395b7dfc09fc49900bf8f0d}{connections\_length}, temp\_pointer);
150     \}
151 
152     \textcolor{keywordflow}{return} 0;
153 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{d5/d26/_t_c_p__connection_8c_a10a5b3ddc6f1bfa7785301f33c369695_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_a10a5b3ddc6f1bfa7785301f33c369695_icgraph}
\end{center}
\end{figure}


\hypertarget{_t_c_p__connection_8c_add1161d338a19eca0bb42f242b543036}{\index{T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}!wipe\+\_\+tcp\+\_\+connection@{wipe\+\_\+tcp\+\_\+connection}}
\index{wipe\+\_\+tcp\+\_\+connection@{wipe\+\_\+tcp\+\_\+connection}!T\+C\+P\+\_\+connection.\+c@{T\+C\+P\+\_\+connection.\+c}}
\subsubsection[{wipe\+\_\+tcp\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}static int wipe\+\_\+tcp\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf T\+C\+P\+\_\+\+Connections} $\ast$}]{tcp\+\_\+c, }
\item[{int}]{tcp\+\_\+connections\+\_\+number}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{_t_c_p__connection_8c_add1161d338a19eca0bb42f242b543036}


Definition at line 160 of file T\+C\+P\+\_\+connection.\+c.



References i, realloc\+\_\+tox\+\_\+array, T\+C\+P\+\_\+con\+::status, T\+C\+P\+\_\+\+C\+O\+N\+N\+\_\+\+N\+O\+N\+E, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections, T\+C\+P\+\_\+\+Connections\+::tcp\+\_\+connections\+\_\+length, and tcp\+\_\+connections\+\_\+number\+\_\+not\+\_\+valid().



Referenced by kill\+\_\+tcp\+\_\+relay\+\_\+connection().


\begin{DoxyCode}
161 \{
162     \textcolor{keywordflow}{if} (\hyperlink{_t_c_p__connection_8c_ae8f5b59977d8d4221ff8da3922d257a5}{tcp\_connections\_number\_not\_valid}(tcp\_c, tcp\_connections\_number))
163         \textcolor{keywordflow}{return} -1;
164 
165     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
166     memset(&(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[tcp\_connections\_number]), 0 , \textcolor{keyword}{sizeof}(
      \hyperlink{struct_t_c_p__con}{TCP\_con}));
167 
168     \textcolor{keywordflow}{for} (i = tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}; i != 0; --i) \{
169         \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}[i - 1].\hyperlink{struct_t_c_p__con_ade818037fd6c985038ff29656089758d}{status} != 
      \hyperlink{_t_c_p__connection_8h_ac0d2accad7ab0ed0ededf15e127d6f56}{TCP\_CONN\_NONE})
170             \textcolor{keywordflow}{break};
171     \}
172 
173     \textcolor{keywordflow}{if} (tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length} != i) \{
174         tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length} = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
175         \hyperlink{struct_t_c_p__con}{TCP\_con} *temp\_pointer;
176         \hyperlink{_t_c_p__connection_8c_a3f335ac6fd27dea24086b5b7364b729d}{realloc\_tox\_array}(tcp\_c->\hyperlink{struct_t_c_p___connections_a600688b27d874e40eab4680fb90fa58a}{tcp\_connections}, \textcolor{keyword}{sizeof}(
      \hyperlink{struct_t_c_p__con}{TCP\_con}), tcp\_c->\hyperlink{struct_t_c_p___connections_aa1780d3567bf0105a493ce227133f810}{tcp\_connections\_length}, temp\_pointer);
177     \}
178 
179     \textcolor{keywordflow}{return} 0;
180 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{d5/d26/_t_c_p__connection_8c_add1161d338a19eca0bb42f242b543036_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d26/_t_c_p__connection_8c_add1161d338a19eca0bb42f242b543036_icgraph}
\end{center}
\end{figure}


