\hypertarget{assoc_8h}{\section{toxcore/assoc.h File Reference}
\label{assoc_8h}\index{toxcore/assoc.\+h@{toxcore/assoc.\+h}}
}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dd/d69/assoc_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_assoc__close__entries}{Assoc\+\_\+close\+\_\+entries}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{assoc_8h_abd791690b681175ce9d2975185e33825}{A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E}
\item 
\#define \hyperlink{assoc_8h_ab4aa21ae6dcbba80ec61b62f980725fe}{D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S}~44
\item 
\#define \hyperlink{assoc_8h_a60f209fd553fa95d0f6973b367b9b60c}{A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H}~45
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{struct_assoc}{Assoc} \hyperlink{assoc_8h_abf7b9aace92e8759dbbd66e4e308089f}{Assoc}
\item 
typedef int($\ast$ \hyperlink{assoc_8h_a4a7c48edbc47a30c9fa8c6fb0fe23817}{Assoc\+\_\+distance\+\_\+relative\+\_\+callback} )(const \hyperlink{struct_assoc}{Assoc} $\ast$assoc, void $\ast$callback\+\_\+data, const uint8\+\_\+t $\ast$client\+\_\+id, const uint8\+\_\+t $\ast$client\+\_\+id1, const uint8\+\_\+t $\ast$client\+\_\+id2)
\item 
typedef uint64\+\_\+t($\ast$ \hyperlink{assoc_8h_a0bac0791c4a8eac62f9f39c783da3b91}{Assoc\+\_\+distance\+\_\+absolute\+\_\+callback} )(const \hyperlink{struct_assoc}{Assoc} $\ast$assoc, void $\ast$callback\+\_\+data, const uint8\+\_\+t $\ast$client\+\_\+id\+\_\+ref, const uint8\+\_\+t $\ast$client\+\_\+id\+\_\+check)
\item 
typedef enum \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2c}{Assoc\+Close\+Entries\+Flags} \hyperlink{assoc_8h_a3a7067dfdc2190da597dd0ad9e7cc944}{Assoc\+Close\+Entries\+Flags}
\item 
typedef struct \hyperlink{struct_assoc__close__entries}{Assoc\+\_\+close\+\_\+entries} \hyperlink{assoc_8h_ac23315d028e4457f6a7f26dc9763be52}{Assoc\+\_\+close\+\_\+entries}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08d}{N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S} \{ \hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08dafe29bdbfb6e2165eec29bf28af429856}{B\+A\+D}, 
\hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08da296386fa8bc99fecd6d132a945cc7cee}{S\+E\+E\+N\+B\+\_\+\+H\+E\+A\+R\+D\+G}, 
\hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08dae87e1b5519c2bb23c5afac1d33653a99}{S\+E\+E\+N\+G}, 
\hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08da1e780c62cb3fd2edcac39f739bbe6f6c}{U\+S\+E\+D}
 \}
\item 
enum \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2c}{Assoc\+Close\+Entries\+Flags} \{ \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}{Proto\+I\+Pv4} = 1, 
\hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}{Proto\+I\+Pv6} = 2, 
\hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6}{L\+A\+N\+Ok} = 4
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \hyperlink{assoc_8h_aa0230ae0304fd8540a5bce578d242f30}{Assoc\+\_\+add\+\_\+entry} (\hyperlink{struct_assoc}{Assoc} $\ast$assoc, const uint8\+\_\+t $\ast$id, const \hyperlink{struct_i_p_p_ts}{I\+P\+P\+Ts} $\ast$ippts\+\_\+send, const \hyperlink{struct_i_p___port}{I\+P\+\_\+\+Port} $\ast$ipp\+\_\+recv, uint8\+\_\+t used)
\item 
uint8\+\_\+t \hyperlink{assoc_8h_ad8b38a62362a313e54af7ae07c36606f}{Assoc\+\_\+get\+\_\+close\+\_\+entries} (\hyperlink{struct_assoc}{Assoc} $\ast$assoc, \hyperlink{struct_assoc__close__entries}{Assoc\+\_\+close\+\_\+entries} $\ast$close\+\_\+entries)
\item 
\hyperlink{struct_assoc}{Assoc} $\ast$ \hyperlink{assoc_8h_ab7f978008ad6c86ab5063e989fe49d0c}{new\+\_\+\+Assoc\+\_\+default} (const uint8\+\_\+t $\ast$public\+\_\+id)
\item 
\hyperlink{struct_assoc}{Assoc} $\ast$ \hyperlink{assoc_8h_ae180bc47f7e0f171ed9bbedd7d50e416}{new\+\_\+\+Assoc} (size\+\_\+t bits, size\+\_\+t entries, const uint8\+\_\+t $\ast$public\+\_\+id)
\item 
void \hyperlink{assoc_8h_a0389b61e9667ab9e78ee87247b520689}{Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed} (\hyperlink{struct_assoc}{Assoc} $\ast$assoc, const uint8\+\_\+t $\ast$public\+\_\+id)
\item 
void \hyperlink{assoc_8h_a36aff33785fb0db2565cf4cb5b080327}{do\+\_\+\+Assoc} (\hyperlink{struct_assoc}{Assoc} $\ast$assoc, \hyperlink{struct_d_h_t}{D\+H\+T} $\ast$dht)
\item 
void \hyperlink{assoc_8h_a26d82e35d047181d0e883a4b91373793}{kill\+\_\+\+Assoc} (\hyperlink{struct_assoc}{Assoc} $\ast$assoc)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{assoc_8h_abd791690b681175ce9d2975185e33825}{\index{assoc.\+h@{assoc.\+h}!A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E@{A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E}}
\index{A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E@{A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E}!assoc.\+h@{assoc.\+h}}
\subsubsection[{A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+S\+S\+O\+C\+\_\+\+A\+V\+A\+I\+L\+A\+B\+L\+E}}\label{assoc_8h_abd791690b681175ce9d2975185e33825}


Definition at line 6 of file assoc.\+h.

\hypertarget{assoc_8h_a60f209fd553fa95d0f6973b367b9b60c}{\index{assoc.\+h@{assoc.\+h}!A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H@{A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H}}
\index{A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H@{A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H}!assoc.\+h@{assoc.\+h}}
\subsubsection[{A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H~45}}\label{assoc_8h_a60f209fd553fa95d0f6973b367b9b60c}


Definition at line 91 of file assoc.\+h.



Referenced by do\+\_\+\+Assoc().

\hypertarget{assoc_8h_ab4aa21ae6dcbba80ec61b62f980725fe}{\index{assoc.\+h@{assoc.\+h}!D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S@{D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S}}
\index{D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S@{D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S}!assoc.\+h@{assoc.\+h}}
\subsubsection[{D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+B\+I\+T\+S~44}}\label{assoc_8h_ab4aa21ae6dcbba80ec61b62f980725fe}


Definition at line 27 of file assoc.\+h.



Referenced by id\+\_\+distance().



\subsection{Typedef Documentation}
\hypertarget{assoc_8h_abf7b9aace92e8759dbbd66e4e308089f}{\index{assoc.\+h@{assoc.\+h}!Assoc@{Assoc}}
\index{Assoc@{Assoc}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Assoc} {\bf Assoc}}}\label{assoc_8h_abf7b9aace92e8759dbbd66e4e308089f}


Definition at line 18 of file assoc.\+h.

\hypertarget{assoc_8h_ac23315d028e4457f6a7f26dc9763be52}{\index{assoc.\+h@{assoc.\+h}!Assoc\+\_\+close\+\_\+entries@{Assoc\+\_\+close\+\_\+entries}}
\index{Assoc\+\_\+close\+\_\+entries@{Assoc\+\_\+close\+\_\+entries}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+\_\+close\+\_\+entries}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf Assoc\+\_\+close\+\_\+entries}  {\bf Assoc\+\_\+close\+\_\+entries}}}\label{assoc_8h_ac23315d028e4457f6a7f26dc9763be52}
\hypertarget{assoc_8h_a0bac0791c4a8eac62f9f39c783da3b91}{\index{assoc.\+h@{assoc.\+h}!Assoc\+\_\+distance\+\_\+absolute\+\_\+callback@{Assoc\+\_\+distance\+\_\+absolute\+\_\+callback}}
\index{Assoc\+\_\+distance\+\_\+absolute\+\_\+callback@{Assoc\+\_\+distance\+\_\+absolute\+\_\+callback}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+\_\+distance\+\_\+absolute\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}typedef uint64\+\_\+t($\ast$ Assoc\+\_\+distance\+\_\+absolute\+\_\+callback)(const {\bf Assoc} $\ast$assoc, void $\ast$callback\+\_\+data, const uint8\+\_\+t $\ast$client\+\_\+id\+\_\+ref, const uint8\+\_\+t $\ast$client\+\_\+id\+\_\+check)}}\label{assoc_8h_a0bac0791c4a8eac62f9f39c783da3b91}


Definition at line 31 of file assoc.\+h.

\hypertarget{assoc_8h_a4a7c48edbc47a30c9fa8c6fb0fe23817}{\index{assoc.\+h@{assoc.\+h}!Assoc\+\_\+distance\+\_\+relative\+\_\+callback@{Assoc\+\_\+distance\+\_\+relative\+\_\+callback}}
\index{Assoc\+\_\+distance\+\_\+relative\+\_\+callback@{Assoc\+\_\+distance\+\_\+relative\+\_\+callback}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+\_\+distance\+\_\+relative\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}typedef int($\ast$ Assoc\+\_\+distance\+\_\+relative\+\_\+callback)(const {\bf Assoc} $\ast$assoc, void $\ast$callback\+\_\+data, const uint8\+\_\+t $\ast$client\+\_\+id, const uint8\+\_\+t $\ast$client\+\_\+id1, const uint8\+\_\+t $\ast$client\+\_\+id2)}}\label{assoc_8h_a4a7c48edbc47a30c9fa8c6fb0fe23817}


Definition at line 24 of file assoc.\+h.

\hypertarget{assoc_8h_a3a7067dfdc2190da597dd0ad9e7cc944}{\index{assoc.\+h@{assoc.\+h}!Assoc\+Close\+Entries\+Flags@{Assoc\+Close\+Entries\+Flags}}
\index{Assoc\+Close\+Entries\+Flags@{Assoc\+Close\+Entries\+Flags}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+Close\+Entries\+Flags}]{\setlength{\rightskip}{0pt plus 5cm}typedef enum {\bf Assoc\+Close\+Entries\+Flags}  {\bf Assoc\+Close\+Entries\+Flags}}}\label{assoc_8h_a3a7067dfdc2190da597dd0ad9e7cc944}


\subsection{Enumeration Type Documentation}
\hypertarget{assoc_8h_a7b447edde2593107a52acfee89281d2c}{\index{assoc.\+h@{assoc.\+h}!Assoc\+Close\+Entries\+Flags@{Assoc\+Close\+Entries\+Flags}}
\index{Assoc\+Close\+Entries\+Flags@{Assoc\+Close\+Entries\+Flags}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+Close\+Entries\+Flags}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Assoc\+Close\+Entries\+Flags}}}\label{assoc_8h_a7b447edde2593107a52acfee89281d2c}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{Proto\+I\+Pv4@{Proto\+I\+Pv4}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!Proto\+I\+Pv4@{Proto\+I\+Pv4}}\item[{\em 
\hypertarget{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}{Proto\+I\+Pv4}\label{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}
}]\index{Proto\+I\+Pv6@{Proto\+I\+Pv6}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!Proto\+I\+Pv6@{Proto\+I\+Pv6}}\item[{\em 
\hypertarget{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}{Proto\+I\+Pv6}\label{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}
}]\index{L\+A\+N\+Ok@{L\+A\+N\+Ok}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!L\+A\+N\+Ok@{L\+A\+N\+Ok}}\item[{\em 
\hypertarget{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6}{L\+A\+N\+Ok}\label{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6}
}]\end{description}
\end{Desc}


Definition at line 43 of file assoc.\+h.


\begin{DoxyCode}
43                                     \{
44     \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}{ProtoIPv4} = 1,
45     \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}{ProtoIPv6} = 2,
46     \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6}{LANOk}     = 4,
47 \} \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2c}{AssocCloseEntriesFlags};
\end{DoxyCode}
\hypertarget{assoc_8h_ac1c014189853c6794e82c63012baa08d}{\index{assoc.\+h@{assoc.\+h}!N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S@{N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S}}
\index{N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S@{N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S}!assoc.\+h@{assoc.\+h}}
\subsubsection[{N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf N\+O\+D\+E\+\_\+\+S\+T\+A\+T\+U\+S}}}\label{assoc_8h_ac1c014189853c6794e82c63012baa08d}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{B\+A\+D@{B\+A\+D}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!B\+A\+D@{B\+A\+D}}\item[{\em 
\hypertarget{assoc_8h_ac1c014189853c6794e82c63012baa08dafe29bdbfb6e2165eec29bf28af429856}{B\+A\+D}\label{assoc_8h_ac1c014189853c6794e82c63012baa08dafe29bdbfb6e2165eec29bf28af429856}
}]\index{S\+E\+E\+N\+B\+\_\+\+H\+E\+A\+R\+D\+G@{S\+E\+E\+N\+B\+\_\+\+H\+E\+A\+R\+D\+G}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!S\+E\+E\+N\+B\+\_\+\+H\+E\+A\+R\+D\+G@{S\+E\+E\+N\+B\+\_\+\+H\+E\+A\+R\+D\+G}}\item[{\em 
\hypertarget{assoc_8h_ac1c014189853c6794e82c63012baa08da296386fa8bc99fecd6d132a945cc7cee}{S\+E\+E\+N\+B\+\_\+\+H\+E\+A\+R\+D\+G}\label{assoc_8h_ac1c014189853c6794e82c63012baa08da296386fa8bc99fecd6d132a945cc7cee}
}]\index{S\+E\+E\+N\+G@{S\+E\+E\+N\+G}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!S\+E\+E\+N\+G@{S\+E\+E\+N\+G}}\item[{\em 
\hypertarget{assoc_8h_ac1c014189853c6794e82c63012baa08dae87e1b5519c2bb23c5afac1d33653a99}{S\+E\+E\+N\+G}\label{assoc_8h_ac1c014189853c6794e82c63012baa08dae87e1b5519c2bb23c5afac1d33653a99}
}]\index{U\+S\+E\+D@{U\+S\+E\+D}!assoc.\+h@{assoc.\+h}}\index{assoc.\+h@{assoc.\+h}!U\+S\+E\+D@{U\+S\+E\+D}}\item[{\em 
\hypertarget{assoc_8h_ac1c014189853c6794e82c63012baa08da1e780c62cb3fd2edcac39f739bbe6f6c}{U\+S\+E\+D}\label{assoc_8h_ac1c014189853c6794e82c63012baa08da1e780c62cb3fd2edcac39f739bbe6f6c}
}]\end{description}
\end{Desc}


Definition at line 11 of file assoc.\+h.


\begin{DoxyCode}
11 \{ \hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08dafe29bdbfb6e2165eec29bf28af429856}{BAD}, \hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08da296386fa8bc99fecd6d132a945cc7cee}{SEENB\_HEARDG}, \hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08dae87e1b5519c2bb23c5afac1d33653a99}{SEENG}, \hyperlink{assoc_8h_ac1c014189853c6794e82c63012baa08da1e780c62cb3fd2edcac39f739bbe6f6c}{USED} \};
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{assoc_8h_aa0230ae0304fd8540a5bce578d242f30}{\index{assoc.\+h@{assoc.\+h}!Assoc\+\_\+add\+\_\+entry@{Assoc\+\_\+add\+\_\+entry}}
\index{Assoc\+\_\+add\+\_\+entry@{Assoc\+\_\+add\+\_\+entry}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+\_\+add\+\_\+entry}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t Assoc\+\_\+add\+\_\+entry (
\begin{DoxyParamCaption}
\item[{{\bf Assoc} $\ast$}]{assoc, }
\item[{const uint8\+\_\+t $\ast$}]{id, }
\item[{const {\bf I\+P\+P\+Ts} $\ast$}]{ippts\+\_\+send, }
\item[{const {\bf I\+P\+\_\+\+Port} $\ast$}]{ipp\+\_\+recv, }
\item[{uint8\+\_\+t}]{used}
\end{DoxyParamCaption}
)}}\label{assoc_8h_aa0230ae0304fd8540a5bce578d242f30}


Definition at line 552 of file assoc.\+c.



References candidates\+\_\+create\+\_\+new(), candidates\+\_\+search(), candidates\+\_\+update\+\_\+assoc(), client\+\_\+id\+\_\+self\+\_\+update(), id\+\_\+equal(), id\+\_\+hash(), I\+P\+P\+Ts\+::ip\+\_\+port, ipport\+\_\+isset(), Assoc\+::self\+\_\+client\+\_\+id, and Assoc\+::self\+\_\+hash.



Referenced by addto\+\_\+lists(), returnedip\+\_\+ports(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
553 \{
554     \textcolor{keywordflow}{if} (!assoc || !\textcolor{keywordtype}{id} || !ippts\_send)
555         \textcolor{keywordflow}{return} 0;
556 
557     \textcolor{keywordflow}{if} (!assoc->\hyperlink{struct_assoc_a6531d0c8e69576ae8c58a02914abaefe}{self\_hash}) \{
558         \hyperlink{assoc_8c_aa8781ddcd6a9240db73c39a2ff844d12}{client\_id\_self\_update}(assoc);
559 
560         \textcolor{keywordflow}{if} (!assoc->\hyperlink{struct_assoc_a6531d0c8e69576ae8c58a02914abaefe}{self\_hash})
561             \textcolor{keywordflow}{return} 0;
562     \}
563 
564     \textcolor{keywordflow}{if} (!\hyperlink{network_8c_a8436367218afb29bcf1b5fecd071648e}{ipport\_isset}(&ippts\_send->\hyperlink{struct_i_p_p_ts_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}))
565         \textcolor{keywordflow}{return} 0;
566 
567     \textcolor{keywordflow}{if} (ipp\_recv && !\hyperlink{network_8c_a8436367218afb29bcf1b5fecd071648e}{ipport\_isset}(ipp\_recv))
568         ipp\_recv = NULL;
569 
570     \hyperlink{assoc_8c_ac2d400520225f5a2aabf44895add81dc}{hash\_t} hash = \hyperlink{assoc_8c_a89ad0cf0f7d7c45e00c8bbdd66b56e95}{id\_hash}(assoc, \textcolor{keywordtype}{id});
571 
572     \textcolor{keywordflow}{if} (hash == assoc->\hyperlink{struct_assoc_a6531d0c8e69576ae8c58a02914abaefe}{self\_hash})
573         \textcolor{keywordflow}{if} (\hyperlink{util_8c_ada3d44b4f530d3c8c9cb69b732be94b1}{id\_equal}(\textcolor{keywordtype}{id}, assoc->\hyperlink{struct_assoc_a59ef97a1dbf10c89fb43f6fff2e65b39}{self\_client\_id}))
574             \textcolor{keywordflow}{return} 0;
575 
576     \textcolor{comment}{/* if it's new:}
577 \textcolor{comment}{     * callback, if there's desire, add to clients, else to candidates}
578 \textcolor{comment}{     *}
579 \textcolor{comment}{     * if it's "old":}
580 \textcolor{comment}{     *    if it's client: refresh}
581 \textcolor{comment}{     *    if it's candidate:}
582 \textcolor{comment}{     *       if !ipp\_recv, refresh}
583 \textcolor{comment}{     *       if ipp\_recv: callback, if there's desire, move to candidates}
584 \textcolor{comment}{     */}
585     \hyperlink{struct_client__entry}{Client\_entry} *cnd\_entry;
586 
587     \textcolor{keywordflow}{if} (!\hyperlink{assoc_8c_a7d1789e9568f82369268469130cff891}{candidates\_search}(assoc, \textcolor{keywordtype}{id}, hash, &cnd\_entry)) \{
588         \textcolor{keywordflow}{if} (\hyperlink{assoc_8c_aa745e9c0a5448ce04ab65c5156b4a531}{candidates\_create\_new}(assoc, hash, \textcolor{keywordtype}{id}, used, ippts\_send, ipp\_recv))
589             \textcolor{keywordflow}{return} 1;
590         \textcolor{keywordflow}{else}
591             \textcolor{keywordflow}{return} 0;
592     \} \textcolor{keywordflow}{else} \{
593         \hyperlink{assoc_8c_a12f651ee082f440e6efcff809958e005}{candidates\_update\_assoc}(assoc, cnd\_entry, used, ippts\_send, ipp\_recv);
594         \textcolor{keywordflow}{return} 2;
595     \}
596 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_aa0230ae0304fd8540a5bce578d242f30_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_aa0230ae0304fd8540a5bce578d242f30_icgraph}
\end{center}
\end{figure}


\hypertarget{assoc_8h_ad8b38a62362a313e54af7ae07c36606f}{\index{assoc.\+h@{assoc.\+h}!Assoc\+\_\+get\+\_\+close\+\_\+entries@{Assoc\+\_\+get\+\_\+close\+\_\+entries}}
\index{Assoc\+\_\+get\+\_\+close\+\_\+entries@{Assoc\+\_\+get\+\_\+close\+\_\+entries}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+\_\+get\+\_\+close\+\_\+entries}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t Assoc\+\_\+get\+\_\+close\+\_\+entries (
\begin{DoxyParamCaption}
\item[{{\bf Assoc} $\ast$}]{assoc, }
\item[{{\bf Assoc\+\_\+close\+\_\+entries} $\ast$}]{close\+\_\+entries}
\end{DoxyParamCaption}
)}}\label{assoc_8h_ad8b38a62362a313e54af7ae07c36606f}


Definition at line 602 of file assoc.\+c.



References Client\+\_\+data\+::assoc4, Client\+\_\+data\+::assoc6, assoc\+\_\+id\+\_\+closest(), B\+A\+D\+\_\+\+N\+O\+D\+E\+\_\+\+T\+I\+M\+E\+O\+U\+T, Assoc\+::candidates, Assoc\+::candidates\+\_\+bucket\+\_\+count, Assoc\+::candidates\+\_\+bucket\+\_\+size, Client\+\_\+entry\+::client, client\+\_\+id\+\_\+self\+\_\+update(), Assoc\+\_\+close\+\_\+entries\+::count\+\_\+good, Assoc\+\_\+close\+\_\+entries\+::custom\+\_\+data, dist\+\_\+index\+\_\+bubble(), dist\+\_\+index\+\_\+comp(), dist\+\_\+index\+\_\+entry(), Assoc\+\_\+close\+\_\+entries\+::distance\+\_\+absolute\+\_\+func, D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+I\+N\+D\+E\+X\+\_\+\+B\+I\+T\+S, D\+I\+S\+T\+A\+N\+C\+E\+\_\+\+I\+N\+D\+E\+X\+\_\+\+I\+N\+D\+E\+X\+\_\+\+M\+A\+S\+K, Assoc\+\_\+close\+\_\+entries\+::distance\+\_\+relative\+\_\+func, Assoc\+\_\+close\+\_\+entries\+::flags, Client\+\_\+entry\+::hash, i, id\+\_\+distance(), I\+P\+\_\+\+Port\+::ip, I\+P\+P\+Ts\+Png\+::ip\+\_\+port, ipport\+\_\+isset(), is\+\_\+timeout(), L\+A\+N\+\_\+ip(), L\+A\+N\+Ok, candidates\+\_\+bucket\+::list, Proto\+I\+Pv4, Proto\+I\+Pv6, Client\+\_\+data\+::public\+\_\+key, Assoc\+\_\+close\+\_\+entries\+::result, Client\+\_\+entry\+::seen\+\_\+at, Assoc\+::self\+\_\+hash, I\+P\+P\+Ts\+Png\+::timestamp, and Assoc\+\_\+close\+\_\+entries\+::wanted\+\_\+id.



Referenced by D\+H\+T\+\_\+addfriend(), get\+\_\+close\+\_\+nodes(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
603 \{
604     \textcolor{keywordflow}{if} (!assoc || !state || !state->wanted\_id || !state->result)
605         \textcolor{keywordflow}{return} 0;
606 
607     \textcolor{keywordflow}{if} (!assoc->\hyperlink{struct_assoc_a6531d0c8e69576ae8c58a02914abaefe}{self\_hash}) \{
608         \hyperlink{assoc_8c_aa8781ddcd6a9240db73c39a2ff844d12}{client\_id\_self\_update}(assoc);
609 
610         \textcolor{keywordflow}{if} (!assoc->\hyperlink{struct_assoc_a6531d0c8e69576ae8c58a02914abaefe}{self\_hash})
611             \textcolor{keywordflow}{return} 0;
612     \}
613 
614     \textcolor{keywordflow}{if} (!state->distance\_relative\_func)
615         state->distance\_relative\_func = \hyperlink{assoc_8c_ad78d05a8a1915614699da4704cd5641b}{assoc\_id\_closest};
616 
617     \textcolor{keywordflow}{if} (!state->distance\_absolute\_func)
618         state->distance\_absolute\_func = \hyperlink{assoc_8c_af9b9ca1f09c12f5ba91e06bf254e09f6}{id\_distance};
619 
620     \textcolor{keywordtype}{size\_t} dist\_list\_len = assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count} * assoc->
      \hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size};
621     uint64\_t dist\_list[dist\_list\_len];
622     memset(dist\_list, ~0, dist\_list\_len * \textcolor{keyword}{sizeof}(dist\_list[0]));
623     \hyperlink{assoc_8c_a870a9554cd560a551b3bb8229c684325}{bucket\_t} b;
624     \textcolor{keywordtype}{size\_t} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
625 
626     \textcolor{keywordflow}{for} (b = 0; b < assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}; b++) \{
627         \hyperlink{structcandidates__bucket}{candidates\_bucket} *cnd\_bckt = &assoc->\hyperlink{struct_assoc_a9d492ea4282a0aca2bcb32d987f58175}{candidates}[b];
628 
629         \textcolor{keywordflow}{for} (i = 0; i < assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size}; i++) \{
630             \hyperlink{struct_client__entry}{Client\_entry} *entry = &cnd\_bckt->\hyperlink{structcandidates__bucket_a515f2b5e53003e623b334ab90c4280e0}{list}[\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}];
631 
632             \textcolor{keywordflow}{if} (entry->\hyperlink{struct_client__entry_a35aa0f6864b81ef3de3d4d46ef823a0c}{hash}) \{
633                 \textcolor{keywordflow}{if} (state->flags & \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}{ProtoIPv4}) \{
634                     \textcolor{keywordflow}{if} (!\hyperlink{network_8c_a8436367218afb29bcf1b5fecd071648e}{ipport\_isset}(&entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_ac9843379cbcd02bdfa5c180a1474a6c5}{assoc4}.
      \hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}))
635                         \textcolor{keywordflow}{continue};
636 
637                     \textcolor{keywordflow}{if} (!(state->flags & \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6}{LANOk}))
638                         \textcolor{keywordflow}{if} (!\hyperlink{_l_a_n__discovery_8c_a2d80a53390598eb8ededbc63f4e9c152}{LAN\_ip}(entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_ac9843379cbcd02bdfa5c180a1474a6c5}{assoc4}.
      \hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}))
639                             \textcolor{keywordflow}{continue};
640                 \}
641 
642                 \textcolor{keywordflow}{if} (state->flags & \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}{ProtoIPv6}) \{
643                     \textcolor{keywordflow}{if} (!\hyperlink{network_8c_a8436367218afb29bcf1b5fecd071648e}{ipport\_isset}(&entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_a87d394929a2604f6f785fec949fac618}{assoc6}.
      \hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}))
644                         \textcolor{keywordflow}{continue};
645 
646                     \textcolor{keywordflow}{if} (!(state->flags & \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f8f3b5e55e2761eed576314ae2afaf6}{LANOk}))
647                         \textcolor{keywordflow}{if} (!\hyperlink{_l_a_n__discovery_8c_a2d80a53390598eb8ededbc63f4e9c152}{LAN\_ip}(entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_a87d394929a2604f6f785fec949fac618}{assoc6}.
      \hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}))
648                             \textcolor{keywordflow}{continue};
649                 \}
650 
651                 uint64\_t dist = state->distance\_absolute\_func(assoc, state->custom\_data, state->wanted\_id, 
      entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key});
652                 uint32\_t index = b * assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size} + 
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
653                 dist\_list[index] = (dist << \hyperlink{assoc_8c_a2e1d880acaeb435b8dc3c55206545aeb}{DISTANCE\_INDEX\_INDEX\_BITS}) | index;
654             \}
655         \}
656     \}
657 
658     qsort(dist\_list, dist\_list\_len, \textcolor{keyword}{sizeof}(dist\_list[0]), \hyperlink{assoc_8c_afe8472c27f16e873da0fa3a6995c1197}{dist\_index\_comp});
659 
660     \textcolor{comment}{/* ok, ok, it's not *perfectly* sorted, because we used an absolute distance}
661 \textcolor{comment}{     * go over the result and see if we need to "smoothen things out"}
662 \textcolor{comment}{     * because those should be only very few and short streaks, the worst regularly}
663 \textcolor{comment}{     * used sorting function aka bubble sort is used */}
664     uint64\_t dist\_prev = ~0;
665     \textcolor{keywordtype}{size\_t} ind\_prev = ~0, ind\_curr;
666     \textcolor{keywordtype}{size\_t} len = 1;
667 
668     \textcolor{keywordflow}{for} (ind\_curr = 0; ind\_curr < dist\_list\_len; ind\_curr++) \{
669         \textcolor{comment}{/* sorted increasingly, so an invalid entry marks the end */}
670         \textcolor{keywordflow}{if} ((dist\_list[ind\_curr] & \hyperlink{assoc_8c_a8d6efce995b5d21adfd794b9c8bfde10}{DISTANCE\_INDEX\_INDEX\_MASK}) == 
      DISTANCE\_INDEX\_INDEX\_MASK)
671             \textcolor{keywordflow}{break};
672 
673         uint64\_t dist\_curr = dist\_list[ind\_curr] >> \hyperlink{assoc_8c_a2e1d880acaeb435b8dc3c55206545aeb}{DISTANCE\_INDEX\_INDEX\_BITS};
674 
675         \textcolor{keywordflow}{if} (dist\_prev == dist\_curr)
676             len++;
677         \textcolor{keywordflow}{else} \{
678             \textcolor{keywordflow}{if} (len > 1)
679                 \hyperlink{assoc_8c_a9419b231b388fff46f176830c4b9a52f}{dist\_index\_bubble}(assoc, dist\_list, ind\_prev, ind\_curr - 1, state->
      wanted\_id, state->custom\_data,
680                                   state->distance\_relative\_func);
681 
682             dist\_prev = dist\_curr;
683             ind\_prev = ind\_curr;
684             len = 1;
685         \}
686     \}
687 
688     \textcolor{keywordflow}{if} (len > 1)
689         \hyperlink{assoc_8c_a9419b231b388fff46f176830c4b9a52f}{dist\_index\_bubble}(assoc, dist\_list, ind\_prev, ind\_curr - 1, state->wanted\_id, 
      state->custom\_data,
690                           state->distance\_relative\_func);
691 
692     \textcolor{comment}{/* ok, now dist\_list is a strictly ascending sorted list of nodes}
693 \textcolor{comment}{     * a) extract CLOSE\_QUOTA\_USED clients, not timed out}
694 \textcolor{comment}{     * b) extract (1 - QUOTA) (better!) clients & candidates, not timed out}
695 \textcolor{comment}{     * c) save candidates which would be better, if contact can be established */}
696     \textcolor{keywordtype}{size\_t} client\_quota\_good = 0, pos = 0;
697     \textcolor{keywordtype}{size\_t} client\_quota\_max = state->count\_good;
698 
699     ssize\_t taken\_last = - 1;
700 
701     \textcolor{keywordflow}{for} (i = 0; (i < dist\_list\_len) && (pos < state->count); i++) \{
702         \textcolor{comment}{/* sorted increasingly, so an invalid entry marks the end */}
703         \textcolor{keywordflow}{if} ((dist\_list[i] & DISTANCE\_INDEX\_INDEX\_MASK) == 
      \hyperlink{assoc_8c_a8d6efce995b5d21adfd794b9c8bfde10}{DISTANCE\_INDEX\_INDEX\_MASK})
704             \textcolor{keywordflow}{break};
705 
706         \hyperlink{struct_client__entry}{Client\_entry} *entry = \hyperlink{assoc_8c_a07e9e64cd1b39d0dc9259d998e52f1ab}{dist\_index\_entry}(assoc, dist\_list[i]);
707 
708         \textcolor{keywordflow}{if} (entry && entry->\hyperlink{struct_client__entry_a35aa0f6864b81ef3de3d4d46ef823a0c}{hash}) \{
709             \textcolor{keywordflow}{if} (client\_quota\_good >= client\_quota\_max) \{
710                 state->result[pos++] = &entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client};
711                 taken\_last = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
712             \} \textcolor{keywordflow}{else} \{
713                 \textcolor{keywordflow}{if} (state->flags & (\hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}{ProtoIPv4} | \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}{ProtoIPv6})) \{
714                     \textcolor{keywordflow}{if} ((state->flags & \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca8f72d319431bcfbaf2fb152a649d090c}{ProtoIPv4}) && \hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(entry->
      \hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_ac9843379cbcd02bdfa5c180a1474a6c5}{assoc4}.\hyperlink{struct_i_p_p_ts_png_a465bef81f6478756e5443025b1f2ddfa}{timestamp}, \hyperlink{_d_h_t_8h_a2c542fd03a43f340d1fb281afe54453f}{BAD\_NODE\_TIMEOUT}))
715                         \textcolor{keywordflow}{continue};
716 
717                     \textcolor{keywordflow}{if} ((state->flags & \hyperlink{assoc_8h_a7b447edde2593107a52acfee89281d2ca1e654e12e0aea9fe657086a3c3ed9eca}{ProtoIPv6}) && \hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(entry->
      \hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_a87d394929a2604f6f785fec949fac618}{assoc6}.\hyperlink{struct_i_p_p_ts_png_a465bef81f6478756e5443025b1f2ddfa}{timestamp}, \hyperlink{_d_h_t_8h_a2c542fd03a43f340d1fb281afe54453f}{BAD\_NODE\_TIMEOUT}))
718                         \textcolor{keywordflow}{continue};
719                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(entry->\hyperlink{struct_client__entry_ab632ae1b8a283a06d6cb3881c377c6cd}{seen\_at}, 
      \hyperlink{_d_h_t_8h_a2c542fd03a43f340d1fb281afe54453f}{BAD\_NODE\_TIMEOUT}))
720                     \textcolor{keywordflow}{continue};
721 
722                 state->result[pos++] = &entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client};
723                 client\_quota\_good++;
724                 taken\_last = \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
725             \}
726         \}
727     \}
728 
729     \textcolor{comment}{/* if we had not enough valid entries the list might still not be filled.}
730 \textcolor{comment}{     *}
731 \textcolor{comment}{     * start again from last taken client, but leave out any requirement}
732 \textcolor{comment}{     */}
733     \textcolor{keywordflow}{if} (pos < state->count) \{
734         \textcolor{keywordflow}{for} (i = taken\_last + 1; (i < dist\_list\_len) && (pos < state->count); i++) \{
735             \textcolor{comment}{/* sorted increasingly, so an invalid entry marks the end */}
736             \textcolor{keywordflow}{if} ((dist\_list[i] & DISTANCE\_INDEX\_INDEX\_MASK) == 
      \hyperlink{assoc_8c_a8d6efce995b5d21adfd794b9c8bfde10}{DISTANCE\_INDEX\_INDEX\_MASK})
737                 \textcolor{keywordflow}{break};
738 
739             \hyperlink{struct_client__entry}{Client\_entry} *entry = \hyperlink{assoc_8c_a07e9e64cd1b39d0dc9259d998e52f1ab}{dist\_index\_entry}(assoc, dist\_list[i]);
740 
741             \textcolor{keywordflow}{if} (entry && entry->\hyperlink{struct_client__entry_a35aa0f6864b81ef3de3d4d46ef823a0c}{hash})
742                 state->result[pos++] = &entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client};
743         \}
744     \}
745 
746     \textcolor{keywordflow}{return} pos;
747 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_ad8b38a62362a313e54af7ae07c36606f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_ad8b38a62362a313e54af7ae07c36606f_icgraph}
\end{center}
\end{figure}


\hypertarget{assoc_8h_a0389b61e9667ab9e78ee87247b520689}{\index{assoc.\+h@{assoc.\+h}!Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed@{Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed}}
\index{Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed@{Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed}!assoc.\+h@{assoc.\+h}}
\subsubsection[{Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed}]{\setlength{\rightskip}{0pt plus 5cm}void Assoc\+\_\+self\+\_\+client\+\_\+id\+\_\+changed (
\begin{DoxyParamCaption}
\item[{{\bf Assoc} $\ast$}]{assoc, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+id}
\end{DoxyParamCaption}
)}}\label{assoc_8h_a0389b61e9667ab9e78ee87247b520689}


Definition at line 872 of file assoc.\+c.



References client\+\_\+id\+\_\+self\+\_\+update(), id\+\_\+copy(), Assoc\+::self\+\_\+client\+\_\+id, and Assoc\+::self\+\_\+hash.


\begin{DoxyCode}
873 \{
874     \textcolor{keywordflow}{if} (assoc && \textcolor{keywordtype}{id}) \{
875         assoc->\hyperlink{struct_assoc_a6531d0c8e69576ae8c58a02914abaefe}{self\_hash} = 0;
876         \hyperlink{util_8c_aa30049b8c1d82c280d6d872feea3353b}{id\_copy}(assoc->\hyperlink{struct_assoc_a59ef97a1dbf10c89fb43f6fff2e65b39}{self\_client\_id}, \textcolor{keywordtype}{id});
877         \hyperlink{assoc_8c_aa8781ddcd6a9240db73c39a2ff844d12}{client\_id\_self\_update}(assoc);
878     \}
879 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_a0389b61e9667ab9e78ee87247b520689_cgraph}
\end{center}
\end{figure}


\hypertarget{assoc_8h_a36aff33785fb0db2565cf4cb5b080327}{\index{assoc.\+h@{assoc.\+h}!do\+\_\+\+Assoc@{do\+\_\+\+Assoc}}
\index{do\+\_\+\+Assoc@{do\+\_\+\+Assoc}!assoc.\+h@{assoc.\+h}}
\subsubsection[{do\+\_\+\+Assoc}]{\setlength{\rightskip}{0pt plus 5cm}void do\+\_\+\+Assoc (
\begin{DoxyParamCaption}
\item[{{\bf Assoc} $\ast$}]{assoc, }
\item[{{\bf D\+H\+T} $\ast$}]{dht}
\end{DoxyParamCaption}
)}}\label{assoc_8h_a36aff33785fb0db2565cf4cb5b080327}


Definition at line 886 of file assoc.\+c.



References A\+S\+S\+O\+C\+\_\+\+B\+U\+C\+K\+E\+T\+\_\+\+R\+E\+F\+R\+E\+S\+H, Assoc\+::candidates, Assoc\+::candidates\+\_\+bucket\+\_\+count, Assoc\+::candidates\+\_\+bucket\+\_\+size, C\+A\+N\+D\+I\+D\+A\+T\+E\+S\+\_\+\+H\+E\+A\+R\+D\+\_\+\+T\+I\+M\+E\+O\+U\+T, C\+A\+N\+D\+I\+D\+A\+T\+E\+S\+\_\+\+S\+E\+E\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T, Client\+\_\+entry\+::client, D\+H\+T\+\_\+getnodes(), for(), Client\+\_\+entry\+::getnodes, Assoc\+::getnodes, Client\+\_\+entry\+::hash, Client\+\_\+entry\+::heard\+\_\+at, i, I\+P\+\_\+\+Port\+::ip, ip\+\_\+ntoa(), I\+P\+P\+Ts\+Png\+::ip\+\_\+port, is\+\_\+timeout(), candidates\+\_\+bucket\+::list, L\+O\+G\+G\+E\+R\+\_\+\+D\+E\+B\+U\+G, L\+O\+G\+G\+E\+R\+\_\+\+S\+C\+O\+P\+E, m, I\+P\+\_\+\+Port\+::port, Client\+\_\+data\+::public\+\_\+key, Client\+\_\+entry\+::seen\+\_\+at, and unix\+\_\+time().



Referenced by do\+\_\+\+D\+H\+T().


\begin{DoxyCode}
887 \{
888     \textcolor{keywordflow}{if} (\hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(assoc->\hyperlink{struct_assoc_aec732782691c39a31d8c579a79a8fed2}{getnodes}, \hyperlink{assoc_8h_a60f209fd553fa95d0f6973b367b9b60c}{ASSOC\_BUCKET\_REFRESH})) \{
889         assoc->\hyperlink{struct_assoc_aec732782691c39a31d8c579a79a8fed2}{getnodes} = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
890 
891         \textcolor{keywordtype}{size\_t} candidate = (rand() % assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}) + assoc->
      \hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count};
892 
893         \textcolor{comment}{/* in that bucket or the buckets closest to it:}
894 \textcolor{comment}{         * find the best heard candidate}
895 \textcolor{comment}{         * find the best seen candidate}
896 \textcolor{comment}{         * send getnode() requests to both */}
897         uint8\_t *target\_id = NULL;
898         \hyperlink{struct_client__entry}{Client\_entry} *heard = NULL, *seen = NULL;
899         \textcolor{keywordtype}{size\_t} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}, k, \hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m};
900 
901         \hyperlink{toxav__many__test_8c_a8799beff27c0e5459ef50f9ca1efe92c}{for} (i = 1; i < assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}; i++) \{
902             \textcolor{keywordflow}{if} (i % 2)
903                 k = - (i >> 1);
904             \textcolor{keywordflow}{else}
905                 k = i >> 1;
906 
907             \textcolor{keywordtype}{size\_t} bckt = (candidate + k) % assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count};
908 
909             \hyperlink{toxav__many__test_8c_a8799beff27c0e5459ef50f9ca1efe92c}{for} (\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} = 0; \hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m} < assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size}; 
      \hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}++)
910                 \textcolor{keywordflow}{if} (assoc->\hyperlink{struct_assoc_a9d492ea4282a0aca2bcb32d987f58175}{candidates}[bckt].\hyperlink{structcandidates__bucket_a515f2b5e53003e623b334ab90c4280e0}{list}[\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}].\hyperlink{struct_client__entry_a35aa0f6864b81ef3de3d4d46ef823a0c}{hash}) \{
911                     \hyperlink{struct_client__entry}{Client\_entry} *entry = &assoc->\hyperlink{struct_assoc_a9d492ea4282a0aca2bcb32d987f58175}{candidates}[bckt].
      \hyperlink{structcandidates__bucket_a515f2b5e53003e623b334ab90c4280e0}{list}[\hyperlink{messenger__test_8c_aea6eb6c7c30a659f1b0dee83eaf03ea2}{m}];
912 
913                     \textcolor{keywordflow}{if} (!\hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(entry->\hyperlink{struct_client__entry_aec732782691c39a31d8c579a79a8fed2}{getnodes}, 
      \hyperlink{assoc_8c_a9bb69b73619cccc40c0aa09c227f2bce}{CANDIDATES\_SEEN\_TIMEOUT}))
914                         \textcolor{keywordflow}{continue};
915 
916                     \textcolor{keywordflow}{if} (!target\_id)
917                         target\_id = entry->\hyperlink{struct_client__entry_a114cded03654e9d27771e24fa1712e39}{client}.\hyperlink{struct_client__data_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key};
918 
919                     \textcolor{keywordflow}{if} (entry->\hyperlink{struct_client__entry_ab632ae1b8a283a06d6cb3881c377c6cd}{seen\_at}) \{
920                         \textcolor{keywordflow}{if} (!seen)
921                             \textcolor{keywordflow}{if} (!\hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(entry->\hyperlink{struct_client__entry_ab632ae1b8a283a06d6cb3881c377c6cd}{seen\_at}, 
      \hyperlink{assoc_8c_a9bb69b73619cccc40c0aa09c227f2bce}{CANDIDATES\_SEEN\_TIMEOUT}))
922                                 seen = entry;
923                     \}
924 
925                     \textcolor{keywordflow}{if} (entry->\hyperlink{struct_client__entry_a0886ba8c555aa6352f2dbf0606636f13}{heard\_at}) \{
926                         \textcolor{keywordflow}{if} (!heard)
927                             \textcolor{keywordflow}{if} (!\hyperlink{util_8c_ab643c84141e04b54ba650c50165ba288}{is\_timeout}(entry->\hyperlink{struct_client__entry_a0886ba8c555aa6352f2dbf0606636f13}{heard\_at}, 
      \hyperlink{assoc_8c_ace4ac45ae9f3a8310f57d6ddbdf051ee}{CANDIDATES\_HEARD\_TIMEOUT}))
928                                 heard = entry;
929                     \}
930 
931                     \textcolor{keywordflow}{if} (seen && heard)
932                         \textcolor{keywordflow}{break};
933                 \}
934 
935             \textcolor{keywordflow}{if} (seen && heard)
936                 \textcolor{keywordflow}{break};
937         \}
938 
939         \textcolor{keywordflow}{if} (seen) \{
940             \hyperlink{struct_i_p_p_ts_png}{IPPTsPng} *ippts = seen->seen\_family == AF\_INET ? &seen->client.assoc4 : &seen->client.
      assoc6;
941 
942             \hyperlink{logger_8h_a9885ca09ce5f94d936c91a5b0856a024}{LOGGER\_DEBUG}(\textcolor{stringliteral}{"[%u] => S[%s...] %s:%u"}, (uint32\_t)(candidate % assoc->
      \hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}),
943                          idpart2str(seen->client.public\_key, 8), \hyperlink{network_8c_af71f49c78ce7b76ccf08785c6ec08706}{ip\_ntoa}(&ippts->
      \hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}), htons(ippts->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a8e0798404bf2cf5dabb84c5ba9a4f236}{port}));
944 
945             \hyperlink{_d_h_t_8c_a769ef744f969e1b4c55547cb74abee59}{DHT\_getnodes}(dht, &ippts->\hyperlink{struct_i_p_p_ts_png_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}, seen->client.public\_key, target\_id);
946             seen->getnodes = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
947         \}
948 
949         \textcolor{keywordflow}{if} (heard && (heard != seen)) \{
950             \hyperlink{struct_i_p___port}{IP\_Port} *ipp = heard->heard\_family == AF\_INET ? &heard->assoc\_heard4 : &heard->
      assoc\_heard6;
951 
952             \hyperlink{logger_8h_a9885ca09ce5f94d936c91a5b0856a024}{LOGGER\_DEBUG}(\textcolor{stringliteral}{"[%u] => H[%s...] %s:%u"}, (uint32\_t)(candidate % assoc->
      \hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}),
953                          idpart2str(heard->client.public\_key, 8), \hyperlink{network_8c_af71f49c78ce7b76ccf08785c6ec08706}{ip\_ntoa}(&ipp->
      \hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}), htons(ipp->\hyperlink{struct_i_p___port_a8e0798404bf2cf5dabb84c5ba9a4f236}{port}));
954 
955             \hyperlink{_d_h_t_8c_a769ef744f969e1b4c55547cb74abee59}{DHT\_getnodes}(dht, ipp, heard->client.public\_key, target\_id);
956             heard->getnodes = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
957         \}
958 
959         \hyperlink{logger_8h_a3c9976e3ba8401ba5a2117ee6297c669}{LOGGER\_SCOPE} (
960 
961             \textcolor{keywordflow}{if} ( !heard && !seen )
962             \hyperlink{logger_8h_a9885ca09ce5f94d936c91a5b0856a024}{LOGGER\_DEBUG}(\textcolor{stringliteral}{"[%u] => no nodes to talk to??"}, (uint32\_t)(candidate % assoc->
      \hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}));
963         );
964     \}
965 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_a36aff33785fb0db2565cf4cb5b080327_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_a36aff33785fb0db2565cf4cb5b080327_icgraph}
\end{center}
\end{figure}


\hypertarget{assoc_8h_a26d82e35d047181d0e883a4b91373793}{\index{assoc.\+h@{assoc.\+h}!kill\+\_\+\+Assoc@{kill\+\_\+\+Assoc}}
\index{kill\+\_\+\+Assoc@{kill\+\_\+\+Assoc}!assoc.\+h@{assoc.\+h}}
\subsubsection[{kill\+\_\+\+Assoc}]{\setlength{\rightskip}{0pt plus 5cm}void kill\+\_\+\+Assoc (
\begin{DoxyParamCaption}
\item[{{\bf Assoc} $\ast$}]{assoc}
\end{DoxyParamCaption}
)}}\label{assoc_8h_a26d82e35d047181d0e883a4b91373793}


Definition at line 968 of file assoc.\+c.



References Assoc\+::candidates, and candidates\+\_\+bucket\+::list.



Referenced by kill\+\_\+\+D\+H\+T(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
969 \{
970     \textcolor{keywordflow}{if} (assoc) \{
971         free(assoc->\hyperlink{struct_assoc_a9d492ea4282a0aca2bcb32d987f58175}{candidates}->\hyperlink{structcandidates__bucket_a515f2b5e53003e623b334ab90c4280e0}{list});
972         free(assoc->\hyperlink{struct_assoc_a9d492ea4282a0aca2bcb32d987f58175}{candidates});
973         free(assoc);
974     \}
975 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_a26d82e35d047181d0e883a4b91373793_icgraph}
\end{center}
\end{figure}


\hypertarget{assoc_8h_ae180bc47f7e0f171ed9bbedd7d50e416}{\index{assoc.\+h@{assoc.\+h}!new\+\_\+\+Assoc@{new\+\_\+\+Assoc}}
\index{new\+\_\+\+Assoc@{new\+\_\+\+Assoc}!assoc.\+h@{assoc.\+h}}
\subsubsection[{new\+\_\+\+Assoc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Assoc}$\ast$ new\+\_\+\+Assoc (
\begin{DoxyParamCaption}
\item[{size\+\_\+t}]{bits, }
\item[{size\+\_\+t}]{entries, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+id}
\end{DoxyParamCaption}
)}}\label{assoc_8h_ae180bc47f7e0f171ed9bbedd7d50e416}


Definition at line 779 of file assoc.\+c.



References Assoc\+::candidates, Assoc\+::candidates\+\_\+bucket\+\_\+bits, Assoc\+::candidates\+\_\+bucket\+\_\+count, Assoc\+::candidates\+\_\+bucket\+\_\+size, client\+\_\+id\+\_\+self\+\_\+update(), Assoc\+::getnodes, Client\+\_\+entry\+::hash, H\+A\+S\+H\+\_\+\+C\+O\+L\+L\+I\+D\+E\+\_\+\+P\+R\+I\+M\+E, id\+\_\+copy(), candidates\+\_\+bucket\+::list, L\+O\+G\+G\+E\+R\+\_\+\+D\+E\+B\+U\+G, prime\+\_\+upto\+\_\+min9(), Assoc\+::self\+\_\+client\+\_\+id, and unix\+\_\+time().



Referenced by new\+\_\+\+Assoc\+\_\+default(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
780 \{
781     \textcolor{keywordflow}{if} (!public\_id)
782         \textcolor{keywordflow}{return} NULL;
783 
784     \hyperlink{struct_assoc}{Assoc} *assoc = calloc(1, \textcolor{keyword}{sizeof}(*assoc));
785 
786     \textcolor{keywordflow}{if} (!assoc)
787         \textcolor{keywordflow}{return} NULL;
788 
789     \textcolor{comment}{/*}
790 \textcolor{comment}{     * bits must be in [ 2 .. 15 ]}
791 \textcolor{comment}{     * entries must be a prime}
792 \textcolor{comment}{     */}
793     \textcolor{keywordflow}{if} (bits < 2)
794         bits = 2;
795     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (bits > 15)
796         bits = 15;
797 
798     assoc->\hyperlink{struct_assoc_ab4153986e9b7dd71547967436299a424}{candidates\_bucket\_bits} = bits;
799     assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count} = 1U << bits;
800 
801     \textcolor{keywordflow}{if} (entries < 25) \{
802         \textcolor{keywordflow}{if} (entries <= 6)
803             entries = 5;
804         \textcolor{keywordflow}{else} \{
805             entries = entries - (1 - (entries % 2)); \textcolor{comment}{/* even => odd */}
806 
807             \textcolor{comment}{/* 7..23: all odds but 9&15 are prime */}
808             \textcolor{keywordflow}{if} (!(entries % 3)) \textcolor{comment}{/* 9, 15 */}
809                 entries -= 2;   \textcolor{comment}{/* 7, 13 */}
810         \}
811     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (entries > ((1 << 17) - 1)) \textcolor{comment}{/* 130k+ */}
812         entries = (1 << 17) - 1;
813     \textcolor{keywordflow}{else} \{
814         \textcolor{comment}{/* 9+: test and find a prime less or equal */}
815         \textcolor{keywordtype}{size\_t} entries\_test = \hyperlink{assoc_8c_a03b6b225cc18ca1fbabbc77e5248a743}{prime\_upto\_min9}(entries);
816 
817         \textcolor{keywordflow}{if} (entries\_test == \hyperlink{assoc_8c_a1899251b38a7a195f127d3d2d9d387e2}{HASH\_COLLIDE\_PRIME}) \textcolor{comment}{/* disallowed */}
818             entries\_test = \hyperlink{assoc_8c_a03b6b225cc18ca1fbabbc77e5248a743}{prime\_upto\_min9}(entries\_test - 1);
819 
820         \textcolor{keywordflow}{if} (entries\_test != entries) \{
821 
822             \hyperlink{logger_8h_a9885ca09ce5f94d936c91a5b0856a024}{LOGGER\_DEBUG}(\textcolor{stringliteral}{"trimmed %i to %i.\(\backslash\)n"}, (\textcolor{keywordtype}{int})entries, (\textcolor{keywordtype}{int})entries\_test);
823             entries = (size\_t)entries\_test;
824         \}
825     \}
826 
827     assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size} = entries;
828 
829     \textcolor{comment}{/* allocation: preferably few blobs */}
830     \textcolor{keywordtype}{size\_t} bckt, cix;
831     \hyperlink{struct_client__entry}{Client\_entry} *clients = malloc(\textcolor{keyword}{sizeof}(*clients) * assoc->
      \hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count} * assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size});
832 
833     \textcolor{keywordflow}{if} (!clients) \{
834         free(assoc);
835         \textcolor{keywordflow}{return} NULL;
836     \}
837 
838     \hyperlink{structcandidates__bucket}{candidates\_bucket} *lists = malloc(\textcolor{keyword}{sizeof}(*lists) * assoc->
      \hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count});
839 
840     \textcolor{keywordflow}{if} (!lists) \{
841         free(assoc);
842         free(clients);
843         \textcolor{keywordflow}{return} NULL;
844     \}
845 
846     \textcolor{keywordflow}{for} (bckt = 0; bckt < assoc->\hyperlink{struct_assoc_a22dd0674eae131fab27462b931d4397c}{candidates\_bucket\_count}; bckt++) \{
847         \hyperlink{structcandidates__bucket}{candidates\_bucket} *list = &lists[bckt];
848 
849         list->\hyperlink{structcandidates__bucket_a515f2b5e53003e623b334ab90c4280e0}{list} = &clients[bckt * assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size}];
850 
851         \textcolor{keywordflow}{for} (cix = 0; cix < assoc->\hyperlink{struct_assoc_a9349f5b3095733f74b3704aa9766a05a}{candidates\_bucket\_size}; cix++)
852             list->\hyperlink{structcandidates__bucket_a515f2b5e53003e623b334ab90c4280e0}{list}[cix].\hyperlink{struct_client__entry_a35aa0f6864b81ef3de3d4d46ef823a0c}{hash} = 0;
853     \}
854 
855     assoc->\hyperlink{struct_assoc_a9d492ea4282a0aca2bcb32d987f58175}{candidates} = lists;
856     assoc->\hyperlink{struct_assoc_aec732782691c39a31d8c579a79a8fed2}{getnodes} = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
857 
858     \hyperlink{util_8c_aa30049b8c1d82c280d6d872feea3353b}{id\_copy}(assoc->\hyperlink{struct_assoc_a59ef97a1dbf10c89fb43f6fff2e65b39}{self\_client\_id}, public\_id);
859     \hyperlink{assoc_8c_aa8781ddcd6a9240db73c39a2ff844d12}{client\_id\_self\_update}(assoc);
860 
861     \textcolor{keywordflow}{return} assoc;
862 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_ae180bc47f7e0f171ed9bbedd7d50e416_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_ae180bc47f7e0f171ed9bbedd7d50e416_icgraph}
\end{center}
\end{figure}


\hypertarget{assoc_8h_ab7f978008ad6c86ab5063e989fe49d0c}{\index{assoc.\+h@{assoc.\+h}!new\+\_\+\+Assoc\+\_\+default@{new\+\_\+\+Assoc\+\_\+default}}
\index{new\+\_\+\+Assoc\+\_\+default@{new\+\_\+\+Assoc\+\_\+default}!assoc.\+h@{assoc.\+h}}
\subsubsection[{new\+\_\+\+Assoc\+\_\+default}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Assoc}$\ast$ new\+\_\+\+Assoc\+\_\+default (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+id}
\end{DoxyParamCaption}
)}}\label{assoc_8h_ab7f978008ad6c86ab5063e989fe49d0c}


Definition at line 864 of file assoc.\+c.



References new\+\_\+\+Assoc().



Referenced by new\+\_\+\+D\+H\+T(), and S\+T\+A\+R\+T\+\_\+\+T\+E\+S\+T().


\begin{DoxyCode}
865 \{
866     \textcolor{comment}{/* original 8, 251 averages to ~32k entries... probably the whole DHT :D}
867 \textcolor{comment}{     * 320 entries is fine, hopefully */}
868     \textcolor{keywordflow}{return} \hyperlink{assoc_8c_ae180bc47f7e0f171ed9bbedd7d50e416}{new\_Assoc}(6, 15, public\_id);
869 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_ab7f978008ad6c86ab5063e989fe49d0c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d7d/assoc_8h_ab7f978008ad6c86ab5063e989fe49d0c_icgraph}
\end{center}
\end{figure}


