\hypertarget{toxdns_8c}{\section{toxdns/toxdns.c File Reference}
\label{toxdns_8c}\index{toxdns/toxdns.\+c@{toxdns/toxdns.\+c}}
}
{\ttfamily \#include \char`\"{}../toxcore/\+Messenger.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../toxcore/logger.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}toxdns.\+h\char`\"{}}\\*
Include dependency graph for toxdns.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/df8/toxdns_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_d_n_s___object}{D\+N\+S\+\_\+\+Object}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{toxdns_8c_aa2d2b24f2a06e540a15e92bc817dd549}{\+\_\+encode}(a, b, c)
\item 
\#define \hyperlink{toxdns_8c_a030f8109c3cecf920052e35d739c665b}{D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}~(6 $\ast$ 5)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{toxdns_8c_af706c01c703b9680f61ce13f87fa72f8}{dns\+\_\+new\+\_\+temp\+\_\+keys} (\hyperlink{struct_d_n_s___object}{D\+N\+S\+\_\+\+Object} $\ast$d)
\item 
void $\ast$ \hyperlink{toxdns_8c_a0caab80768c3729d09cd6153379574c0}{tox\+\_\+dns3\+\_\+new} (uint8\+\_\+t $\ast$server\+\_\+public\+\_\+key)
\item 
void \hyperlink{toxdns_8c_a8948e29b73fc31a68f225e98203e9e01}{tox\+\_\+dns3\+\_\+kill} (void $\ast$dns3\+\_\+object)
\item 
int \hyperlink{toxdns_8c_a6f93ef1f6854405e7f5badad990f12d9}{tox\+\_\+generate\+\_\+dns3\+\_\+string} (void $\ast$dns3\+\_\+object, uint8\+\_\+t $\ast$string, uint16\+\_\+t string\+\_\+max\+\_\+len, uint32\+\_\+t $\ast$request\+\_\+id, uint8\+\_\+t $\ast$name, uint8\+\_\+t name\+\_\+len)
\item 
static int \hyperlink{toxdns_8c_a902c2d90b0d164c79f93ff2a80776ed8}{decode} (uint8\+\_\+t $\ast$dest, uint8\+\_\+t $\ast$src)
\item 
int \hyperlink{toxdns_8c_abf411ab6dee645acc0b1f0d429690403}{tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T} (void $\ast$dns3\+\_\+object, uint8\+\_\+t $\ast$tox\+\_\+id, uint8\+\_\+t $\ast$id\+\_\+record, uint32\+\_\+t id\+\_\+record\+\_\+len, uint32\+\_\+t request\+\_\+id)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const char \hyperlink{toxdns_8c_a3ce3456af76f05091933ec5db5dd1eec}{base32} \mbox{[}32\mbox{]} = \{\char`\"{}abcdefghijklmnopqrstuvwxyz012345\char`\"{}\}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{toxdns_8c_aa2d2b24f2a06e540a15e92bc817dd549}{\index{toxdns.\+c@{toxdns.\+c}!\+\_\+encode@{\+\_\+encode}}
\index{\+\_\+encode@{\+\_\+encode}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{\+\_\+encode}]{\setlength{\rightskip}{0pt plus 5cm}\#define \+\_\+encode(
\begin{DoxyParamCaption}
\item[{}]{a, }
\item[{}]{b, }
\item[{}]{c}
\end{DoxyParamCaption}
)}}\label{toxdns_8c_aa2d2b24f2a06e540a15e92bc817dd549}
{\bfseries Value\+:}
\begin{DoxyCode}
\{ \(\backslash\)
uint8\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i} = 0; \hyperlink{toxav__many__test_8c_a8fdafe3be7e00ce3d4f0cb50a9a5eb39}{\(\backslash\)}
\hyperlink{toxav__many__test_8c_a8fdafe3be7e00ce3d4f0cb50a9a5eb39}{    while}(i != c) \{ \(\backslash\)
        *a++ = \hyperlink{toxdns_8c_a3ce3456af76f05091933ec5db5dd1eec}{base32}[((b[0] >> bits) | (b[1] << (8 - bits))) & 0x1F]; \(\backslash\)
        bits += 5; \(\backslash\)
        if(bits >= 8) \{ \(\backslash\)
            bits -= 8; \(\backslash\)
            b++; \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{\(\backslash\)}
\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{            i}++; \(\backslash\)
        \} \(\backslash\)
    \} \(\backslash\)
\} \(\backslash\)
\end{DoxyCode}


Definition at line 34 of file toxdns.\+c.



Referenced by tox\+\_\+generate\+\_\+dns3\+\_\+string().

\hypertarget{toxdns_8c_a030f8109c3cecf920052e35d739c665b}{\index{toxdns.\+c@{toxdns.\+c}!D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}}
\index{D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L~(6 $\ast$ 5)}}\label{toxdns_8c_a030f8109c3cecf920052e35d739c665b}


Referenced by tox\+\_\+generate\+\_\+dns3\+\_\+string().



\subsection{Function Documentation}
\hypertarget{toxdns_8c_a902c2d90b0d164c79f93ff2a80776ed8}{\index{toxdns.\+c@{toxdns.\+c}!decode@{decode}}
\index{decode@{decode}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{decode}]{\setlength{\rightskip}{0pt plus 5cm}static int decode (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{dest, }
\item[{uint8\+\_\+t $\ast$}]{src}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{toxdns_8c_a902c2d90b0d164c79f93ff2a80776ed8}


Definition at line 155 of file toxdns.\+c.



Referenced by tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T().


\begin{DoxyCode}
156 \{
157     uint8\_t *p = src, *op = dest, bits = 0;
158     *op = 0;
159 
160     \textcolor{keywordflow}{while} (*p) \{
161         uint8\_t ch = *p++;
162 
163         \textcolor{keywordflow}{if} (\textcolor{charliteral}{'A'} <= ch && ch <= \textcolor{charliteral}{'Z'}) \{
164             ch = ch - \textcolor{charliteral}{'A'};
165         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{charliteral}{'a'} <= ch && ch <= \textcolor{charliteral}{'z'}) \{
166             ch = ch - \textcolor{charliteral}{'a'};
167         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{charliteral}{'0'} <= ch && ch <= \textcolor{charliteral}{'5'}) \{
168             ch = ch - \textcolor{charliteral}{'0'} + 26;
169         \} \textcolor{keywordflow}{else} \{
170             \textcolor{keywordflow}{return} - 1;
171         \}
172 
173         *op |= (ch << bits);
174         bits += 5;
175 
176         \textcolor{keywordflow}{if} (bits >= 8) \{
177             bits -= 8;
178             ++op;
179             *op = (ch >> (5 - bits));
180         \}
181     \}
182 
183     \textcolor{keywordflow}{return} op - dest;
184 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d84/toxdns_8c_a902c2d90b0d164c79f93ff2a80776ed8_icgraph}
\end{center}
\end{figure}


\hypertarget{toxdns_8c_af706c01c703b9680f61ce13f87fa72f8}{\index{toxdns.\+c@{toxdns.\+c}!dns\+\_\+new\+\_\+temp\+\_\+keys@{dns\+\_\+new\+\_\+temp\+\_\+keys}}
\index{dns\+\_\+new\+\_\+temp\+\_\+keys@{dns\+\_\+new\+\_\+temp\+\_\+keys}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{dns\+\_\+new\+\_\+temp\+\_\+keys}]{\setlength{\rightskip}{0pt plus 5cm}static void dns\+\_\+new\+\_\+temp\+\_\+keys (
\begin{DoxyParamCaption}
\item[{{\bf D\+N\+S\+\_\+\+Object} $\ast$}]{d}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{toxdns_8c_af706c01c703b9680f61ce13f87fa72f8}


Definition at line 57 of file toxdns.\+c.



References encrypt\+\_\+precompute(), D\+N\+S\+\_\+\+Object\+::nonce, D\+N\+S\+\_\+\+Object\+::nonce\+\_\+start, random\+\_\+int(), D\+N\+S\+\_\+\+Object\+::server\+\_\+public\+\_\+key, D\+N\+S\+\_\+\+Object\+::shared\+\_\+key, D\+N\+S\+\_\+\+Object\+::temp\+\_\+pk, and D\+N\+S\+\_\+\+Object\+::temp\+\_\+sk.



Referenced by tox\+\_\+dns3\+\_\+new(), and tox\+\_\+generate\+\_\+dns3\+\_\+string().


\begin{DoxyCode}
58 \{
59     d->\hyperlink{struct_d_n_s___object_aa2f9785a9d9116cc4592db06375cb887}{nonce} = d->\hyperlink{struct_d_n_s___object_a9bf0718fc917292d63aa2667d22c0502}{nonce\_start} = \hyperlink{crypto__core_8c_a5f13cbe4c46d8801e2c7467068f87306}{random\_int}();
60     crypto\_box\_keypair(d->\hyperlink{struct_d_n_s___object_a46affbcc202b25e96fd1f5238e9e97e0}{temp\_pk}, d->\hyperlink{struct_d_n_s___object_a3652189f09ee098ced277788337d95e7}{temp\_sk});
61     \hyperlink{crypto__core_8c_a0d8eaef49981c5dc3ada078866b42f6d}{encrypt\_precompute}(d->\hyperlink{struct_d_n_s___object_acc2e1517636c724d8778c873a4fce5e1}{server\_public\_key}, d->
      \hyperlink{struct_d_n_s___object_a3652189f09ee098ced277788337d95e7}{temp\_sk}, d->\hyperlink{struct_d_n_s___object_a0f4a120c7bd84eb7beebe6c163ce5744}{shared\_key});
62 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{da/d84/toxdns_8c_af706c01c703b9680f61ce13f87fa72f8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d84/toxdns_8c_af706c01c703b9680f61ce13f87fa72f8_icgraph}
\end{center}
\end{figure}


\hypertarget{toxdns_8c_abf411ab6dee645acc0b1f0d429690403}{\index{toxdns.\+c@{toxdns.\+c}!tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T@{tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T}}
\index{tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T@{tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T}]{\setlength{\rightskip}{0pt plus 5cm}int tox\+\_\+decrypt\+\_\+dns3\+\_\+\+T\+X\+T (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{dns3\+\_\+object, }
\item[{uint8\+\_\+t $\ast$}]{tox\+\_\+id, }
\item[{uint8\+\_\+t $\ast$}]{id\+\_\+record, }
\item[{uint32\+\_\+t}]{id\+\_\+record\+\_\+len, }
\item[{uint32\+\_\+t}]{request\+\_\+id}
\end{DoxyParamCaption}
)}}\label{toxdns_8c_abf411ab6dee645acc0b1f0d429690403}


Definition at line 198 of file toxdns.\+c.



References make-\/funny-\/savefile\+::data, decode(), decrypt\+\_\+data\+\_\+symmetric(), F\+R\+I\+E\+N\+D\+\_\+\+A\+D\+D\+R\+E\+S\+S\+\_\+\+S\+I\+Z\+E, nonce, and D\+N\+S\+\_\+\+Object\+::shared\+\_\+key.



Referenced by main().


\begin{DoxyCode}
200 \{
201     \hyperlink{struct_d_n_s___object}{DNS\_Object} *d = dns3\_object;
202 
203     \textcolor{keywordflow}{if} (id\_record\_len != 87)
204         \textcolor{keywordflow}{return} -1;
205 
206     \textcolor{comment}{/*if (id\_record\_len > 255 || id\_record\_len <= (sizeof(uint32\_t) + crypto\_box\_MACBYTES))}
207 \textcolor{comment}{        return -1;*/}
208 
209     uint8\_t id\_record\_null[id\_record\_len + 1];
210     memcpy(id\_record\_null, id\_record, id\_record\_len);
211     id\_record\_null[id\_record\_len] = 0;
212     uint8\_t \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}[id\_record\_len];
213     \textcolor{keywordtype}{int} length = \hyperlink{toxdns_8c_a902c2d90b0d164c79f93ff2a80776ed8}{decode}(data, id\_record\_null);
214 
215     \textcolor{keywordflow}{if} (length == -1)
216         \textcolor{keywordflow}{return} -1;
217 
218     uint8\_t \hyperlink{crypto__test_8c_a7932c523f7065073a396e571319201ce}{nonce}[crypto\_box\_NONCEBYTES] = \{0\};
219     memcpy(nonce, &request\_id, \textcolor{keyword}{sizeof}(uint32\_t));
220     nonce[\textcolor{keyword}{sizeof}(uint32\_t)] = 1;
221     \textcolor{keywordtype}{int} len = \hyperlink{crypto__core_8c_a824b257fcff74b9d17c5247223fbed29}{decrypt\_data\_symmetric}(d->\hyperlink{struct_d_n_s___object_a0f4a120c7bd84eb7beebe6c163ce5744}{shared\_key}, nonce, data, length, 
      tox\_id);
222 
223     \textcolor{keywordflow}{if} (len != \hyperlink{_messenger_8h_a22c0e97a4b45902742a86bba24cc5d5d}{FRIEND\_ADDRESS\_SIZE})
224         \textcolor{keywordflow}{return} -1;
225 
226     \textcolor{keywordflow}{return} 0;
227 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d84/toxdns_8c_abf411ab6dee645acc0b1f0d429690403_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{da/d84/toxdns_8c_abf411ab6dee645acc0b1f0d429690403_icgraph}
\end{center}
\end{figure}


\hypertarget{toxdns_8c_a8948e29b73fc31a68f225e98203e9e01}{\index{toxdns.\+c@{toxdns.\+c}!tox\+\_\+dns3\+\_\+kill@{tox\+\_\+dns3\+\_\+kill}}
\index{tox\+\_\+dns3\+\_\+kill@{tox\+\_\+dns3\+\_\+kill}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{tox\+\_\+dns3\+\_\+kill}]{\setlength{\rightskip}{0pt plus 5cm}void tox\+\_\+dns3\+\_\+kill (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{dns3\+\_\+object}
\end{DoxyParamCaption}
)}}\label{toxdns_8c_a8948e29b73fc31a68f225e98203e9e01}


Definition at line 83 of file toxdns.\+c.


\begin{DoxyCode}
84 \{
85     memset(dns3\_object, 0, \textcolor{keyword}{sizeof}(\hyperlink{struct_d_n_s___object}{DNS\_Object}));
86     free(dns3\_object);
87 \}
\end{DoxyCode}
\hypertarget{toxdns_8c_a0caab80768c3729d09cd6153379574c0}{\index{toxdns.\+c@{toxdns.\+c}!tox\+\_\+dns3\+\_\+new@{tox\+\_\+dns3\+\_\+new}}
\index{tox\+\_\+dns3\+\_\+new@{tox\+\_\+dns3\+\_\+new}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{tox\+\_\+dns3\+\_\+new}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ tox\+\_\+dns3\+\_\+new (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{server\+\_\+public\+\_\+key}
\end{DoxyParamCaption}
)}}\label{toxdns_8c_a0caab80768c3729d09cd6153379574c0}


Definition at line 69 of file toxdns.\+c.



References dns\+\_\+new\+\_\+temp\+\_\+keys(), and D\+N\+S\+\_\+\+Object\+::server\+\_\+public\+\_\+key.



Referenced by main().


\begin{DoxyCode}
70 \{
71     \hyperlink{struct_d_n_s___object}{DNS\_Object} *d = malloc(\textcolor{keyword}{sizeof}(\hyperlink{struct_d_n_s___object}{DNS\_Object}));
72 
73     \textcolor{keywordflow}{if} (d == NULL)
74         \textcolor{keywordflow}{return} NULL;
75 
76     memcpy(d->\hyperlink{struct_d_n_s___object_acc2e1517636c724d8778c873a4fce5e1}{server\_public\_key}, server\_public\_key, crypto\_box\_PUBLICKEYBYTES);
77     \hyperlink{toxdns_8c_af706c01c703b9680f61ce13f87fa72f8}{dns\_new\_temp\_keys}(d);
78     \textcolor{keywordflow}{return} d;
79 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d84/toxdns_8c_a0caab80768c3729d09cd6153379574c0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=234pt]{da/d84/toxdns_8c_a0caab80768c3729d09cd6153379574c0_icgraph}
\end{center}
\end{figure}


\hypertarget{toxdns_8c_a6f93ef1f6854405e7f5badad990f12d9}{\index{toxdns.\+c@{toxdns.\+c}!tox\+\_\+generate\+\_\+dns3\+\_\+string@{tox\+\_\+generate\+\_\+dns3\+\_\+string}}
\index{tox\+\_\+generate\+\_\+dns3\+\_\+string@{tox\+\_\+generate\+\_\+dns3\+\_\+string}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{tox\+\_\+generate\+\_\+dns3\+\_\+string}]{\setlength{\rightskip}{0pt plus 5cm}int tox\+\_\+generate\+\_\+dns3\+\_\+string (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{dns3\+\_\+object, }
\item[{uint8\+\_\+t $\ast$}]{string, }
\item[{uint16\+\_\+t}]{string\+\_\+max\+\_\+len, }
\item[{uint32\+\_\+t $\ast$}]{request\+\_\+id, }
\item[{uint8\+\_\+t $\ast$}]{name, }
\item[{uint8\+\_\+t}]{name\+\_\+len}
\end{DoxyParamCaption}
)}}\label{toxdns_8c_a6f93ef1f6854405e7f5badad990f12d9}


Definition at line 101 of file toxdns.\+c.



References \+\_\+encode, dns\+\_\+new\+\_\+temp\+\_\+keys(), D\+O\+T\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L, encrypt\+\_\+data\+\_\+symmetric(), i, L\+O\+G\+G\+E\+R\+\_\+\+E\+R\+R\+O\+R, nonce, D\+N\+S\+\_\+\+Object\+::nonce, D\+N\+S\+\_\+\+Object\+::nonce\+\_\+start, D\+N\+S\+\_\+\+Object\+::shared\+\_\+key, and D\+N\+S\+\_\+\+Object\+::temp\+\_\+pk.



Referenced by main().


\begin{DoxyCode}
103 \{
104 \textcolor{preprocessor}{#define DOT\_INTERVAL (6 * 5)}
105     \textcolor{keywordtype}{int} base = (\textcolor{keyword}{sizeof}(uint32\_t) + crypto\_box\_PUBLICKEYBYTES + name\_len + crypto\_box\_MACBYTES);
106     \textcolor{keywordtype}{int} end\_len = ((base * 8) / 5) + (base / \hyperlink{toxdns_8c_a030f8109c3cecf920052e35d739c665b}{DOT\_INTERVAL}) + !!(base % 5);
107     end\_len -= !(base % \hyperlink{toxdns_8c_a030f8109c3cecf920052e35d739c665b}{DOT\_INTERVAL});
108 
109     \textcolor{keywordflow}{if} (end\_len > string\_max\_len)
110         \textcolor{keywordflow}{return} -1;
111 
112     \hyperlink{struct_d_n_s___object}{DNS\_Object} *d = dns3\_object;
113     uint8\_t buffer[1024];
114     uint8\_t \hyperlink{crypto__test_8c_a7932c523f7065073a396e571319201ce}{nonce}[crypto\_box\_NONCEBYTES] = \{0\};
115     memcpy(nonce, &d->\hyperlink{struct_d_n_s___object_aa2f9785a9d9116cc4592db06375cb887}{nonce}, \textcolor{keyword}{sizeof}(uint32\_t));
116     memcpy(buffer, &d->\hyperlink{struct_d_n_s___object_aa2f9785a9d9116cc4592db06375cb887}{nonce}, \textcolor{keyword}{sizeof}(uint32\_t));
117     memcpy(buffer + \textcolor{keyword}{sizeof}(uint32\_t), d->\hyperlink{struct_d_n_s___object_a46affbcc202b25e96fd1f5238e9e97e0}{temp\_pk}, crypto\_box\_PUBLICKEYBYTES);
118     \textcolor{keywordtype}{int} len = \hyperlink{crypto__core_8c_a81efc0a4a6e0efe372651e26e342a6e5}{encrypt\_data\_symmetric}(d->\hyperlink{struct_d_n_s___object_a0f4a120c7bd84eb7beebe6c163ce5744}{shared\_key}, nonce, name, name\_len,
119                                      buffer + \textcolor{keyword}{sizeof}(uint32\_t) + crypto\_box\_PUBLICKEYBYTES);
120 
121     \textcolor{keywordflow}{if} (len == -1)
122         \textcolor{keywordflow}{return} -1;
123 
124     \textcolor{keywordtype}{int} total\_len = len + \textcolor{keyword}{sizeof}(uint32\_t) + crypto\_box\_PUBLICKEYBYTES;
125     uint8\_t *buff = buffer, *old\_str = string;
126     buffer[total\_len] = 0;
127     uint8\_t bits = 0;
128     \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
129 
130     \textcolor{keywordflow}{for} (i = !(total\_len % \hyperlink{toxdns_8c_a030f8109c3cecf920052e35d739c665b}{DOT\_INTERVAL}); i < (total\_len / 
      \hyperlink{toxdns_8c_a030f8109c3cecf920052e35d739c665b}{DOT\_INTERVAL}); ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
131         \hyperlink{toxdns_8c_aa2d2b24f2a06e540a15e92bc817dd549}{\_encode}(\textcolor{keywordtype}{string}, buff, DOT\_INTERVAL);
132         *\textcolor{keywordtype}{string} = \textcolor{charliteral}{'.'};
133         ++string;
134     \}
135 
136     \textcolor{keywordtype}{int} left = total\_len - (buff - buffer);
137     \hyperlink{toxdns_8c_aa2d2b24f2a06e540a15e92bc817dd549}{\_encode}(\textcolor{keywordtype}{string}, buff, left);
138 \textcolor{preprocessor}{#undef DOT\_INTERVAL}
139     *request\_id = d->\hyperlink{struct_d_n_s___object_aa2f9785a9d9116cc4592db06375cb887}{nonce};
140     ++d->\hyperlink{struct_d_n_s___object_aa2f9785a9d9116cc4592db06375cb887}{nonce};
141 
142     \textcolor{keywordflow}{if} (d->\hyperlink{struct_d_n_s___object_aa2f9785a9d9116cc4592db06375cb887}{nonce} == d->\hyperlink{struct_d_n_s___object_a9bf0718fc917292d63aa2667d22c0502}{nonce\_start}) \{
143         \hyperlink{toxdns_8c_af706c01c703b9680f61ce13f87fa72f8}{dns\_new\_temp\_keys}(d);
144     \}
145 
146     \textcolor{keywordflow}{if} (end\_len != \textcolor{keywordtype}{string} - old\_str) \{
147         \hyperlink{logger_8h_aedad6a1e3ffe0d4cd0992b822ec0eeeb}{LOGGER\_ERROR}(\textcolor{stringliteral}{"tox\_generate\_dns3\_string Fail, %u != %lu\(\backslash\)n"}, end\_len, \textcolor{keywordtype}{string} - old\_str);
148         \textcolor{keywordflow}{return} -1;
149     \}
150 
151     \textcolor{keywordflow}{return} \textcolor{keywordtype}{string} - old\_str;
152 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{da/d84/toxdns_8c_a6f93ef1f6854405e7f5badad990f12d9_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{da/d84/toxdns_8c_a6f93ef1f6854405e7f5badad990f12d9_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{toxdns_8c_a3ce3456af76f05091933ec5db5dd1eec}{\index{toxdns.\+c@{toxdns.\+c}!base32@{base32}}
\index{base32@{base32}!toxdns.\+c@{toxdns.\+c}}
\subsubsection[{base32}]{\setlength{\rightskip}{0pt plus 5cm}const char base32\mbox{[}32\mbox{]} = \{\char`\"{}abcdefghijklmnopqrstuvwxyz012345\char`\"{}\}\hspace{0.3cm}{\ttfamily [static]}}}\label{toxdns_8c_a3ce3456af76f05091933ec5db5dd1eec}


Definition at line 32 of file toxdns.\+c.

