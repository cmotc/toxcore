\hypertarget{friend__connection_8h}{\section{toxcore/friend\+\_\+connection.h File Reference}
\label{friend__connection_8h}\index{toxcore/friend\+\_\+connection.\+h@{toxcore/friend\+\_\+connection.\+h}}
}
{\ttfamily \#include \char`\"{}net\+\_\+crypto.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}D\+H\+T.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}L\+A\+N\+\_\+discovery.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}onion\+\_\+client.\+h\char`\"{}}\\*
Include dependency graph for friend\+\_\+connection.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d17/friend__connection_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d42/friend__connection_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_friend___conn}{Friend\+\_\+\+Conn}
\item 
struct \hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{friend__connection_8h_a28f384352cf0b5c144fdafb826701811}{M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S}~2
\item 
\#define \hyperlink{friend__connection_8h_aa42482d7e48a639e42ba46c923edabfd}{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}~0
\item 
\#define \hyperlink{friend__connection_8h_a6eb210c3066f32144781de4e11a6c506}{G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}~1
\item 
\#define \hyperlink{friend__connection_8h_a8302037b6dec7ebbc22f4f2aab6d3d83}{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E}~16
\item 
\#define \hyperlink{friend__connection_8h_a8fd0b06a9d90811816572d8ec96d1b8a}{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S}~17
\item 
\#define \hyperlink{friend__connection_8h_ac63465b658c6d3b4ac5c6a543cd0728a}{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S}~18
\item 
\#define \hyperlink{friend__connection_8h_ab1dd8a59ba0bb89f6159e357b023789a}{F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}~8
\item 
\#define \hyperlink{friend__connection_8h_a392cf3bbef6af58c5cc3d8adca4bea70}{F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T}~(\hyperlink{friend__connection_8h_ab1dd8a59ba0bb89f6159e357b023789a}{F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L} $\ast$ 4)
\item 
\#define \hyperlink{friend__connection_8h_a9961aac2a11e6d9ecdc2483f8816f9cd}{F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T}~\hyperlink{_d_h_t_8h_a2c542fd03a43f340d1fb281afe54453f}{B\+A\+D\+\_\+\+N\+O\+D\+E\+\_\+\+T\+I\+M\+E\+O\+U\+T}
\item 
\#define \hyperlink{friend__connection_8h_aac882ca62f0b32b069ace03fa3f106c0}{F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S}~(\hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S} $\ast$ 4)
\item 
\#define \hyperlink{friend__connection_8h_aa8e1a5d456629869bec9ec62761f3df3}{M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S}~(\hyperlink{_t_c_p__connection_8h_a56e5080b902e3fd06f9c0bfa74af34c5}{R\+E\+C\+O\+M\+M\+E\+N\+D\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S})
\item 
\#define \hyperlink{friend__connection_8h_a19e48bdb6f18161c3306b82439e6ce62}{S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}~(5 $\ast$ 60)
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a93ea4a0b69b92435539e13a44bcc910b}{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E}, 
\hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a0ad1ac040d579509cc0a3f1df0ab38ad}{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G}, 
\hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{friend__connection_8h_a97c5d86b2475e17f2cda62ad13df1bea}{getfriend\+\_\+conn\+\_\+id\+\_\+pk} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, const uint8\+\_\+t $\ast$real\+\_\+pk)
\item 
int \hyperlink{friend__connection_8h_ae9fc0c8cb8838cd5d069e44911c23e63}{friend\+\_\+connection\+\_\+lock} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id)
\item 
unsigned int \hyperlink{friend__connection_8h_ae5c94f8543c84506c85faac6d2b3a9dd}{friend\+\_\+con\+\_\+connected} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id)
\item 
int \hyperlink{friend__connection_8h_a4605fa0bd8ff3f9bd217ee6dcadbfe5f}{get\+\_\+friendcon\+\_\+public\+\_\+keys} (uint8\+\_\+t $\ast$real\+\_\+pk, uint8\+\_\+t $\ast$dht\+\_\+temp\+\_\+pk, \hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id)
\item 
void \hyperlink{friend__connection_8h_a04fb221a2ac726ec3ca86be7b1e63238}{set\+\_\+dht\+\_\+temp\+\_\+pk} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id, const uint8\+\_\+t $\ast$dht\+\_\+temp\+\_\+pk)
\item 
int \hyperlink{friend__connection_8h_ac89688f7660c1cb5fb664ecc09bab460}{friend\+\_\+add\+\_\+tcp\+\_\+relay} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id, \hyperlink{struct_i_p___port}{I\+P\+\_\+\+Port} ip\+\_\+port, const uint8\+\_\+t $\ast$public\+\_\+key)
\item 
int \hyperlink{friend__connection_8h_a15c404d517b4a4fb3976f4d85bfbaef0}{friend\+\_\+connection\+\_\+callbacks} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id, unsigned int index, int($\ast$\hyperlink{_t_c_p__test_8c_ae4f12b6805a17277d33e73ac030d7aca}{status\+\_\+callback})(void $\ast$object, int id, uint8\+\_\+t status), int($\ast$\hyperlink{_t_c_p__test_8c_a36ed22ce4a6bec3fb113a4eaf29df5e1}{data\+\_\+callback})(void $\ast$object, int id, uint8\+\_\+t $\ast$data, uint16\+\_\+t length), int($\ast$lossy\+\_\+data\+\_\+callback)(void $\ast$object, int id, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length), void $\ast$object, int number)
\item 
int \hyperlink{friend__connection_8h_a8586e3dfb2047821c4214adf8d06a877}{friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id)
\item 
int \hyperlink{friend__connection_8h_a613a80a004fccd616de2a67d84a25d3c}{new\+\_\+friend\+\_\+connection} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, const uint8\+\_\+t $\ast$real\+\_\+public\+\_\+key)
\item 
int \hyperlink{friend__connection_8h_a5f311791c0ec4ecd8fdf5359cf7fb95a}{kill\+\_\+friend\+\_\+connection} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id)
\item 
int \hyperlink{friend__connection_8h_a2af492c22c086276ed147d0826839d25}{send\+\_\+friend\+\_\+request\+\_\+packet} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int friendcon\+\_\+id, uint32\+\_\+t nospam\+\_\+num, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)
\item 
void \hyperlink{friend__connection_8h_ab3249bbbafb0a8be7d181e3bc6f9563f}{set\+\_\+friend\+\_\+request\+\_\+callback} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c, int($\ast$fr\+\_\+request\+\_\+callback)(void $\ast$, const uint8\+\_\+t $\ast$, const uint8\+\_\+t $\ast$, uint16\+\_\+t), void $\ast$object)
\item 
\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$ \hyperlink{friend__connection_8h_a319bec2419cf5fc5525af4fae03b86ef}{new\+\_\+friend\+\_\+connections} (\hyperlink{struct_onion___client}{Onion\+\_\+\+Client} $\ast$onion\+\_\+c)
\item 
void \hyperlink{friend__connection_8h_aea88c3aa2deff558e9b13ed5229cbb6b}{do\+\_\+friend\+\_\+connections} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c)
\item 
void \hyperlink{friend__connection_8h_a2ef8cdbd93f21f11ff0333a9527c2c02}{kill\+\_\+friend\+\_\+connections} (\hyperlink{struct_friend___connections}{Friend\+\_\+\+Connections} $\ast$fr\+\_\+c)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{friend__connection_8h_a392cf3bbef6af58c5cc3d8adca4bea70}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T@{F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T}}
\index{F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T@{F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T~({\bf F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L} $\ast$ 4)}}\label{friend__connection_8h_a392cf3bbef6af58c5cc3d8adca4bea70}


Definition at line 46 of file friend\+\_\+connection.\+h.



Referenced by do\+\_\+friend\+\_\+connections().

\hypertarget{friend__connection_8h_a9961aac2a11e6d9ecdc2483f8816f9cd}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T@{F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T}}
\index{F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T@{F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T~{\bf B\+A\+D\+\_\+\+N\+O\+D\+E\+\_\+\+T\+I\+M\+E\+O\+U\+T}}}\label{friend__connection_8h_a9961aac2a11e6d9ecdc2483f8816f9cd}


Definition at line 49 of file friend\+\_\+connection.\+h.



Referenced by do\+\_\+friend\+\_\+connections().

\hypertarget{friend__connection_8h_aac882ca62f0b32b069ace03fa3f106c0}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S@{F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S}}
\index{F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S@{F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S~({\bf M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S} $\ast$ 4)}}\label{friend__connection_8h_aac882ca62f0b32b069ace03fa3f106c0}


Definition at line 51 of file friend\+\_\+connection.\+h.



Referenced by connect\+\_\+to\+\_\+saved\+\_\+tcp\+\_\+relays(), and friend\+\_\+add\+\_\+tcp\+\_\+relay().

\hypertarget{friend__connection_8h_ab1dd8a59ba0bb89f6159e357b023789a}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}}
\index{F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L~8}}\label{friend__connection_8h_ab1dd8a59ba0bb89f6159e357b023789a}


Definition at line 43 of file friend\+\_\+connection.\+h.



Referenced by do\+\_\+friend\+\_\+connections().

\hypertarget{friend__connection_8h_a6eb210c3066f32144781de4e11a6c506}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X@{G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}}
\index{G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X@{G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+R\+O\+U\+P\+C\+H\+A\+T\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X~1}}\label{friend__connection_8h_a6eb210c3066f32144781de4e11a6c506}


Definition at line 36 of file friend\+\_\+connection.\+h.



Referenced by add\+\_\+conn\+\_\+to\+\_\+groupchat().

\hypertarget{friend__connection_8h_a28f384352cf0b5c144fdafb826701811}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S@{M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S}}
\index{M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S@{M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S~2}}\label{friend__connection_8h_a28f384352cf0b5c144fdafb826701811}


Definition at line 34 of file friend\+\_\+connection.\+h.



Referenced by friend\+\_\+connection\+\_\+callbacks(), handle\+\_\+lossy\+\_\+packet(), handle\+\_\+packet(), and handle\+\_\+status().

\hypertarget{friend__connection_8h_aa8e1a5d456629869bec9ec62761f3df3}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S@{M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S}}
\index{M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S@{M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+S\+H\+A\+R\+E\+D\+\_\+\+R\+E\+L\+A\+Y\+S~({\bf R\+E\+C\+O\+M\+M\+E\+N\+D\+E\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S})}}\label{friend__connection_8h_aa8e1a5d456629869bec9ec62761f3df3}


Definition at line 54 of file friend\+\_\+connection.\+h.



Referenced by handle\+\_\+packet(), and send\+\_\+relays().

\hypertarget{friend__connection_8h_aa42482d7e48a639e42ba46c923edabfd}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}}
\index{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X@{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+E\+S\+S\+E\+N\+G\+E\+R\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+\_\+\+I\+N\+D\+E\+X~0}}\label{friend__connection_8h_aa42482d7e48a639e42ba46c923edabfd}


Definition at line 35 of file friend\+\_\+connection.\+h.



Referenced by init\+\_\+new\+\_\+friend(), and m\+\_\+delfriend().

\hypertarget{friend__connection_8h_a8302037b6dec7ebbc22f4f2aab6d3d83}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E@{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E}}
\index{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E@{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+A\+L\+I\+V\+E~16}}\label{friend__connection_8h_a8302037b6dec7ebbc22f4f2aab6d3d83}


Definition at line 38 of file friend\+\_\+connection.\+h.



Referenced by handle\+\_\+packet(), and send\+\_\+ping().

\hypertarget{friend__connection_8h_ac63465b658c6d3b4ac5c6a543cd0728a}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S@{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S}}
\index{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S@{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S~18}}\label{friend__connection_8h_ac63465b658c6d3b4ac5c6a543cd0728a}


Definition at line 40 of file friend\+\_\+connection.\+h.



Referenced by handle\+\_\+packet(), and send\+\_\+friend\+\_\+request\+\_\+packet().

\hypertarget{friend__connection_8h_a8fd0b06a9d90811816572d8ec96d1b8a}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S@{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S}}
\index{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S@{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S~17}}\label{friend__connection_8h_a8fd0b06a9d90811816572d8ec96d1b8a}


Definition at line 39 of file friend\+\_\+connection.\+h.



Referenced by handle\+\_\+packet(), and send\+\_\+relays().

\hypertarget{friend__connection_8h_a19e48bdb6f18161c3306b82439e6ce62}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}}
\index{S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L@{S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L~(5 $\ast$ 60)}}\label{friend__connection_8h_a19e48bdb6f18161c3306b82439e6ce62}


Definition at line 57 of file friend\+\_\+connection.\+h.



Referenced by do\+\_\+friend\+\_\+connections().



\subsection{Enumeration Type Documentation}
\hypertarget{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5}{\subsubsection[{anonymous enum}]{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}}\label{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E@{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E@{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E}}\item[{\em 
\hypertarget{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a93ea4a0b69b92435539e13a44bcc910b}{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+N\+E}\label{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a93ea4a0b69b92435539e13a44bcc910b}
}]\index{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G@{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G@{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G}}\item[{\em 
\hypertarget{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a0ad1ac040d579509cc0a3f1df0ab38ad}{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G}\label{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a0ad1ac040d579509cc0a3f1df0ab38ad}
}]\index{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D@{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D@{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D}}\item[{\em 
\hypertarget{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D}\label{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}
}]\end{description}
\end{Desc}


Definition at line 60 of file friend\+\_\+connection.\+h.


\begin{DoxyCode}
60      \{
61     \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a93ea4a0b69b92435539e13a44bcc910b}{FRIENDCONN\_STATUS\_NONE},
62     \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a0ad1ac040d579509cc0a3f1df0ab38ad}{FRIENDCONN\_STATUS\_CONNECTING},
63     \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{FRIENDCONN\_STATUS\_CONNECTED}
64 \};
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{friend__connection_8h_aea88c3aa2deff558e9b13ed5229cbb6b}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!do\+\_\+friend\+\_\+connections@{do\+\_\+friend\+\_\+connections}}
\index{do\+\_\+friend\+\_\+connections@{do\+\_\+friend\+\_\+connections}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{do\+\_\+friend\+\_\+connections}]{\setlength{\rightskip}{0pt plus 5cm}void do\+\_\+friend\+\_\+connections (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_aea88c3aa2deff558e9b13ed5229cbb6b}


Definition at line 791 of file friend\+\_\+connection.\+c.



References connect\+\_\+to\+\_\+saved\+\_\+tcp\+\_\+relays(), Friend\+\_\+\+Conn\+::crypt\+\_\+connection\+\_\+id, crypto\+\_\+kill(), Friend\+\_\+\+Connections\+::dht, D\+H\+T\+\_\+delfriend(), Friend\+\_\+\+Conn\+::dht\+\_\+ip\+\_\+port, Friend\+\_\+\+Conn\+::dht\+\_\+ip\+\_\+port\+\_\+lastrecv, Friend\+\_\+\+Conn\+::dht\+\_\+lock, Friend\+\_\+\+Conn\+::dht\+\_\+pk\+\_\+lastrecv, Friend\+\_\+\+Conn\+::dht\+\_\+temp\+\_\+pk, I\+P\+::family, F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\+O\+U\+T, F\+R\+I\+E\+N\+D\+\_\+\+D\+H\+T\+\_\+\+T\+I\+M\+E\+O\+U\+T, friend\+\_\+new\+\_\+connection(), F\+R\+I\+E\+N\+D\+\_\+\+P\+I\+N\+G\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L, F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G, get\+\_\+conn(), handle\+\_\+status(), i, I\+P\+\_\+\+Port\+::ip, L\+A\+Ndiscovery(), M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+T\+C\+P\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+S, Friend\+\_\+\+Connections\+::net\+\_\+crypto, Friend\+\_\+\+Connections\+::num\+\_\+cons, Friend\+\_\+\+Conn\+::ping\+\_\+lastrecv, Friend\+\_\+\+Conn\+::ping\+\_\+lastsent, send\+\_\+ping(), send\+\_\+relays(), set\+\_\+direct\+\_\+ip\+\_\+port(), S\+H\+A\+R\+E\+\_\+\+R\+E\+L\+A\+Y\+S\+\_\+\+I\+N\+T\+E\+R\+V\+A\+L, Friend\+\_\+\+Conn\+::share\+\_\+relays\+\_\+lastsent, Friend\+\_\+\+Conn\+::status, and unix\+\_\+time().



Referenced by do\+\_\+messenger().


\begin{DoxyCode}
792 \{
793     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
794     uint64\_t temp\_time = \hyperlink{util_8c_ac958d9f8847cb8039444bfa3d304233a}{unix\_time}();
795 
796     \textcolor{keywordflow}{for} (i = 0; i < fr\_c->\hyperlink{struct_friend___connections_a81ac77652d6cc5071baca915581c5dfa}{num\_cons}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
797         \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, i);
798 
799         \textcolor{keywordflow}{if} (friend\_con) \{
800             \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a0ad1ac040d579509cc0a3f1df0ab38ad}{FRIENDCONN\_STATUS\_CONNECTING}) \{
801                 \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a64eb95337c42cb30956ee42f7c42cf0e}{dht\_pk\_lastrecv} + 
      \hyperlink{friend__connection_8h_a9961aac2a11e6d9ecdc2483f8816f9cd}{FRIEND\_DHT\_TIMEOUT} < temp\_time) \{
802                     \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a1da451cf7bce45009c3ae38c003f2ed8}{dht\_lock}) \{
803                         \hyperlink{_d_h_t_8c_a4e70f3fc186c6e459908307c935d00b2}{DHT\_delfriend}(fr\_c->\hyperlink{struct_friend___connections_a8b3d6ce8745acc52695e252bdb1531b6}{dht}, friend\_con->
      \hyperlink{struct_friend___conn_ab863a4d1023acff25635c1b4a36015a2}{dht\_temp\_pk}, friend\_con->\hyperlink{struct_friend___conn_a1da451cf7bce45009c3ae38c003f2ed8}{dht\_lock});
804                         friend\_con->\hyperlink{struct_friend___conn_a1da451cf7bce45009c3ae38c003f2ed8}{dht\_lock} = 0;
805                     \}
806                 \}
807 
808                 \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a1b4abfeab3eeeb285cfc69b1ac8d84bb}{dht\_ip\_port\_lastrecv} + 
      \hyperlink{friend__connection_8h_a9961aac2a11e6d9ecdc2483f8816f9cd}{FRIEND\_DHT\_TIMEOUT} < temp\_time) \{
809                     friend\_con->\hyperlink{struct_friend___conn_ace58c2ab8adca0a754bcd2527e88a9d2}{dht\_ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} = 0;
810                 \}
811 
812                 \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a1da451cf7bce45009c3ae38c003f2ed8}{dht\_lock}) \{
813                     \textcolor{keywordflow}{if} (\hyperlink{friend__connection_8c_ac2af058fd8684e6abc7b136889f5f4e5}{friend\_new\_connection}(fr\_c, i) == 0) \{
814                         \hyperlink{net__crypto_8c_a8ced4e168a95db5708bf4b3095cb4df6}{set\_direct\_ip\_port}(fr\_c->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, friend\_con->
      \hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id}, friend\_con->\hyperlink{struct_friend___conn_ace58c2ab8adca0a754bcd2527e88a9d2}{dht\_ip\_port}, 0);
815                         \hyperlink{friend__connection_8c_a612a688a590b1836efec92949e3cbdff}{connect\_to\_saved\_tcp\_relays}(fr\_c, i, (
      \hyperlink{_t_c_p__connection_8h_a8ee1e3e61abfebc476a63a83ec2c05ee}{MAX\_FRIEND\_TCP\_CONNECTIONS} / 2)); \textcolor{comment}{/* Only fill it half up. */}
816                     \}
817                 \}
818 
819             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{FRIENDCONN\_STATUS\_CONNECTED}) 
      \{
820                 \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a1625b76f8f5277e17545953d96b893fb}{ping\_lastsent} + 
      \hyperlink{friend__connection_8h_ab1dd8a59ba0bb89f6159e357b023789a}{FRIEND\_PING\_INTERVAL} < temp\_time) \{
821                     \hyperlink{friend__connection_8c_a8896f283aafad13adc5b68311cf24cd2}{send\_ping}(fr\_c, i);
822                 \}
823 
824                 \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_aa5f9fa72527b8eafd6457864f32d2701}{share\_relays\_lastsent} + 
      \hyperlink{friend__connection_8h_a19e48bdb6f18161c3306b82439e6ce62}{SHARE\_RELAYS\_INTERVAL} < temp\_time) \{
825                     \hyperlink{friend__connection_8c_a6e0e582317de001468faab8240bd2b5c}{send\_relays}(fr\_c, i);
826                 \}
827 
828                 \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a5130c3c4a93050475770184608d61918}{ping\_lastrecv} + 
      \hyperlink{friend__connection_8h_a392cf3bbef6af58c5cc3d8adca4bea70}{FRIEND\_CONNECTION\_TIMEOUT} < temp\_time) \{
829                     \textcolor{comment}{/* If we stopped receiving ping packets, kill it. */}
830                     \hyperlink{net__crypto_8c_a16c3a0008512675dad8eb00ff1822763}{crypto\_kill}(fr\_c->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, friend\_con->
      \hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id});
831                     friend\_con->\hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id} = -1;
832                     \hyperlink{friend__connection_8c_abf73eaa3805a863ab454fb4afe0fb49f}{handle\_status}(fr\_c, i, 0); \textcolor{comment}{/* Going offline. */}
833                 \}
834             \}
835         \}
836     \}
837 
838     \hyperlink{friend__connection_8c_adfc6df8fda15c84a4c49468d1d2fc3fc}{LANdiscovery}(fr\_c);
839 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_aea88c3aa2deff558e9b13ed5229cbb6b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_aea88c3aa2deff558e9b13ed5229cbb6b_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_ac89688f7660c1cb5fb664ecc09bab460}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!friend\+\_\+add\+\_\+tcp\+\_\+relay@{friend\+\_\+add\+\_\+tcp\+\_\+relay}}
\index{friend\+\_\+add\+\_\+tcp\+\_\+relay@{friend\+\_\+add\+\_\+tcp\+\_\+relay}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{friend\+\_\+add\+\_\+tcp\+\_\+relay}]{\setlength{\rightskip}{0pt plus 5cm}int friend\+\_\+add\+\_\+tcp\+\_\+relay (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id, }
\item[{{\bf I\+P\+\_\+\+Port}}]{ip\+\_\+port, }
\item[{const uint8\+\_\+t $\ast$}]{public\+\_\+key}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_ac89688f7660c1cb5fb664ecc09bab460}


Definition at line 154 of file friend\+\_\+connection.\+c.



References add\+\_\+tcp\+\_\+relay\+\_\+peer(), Friend\+\_\+\+Conn\+::crypt\+\_\+connection\+\_\+id, Friend\+\_\+\+Conn\+::dht\+\_\+ip\+\_\+port, Friend\+\_\+\+Conn\+::dht\+\_\+temp\+\_\+pk, I\+P\+::family, F\+R\+I\+E\+N\+D\+\_\+\+M\+A\+X\+\_\+\+S\+T\+O\+R\+E\+D\+\_\+\+T\+C\+P\+\_\+\+R\+E\+L\+A\+Y\+S, get\+\_\+conn(), Friend\+\_\+\+Conn\+::hosting\+\_\+tcp\+\_\+relay, i, I\+P\+\_\+\+Port\+::ip, Node\+\_\+format\+::ip\+\_\+port, Local\+\_\+ip(), Friend\+\_\+\+Connections\+::net\+\_\+crypto, Node\+\_\+format\+::public\+\_\+key, Friend\+\_\+\+Conn\+::tcp\+\_\+relay\+\_\+counter, and Friend\+\_\+\+Conn\+::tcp\+\_\+relays.



Referenced by dht\+\_\+ip\+\_\+callback(), handle\+\_\+packet(), send\+\_\+relays(), and tcp\+\_\+relay\+\_\+node\+\_\+callback().


\begin{DoxyCode}
155 \{
156     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
157 
158     \textcolor{keywordflow}{if} (!friend\_con)
159         \textcolor{keywordflow}{return} -1;
160 
161     \textcolor{comment}{/* Local ip and same pk means that they are hosting a TCP relay. */}
162     \textcolor{keywordflow}{if} (\hyperlink{_l_a_n__discovery_8c_a56fb8ae3cd774c1b1d5670b9c4fb8959}{Local\_ip}(ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}) && memcmp(friend\_con->\hyperlink{struct_friend___conn_ab863a4d1023acff25635c1b4a36015a2}{dht\_temp\_pk}, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, crypto\_box\_PUBLICKEYBYTES) == 0) \{
163         \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_ace58c2ab8adca0a754bcd2527e88a9d2}{dht\_ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} != 0) \{
164             ip\_port.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip} = friend\_con->\hyperlink{struct_friend___conn_ace58c2ab8adca0a754bcd2527e88a9d2}{dht\_ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip};
165         \} \textcolor{keywordflow}{else} \{
166             friend\_con->\hyperlink{struct_friend___conn_a4865ba9009fdee84e62a08fb92a59ab5}{hosting\_tcp\_relay} = 0;
167         \}
168     \}
169 
170     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
171 
172     uint16\_t index = friend\_con->\hyperlink{struct_friend___conn_aff5cc62447994133f0b5b15e11aa92ed}{tcp\_relay\_counter} % 
      \hyperlink{friend__connection_8h_aac882ca62f0b32b069ace03fa3f106c0}{FRIEND\_MAX\_STORED\_TCP\_RELAYS};
173 
174     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{friend__connection_8h_aac882ca62f0b32b069ace03fa3f106c0}{FRIEND\_MAX\_STORED\_TCP\_RELAYS}; ++
      \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
175         \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_ae6c286282d15bfd5ceea7c2d8b19be5d}{tcp\_relays}[i].\hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port}.\hyperlink{struct_i_p___port_a0c6193a337a223c63411b2fe722d79ec}{ip}.\hyperlink{struct_i_p_adad4493a852deb413bb8c515368deaac}{family} != 0
176                 && memcmp(friend\_con->\hyperlink{struct_friend___conn_ae6c286282d15bfd5ceea7c2d8b19be5d}{tcp\_relays}[i].\hyperlink{struct_node__format_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, crypto\_box\_PUBLICKEYBYTES) == 0) \{
177             memset(&friend\_con->\hyperlink{struct_friend___conn_ae6c286282d15bfd5ceea7c2d8b19be5d}{tcp\_relays}[i], 0, \textcolor{keyword}{sizeof}(\hyperlink{struct_node__format}{Node\_format}));
178         \}
179     \}
180 
181     friend\_con->\hyperlink{struct_friend___conn_ae6c286282d15bfd5ceea7c2d8b19be5d}{tcp\_relays}[index].\hyperlink{struct_node__format_a86e2a5a56c0dd22df6e8b8a10e40f9e4}{ip\_port} = ip\_port;
182     memcpy(friend\_con->\hyperlink{struct_friend___conn_ae6c286282d15bfd5ceea7c2d8b19be5d}{tcp\_relays}[index].\hyperlink{struct_node__format_aaa806bb1136fb3d4b5d8d8970b596ff7}{public\_key}, 
      \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key}, crypto\_box\_PUBLICKEYBYTES);
183     ++friend\_con->\hyperlink{struct_friend___conn_aff5cc62447994133f0b5b15e11aa92ed}{tcp\_relay\_counter};
184 
185     \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_a4b9f3aef7b0d4c461294e24a21e64e71}{add\_tcp\_relay\_peer}(fr\_c->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, friend\_con->
      \hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id}, ip\_port, \hyperlink{namespacemake-funny-savefile_a6734667aeff5c30ad9e5624ccb556a87}{public\_key});
186 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ac89688f7660c1cb5fb664ecc09bab460_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ac89688f7660c1cb5fb664ecc09bab460_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_ae5c94f8543c84506c85faac6d2b3a9dd}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!friend\+\_\+con\+\_\+connected@{friend\+\_\+con\+\_\+connected}}
\index{friend\+\_\+con\+\_\+connected@{friend\+\_\+con\+\_\+connected}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{friend\+\_\+con\+\_\+connected}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int friend\+\_\+con\+\_\+connected (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_ae5c94f8543c84506c85faac6d2b3a9dd}


Definition at line 561 of file friend\+\_\+connection.\+c.



References get\+\_\+conn(), and Friend\+\_\+\+Conn\+::status.



Referenced by connect\+\_\+to\+\_\+closest(), init\+\_\+new\+\_\+friend(), and m\+\_\+delfriend().


\begin{DoxyCode}
562 \{
563     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
564 
565     \textcolor{keywordflow}{if} (!friend\_con)
566         \textcolor{keywordflow}{return} 0;
567 
568     \textcolor{keywordflow}{return} friend\_con->\hyperlink{struct_friend___conn_ade818037fd6c985038ff29656089758d}{status};
569 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ae5c94f8543c84506c85faac6d2b3a9dd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ae5c94f8543c84506c85faac6d2b3a9dd_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a15c404d517b4a4fb3976f4d85bfbaef0}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!friend\+\_\+connection\+\_\+callbacks@{friend\+\_\+connection\+\_\+callbacks}}
\index{friend\+\_\+connection\+\_\+callbacks@{friend\+\_\+connection\+\_\+callbacks}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{friend\+\_\+connection\+\_\+callbacks}]{\setlength{\rightskip}{0pt plus 5cm}int friend\+\_\+connection\+\_\+callbacks (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id, }
\item[{unsigned int}]{index, }
\item[{int($\ast$)(void $\ast$object, int id, uint8\+\_\+t status)}]{status\+\_\+callback, }
\item[{int($\ast$)(void $\ast$object, int id, uint8\+\_\+t $\ast$data, uint16\+\_\+t length)}]{data\+\_\+callback, }
\item[{int($\ast$)(void $\ast$object, int id, const uint8\+\_\+t $\ast$data, uint16\+\_\+t length)}]{lossy\+\_\+data\+\_\+callback, }
\item[{void $\ast$}]{object, }
\item[{int}]{number}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a15c404d517b4a4fb3976f4d85bfbaef0}


Definition at line 605 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Conn\+::callbacks, Friend\+\_\+\+Conn\+::data\+\_\+callback, data\+\_\+callback(), Friend\+\_\+\+Conn\+::data\+\_\+callback\+\_\+id, Friend\+\_\+\+Conn\+::data\+\_\+callback\+\_\+object, get\+\_\+conn(), Friend\+\_\+\+Conn\+::lossy\+\_\+data\+\_\+callback, Friend\+\_\+\+Conn\+::lossy\+\_\+data\+\_\+callback\+\_\+id, Friend\+\_\+\+Conn\+::lossy\+\_\+data\+\_\+callback\+\_\+object, M\+A\+X\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+O\+N\+\_\+\+C\+A\+L\+L\+B\+A\+C\+K\+S, Friend\+\_\+\+Conn\+::status\+\_\+callback, status\+\_\+callback(), Friend\+\_\+\+Conn\+::status\+\_\+callback\+\_\+id, and Friend\+\_\+\+Conn\+::status\+\_\+callback\+\_\+object.



Referenced by add\+\_\+conn\+\_\+to\+\_\+groupchat(), init\+\_\+new\+\_\+friend(), and m\+\_\+delfriend().


\begin{DoxyCode}
609 \{
610     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
611 
612     \textcolor{keywordflow}{if} (!friend\_con)
613         \textcolor{keywordflow}{return} -1;
614 
615     \textcolor{keywordflow}{if} (index >= \hyperlink{friend__connection_8h_a28f384352cf0b5c144fdafb826701811}{MAX\_FRIEND\_CONNECTION\_CALLBACKS})
616         \textcolor{keywordflow}{return} -1;
617 
618     friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a5b3bbefec1bad16d4dbacabf34692bd6}{status\_callback} = 
      \hyperlink{_t_c_p__test_8c_ae4f12b6805a17277d33e73ac030d7aca}{status\_callback};
619     friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_aeff54fdc061a263f5d331a9e0572fee7}{data\_callback} = 
      \hyperlink{_t_c_p__test_8c_a36ed22ce4a6bec3fb113a4eaf29df5e1}{data\_callback};
620     friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a12463710aaaa4801d03d6fe347d16e3e}{lossy\_data\_callback} = lossy\_data\_callback;
621 
622     friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a73f125475af5ebdac27d2c2a9060039b}{status\_callback\_object} =
623         friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a9135a1782241a1b2d5e9bcedef0c29a5}{data\_callback\_object} =
624             friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a5a1c6eb314a3e3142dd5ae3d3868491b}{lossy\_data\_callback\_object} = 
      object;
625 
626     friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a374df80da5cf3057d7c3743afadb2596}{status\_callback\_id} =
627         friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a51067e0002b1d9ac8e14377917289292}{data\_callback\_id} =
628             friend\_con->\hyperlink{struct_friend___conn_a213983130190a8281ab689630f0aee97}{callbacks}[index].\hyperlink{struct_friend___conn_a5c67a04bbd12eda4d5fe29f10d082bec}{lossy\_data\_callback\_id} = number;
629     \textcolor{keywordflow}{return} 0;
630 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a15c404d517b4a4fb3976f4d85bfbaef0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a15c404d517b4a4fb3976f4d85bfbaef0_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a8586e3dfb2047821c4214adf8d06a877}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id@{friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id}}
\index{friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id@{friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id}]{\setlength{\rightskip}{0pt plus 5cm}int friend\+\_\+connection\+\_\+crypt\+\_\+connection\+\_\+id (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a8586e3dfb2047821c4214adf8d06a877}


Definition at line 637 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Conn\+::crypt\+\_\+connection\+\_\+id, and get\+\_\+conn().



Referenced by do\+\_\+reqchunk\+\_\+filecb(), file\+\_\+data(), friend\+\_\+received\+\_\+packet(), m\+\_\+get\+\_\+friend\+\_\+connectionstatus(), m\+\_\+send\+\_\+message\+\_\+generic(), send\+\_\+custom\+\_\+lossless\+\_\+packet(), send\+\_\+custom\+\_\+lossy\+\_\+packet(), send\+\_\+file\+\_\+data\+\_\+packet(), send\+\_\+lossy\+\_\+group\+\_\+peer(), send\+\_\+offline\+\_\+packet(), send\+\_\+online\+\_\+packet(), send\+\_\+packet\+\_\+group\+\_\+peer(), send\+\_\+packet\+\_\+online(), and write\+\_\+cryptpacket\+\_\+id().


\begin{DoxyCode}
638 \{
639     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
640 
641     \textcolor{keywordflow}{if} (!friend\_con)
642         \textcolor{keywordflow}{return} -1;
643 
644     \textcolor{keywordflow}{return} friend\_con->\hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id};
645 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a8586e3dfb2047821c4214adf8d06a877_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a8586e3dfb2047821c4214adf8d06a877_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_ae9fc0c8cb8838cd5d069e44911c23e63}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!friend\+\_\+connection\+\_\+lock@{friend\+\_\+connection\+\_\+lock}}
\index{friend\+\_\+connection\+\_\+lock@{friend\+\_\+connection\+\_\+lock}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{friend\+\_\+connection\+\_\+lock}]{\setlength{\rightskip}{0pt plus 5cm}int friend\+\_\+connection\+\_\+lock (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_ae9fc0c8cb8838cd5d069e44911c23e63}


Definition at line 546 of file friend\+\_\+connection.\+c.



References get\+\_\+conn(), and Friend\+\_\+\+Conn\+::lock\+\_\+count.



Referenced by add\+\_\+conn\+\_\+to\+\_\+groupchat().


\begin{DoxyCode}
547 \{
548     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
549 
550     \textcolor{keywordflow}{if} (!friend\_con)
551         \textcolor{keywordflow}{return} -1;
552 
553     ++friend\_con->\hyperlink{struct_friend___conn_a712c4c639bfc0f5a8616eead3e24ca4e}{lock\_count};
554     \textcolor{keywordflow}{return} 0;
555 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ae9fc0c8cb8838cd5d069e44911c23e63_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ae9fc0c8cb8838cd5d069e44911c23e63_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a4605fa0bd8ff3f9bd217ee6dcadbfe5f}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!get\+\_\+friendcon\+\_\+public\+\_\+keys@{get\+\_\+friendcon\+\_\+public\+\_\+keys}}
\index{get\+\_\+friendcon\+\_\+public\+\_\+keys@{get\+\_\+friendcon\+\_\+public\+\_\+keys}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{get\+\_\+friendcon\+\_\+public\+\_\+keys}]{\setlength{\rightskip}{0pt plus 5cm}int get\+\_\+friendcon\+\_\+public\+\_\+keys (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{real\+\_\+pk, }
\item[{uint8\+\_\+t $\ast$}]{dht\+\_\+temp\+\_\+pk, }
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a4605fa0bd8ff3f9bd217ee6dcadbfe5f}


Definition at line 576 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Conn\+::dht\+\_\+temp\+\_\+pk, get\+\_\+conn(), and Friend\+\_\+\+Conn\+::real\+\_\+public\+\_\+key.



Referenced by connect\+\_\+to\+\_\+closest(), handle\+\_\+friend\+\_\+invite\+\_\+packet(), and send\+\_\+lossy\+\_\+all\+\_\+close().


\begin{DoxyCode}
577 \{
578     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
579 
580     \textcolor{keywordflow}{if} (!friend\_con)
581         \textcolor{keywordflow}{return} -1;
582 
583     \textcolor{keywordflow}{if} (real\_pk)
584         memcpy(real\_pk, friend\_con->\hyperlink{struct_friend___conn_a996dcaefa2a5954a199e2beb584c1feb}{real\_public\_key}, crypto\_box\_PUBLICKEYBYTES);
585 
586     \textcolor{keywordflow}{if} (dht\_temp\_pk)
587         memcpy(dht\_temp\_pk, friend\_con->\hyperlink{struct_friend___conn_ab863a4d1023acff25635c1b4a36015a2}{dht\_temp\_pk}, crypto\_box\_PUBLICKEYBYTES);
588 
589     \textcolor{keywordflow}{return} 0;
590 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a4605fa0bd8ff3f9bd217ee6dcadbfe5f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a4605fa0bd8ff3f9bd217ee6dcadbfe5f_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a97c5d86b2475e17f2cda62ad13df1bea}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!getfriend\+\_\+conn\+\_\+id\+\_\+pk@{getfriend\+\_\+conn\+\_\+id\+\_\+pk}}
\index{getfriend\+\_\+conn\+\_\+id\+\_\+pk@{getfriend\+\_\+conn\+\_\+id\+\_\+pk}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{getfriend\+\_\+conn\+\_\+id\+\_\+pk}]{\setlength{\rightskip}{0pt plus 5cm}int getfriend\+\_\+conn\+\_\+id\+\_\+pk (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{const uint8\+\_\+t $\ast$}]{real\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a97c5d86b2475e17f2cda62ad13df1bea}


Definition at line 133 of file friend\+\_\+connection.\+c.



References get\+\_\+conn(), i, Friend\+\_\+\+Connections\+::num\+\_\+cons, and Friend\+\_\+\+Conn\+::real\+\_\+public\+\_\+key.



Referenced by connect\+\_\+to\+\_\+closest(), delpeer(), handle\+\_\+new\+\_\+connections(), and new\+\_\+friend\+\_\+connection().


\begin{DoxyCode}
134 \{
135     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
136 
137     \textcolor{keywordflow}{for} (i = 0; i < fr\_c->\hyperlink{struct_friend___connections_a81ac77652d6cc5071baca915581c5dfa}{num\_cons}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
138         \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, i);
139 
140         \textcolor{keywordflow}{if} (friend\_con) \{
141             \textcolor{keywordflow}{if} (memcmp(friend\_con->\hyperlink{struct_friend___conn_a996dcaefa2a5954a199e2beb584c1feb}{real\_public\_key}, real\_pk, crypto\_box\_PUBLICKEYBYTES) == 0
      )
142                 \textcolor{keywordflow}{return} \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
143         \}
144     \}
145 
146     \textcolor{keywordflow}{return} -1;
147 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a97c5d86b2475e17f2cda62ad13df1bea_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a97c5d86b2475e17f2cda62ad13df1bea_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a5f311791c0ec4ecd8fdf5359cf7fb95a}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!kill\+\_\+friend\+\_\+connection@{kill\+\_\+friend\+\_\+connection}}
\index{kill\+\_\+friend\+\_\+connection@{kill\+\_\+friend\+\_\+connection}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{kill\+\_\+friend\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}int kill\+\_\+friend\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a5f311791c0ec4ecd8fdf5359cf7fb95a}


Definition at line 690 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Conn\+::crypt\+\_\+connection\+\_\+id, crypto\+\_\+kill(), Friend\+\_\+\+Connections\+::dht, D\+H\+T\+\_\+delfriend(), Friend\+\_\+\+Conn\+::dht\+\_\+lock, Friend\+\_\+\+Conn\+::dht\+\_\+temp\+\_\+pk, get\+\_\+conn(), Friend\+\_\+\+Conn\+::lock\+\_\+count, Friend\+\_\+\+Connections\+::net\+\_\+crypto, Friend\+\_\+\+Connections\+::onion\+\_\+c, onion\+\_\+delfriend(), Friend\+\_\+\+Conn\+::onion\+\_\+friendnum, and wipe\+\_\+friend\+\_\+conn().



Referenced by connect\+\_\+to\+\_\+closest(), del\+\_\+groupchat(), handle\+\_\+direct\+\_\+packet(), handle\+\_\+packet\+\_\+online(), kill\+\_\+friend\+\_\+connections(), m\+\_\+delfriend(), and remove\+\_\+close\+\_\+conn().


\begin{DoxyCode}
691 \{
692     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
693 
694     \textcolor{keywordflow}{if} (!friend\_con)
695         \textcolor{keywordflow}{return} -1;
696 
697     \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a712c4c639bfc0f5a8616eead3e24ca4e}{lock\_count}) \{
698         --friend\_con->\hyperlink{struct_friend___conn_a712c4c639bfc0f5a8616eead3e24ca4e}{lock\_count};
699         \textcolor{keywordflow}{return} 0;
700     \}
701 
702     \hyperlink{onion__client_8c_a986bc935dff33db8070c431fcd2363eb}{onion\_delfriend}(fr\_c->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, friend\_con->
      \hyperlink{struct_friend___conn_a009e6d32e21cc7fb0c8caded782e974b}{onion\_friendnum});
703     \hyperlink{net__crypto_8c_a16c3a0008512675dad8eb00ff1822763}{crypto\_kill}(fr\_c->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, friend\_con->
      \hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id});
704 
705     \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_a1da451cf7bce45009c3ae38c003f2ed8}{dht\_lock}) \{
706         \hyperlink{_d_h_t_8c_a4e70f3fc186c6e459908307c935d00b2}{DHT\_delfriend}(fr\_c->\hyperlink{struct_friend___connections_a8b3d6ce8745acc52695e252bdb1531b6}{dht}, friend\_con->\hyperlink{struct_friend___conn_ab863a4d1023acff25635c1b4a36015a2}{dht\_temp\_pk}, friend\_con->
      \hyperlink{struct_friend___conn_a1da451cf7bce45009c3ae38c003f2ed8}{dht\_lock});
707     \}
708 
709     \textcolor{keywordflow}{return} \hyperlink{friend__connection_8c_af2c8594ddd6bfd683ee88fcfef107080}{wipe\_friend\_conn}(fr\_c, friendcon\_id);
710 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a5f311791c0ec4ecd8fdf5359cf7fb95a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a5f311791c0ec4ecd8fdf5359cf7fb95a_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a2ef8cdbd93f21f11ff0333a9527c2c02}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!kill\+\_\+friend\+\_\+connections@{kill\+\_\+friend\+\_\+connections}}
\index{kill\+\_\+friend\+\_\+connections@{kill\+\_\+friend\+\_\+connections}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{kill\+\_\+friend\+\_\+connections}]{\setlength{\rightskip}{0pt plus 5cm}void kill\+\_\+friend\+\_\+connections (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a2ef8cdbd93f21f11ff0333a9527c2c02}


Definition at line 842 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Connections\+::dht, i, kill\+\_\+friend\+\_\+connection(), L\+A\+Ndiscovery\+\_\+kill(), and Friend\+\_\+\+Connections\+::num\+\_\+cons.



Referenced by kill\+\_\+messenger(), and new\+\_\+messenger().


\begin{DoxyCode}
843 \{
844     \textcolor{keywordflow}{if} (!fr\_c)
845         \textcolor{keywordflow}{return};
846 
847     uint32\_t \hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i};
848 
849     \textcolor{keywordflow}{for} (i = 0; i < fr\_c->\hyperlink{struct_friend___connections_a81ac77652d6cc5071baca915581c5dfa}{num\_cons}; ++\hyperlink{toxav__many__test_8c_acb559820d9ca11295b4500f179ef6392}{i}) \{
850         \hyperlink{friend__connection_8c_a5f311791c0ec4ecd8fdf5359cf7fb95a}{kill\_friend\_connection}(fr\_c, i);
851     \}
852 
853     \hyperlink{_l_a_n__discovery_8c_af2a395c13cd4dff580e3638f41ef02d0}{LANdiscovery\_kill}(fr\_c->\hyperlink{struct_friend___connections_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
854     free(fr\_c);
855 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a2ef8cdbd93f21f11ff0333a9527c2c02_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a2ef8cdbd93f21f11ff0333a9527c2c02_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a613a80a004fccd616de2a67d84a25d3c}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!new\+\_\+friend\+\_\+connection@{new\+\_\+friend\+\_\+connection}}
\index{new\+\_\+friend\+\_\+connection@{new\+\_\+friend\+\_\+connection}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{new\+\_\+friend\+\_\+connection}]{\setlength{\rightskip}{0pt plus 5cm}int new\+\_\+friend\+\_\+connection (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{const uint8\+\_\+t $\ast$}]{real\+\_\+public\+\_\+key}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a613a80a004fccd616de2a67d84a25d3c}


Definition at line 653 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Connections\+::conns, create\+\_\+friend\+\_\+conn(), Friend\+\_\+\+Conn\+::crypt\+\_\+connection\+\_\+id, dht\+\_\+pk\+\_\+callback(), F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+I\+N\+G, getfriend\+\_\+conn\+\_\+id\+\_\+pk(), Friend\+\_\+\+Conn\+::lock\+\_\+count, onion\+\_\+addfriend(), Friend\+\_\+\+Connections\+::onion\+\_\+c, onion\+\_\+dht\+\_\+pk\+\_\+callback(), Friend\+\_\+\+Conn\+::onion\+\_\+friendnum, Friend\+\_\+\+Conn\+::real\+\_\+public\+\_\+key, recv\+\_\+tcp\+\_\+relay\+\_\+handler(), Friend\+\_\+\+Conn\+::status, and tcp\+\_\+relay\+\_\+node\+\_\+callback().



Referenced by connect\+\_\+to\+\_\+closest(), and init\+\_\+new\+\_\+friend().


\begin{DoxyCode}
654 \{
655     \textcolor{keywordtype}{int} friendcon\_id = \hyperlink{friend__connection_8c_a97c5d86b2475e17f2cda62ad13df1bea}{getfriend\_conn\_id\_pk}(fr\_c, real\_public\_key);
656 
657     \textcolor{keywordflow}{if} (friendcon\_id != -1) \{
658         ++fr\_c->\hyperlink{struct_friend___connections_a2690adb6c61682af2e8592f53e9de9a0}{conns}[friendcon\_id].\hyperlink{struct_friend___conn_a712c4c639bfc0f5a8616eead3e24ca4e}{lock\_count};
659         \textcolor{keywordflow}{return} friendcon\_id;
660     \}
661 
662     friendcon\_id = \hyperlink{friend__connection_8c_ad22b76facda79873a4cde9562c8cd663}{create\_friend\_conn}(fr\_c);
663 
664     \textcolor{keywordflow}{if} (friendcon\_id == -1)
665         \textcolor{keywordflow}{return} -1;
666 
667     int32\_t onion\_friendnum = \hyperlink{onion__client_8c_a4dd8a80061f115daba3ffb2a3f611b38}{onion\_addfriend}(fr\_c->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, real\_public\_key);
668 
669     \textcolor{keywordflow}{if} (onion\_friendnum == -1)
670         \textcolor{keywordflow}{return} -1;
671 
672     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = &fr\_c->\hyperlink{struct_friend___connections_a2690adb6c61682af2e8592f53e9de9a0}{conns}[friendcon\_id];
673 
674     friend\_con->\hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id} = -1;
675     friend\_con->\hyperlink{struct_friend___conn_ade818037fd6c985038ff29656089758d}{status} = \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5a0ad1ac040d579509cc0a3f1df0ab38ad}{FRIENDCONN\_STATUS\_CONNECTING};
676     memcpy(friend\_con->\hyperlink{struct_friend___conn_a996dcaefa2a5954a199e2beb584c1feb}{real\_public\_key}, real\_public\_key, crypto\_box\_PUBLICKEYBYTES);
677     friend\_con->\hyperlink{struct_friend___conn_a009e6d32e21cc7fb0c8caded782e974b}{onion\_friendnum} = onion\_friendnum;
678 
679     \hyperlink{onion__client_8c_a7bb680d62616d0dfbb6f7d2ff097107c}{recv\_tcp\_relay\_handler}(fr\_c->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, onion\_friendnum, &
      \hyperlink{friend__connection_8c_a9360ec098f2b1082b480b4e36b0a5f07}{tcp\_relay\_node\_callback}, fr\_c, friendcon\_id);
680     \hyperlink{onion__client_8c_a08895281211a01749ee466338fedbeec}{onion\_dht\_pk\_callback}(fr\_c->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, onion\_friendnum, &
      \hyperlink{friend__connection_8c_a53d1bd9e6126683e05e0e14cc70d1a8a}{dht\_pk\_callback}, fr\_c, friendcon\_id);
681 
682     \textcolor{keywordflow}{return} friendcon\_id;
683 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a613a80a004fccd616de2a67d84a25d3c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a613a80a004fccd616de2a67d84a25d3c_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a319bec2419cf5fc5525af4fae03b86ef}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!new\+\_\+friend\+\_\+connections@{new\+\_\+friend\+\_\+connections}}
\index{new\+\_\+friend\+\_\+connections@{new\+\_\+friend\+\_\+connections}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{new\+\_\+friend\+\_\+connections}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Friend\+\_\+\+Connections}$\ast$ new\+\_\+friend\+\_\+connections (
\begin{DoxyParamCaption}
\item[{{\bf Onion\+\_\+\+Client} $\ast$}]{onion\+\_\+c}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a319bec2419cf5fc5525af4fae03b86ef}


Definition at line 761 of file friend\+\_\+connection.\+c.



References Onion\+\_\+\+Client\+::c, Friend\+\_\+\+Connections\+::dht, Onion\+\_\+\+Client\+::dht, handle\+\_\+new\+\_\+connections(), L\+A\+Ndiscovery\+\_\+init(), Friend\+\_\+\+Connections\+::net\+\_\+crypto, new\+\_\+connection\+\_\+handler(), and Friend\+\_\+\+Connections\+::onion\+\_\+c.



Referenced by new\+\_\+messenger().


\begin{DoxyCode}
762 \{
763     \textcolor{keywordflow}{if} (!onion\_c)
764         \textcolor{keywordflow}{return} NULL;
765 
766     \hyperlink{struct_friend___connections}{Friend\_Connections} *temp = calloc(1, \textcolor{keyword}{sizeof}(
      \hyperlink{struct_friend___connections}{Friend\_Connections}));
767 
768     \textcolor{keywordflow}{if} (temp == NULL)
769         \textcolor{keywordflow}{return} NULL;
770 
771     temp->\hyperlink{struct_friend___connections_a8b3d6ce8745acc52695e252bdb1531b6}{dht} = onion\_c->\hyperlink{struct_onion___client_a8b3d6ce8745acc52695e252bdb1531b6}{dht};
772     temp->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto} = onion\_c->\hyperlink{struct_onion___client_a0f5b9349eb586149cef9017eed2abdfe}{c};
773     temp->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c} = onion\_c;
774 
775     \hyperlink{net__crypto_8c_adaa8cd47d0ede85ca13626e91d2e995d}{new\_connection\_handler}(temp->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, &
      \hyperlink{friend__connection_8c_ad12421e11a4e0a8ca7223e0d715d2b0c}{handle\_new\_connections}, temp);
776     \hyperlink{_l_a_n__discovery_8c_ab5177e8d5fc82b7c156f777f13649912}{LANdiscovery\_init}(temp->\hyperlink{struct_friend___connections_a8b3d6ce8745acc52695e252bdb1531b6}{dht});
777 
778     \textcolor{keywordflow}{return} temp;
779 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a319bec2419cf5fc5525af4fae03b86ef_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a319bec2419cf5fc5525af4fae03b86ef_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a2af492c22c086276ed147d0826839d25}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!send\+\_\+friend\+\_\+request\+\_\+packet@{send\+\_\+friend\+\_\+request\+\_\+packet}}
\index{send\+\_\+friend\+\_\+request\+\_\+packet@{send\+\_\+friend\+\_\+request\+\_\+packet}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{send\+\_\+friend\+\_\+request\+\_\+packet}]{\setlength{\rightskip}{0pt plus 5cm}int send\+\_\+friend\+\_\+request\+\_\+packet (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id, }
\item[{uint32\+\_\+t}]{nospam\+\_\+num, }
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint16\+\_\+t}]{length}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a2af492c22c086276ed147d0826839d25}


Definition at line 731 of file friend\+\_\+connection.\+c.



References Friend\+\_\+\+Conn\+::crypt\+\_\+connection\+\_\+id, C\+R\+Y\+P\+T\+O\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q, F\+R\+I\+E\+N\+D\+C\+O\+N\+N\+\_\+\+S\+T\+A\+T\+U\+S\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D, get\+\_\+conn(), Friend\+\_\+\+Connections\+::net\+\_\+crypto, num, Friend\+\_\+\+Connections\+::onion\+\_\+c, O\+N\+I\+O\+N\+\_\+\+C\+L\+I\+E\+N\+T\+\_\+\+M\+A\+X\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E, Friend\+\_\+\+Conn\+::onion\+\_\+friendnum, P\+A\+C\+K\+E\+T\+\_\+\+I\+D\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q\+U\+E\+S\+T\+S, send\+\_\+onion\+\_\+data(), Friend\+\_\+\+Conn\+::status, and write\+\_\+cryptpacket().



Referenced by do\+\_\+friends().


\begin{DoxyCode}
733 \{
734     \textcolor{keywordflow}{if} (1 + \textcolor{keyword}{sizeof}(nospam\_num) + length > \hyperlink{onion__client_8h_ac85db1e76117776faac7e5c454808bbd}{ONION\_CLIENT\_MAX\_DATA\_SIZE} || length ==
       0)
735         \textcolor{keywordflow}{return} -1;
736 
737     \hyperlink{struct_friend___conn}{Friend\_Conn} *friend\_con = \hyperlink{friend__connection_8c_a0c0c32645b094058a6e6d6bcab4ed718}{get\_conn}(fr\_c, friendcon\_id);
738 
739     \textcolor{keywordflow}{if} (!friend\_con)
740         \textcolor{keywordflow}{return} -1;
741 
742     uint8\_t packet[1 + \textcolor{keyword}{sizeof}(nospam\_num) + length];
743     memcpy(packet + 1, &nospam\_num, \textcolor{keyword}{sizeof}(nospam\_num));
744     memcpy(packet + 1 + \textcolor{keyword}{sizeof}(nospam\_num), \hyperlink{namespacemake-funny-savefile_aa7a0efb8690a34f61a95b00cc723ca27}{data}, length);
745 
746     \textcolor{keywordflow}{if} (friend\_con->\hyperlink{struct_friend___conn_ade818037fd6c985038ff29656089758d}{status} == \hyperlink{friend__connection_8h_a99fb83031ce9923c84392b4e92f956b5ad8c8e0080a23ea8dc2a883e4321f0598}{FRIENDCONN\_STATUS\_CONNECTED}) \{
747         packet[0] = \hyperlink{friend__connection_8h_ac63465b658c6d3b4ac5c6a543cd0728a}{PACKET\_ID\_FRIEND\_REQUESTS};
748         \textcolor{keywordflow}{return} \hyperlink{net__crypto_8c_ab17ccce6d503f75b7d98be214ebd7621}{write\_cryptpacket}(fr\_c->\hyperlink{struct_friend___connections_ab06a41217a1e9b5985555e19e088ae94}{net\_crypto}, friend\_con->
      \hyperlink{struct_friend___conn_a5ca114d88c26607a45883173f86c7c20}{crypt\_connection\_id}, packet, \textcolor{keyword}{sizeof}(packet), 0) != -1;
749     \} \textcolor{keywordflow}{else} \{
750         packet[0] = \hyperlink{crypto__core_8h_ae5cf60e6c6a34326d0d7ac15df18ba25}{CRYPTO\_PACKET\_FRIEND\_REQ};
751         \textcolor{keywordtype}{int} \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num} = \hyperlink{onion__client_8c_aa1be42b5ea93bd068f47271831157927}{send\_onion\_data}(fr\_c->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, friend\_con->
      \hyperlink{struct_friend___conn_a009e6d32e21cc7fb0c8caded782e974b}{onion\_friendnum}, packet, \textcolor{keyword}{sizeof}(packet));
752 
753         \textcolor{keywordflow}{if} (num <= 0)
754             \textcolor{keywordflow}{return} -1;
755 
756         \textcolor{keywordflow}{return} \hyperlink{tox__test_8c_abea371f9030e15a5d2a4c181576833d8}{num};
757     \}
758 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a2af492c22c086276ed147d0826839d25_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a2af492c22c086276ed147d0826839d25_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_a04fb221a2ac726ec3ca86be7b1e63238}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!set\+\_\+dht\+\_\+temp\+\_\+pk@{set\+\_\+dht\+\_\+temp\+\_\+pk}}
\index{set\+\_\+dht\+\_\+temp\+\_\+pk@{set\+\_\+dht\+\_\+temp\+\_\+pk}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{set\+\_\+dht\+\_\+temp\+\_\+pk}]{\setlength{\rightskip}{0pt plus 5cm}void set\+\_\+dht\+\_\+temp\+\_\+pk (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int}]{friendcon\+\_\+id, }
\item[{const uint8\+\_\+t $\ast$}]{dht\+\_\+temp\+\_\+pk}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_a04fb221a2ac726ec3ca86be7b1e63238}


Definition at line 594 of file friend\+\_\+connection.\+c.



References dht\+\_\+pk\+\_\+callback().



Referenced by connect\+\_\+to\+\_\+closest().


\begin{DoxyCode}
595 \{
596     \hyperlink{friend__connection_8c_a53d1bd9e6126683e05e0e14cc70d1a8a}{dht\_pk\_callback}(fr\_c, friendcon\_id, dht\_temp\_pk);
597 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a04fb221a2ac726ec3ca86be7b1e63238_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_a04fb221a2ac726ec3ca86be7b1e63238_icgraph}
\end{center}
\end{figure}


\hypertarget{friend__connection_8h_ab3249bbbafb0a8be7d181e3bc6f9563f}{\index{friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}!set\+\_\+friend\+\_\+request\+\_\+callback@{set\+\_\+friend\+\_\+request\+\_\+callback}}
\index{set\+\_\+friend\+\_\+request\+\_\+callback@{set\+\_\+friend\+\_\+request\+\_\+callback}!friend\+\_\+connection.\+h@{friend\+\_\+connection.\+h}}
\subsubsection[{set\+\_\+friend\+\_\+request\+\_\+callback}]{\setlength{\rightskip}{0pt plus 5cm}void set\+\_\+friend\+\_\+request\+\_\+callback (
\begin{DoxyParamCaption}
\item[{{\bf Friend\+\_\+\+Connections} $\ast$}]{fr\+\_\+c, }
\item[{int($\ast$)(void $\ast$, const uint8\+\_\+t $\ast$, const uint8\+\_\+t $\ast$, uint16\+\_\+t)}]{fr\+\_\+request\+\_\+callback, }
\item[{void $\ast$}]{object}
\end{DoxyParamCaption}
)}}\label{friend__connection_8h_ab3249bbbafb0a8be7d181e3bc6f9563f}


Definition at line 717 of file friend\+\_\+connection.\+c.



References C\+R\+Y\+P\+T\+O\+\_\+\+P\+A\+C\+K\+E\+T\+\_\+\+F\+R\+I\+E\+N\+D\+\_\+\+R\+E\+Q, Friend\+\_\+\+Connections\+::fr\+\_\+request\+\_\+callback, Friend\+\_\+\+Connections\+::fr\+\_\+request\+\_\+object, Friend\+\_\+\+Connections\+::onion\+\_\+c, and oniondata\+\_\+registerhandler().



Referenced by friendreq\+\_\+init().


\begin{DoxyCode}
719 \{
720     fr\_c->\hyperlink{struct_friend___connections_a36e4f0e3167d9e95df5d7f83cbafa7fc}{fr\_request\_callback} = fr\_request\_callback;
721     fr\_c->\hyperlink{struct_friend___connections_abd31f2a386ec582b378de4fc3f05ea6c}{fr\_request\_object} = object;
722     \hyperlink{onion__client_8c_a2dfcba5e4eb429f5f2ae79ae999149c4}{oniondata\_registerhandler}(fr\_c->\hyperlink{struct_friend___connections_ae202b81f9a2c2fa80fd310a0996795fc}{onion\_c}, 
      \hyperlink{crypto__core_8h_ae5cf60e6c6a34326d0d7ac15df18ba25}{CRYPTO\_PACKET\_FRIEND\_REQ}, fr\_request\_callback, \textcolor{keywordtype}{object});
723 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{d0/d08/friend__connection_8h_ab3249bbbafb0a8be7d181e3bc6f9563f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d08/friend__connection_8h_ab3249bbbafb0a8be7d181e3bc6f9563f_icgraph}
\end{center}
\end{figure}


